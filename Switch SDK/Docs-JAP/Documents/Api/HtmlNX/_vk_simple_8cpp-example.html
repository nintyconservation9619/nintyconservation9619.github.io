<!-- HTML header for doxygen 1.8.8-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.10"/>
<title>NintendoSDK API Reference: VkSimple.cpp</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="openclose.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="stylesheet.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">NintendoSDK API Reference
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- 構築: Doxygen 1.8.10 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'検索');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>総合概要</span></a></li>
      <li><a href="pages.html"><span>諸情報</span></a></li>
      <li><a href="modules.html"><span>モジュール</span></a></li>
      <li><a href="namespaces.html"><span>名前空間</span></a></li>
      <li><a href="annotated.html"><span>クラス</span></a></li>
      <li><a href="files.html"><span>ファイル</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="検索" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">VkSimple.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<p>ソースコードの説明は、<a class="el" href="_page_sample_vk_simple.html">VkSimple</a> および <a class="el" href="_vk_simple_8cpp.html" title="Basic example of initializing and using Vulkan. ">VkSimple.cpp</a> を参照してください。</p>
<div class="fragment"><div class="line"><span class="comment">/*--------------------------------------------------------------------------------*</span></div>
<div class="line"><span class="comment">  Copyright (C)Nintendo All rights reserved.</span></div>
<div class="line"><span class="comment"></span></div>
<div class="line"><span class="comment">  These coded instructions, statements, and computer programs contain proprietary</span></div>
<div class="line"><span class="comment">  information of Nintendo and/or its licensed developers and are protected by</span></div>
<div class="line"><span class="comment">  national and international copyright laws. They may not be disclosed to third</span></div>
<div class="line"><span class="comment">  parties or copied or duplicated in any form, in whole or in part, without the</span></div>
<div class="line"><span class="comment">  prior written consent of Nintendo.</span></div>
<div class="line"><span class="comment"></span></div>
<div class="line"><span class="comment">  The content herein is highly confidential and should be handled accordingly.</span></div>
<div class="line"><span class="comment"> *--------------------------------------------------------------------------------*/</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#ifndef VK_USE_PLATFORM_VI_NN</span></div>
<div class="line"><span class="preprocessor">#define VK_USE_PLATFORM_VI_NN</span></div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="nn___assert_8h.html">nn/nn_Assert.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="nn___log_8h.html">nn/nn_Log.h</a>&gt;</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#include &lt;nn/nn_Result.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="fs_8h.html">nn/fs.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;nn/os.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="init_8h.html">nn/init.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="vi_8h.html">nn/vi.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;nn/hid.h&gt;</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="nv___memory_management_8h.html">nv/nv_MemoryManagement.h</a>&gt;</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="mem_8h.html">nn/mem.h</a>&gt;</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#include &lt;vulkan/vulkan.h&gt;</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#include &lt;vector&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;memory&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;cstdlib&gt;</span></div>
<div class="line"></div>
<div class="line"><span class="keyword">const</span> <span class="keywordtype">int</span>        g_MaxSwaps = 3;</div>
<div class="line"><span class="keyword">const</span> <span class="keywordtype">int</span>        g_NumDescriptorSets = 1;</div>
<div class="line"></div>
<div class="line"><span class="keyword">const</span> <span class="keywordtype">size_t</span>     g_GraphicsSystemMemorySize = 32 * 1024 * 1024;</div>
<div class="line"></div>
<div class="line"><a name="_a0"></a><a class="code" href="classnn_1_1vi_1_1_display.html">nn::vi::Display</a>* g_pDisplay;</div>
<div class="line"><a name="_a1"></a><a class="code" href="classnn_1_1vi_1_1_layer.html">nn::vi::Layer</a>*   g_pLayer;</div>
<div class="line"></div>
<div class="line"><span class="keyword">typedef</span> <span class="keyword">struct </span>_MyAppData</div>
<div class="line">{</div>
<div class="line">    VkInstance                          m_Instance;</div>
<div class="line">    VkPhysicalDevice                    m_PhysicalDevice;</div>
<div class="line">    VkPhysicalDeviceProperties          m_PhysicalDeviceProperties;</div>
<div class="line">    VkPhysicalDeviceFeatures            m_PhysicalDeviceFeatures;</div>
<div class="line">    VkPhysicalDeviceMemoryProperties    m_PhysicalDeviceMemoryProperties;</div>
<div class="line">    std::vector&lt;VkLayerProperties&gt;      m_LayerProperties;</div>
<div class="line">    std::vector&lt;VkExtensionProperties&gt;  m_ExtensionProperties;</div>
<div class="line">    std::vector&lt;const char*&gt;            m_LayerNames;</div>
<div class="line">    std::vector&lt;const char*&gt;            m_ExtensionNames;</div>
<div class="line">    VkQueueFamilyProperties             m_QueueFamilyProperties;</div>
<div class="line">    VkDebugReportCallbackEXT            m_DebugCallbackEXT;</div>
<div class="line">    VkDevice                            m_Device;</div>
<div class="line">    VkQueue                             m_Queue;</div>
<div class="line">    VkCommandPool                       m_CommandPool;</div>
<div class="line">    VkCommandBuffer                     m_CommandBuffer;</div>
<div class="line"></div>
<div class="line">    VkSurfaceKHR                        m_SurfaceKhr;</div>
<div class="line">    VkFormat                            m_Format;</div>
<div class="line">    VkSwapchainKHR                      m_SwapChainKhr;</div>
<div class="line">    VkExtent2D                          m_SwapChainExtent;</div>
<div class="line">    uint32_t                            m_SwapchainImageCount;</div>
<div class="line">    uint32_t                            m_CurrentBuffer;</div>
<div class="line">    VkImage*                            m_pSwapChainImages;</div>
<div class="line">    VkImageView*                        m_pColorImageView;</div>
<div class="line">    VkImage                             m_DepthBufferImage;</div>
<div class="line">    VkFormat                            m_DepthBufferFormat;</div>
<div class="line">    VkImageView                         m_DepthBufferImageView;</div>
<div class="line">    VkDeviceMemory                      m_DepthBufferMemory;</div>
<div class="line"></div>
<div class="line">    VkRenderPass                        m_RenderPass;</div>
<div class="line">    VkFramebuffer                       m_pFramebuffers[g_MaxSwaps];</div>
<div class="line">    VkFence                             m_Fence;</div>
<div class="line">    VkPipeline                          m_Pipeline;</div>
<div class="line">    VkPipelineCache                     m_PipelineCache;</div>
<div class="line">    VkPipelineLayout                    m_PipelineLayout;</div>
<div class="line">    VkDescriptorPool                    m_DescriptorPool;</div>
<div class="line">    VkDescriptorSetLayout               m_DescriptorSetLayout;</div>
<div class="line">    VkDescriptorSet                     m_DescriptorSet;</div>
<div class="line">    VkBuffer                            m_VertexBuffer;</div>
<div class="line">    VkDeviceMemory                      m_VertexBufferMem;</div>
<div class="line">    VkViewport                          m_Viewport;</div>
<div class="line">    VkRect2D                            m_Scissor;</div>
<div class="line">    uint32_t                            m_VertexCount;</div>
<div class="line">    VkPipelineShaderStageCreateInfo     m_pShaderStages[2];</div>
<div class="line"></div>
<div class="line">    VkImage                             m_TextureImage;</div>
<div class="line">    VkImageView                         m_TextureImageView;</div>
<div class="line">    VkDeviceMemory                      m_TextureMemory;</div>
<div class="line">    VkSampler                           m_TextureSampler;</div>
<div class="line">} MyAppData;</div>
<div class="line"></div>
<div class="line">MyAppData g_AppData = { 0 };</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">bool</span> SelectMemoryType(uint32_t typeBits, uint32_t requirements_mask, uint32_t* pMemoryTypeIndex)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">bool</span> pass = <span class="keyword">false</span>;</div>
<div class="line">    <span class="keywordflow">for</span> (uint32_t i = 0; i &lt; 32; i++)</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">if</span> ((typeBits &amp; 1) == 1)</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">if</span> ((g_AppData.m_PhysicalDeviceMemoryProperties.memoryTypes[i].propertyFlags &amp; requirements_mask) == requirements_mask)</div>
<div class="line">            {</div>
<div class="line">                *pMemoryTypeIndex = i;</div>
<div class="line">                pass = <span class="keyword">true</span>;</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">        typeBits &gt;&gt;= 1;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">return</span> pass;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> InitializeLayer()</div>
<div class="line">{</div>
<div class="line">    <a name="_a2"></a><a class="code" href="classnn_1_1_result.html">nn::Result</a> result = <a name="a3"></a><a class="code" href="namespacenn_1_1vi.html#ae9cd501562a820272816af783bd798dc">nn::vi::OpenDefaultDisplay</a>(&amp;g_pDisplay);</div>
<div class="line">    <a name="a4"></a><a class="code" href="nn___assert_8h.html#ade59d1d911907a16c0241f8fe3b31542">NN_ASSERT</a>(result.<a name="a5"></a><a class="code" href="classnn_1_1_result.html#a80792d8ec8b6b9e9b34025100baa67ec">IsSuccess</a>());</div>
<div class="line">    <a name="a6"></a><a class="code" href="nn___macro_8h.html#af2d1673769927c5eae977d8dde3ce106">NN_UNUSED</a>(result);</div>
<div class="line"></div>
<div class="line">    result = <a name="a7"></a><a class="code" href="namespacenn_1_1vi.html#a86b2688dc743e37f3acaca99ccdf8c12">nn::vi::CreateLayer</a>(&amp;g_pLayer, g_pDisplay);</div>
<div class="line">    <a class="code" href="nn___assert_8h.html#ade59d1d911907a16c0241f8fe3b31542">NN_ASSERT</a>(result.<a class="code" href="classnn_1_1_result.html#a80792d8ec8b6b9e9b34025100baa67ec">IsSuccess</a>());</div>
<div class="line"></div>
<div class="line">    result = <a name="a8"></a><a class="code" href="namespacenn_1_1vi.html#a2b21403527d5c914a19e58b697c7fcb3">nn::vi::SetLayerScalingMode</a>(g_pLayer, <a name="a9"></a><a class="code" href="namespacenn_1_1vi.html#ab220832b6e24cc6c01d8c7de55ab49a8a183897c0b0608120e5ebad8d7b08cc93">nn::vi::ScalingMode_FitToLayer</a>);</div>
<div class="line">    <a class="code" href="nn___assert_8h.html#ade59d1d911907a16c0241f8fe3b31542">NN_ASSERT</a>(result.IsSuccess());</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">bool</span> InitializeExtensions()</div>
<div class="line">{</div>
<div class="line">    VkResult result;</div>
<div class="line">    uint32_t layerCount;</div>
<div class="line">    VkLayerProperties* pLayers = NULL;</div>
<div class="line"></div>
<div class="line">    g_AppData.m_LayerProperties.clear();</div>
<div class="line">    g_AppData.m_ExtensionProperties.clear();</div>
<div class="line">    g_AppData.m_LayerNames.clear();</div>
<div class="line">    g_AppData.m_ExtensionNames.clear();</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">do</span></div>
<div class="line">    {</div>
<div class="line">        result = vkEnumerateInstanceLayerProperties(&amp;layerCount, NULL);</div>
<div class="line">        <a name="a10"></a><a class="code" href="nn___assert_8h.html#a55d6b188692ffffd64e69532738ed2fc">NN_ASSERT_EQUAL</a>(result, VK_SUCCESS);</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (layerCount == 0)</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">        }</div>
<div class="line">        g_AppData.m_LayerProperties.resize(layerCount);</div>
<div class="line">        pLayers = g_AppData.m_LayerProperties.data();</div>
<div class="line"></div>
<div class="line">        result = vkEnumerateInstanceLayerProperties(&amp;layerCount, pLayers);</div>
<div class="line">    } <span class="keywordflow">while</span> (result == VK_INCOMPLETE);</div>
<div class="line"></div>
<div class="line">    uint32_t totalExtensions = 0;</div>
<div class="line">    <span class="keywordflow">for</span> (uint32_t i = 0; i &lt; layerCount; i++)</div>
<div class="line">    {</div>
<div class="line">        VkExtensionProperties* pExtensions = NULL;</div>
<div class="line">        uint32_t extensionCount = 0;</div>
<div class="line">        <span class="keywordflow">do</span></div>
<div class="line">        {</div>
<div class="line">            result = vkEnumerateInstanceExtensionProperties(pLayers[i].layerName, &amp;extensionCount, NULL);</div>
<div class="line">            <a class="code" href="nn___assert_8h.html#a55d6b188692ffffd64e69532738ed2fc">NN_ASSERT_EQUAL</a>(result, VK_SUCCESS);</div>
<div class="line"></div>
<div class="line">            <span class="keywordflow">if</span> (extensionCount == 0)</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            }</div>
<div class="line"></div>
<div class="line">            g_AppData.m_ExtensionProperties.resize(totalExtensions + extensionCount);</div>
<div class="line">            pExtensions = g_AppData.m_ExtensionProperties.data();</div>
<div class="line">            pExtensions += totalExtensions;</div>
<div class="line">            totalExtensions += extensionCount;</div>
<div class="line"></div>
<div class="line">            result = vkEnumerateInstanceExtensionProperties(pLayers[i].layerName, &amp;extensionCount, pExtensions);</div>
<div class="line"></div>
<div class="line">        } <span class="keywordflow">while</span> (result == VK_INCOMPLETE);</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line">VkBool32 VKAPI_CALL DebugMessageCallback(</div>
<div class="line">    VkDebugReportFlagsEXT                       flags,</div>
<div class="line">    VkDebugReportObjectTypeEXT                  objectType,</div>
<div class="line">    uint64_t                                    <span class="keywordtype">object</span>,</div>
<div class="line">    <span class="keywordtype">size_t</span>                                      location,</div>
<div class="line">    int32_t                                     messageCode,</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">char</span>*                                 pLayerPrefix,</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">char</span>*                                 pMessage,</div>
<div class="line">    <span class="keywordtype">void</span>*                                       pUserData)</div>
<div class="line">{</div>
<div class="line">    <a class="code" href="nn___macro_8h.html#af2d1673769927c5eae977d8dde3ce106">NN_UNUSED</a>(flags);</div>
<div class="line">    <a class="code" href="nn___macro_8h.html#af2d1673769927c5eae977d8dde3ce106">NN_UNUSED</a>(objectType);</div>
<div class="line">    <a class="code" href="nn___macro_8h.html#af2d1673769927c5eae977d8dde3ce106">NN_UNUSED</a>(<span class="keywordtype">object</span>);</div>
<div class="line">    <a class="code" href="nn___macro_8h.html#af2d1673769927c5eae977d8dde3ce106">NN_UNUSED</a>(location);</div>
<div class="line">    <a class="code" href="nn___macro_8h.html#af2d1673769927c5eae977d8dde3ce106">NN_UNUSED</a>(messageCode);</div>
<div class="line">    <a class="code" href="nn___macro_8h.html#af2d1673769927c5eae977d8dde3ce106">NN_UNUSED</a>(pLayerPrefix);</div>
<div class="line">    <a class="code" href="nn___macro_8h.html#af2d1673769927c5eae977d8dde3ce106">NN_UNUSED</a>(pMessage);</div>
<div class="line">    <a class="code" href="nn___macro_8h.html#af2d1673769927c5eae977d8dde3ce106">NN_UNUSED</a>(pUserData);</div>
<div class="line"></div>
<div class="line">    <a name="a11"></a><a class="code" href="nn___log_8h.html#aa8c0b58247a2078e37f2fe0974b98a61">NN_LOG</a>(<span class="stringliteral">&quot;%s\n&quot;</span>, pMessage);</div>
<div class="line">    <span class="keywordflow">return</span> VK_TRUE;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line">PFN_vkCreateDebugReportCallbackEXT pVkCreateDebugReportCallbackEXT = NULL;</div>
<div class="line">PFN_vkDestroyDebugReportCallbackEXT pVkDestroyDebugReportCallbackEXT = NULL;</div>
<div class="line">PFN_vkDebugReportMessageEXT pVkDebugReportMessageEXT = NULL;</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">bool</span> RegisterDebugCallback()</div>
<div class="line">{</div>
<div class="line">    VkResult result;</div>
<div class="line">    VkDebugReportCallbackCreateInfoEXT createInfo = {};</div>
<div class="line">    createInfo.sType = VK_STRUCTURE_TYPE_DEBUG_REPORT_CALLBACK_CREATE_INFO_EXT;</div>
<div class="line">    createInfo.flags = VK_DEBUG_REPORT_WARNING_BIT_EXT | VK_DEBUG_REPORT_PERFORMANCE_WARNING_BIT_EXT | VK_DEBUG_REPORT_ERROR_BIT_EXT;</div>
<div class="line">    createInfo.pfnCallback = DebugMessageCallback;</div>
<div class="line">    createInfo.pNext = NULL;</div>
<div class="line">    createInfo.pUserData = NULL;</div>
<div class="line"></div>
<div class="line">    pVkCreateDebugReportCallbackEXT = (PFN_vkCreateDebugReportCallbackEXT)vkGetInstanceProcAddr(g_AppData.m_Instance, <span class="stringliteral">&quot;vkCreateDebugReportCallbackEXT&quot;</span>);</div>
<div class="line">    pVkDestroyDebugReportCallbackEXT = (PFN_vkDestroyDebugReportCallbackEXT)vkGetInstanceProcAddr(g_AppData.m_Instance, <span class="stringliteral">&quot;vkDestroyDebugReportCallbackEXT&quot;</span>);</div>
<div class="line">    pVkDebugReportMessageEXT = (PFN_vkDebugReportMessageEXT)vkGetInstanceProcAddr(g_AppData.m_Instance, <span class="stringliteral">&quot;vkDebugReportMessageEXT&quot;</span>);</div>
<div class="line"></div>
<div class="line">    result = pVkCreateDebugReportCallbackEXT(g_AppData.m_Instance, &amp;createInfo, NULL, &amp;g_AppData.m_DebugCallbackEXT);</div>
<div class="line">    <a class="code" href="nn___assert_8h.html#a55d6b188692ffffd64e69532738ed2fc">NN_ASSERT_EQUAL</a>(result, VK_SUCCESS);</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">bool</span> VerifyLayers()</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; g_AppData.m_LayerNames.size(); i++)</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordtype">bool</span> foundLayer = <span class="keyword">false</span>;</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = 0; j &lt; g_AppData.m_LayerProperties.size(); j++)</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">if</span> (!strcmp(g_AppData.m_LayerNames[i], g_AppData.m_LayerProperties[j].layerName))</div>
<div class="line">            {</div>
<div class="line">                foundLayer = <span class="keyword">true</span>;</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span> (!foundLayer)</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">bool</span> InitializeInstance()</div>
<div class="line">{</div>
<div class="line">    VkResult result;</div>
<div class="line"></div>
<div class="line">    VkInstanceCreateInfo createInfo = {};</div>
<div class="line">    VkApplicationInfo myAppInfo = {};</div>
<div class="line"></div>
<div class="line">    g_AppData.m_ExtensionNames.push_back(VK_EXT_DEBUG_REPORT_EXTENSION_NAME);</div>
<div class="line">    g_AppData.m_ExtensionNames.push_back(VK_KHR_SURFACE_EXTENSION_NAME);</div>
<div class="line">    g_AppData.m_ExtensionNames.push_back(VK_NN_VI_SURFACE_EXTENSION_NAME);</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (!VerifyLayers())</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    myAppInfo.sType = VK_STRUCTURE_TYPE_APPLICATION_INFO;</div>
<div class="line">    myAppInfo.pNext = NULL;</div>
<div class="line">    myAppInfo.pApplicationName = <span class="stringliteral">&quot;VulkanTestBench&quot;</span>;</div>
<div class="line">    myAppInfo.applicationVersion = 1;</div>
<div class="line">    myAppInfo.pEngineName = <span class="stringliteral">&quot;VulkanTestBench&quot;</span>;</div>
<div class="line">    myAppInfo.apiVersion = VK_MAKE_VERSION(1, 0, 0);</div>
<div class="line"></div>
<div class="line">    createInfo.sType = VK_STRUCTURE_TYPE_INSTANCE_CREATE_INFO;</div>
<div class="line">    createInfo.pNext = NULL;</div>
<div class="line">    createInfo.flags = 0;</div>
<div class="line">    createInfo.pApplicationInfo = &amp;myAppInfo;</div>
<div class="line">    createInfo.enabledLayerCount = (uint32_t)g_AppData.m_LayerNames.size();</div>
<div class="line">    createInfo.ppEnabledLayerNames = g_AppData.m_LayerNames.data();</div>
<div class="line">    createInfo.enabledExtensionCount = (uint32_t)g_AppData.m_ExtensionNames.size();</div>
<div class="line">    createInfo.ppEnabledExtensionNames = g_AppData.m_ExtensionNames.data();</div>
<div class="line"></div>
<div class="line">    result = vkCreateInstance(&amp;createInfo, NULL, &amp;g_AppData.m_Instance);</div>
<div class="line">    <a class="code" href="nn___assert_8h.html#a55d6b188692ffffd64e69532738ed2fc">NN_ASSERT_EQUAL</a>(result, VK_SUCCESS);</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">bool</span> InitializePhysicalDevice()</div>
<div class="line">{</div>
<div class="line">    VkResult result;</div>
<div class="line">    uint32_t deviceCount = 0;</div>
<div class="line"></div>
<div class="line">    result = vkEnumeratePhysicalDevices(g_AppData.m_Instance, &amp;deviceCount, NULL);</div>
<div class="line">    <a class="code" href="nn___assert_8h.html#a55d6b188692ffffd64e69532738ed2fc">NN_ASSERT_EQUAL</a>(result, VK_SUCCESS);</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (deviceCount &lt; 1)</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Grabs the first device available */</span></div>
<div class="line">    deviceCount = 1;</div>
<div class="line">    result = vkEnumeratePhysicalDevices(g_AppData.m_Instance, &amp;deviceCount, &amp;g_AppData.m_PhysicalDevice);</div>
<div class="line">    <a class="code" href="nn___assert_8h.html#a55d6b188692ffffd64e69532738ed2fc">NN_ASSERT_EQUAL</a>(result, VK_SUCCESS);</div>
<div class="line"></div>
<div class="line">    vkGetPhysicalDeviceProperties(g_AppData.m_PhysicalDevice, &amp;g_AppData.m_PhysicalDeviceProperties);</div>
<div class="line">    vkGetPhysicalDeviceMemoryProperties(g_AppData.m_PhysicalDevice, &amp;g_AppData.m_PhysicalDeviceMemoryProperties);</div>
<div class="line">    vkGetPhysicalDeviceFeatures(g_AppData.m_PhysicalDevice, &amp;g_AppData.m_PhysicalDeviceFeatures);</div>
<div class="line"></div>
<div class="line">    <a class="code" href="nn___log_8h.html#aa8c0b58247a2078e37f2fe0974b98a61">NN_LOG</a>(<span class="stringliteral">&quot;timestampPeriod: %g\n&quot;</span>, g_AppData.m_PhysicalDeviceProperties.limits.timestampPeriod);</div>
<div class="line">    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line">VkResult CreateBuffer(VkBuffer* pBuffer, VkDeviceMemory* pBufferMemory, <span class="keywordtype">size_t</span> size, <span class="keywordtype">void</span>* data, VkBufferUsageFlags usageFlags)</div>
<div class="line">{</div>
<div class="line">    VkResult result;</div>
<div class="line"></div>
<div class="line">    VkBufferCreateInfo info = {};</div>
<div class="line">    info.sType = VK_STRUCTURE_TYPE_BUFFER_CREATE_INFO;</div>
<div class="line">    info.pNext = NULL;</div>
<div class="line">    info.usage = usageFlags;</div>
<div class="line">    info.queueFamilyIndexCount = 0;</div>
<div class="line">    info.pQueueFamilyIndices = NULL;</div>
<div class="line">    info.sharingMode = VK_SHARING_MODE_EXCLUSIVE;</div>
<div class="line">    info.flags = 0;</div>
<div class="line">    info.size = size;</div>
<div class="line"></div>
<div class="line">    result = vkCreateBuffer(g_AppData.m_Device, &amp;info, NULL, pBuffer);</div>
<div class="line">    <span class="keywordflow">if</span> (result != VK_SUCCESS)</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">return</span> result;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Required size may be larger than our buffer */</span></div>
<div class="line">    VkMemoryRequirements memReqs;</div>
<div class="line">    vkGetBufferMemoryRequirements(g_AppData.m_Device, *pBuffer, &amp;memReqs);</div>
<div class="line"></div>
<div class="line">    VkMemoryAllocateInfo allocInfo;</div>
<div class="line">    allocInfo.sType = VK_STRUCTURE_TYPE_MEMORY_ALLOCATE_INFO;</div>
<div class="line">    allocInfo.pNext = NULL;</div>
<div class="line">    allocInfo.memoryTypeIndex = 0;</div>
<div class="line">    allocInfo.allocationSize = memReqs.size;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (!SelectMemoryType(memReqs.memoryTypeBits, VK_MEMORY_PROPERTY_HOST_VISIBLE_BIT | VK_MEMORY_PROPERTY_HOST_COHERENT_BIT, &amp;allocInfo.memoryTypeIndex))</div>
<div class="line">    {</div>
<div class="line">        <a class="code" href="nn___assert_8h.html#ade59d1d911907a16c0241f8fe3b31542">NN_ASSERT</a>(<span class="keyword">false</span>, <span class="stringliteral">&quot;Failed to select memory type\n&quot;</span>);</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    result = vkAllocateMemory(g_AppData.m_Device, &amp;allocInfo, NULL, pBufferMemory);</div>
<div class="line">    <span class="keywordflow">if</span> (result != VK_SUCCESS)</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">return</span> result;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (data != <span class="keyword">nullptr</span>)</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordtype">void</span>* pData;</div>
<div class="line">        result = vkMapMemory(g_AppData.m_Device, *pBufferMemory, 0, memReqs.size, 0, &amp;pData);</div>
<div class="line">        <span class="keywordflow">if</span> (result != VK_SUCCESS)</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">return</span> result;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        memcpy(pData, data, size);</div>
<div class="line">        vkUnmapMemory(g_AppData.m_Device, *pBufferMemory);</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    result = vkBindBufferMemory(g_AppData.m_Device, *pBuffer, *pBufferMemory, 0);</div>
<div class="line">    <span class="keywordflow">return</span> result;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">bool</span> InitializeLogicalDevice()</div>
<div class="line">{</div>
<div class="line">    VkResult result;</div>
<div class="line"></div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">char</span>* DeviceExtensions[] = {</div>
<div class="line">        <span class="stringliteral">&quot;VK_KHR_swapchain&quot;</span>,</div>
<div class="line">    };</div>
<div class="line"></div>
<div class="line">    VkDeviceQueueCreateInfo queueInfo = {};</div>
<div class="line">    <span class="keywordtype">float</span> priority = 0.0;</div>
<div class="line">    queueInfo.sType = VK_STRUCTURE_TYPE_DEVICE_QUEUE_CREATE_INFO;</div>
<div class="line">    queueInfo.pNext = NULL;</div>
<div class="line">    queueInfo.flags = 0;</div>
<div class="line">    queueInfo.queueFamilyIndex = 0;</div>
<div class="line">    queueInfo.queueCount = 1;</div>
<div class="line">    queueInfo.pQueuePriorities = &amp;priority;</div>
<div class="line"></div>
<div class="line">    VkDeviceCreateInfo createInfo = {};</div>
<div class="line">    createInfo.sType = VK_STRUCTURE_TYPE_DEVICE_CREATE_INFO;</div>
<div class="line">    createInfo.pNext = NULL;</div>
<div class="line">    createInfo.flags = 0;</div>
<div class="line">    createInfo.queueCreateInfoCount = 1;</div>
<div class="line">    createInfo.pQueueCreateInfos = &amp;queueInfo;</div>
<div class="line">    createInfo.enabledLayerCount = (uint32_t)g_AppData.m_LayerNames.size();</div>
<div class="line">    createInfo.ppEnabledLayerNames = g_AppData.m_LayerNames.data();</div>
<div class="line">    createInfo.enabledExtensionCount = <span class="keyword">sizeof</span>(DeviceExtensions) / <span class="keyword">sizeof</span>(DeviceExtensions[0]);</div>
<div class="line">    createInfo.ppEnabledExtensionNames = DeviceExtensions;</div>
<div class="line">    createInfo.pEnabledFeatures = NULL;</div>
<div class="line"></div>
<div class="line">    result = vkCreateDevice(g_AppData.m_PhysicalDevice, &amp;createInfo, NULL, &amp;g_AppData.m_Device);</div>
<div class="line">    <a class="code" href="nn___assert_8h.html#a55d6b188692ffffd64e69532738ed2fc">NN_ASSERT_EQUAL</a>(result, VK_SUCCESS);</div>
<div class="line"></div>
<div class="line">    vkGetDeviceQueue(g_AppData.m_Device, 0, 0, &amp;g_AppData.m_Queue);</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">bool</span> InitializeQueue()</div>
<div class="line">{</div>
<div class="line">    uint32_t queueFamilyPropertyCount = 0;</div>
<div class="line">    vkGetPhysicalDeviceQueueFamilyProperties(g_AppData.m_PhysicalDevice, &amp;queueFamilyPropertyCount, NULL);</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (queueFamilyPropertyCount &gt; 0)</div>
<div class="line">    {</div>
<div class="line">        std::unique_ptr&lt; VkQueueFamilyProperties &gt; pQueueFamilyProperties(<span class="keyword">new</span> VkQueueFamilyProperties[queueFamilyPropertyCount]);</div>
<div class="line">        vkGetPhysicalDeviceQueueFamilyProperties(g_AppData.m_PhysicalDevice, &amp;queueFamilyPropertyCount, pQueueFamilyProperties.get());</div>
<div class="line">        memcpy(&amp;g_AppData.m_QueueFamilyProperties, pQueueFamilyProperties.get(), <span class="keyword">sizeof</span>(*pQueueFamilyProperties));</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">bool</span> InitializeCommandBuffer()</div>
<div class="line">{</div>
<div class="line">    VkResult result;</div>
<div class="line">    VkCommandPoolCreateInfo info = {};</div>
<div class="line">    info.sType = VK_STRUCTURE_TYPE_COMMAND_POOL_CREATE_INFO;</div>
<div class="line">    info.flags = VK_COMMAND_POOL_CREATE_RESET_COMMAND_BUFFER_BIT;</div>
<div class="line">    info.pNext = NULL;</div>
<div class="line">    info.queueFamilyIndex = 0;</div>
<div class="line"></div>
<div class="line">    result = vkCreateCommandPool(g_AppData.m_Device, &amp;info, NULL, &amp;g_AppData.m_CommandPool);</div>
<div class="line">    <a class="code" href="nn___assert_8h.html#a55d6b188692ffffd64e69532738ed2fc">NN_ASSERT_EQUAL</a>(result, VK_SUCCESS);</div>
<div class="line"></div>
<div class="line">    VkCommandBufferAllocateInfo allocInfo = {};</div>
<div class="line">    allocInfo.sType = VK_STRUCTURE_TYPE_COMMAND_BUFFER_ALLOCATE_INFO;</div>
<div class="line">    allocInfo.pNext = NULL;</div>
<div class="line">    allocInfo.level = VK_COMMAND_BUFFER_LEVEL_PRIMARY;</div>
<div class="line">    allocInfo.commandPool = g_AppData.m_CommandPool;</div>
<div class="line">    allocInfo.commandBufferCount = 1;</div>
<div class="line">    result = vkAllocateCommandBuffers(g_AppData.m_Device, &amp;allocInfo, &amp;g_AppData.m_CommandBuffer);</div>
<div class="line">    <a class="code" href="nn___assert_8h.html#a55d6b188692ffffd64e69532738ed2fc">NN_ASSERT_EQUAL</a>(result, VK_SUCCESS);</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> SetImageLayoutTransition(VkImage image, VkImageAspectFlags aspectMask, VkImageLayout oldLayout, VkImageLayout newLayout)</div>
<div class="line">{</div>
<div class="line">    VkImageMemoryBarrier imageMemBarrier = {};</div>
<div class="line">    imageMemBarrier.sType = VK_STRUCTURE_TYPE_IMAGE_MEMORY_BARRIER;</div>
<div class="line">    imageMemBarrier.pNext = NULL;</div>
<div class="line">    imageMemBarrier.srcAccessMask = 0;</div>
<div class="line">    imageMemBarrier.dstAccessMask = 0;</div>
<div class="line">    imageMemBarrier.oldLayout = oldLayout;</div>
<div class="line">    imageMemBarrier.newLayout = newLayout;</div>
<div class="line">    imageMemBarrier.srcQueueFamilyIndex = VK_QUEUE_FAMILY_IGNORED;</div>
<div class="line">    imageMemBarrier.dstQueueFamilyIndex = VK_QUEUE_FAMILY_IGNORED;</div>
<div class="line">    imageMemBarrier.image = image;</div>
<div class="line">    imageMemBarrier.subresourceRange.aspectMask = aspectMask;</div>
<div class="line">    imageMemBarrier.subresourceRange.baseMipLevel = 0;</div>
<div class="line">    imageMemBarrier.subresourceRange.levelCount = 1;</div>
<div class="line">    imageMemBarrier.subresourceRange.baseArrayLayer = 0;</div>
<div class="line">    imageMemBarrier.subresourceRange.layerCount = 1;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (oldLayout == VK_IMAGE_LAYOUT_COLOR_ATTACHMENT_OPTIMAL)</div>
<div class="line">    {</div>
<div class="line">        imageMemBarrier.srcAccessMask =</div>
<div class="line">            VK_ACCESS_COLOR_ATTACHMENT_WRITE_BIT;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (newLayout == VK_IMAGE_LAYOUT_TRANSFER_DST_OPTIMAL)</div>
<div class="line">    {</div>
<div class="line">        imageMemBarrier.dstAccessMask = VK_ACCESS_TRANSFER_WRITE_BIT;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (newLayout == VK_IMAGE_LAYOUT_TRANSFER_SRC_OPTIMAL)</div>
<div class="line">    {</div>
<div class="line">        imageMemBarrier.dstAccessMask = VK_ACCESS_TRANSFER_READ_BIT;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (oldLayout == VK_IMAGE_LAYOUT_PRESENT_SRC_KHR)</div>
<div class="line">    {</div>
<div class="line">        imageMemBarrier.srcAccessMask = VK_ACCESS_MEMORY_READ_BIT;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (oldLayout == VK_IMAGE_LAYOUT_TRANSFER_DST_OPTIMAL)</div>
<div class="line">    {</div>
<div class="line">        imageMemBarrier.srcAccessMask = VK_ACCESS_TRANSFER_WRITE_BIT;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (oldLayout == VK_IMAGE_LAYOUT_PREINITIALIZED)</div>
<div class="line">    {</div>
<div class="line">        imageMemBarrier.srcAccessMask = VK_ACCESS_HOST_WRITE_BIT;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (newLayout == VK_IMAGE_LAYOUT_SHADER_READ_ONLY_OPTIMAL)</div>
<div class="line">    {</div>
<div class="line">        imageMemBarrier.srcAccessMask =</div>
<div class="line">            VK_ACCESS_HOST_WRITE_BIT | VK_ACCESS_TRANSFER_WRITE_BIT;</div>
<div class="line">        imageMemBarrier.dstAccessMask = VK_ACCESS_SHADER_READ_BIT;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (newLayout == VK_IMAGE_LAYOUT_PRESENT_SRC_KHR)</div>
<div class="line">    {</div>
<div class="line">        imageMemBarrier.dstAccessMask = VK_ACCESS_MEMORY_READ_BIT;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (newLayout == VK_IMAGE_LAYOUT_COLOR_ATTACHMENT_OPTIMAL)</div>
<div class="line">    {</div>
<div class="line">        imageMemBarrier.dstAccessMask =</div>
<div class="line">            VK_ACCESS_COLOR_ATTACHMENT_WRITE_BIT;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (newLayout == VK_IMAGE_LAYOUT_DEPTH_STENCIL_ATTACHMENT_OPTIMAL)</div>
<div class="line">    {</div>
<div class="line">        imageMemBarrier.dstAccessMask =</div>
<div class="line">            VK_ACCESS_DEPTH_STENCIL_ATTACHMENT_WRITE_BIT;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    VkPipelineStageFlags src_stages = VK_PIPELINE_STAGE_ALL_COMMANDS_BIT;</div>
<div class="line">    VkPipelineStageFlags dest_stages = VK_PIPELINE_STAGE_ALL_COMMANDS_BIT;</div>
<div class="line"></div>
<div class="line">    vkCmdPipelineBarrier(g_AppData.m_CommandBuffer, src_stages, dest_stages, 0, 0, NULL, 0, NULL,</div>
<div class="line">        1, &amp;imageMemBarrier);</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">bool</span> InitializeSwapchain()</div>
<div class="line">{</div>
<div class="line">    VkResult result;</div>
<div class="line">    VkViSurfaceCreateInfoNN createInfo = {};</div>
<div class="line">    createInfo.sType = VK_STRUCTURE_TYPE_VI_SURFACE_CREATE_INFO_NN;</div>
<div class="line">    createInfo.pNext = NULL;</div>
<div class="line">    createInfo.flags = 0;</div>
<div class="line"></div>
<div class="line">    <a class="code" href="namespacenn_1_1vi.html#a4d5f9e1b22348c0080755ad26cb980c1">nn::vi::NativeWindowHandle</a> nativeWindow;</div>
<div class="line">    <a name="a12"></a><a class="code" href="namespacenn_1_1vi.html#a7c997ec9cbea93fa248c4e482a4dfe20">nn::vi::GetNativeWindow</a>(&amp;nativeWindow, g_pLayer);</div>
<div class="line">    createInfo.window = nativeWindow;</div>
<div class="line"></div>
<div class="line">    result = vkCreateViSurfaceNN(g_AppData.m_Instance, &amp;createInfo, NULL, &amp;g_AppData.m_SurfaceKhr);</div>
<div class="line">    <a class="code" href="nn___assert_8h.html#a55d6b188692ffffd64e69532738ed2fc">NN_ASSERT_EQUAL</a>(result, VK_SUCCESS);</div>
<div class="line"></div>
<div class="line">    VkBool32 queueSupportsPresent = VK_FALSE;</div>
<div class="line">    vkGetPhysicalDeviceSurfaceSupportKHR(g_AppData.m_PhysicalDevice, 0, g_AppData.m_SurfaceKhr, &amp;queueSupportsPresent);</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Asserts if default queue doesn&#39;t support present */</span></div>
<div class="line">    <a name="a13"></a><a class="code" href="nn___assert_8h.html#a673c7494d18b842ce26fe72d425958dc">NN_ASSERT_NOT_EQUAL</a>(queueSupportsPresent, static_cast&lt; VkBool32 &gt;(VK_FALSE));</div>
<div class="line"></div>
<div class="line">    uint32_t formatCount = 0;</div>
<div class="line">    result = vkGetPhysicalDeviceSurfaceFormatsKHR(g_AppData.m_PhysicalDevice, g_AppData.m_SurfaceKhr, &amp;formatCount, NULL);</div>
<div class="line">    <a class="code" href="nn___assert_8h.html#a55d6b188692ffffd64e69532738ed2fc">NN_ASSERT_EQUAL</a>(result, VK_SUCCESS);</div>
<div class="line"></div>
<div class="line">    VkSurfaceFormatKHR* pSurfaceFormatKHR = (VkSurfaceFormatKHR*)malloc(<span class="keyword">sizeof</span>(VkSurfaceFormatKHR) * formatCount);</div>
<div class="line">    result = vkGetPhysicalDeviceSurfaceFormatsKHR(g_AppData.m_PhysicalDevice, g_AppData.m_SurfaceKhr, &amp;formatCount, pSurfaceFormatKHR);</div>
<div class="line">    <a class="code" href="nn___assert_8h.html#a55d6b188692ffffd64e69532738ed2fc">NN_ASSERT_EQUAL</a>(result, VK_SUCCESS);</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (formatCount == 1 &amp;&amp; pSurfaceFormatKHR[0].format == VK_FORMAT_UNDEFINED)</div>
<div class="line">    {</div>
<div class="line">            <span class="comment">/* No preference for format, use a default here */</span></div>
<div class="line">        g_AppData.m_Format = VK_FORMAT_B8G8R8A8_UNORM;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">    {</div>
<div class="line">            <span class="comment">/* Asserts if no VkSurfaceFormatKHRs found */</span></div>
<div class="line">        <a class="code" href="nn___assert_8h.html#a673c7494d18b842ce26fe72d425958dc">NN_ASSERT_NOT_EQUAL</a>(formatCount, 0U);</div>
<div class="line">        g_AppData.m_Format = pSurfaceFormatKHR[0].format;</div>
<div class="line">    }</div>
<div class="line">    free(pSurfaceFormatKHR);</div>
<div class="line"></div>
<div class="line">    VkSurfaceCapabilitiesKHR surfCapabilities;</div>
<div class="line">    result = vkGetPhysicalDeviceSurfaceCapabilitiesKHR(g_AppData.m_PhysicalDevice, g_AppData.m_SurfaceKhr, &amp;surfCapabilities);</div>
<div class="line">    <a class="code" href="nn___assert_8h.html#a55d6b188692ffffd64e69532738ed2fc">NN_ASSERT_EQUAL</a>(result, VK_SUCCESS);</div>
<div class="line"></div>
<div class="line">    uint32_t presentModeCount = 0;</div>
<div class="line">    result = vkGetPhysicalDeviceSurfacePresentModesKHR(g_AppData.m_PhysicalDevice, g_AppData.m_SurfaceKhr, &amp;presentModeCount, NULL);</div>
<div class="line">    <a class="code" href="nn___assert_8h.html#a55d6b188692ffffd64e69532738ed2fc">NN_ASSERT_EQUAL</a>(result, VK_SUCCESS);</div>
<div class="line"></div>
<div class="line">    VkPresentModeKHR* pPresentModes = (VkPresentModeKHR*)malloc(<span class="keyword">sizeof</span>(VkPresentModeKHR) * presentModeCount);</div>
<div class="line">    result = vkGetPhysicalDeviceSurfacePresentModesKHR(g_AppData.m_PhysicalDevice, g_AppData.m_SurfaceKhr, &amp;presentModeCount, pPresentModes);</div>
<div class="line">    <a class="code" href="nn___assert_8h.html#a55d6b188692ffffd64e69532738ed2fc">NN_ASSERT_EQUAL</a>(result, VK_SUCCESS);</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (surfCapabilities.currentExtent.width == UINT32_MAX)</div>
<div class="line">    {</div>
<div class="line">        g_AppData.m_SwapChainExtent.width = 1280;</div>
<div class="line">        g_AppData.m_SwapChainExtent.height = 720;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">    {</div>
<div class="line">        g_AppData.m_SwapChainExtent = surfCapabilities.currentExtent;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    VkPresentModeKHR swapchainPresentMode = VK_PRESENT_MODE_FIFO_KHR;</div>
<div class="line">    <span class="keywordflow">for</span> (uint32_t i = 0; i &lt; presentModeCount; i++)</div>
<div class="line">    {</div>
<div class="line">            <span class="comment">/* This is the preferred and fastest mode */</span></div>
<div class="line">        <span class="keywordflow">if</span> (pPresentModes[i] == VK_PRESENT_MODE_MAILBOX_KHR)</div>
<div class="line">        {</div>
<div class="line">            swapchainPresentMode = pPresentModes[i];</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">            <span class="comment">/* This mode is faster but tears */</span></div>
<div class="line">        <span class="keywordflow">if</span> (pPresentModes[i] == VK_PRESENT_MODE_IMMEDIATE_KHR)</div>
<div class="line">        {</div>
<div class="line">            swapchainPresentMode = pPresentModes[i];</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (pPresentModes != NULL)</div>
<div class="line">    {</div>
<div class="line">        free(pPresentModes);</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    uint32_t desiredSwapImages = surfCapabilities.minImageCount + 1;</div>
<div class="line">    <span class="keywordflow">if</span> (surfCapabilities.maxImageCount &gt; 0 &amp;&amp; desiredSwapImages &gt; surfCapabilities.maxImageCount)</div>
<div class="line">    {</div>
<div class="line">        desiredSwapImages = surfCapabilities.maxImageCount;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    VkSwapchainCreateInfoKHR swapChainInfo = {};</div>
<div class="line">    swapChainInfo.sType = VK_STRUCTURE_TYPE_SWAPCHAIN_CREATE_INFO_KHR;</div>
<div class="line">    swapChainInfo.pNext = NULL;</div>
<div class="line">    swapChainInfo.surface = g_AppData.m_SurfaceKhr;</div>
<div class="line">    swapChainInfo.minImageCount = desiredSwapImages;</div>
<div class="line">    swapChainInfo.imageFormat = g_AppData.m_Format;</div>
<div class="line">    swapChainInfo.imageExtent = g_AppData.m_SwapChainExtent;</div>
<div class="line">    swapChainInfo.preTransform = (surfCapabilities.supportedTransforms &amp; VK_SURFACE_TRANSFORM_IDENTITY_BIT_KHR) ? VK_SURFACE_TRANSFORM_IDENTITY_BIT_KHR : surfCapabilities.currentTransform;</div>
<div class="line">    swapChainInfo.compositeAlpha = VK_COMPOSITE_ALPHA_OPAQUE_BIT_KHR;</div>
<div class="line">    swapChainInfo.imageArrayLayers = 1;</div>
<div class="line">    swapChainInfo.presentMode = swapchainPresentMode;</div>
<div class="line">    swapChainInfo.oldSwapchain = VK_NULL_HANDLE;</div>
<div class="line">    swapChainInfo.clipped = <span class="keyword">true</span>;</div>
<div class="line">    swapChainInfo.imageColorSpace = VK_COLORSPACE_SRGB_NONLINEAR_KHR;</div>
<div class="line">    swapChainInfo.imageUsage = VK_IMAGE_USAGE_COLOR_ATTACHMENT_BIT | VK_IMAGE_USAGE_TRANSFER_DST_BIT;</div>
<div class="line">    swapChainInfo.imageSharingMode = VK_SHARING_MODE_EXCLUSIVE;</div>
<div class="line">    swapChainInfo.queueFamilyIndexCount = 0;</div>
<div class="line">    swapChainInfo.pQueueFamilyIndices = NULL;</div>
<div class="line"></div>
<div class="line">    result = vkCreateSwapchainKHR(g_AppData.m_Device, &amp;swapChainInfo, NULL, &amp;g_AppData.m_SwapChainKhr);</div>
<div class="line">    <a class="code" href="nn___assert_8h.html#a55d6b188692ffffd64e69532738ed2fc">NN_ASSERT_EQUAL</a>(result, VK_SUCCESS);</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Query the total images */</span></div>
<div class="line">    result = vkGetSwapchainImagesKHR(g_AppData.m_Device, g_AppData.m_SwapChainKhr, &amp;g_AppData.m_SwapchainImageCount, NULL);</div>
<div class="line">    <a class="code" href="nn___assert_8h.html#a55d6b188692ffffd64e69532738ed2fc">NN_ASSERT_EQUAL</a>(result, VK_SUCCESS);</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Grab the VkImage handles for the swap buffers */</span></div>
<div class="line">    g_AppData.m_pSwapChainImages = (VkImage*)malloc(<span class="keyword">sizeof</span>(VkImage) * g_AppData.m_SwapchainImageCount);</div>
<div class="line">    result = vkGetSwapchainImagesKHR(g_AppData.m_Device, g_AppData.m_SwapChainKhr, &amp;g_AppData.m_SwapchainImageCount, g_AppData.m_pSwapChainImages);</div>
<div class="line">    <a class="code" href="nn___assert_8h.html#a55d6b188692ffffd64e69532738ed2fc">NN_ASSERT_EQUAL</a>(result, VK_SUCCESS);</div>
<div class="line"></div>
<div class="line">    g_AppData.m_pColorImageView = (VkImageView*)malloc(<span class="keyword">sizeof</span>(VkImageView) * g_AppData.m_SwapchainImageCount);</div>
<div class="line">    <span class="keywordflow">for</span> (uint32_t i = 0; i &lt; g_AppData.m_SwapchainImageCount; i++)</div>
<div class="line">    {</div>
<div class="line">        VkImageViewCreateInfo colorInfo = {};</div>
<div class="line">        colorInfo.sType = VK_STRUCTURE_TYPE_IMAGE_VIEW_CREATE_INFO;</div>
<div class="line">        colorInfo.pNext = NULL;</div>
<div class="line">        colorInfo.format = g_AppData.m_Format;</div>
<div class="line">        colorInfo.components.r = VK_COMPONENT_SWIZZLE_R;</div>
<div class="line">        colorInfo.components.g = VK_COMPONENT_SWIZZLE_G;</div>
<div class="line">        colorInfo.components.b = VK_COMPONENT_SWIZZLE_B;</div>
<div class="line">        colorInfo.components.a = VK_COMPONENT_SWIZZLE_A;</div>
<div class="line">        colorInfo.subresourceRange.aspectMask = VK_IMAGE_ASPECT_COLOR_BIT;</div>
<div class="line">        colorInfo.subresourceRange.baseMipLevel = 0;</div>
<div class="line">        colorInfo.subresourceRange.levelCount = 1;</div>
<div class="line">        colorInfo.subresourceRange.baseArrayLayer = 0;</div>
<div class="line">        colorInfo.subresourceRange.layerCount = 1;</div>
<div class="line">        colorInfo.viewType = VK_IMAGE_VIEW_TYPE_2D;</div>
<div class="line">        colorInfo.flags = 0;</div>
<div class="line">        colorInfo.image = g_AppData.m_pSwapChainImages[i];</div>
<div class="line"></div>
<div class="line">        SetImageLayoutTransition(colorInfo.image, VK_IMAGE_ASPECT_COLOR_BIT, VK_IMAGE_LAYOUT_UNDEFINED, VK_IMAGE_LAYOUT_PRESENT_SRC_KHR);</div>
<div class="line"></div>
<div class="line">        result = vkCreateImageView(g_AppData.m_Device, &amp;colorInfo, NULL, &amp;g_AppData.m_pColorImageView[i]);</div>
<div class="line">        <a class="code" href="nn___assert_8h.html#a55d6b188692ffffd64e69532738ed2fc">NN_ASSERT_EQUAL</a>(result, VK_SUCCESS);</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    g_AppData.m_CurrentBuffer = 0;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">}<span class="comment">//NOLINT(impl/function_size)</span></div>
<div class="line"></div>
<div class="line"><span class="keywordtype">bool</span> InitializeDepthBuffer()</div>
<div class="line">{</div>
<div class="line">    VkResult result;</div>
<div class="line"></div>
<div class="line">    {</div>
<div class="line">        g_AppData.m_DepthBufferFormat = VK_FORMAT_D24_UNORM_S8_UINT;</div>
<div class="line"></div>
<div class="line">        VkImageCreateInfo info = {};</div>
<div class="line">        info.sType = VK_STRUCTURE_TYPE_IMAGE_CREATE_INFO;</div>
<div class="line">        info.pNext = NULL;</div>
<div class="line">        info.flags = 0;</div>
<div class="line">        info.arrayLayers = 1;</div>
<div class="line">        info.extent.width = g_AppData.m_SwapChainExtent.width;</div>
<div class="line">        info.extent.height = g_AppData.m_SwapChainExtent.height;</div>
<div class="line">        info.extent.depth = 1;</div>
<div class="line">        info.format = g_AppData.m_DepthBufferFormat;</div>
<div class="line">        info.imageType = VK_IMAGE_TYPE_2D;</div>
<div class="line">        info.initialLayout = VK_IMAGE_LAYOUT_UNDEFINED;</div>
<div class="line">        info.mipLevels = 1;</div>
<div class="line">        info.queueFamilyIndexCount = 0;</div>
<div class="line">        info.pQueueFamilyIndices = NULL;</div>
<div class="line">        info.samples = VK_SAMPLE_COUNT_1_BIT;</div>
<div class="line">        info.sharingMode = VK_SHARING_MODE_EXCLUSIVE;</div>
<div class="line">        info.tiling = VK_IMAGE_TILING_OPTIMAL;</div>
<div class="line">        info.usage = VK_IMAGE_USAGE_DEPTH_STENCIL_ATTACHMENT_BIT;</div>
<div class="line"></div>
<div class="line">        result = vkCreateImage(g_AppData.m_Device, &amp;info, NULL, &amp;g_AppData.m_DepthBufferImage);</div>
<div class="line">        <a class="code" href="nn___assert_8h.html#a55d6b188692ffffd64e69532738ed2fc">NN_ASSERT_EQUAL</a>(result, VK_SUCCESS);</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    {</div>
<div class="line">        VkMemoryAllocateInfo info = {};</div>
<div class="line">        VkMemoryRequirements memReq;</div>
<div class="line">        vkGetImageMemoryRequirements(g_AppData.m_Device, g_AppData.m_DepthBufferImage, &amp;memReq);</div>
<div class="line"></div>
<div class="line">        info.sType = VK_STRUCTURE_TYPE_MEMORY_ALLOCATE_INFO;</div>
<div class="line">        info.pNext = NULL;</div>
<div class="line">        info.allocationSize = memReq.size;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (!SelectMemoryType(memReq.memoryTypeBits, 0, &amp;info.memoryTypeIndex))</div>
<div class="line">        {</div>
<div class="line">            <a class="code" href="nn___assert_8h.html#ade59d1d911907a16c0241f8fe3b31542">NN_ASSERT</a>(<span class="keyword">false</span>, <span class="stringliteral">&quot;Failed to select memory type\n&quot;</span>);</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        result = vkAllocateMemory(g_AppData.m_Device, &amp;info, NULL, &amp;g_AppData.m_DepthBufferMemory);</div>
<div class="line">        <a class="code" href="nn___assert_8h.html#a55d6b188692ffffd64e69532738ed2fc">NN_ASSERT_EQUAL</a>(result, VK_SUCCESS);</div>
<div class="line"></div>
<div class="line">        result = vkBindImageMemory(g_AppData.m_Device, g_AppData.m_DepthBufferImage, g_AppData.m_DepthBufferMemory, 0);</div>
<div class="line">        <a class="code" href="nn___assert_8h.html#a55d6b188692ffffd64e69532738ed2fc">NN_ASSERT_EQUAL</a>(result, VK_SUCCESS);</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    {</div>
<div class="line">        VkImageViewCreateInfo info = {};</div>
<div class="line">        info.sType = VK_STRUCTURE_TYPE_IMAGE_VIEW_CREATE_INFO;</div>
<div class="line">        info.pNext = NULL;</div>
<div class="line">        info.image = g_AppData.m_DepthBufferImage;</div>
<div class="line">        info.format = g_AppData.m_DepthBufferFormat;</div>
<div class="line">        info.components.r = VK_COMPONENT_SWIZZLE_R;</div>
<div class="line">        info.components.g = VK_COMPONENT_SWIZZLE_G;</div>
<div class="line">        info.components.b = VK_COMPONENT_SWIZZLE_B;</div>
<div class="line">        info.components.a = VK_COMPONENT_SWIZZLE_A;</div>
<div class="line">        info.subresourceRange.aspectMask = VK_IMAGE_ASPECT_DEPTH_BIT | VK_IMAGE_ASPECT_STENCIL_BIT;</div>
<div class="line">        info.subresourceRange.baseMipLevel = 0;</div>
<div class="line">        info.subresourceRange.baseArrayLayer = 0;</div>
<div class="line">        info.subresourceRange.layerCount = 1;</div>
<div class="line">        info.subresourceRange.levelCount = 1;</div>
<div class="line">        info.viewType = VK_IMAGE_VIEW_TYPE_2D;</div>
<div class="line">        info.flags = 0;</div>
<div class="line"></div>
<div class="line">        result = vkCreateImageView(g_AppData.m_Device, &amp;info, NULL, &amp;g_AppData.m_DepthBufferImageView);</div>
<div class="line">        <a class="code" href="nn___assert_8h.html#a55d6b188692ffffd64e69532738ed2fc">NN_ASSERT_EQUAL</a>(result, VK_SUCCESS);</div>
<div class="line"></div>
<div class="line">        SetImageLayoutTransition(info.image, info.subresourceRange.aspectMask, VK_IMAGE_LAYOUT_UNDEFINED, VK_IMAGE_LAYOUT_DEPTH_STENCIL_ATTACHMENT_OPTIMAL);</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">bool</span> InitializeRenderPass()</div>
<div class="line">{</div>
<div class="line">    VkResult result;</div>
<div class="line">    VkAttachmentDescription attachments[2];</div>
<div class="line">    attachments[0].format = g_AppData.m_Format;</div>
<div class="line">    attachments[0].flags = 0;</div>
<div class="line">    attachments[0].samples = VK_SAMPLE_COUNT_1_BIT;</div>
<div class="line">    attachments[0].loadOp = VK_ATTACHMENT_LOAD_OP_CLEAR;</div>
<div class="line">    attachments[0].storeOp = VK_ATTACHMENT_STORE_OP_STORE;</div>
<div class="line">    attachments[0].initialLayout = VK_IMAGE_LAYOUT_COLOR_ATTACHMENT_OPTIMAL;</div>
<div class="line">    attachments[0].finalLayout = VK_IMAGE_LAYOUT_COLOR_ATTACHMENT_OPTIMAL;</div>
<div class="line">    attachments[0].stencilLoadOp = VK_ATTACHMENT_LOAD_OP_DONT_CARE;</div>
<div class="line">    attachments[0].stencilStoreOp = VK_ATTACHMENT_STORE_OP_DONT_CARE;</div>
<div class="line">    attachments[1].format = g_AppData.m_DepthBufferFormat;</div>
<div class="line">    attachments[1].flags = 0;</div>
<div class="line">    attachments[1].samples = VK_SAMPLE_COUNT_1_BIT;</div>
<div class="line">    attachments[1].loadOp = VK_ATTACHMENT_LOAD_OP_CLEAR;</div>
<div class="line">    attachments[1].storeOp = VK_ATTACHMENT_STORE_OP_STORE;</div>
<div class="line">    attachments[1].initialLayout = VK_IMAGE_LAYOUT_DEPTH_STENCIL_ATTACHMENT_OPTIMAL;</div>
<div class="line">    attachments[1].finalLayout = VK_IMAGE_LAYOUT_DEPTH_STENCIL_ATTACHMENT_OPTIMAL;</div>
<div class="line">    attachments[1].stencilLoadOp = VK_ATTACHMENT_LOAD_OP_CLEAR;</div>
<div class="line">    attachments[1].stencilStoreOp = VK_ATTACHMENT_STORE_OP_STORE;</div>
<div class="line"></div>
<div class="line">    VkAttachmentReference colorReference = {};</div>
<div class="line">    colorReference.attachment = 0;</div>
<div class="line">    colorReference.layout = VK_IMAGE_LAYOUT_COLOR_ATTACHMENT_OPTIMAL;</div>
<div class="line"></div>
<div class="line">    VkAttachmentReference depthReference = {};</div>
<div class="line">    depthReference.attachment = 1;</div>
<div class="line">    depthReference.layout = VK_IMAGE_LAYOUT_DEPTH_STENCIL_ATTACHMENT_OPTIMAL;</div>
<div class="line"></div>
<div class="line">    VkSubpassDescription subpassInfo = {};</div>
<div class="line">    subpassInfo.flags = 0;</div>
<div class="line">    subpassInfo.inputAttachmentCount = 0;</div>
<div class="line">    subpassInfo.pInputAttachments = NULL;</div>
<div class="line">    subpassInfo.colorAttachmentCount = 1;</div>
<div class="line">    subpassInfo.pColorAttachments = &amp;colorReference;</div>
<div class="line">    subpassInfo.pDepthStencilAttachment = &amp;depthReference;</div>
<div class="line">    subpassInfo.pipelineBindPoint = VK_PIPELINE_BIND_POINT_GRAPHICS;</div>
<div class="line">    subpassInfo.pPreserveAttachments = NULL;</div>
<div class="line">    subpassInfo.preserveAttachmentCount = 0;</div>
<div class="line">    subpassInfo.pResolveAttachments = NULL;</div>
<div class="line"></div>
<div class="line">    VkRenderPassCreateInfo createInfo = {};</div>
<div class="line">    createInfo.sType = VK_STRUCTURE_TYPE_RENDER_PASS_CREATE_INFO;</div>
<div class="line">    createInfo.flags = 0;</div>
<div class="line">    createInfo.pNext = NULL;</div>
<div class="line">    createInfo.attachmentCount = 2;</div>
<div class="line">    createInfo.pAttachments = attachments;</div>
<div class="line">    createInfo.dependencyCount = 0;</div>
<div class="line">    createInfo.subpassCount = 1;</div>
<div class="line">    createInfo.pSubpasses = &amp;subpassInfo;</div>
<div class="line">    result = vkCreateRenderPass(g_AppData.m_Device, &amp;createInfo, NULL, &amp;g_AppData.m_RenderPass);</div>
<div class="line">    <a class="code" href="nn___assert_8h.html#a55d6b188692ffffd64e69532738ed2fc">NN_ASSERT_EQUAL</a>(result, VK_SUCCESS);</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">bool</span> InitializeFrameBuffer()</div>
<div class="line">{</div>
<div class="line">    VkResult result;</div>
<div class="line"></div>
<div class="line">    VkImageView attachments[2];</div>
<div class="line">    attachments[1] = g_AppData.m_DepthBufferImageView;</div>
<div class="line"></div>
<div class="line">    VkFramebufferCreateInfo info = {};</div>
<div class="line">    info.sType = VK_STRUCTURE_TYPE_FRAMEBUFFER_CREATE_INFO;</div>
<div class="line">    info.pNext = NULL;</div>
<div class="line">    info.renderPass = g_AppData.m_RenderPass;</div>
<div class="line">    info.attachmentCount = 2;</div>
<div class="line">    info.pAttachments = attachments;</div>
<div class="line">    info.width = g_AppData.m_SwapChainExtent.width;</div>
<div class="line">    info.height = g_AppData.m_SwapChainExtent.height;</div>
<div class="line">    info.layers = 1;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">for</span> (uint32_t i = 0; i &lt; g_AppData.m_SwapchainImageCount; i++)</div>
<div class="line">    {</div>
<div class="line">        attachments[0] = g_AppData.m_pColorImageView[i];</div>
<div class="line">        result = vkCreateFramebuffer(g_AppData.m_Device, &amp;info, NULL, &amp;g_AppData.m_pFramebuffers[i]);</div>
<div class="line">        <a class="code" href="nn___assert_8h.html#a55d6b188692ffffd64e69532738ed2fc">NN_ASSERT_EQUAL</a>(result, VK_SUCCESS);</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">bool</span> InitializeShaders()</div>
<div class="line">{</div>
<div class="line">    VkResult result;</div>
<div class="line"></div>
<div class="line">    VkShaderModuleCreateInfo moduleCreateInfo;</div>
<div class="line"></div>
<div class="line">    <a class="code" href="classnn_1_1_result.html">nn::Result</a> openResult;</div>
<div class="line">    <a name="_a14"></a><a class="code" href="structnn_1_1fs_1_1_file_handle.html">nn::fs::FileHandle</a> vertexSpirvFile;</div>
<div class="line">    openResult = <a name="a15"></a><a class="code" href="namespacenn_1_1fs.html#a0f2b5b30657b1ffaf1dec49bfb36462b">nn::fs::OpenFile</a>(&amp;vertexSpirvFile, <span class="stringliteral">&quot;Contents:/vertex_shader.spv&quot;</span>, <a name="a16"></a><a class="code" href="namespacenn_1_1fs.html#a4c97b79cce78a95c2333dbc9053b9393afde4472d2b455879cad02aade386ac0d">nn::fs::OpenMode_Read</a>);</div>
<div class="line">    <a class="code" href="nn___assert_8h.html#ade59d1d911907a16c0241f8fe3b31542">NN_ASSERT</a>(openResult.<a class="code" href="classnn_1_1_result.html#a80792d8ec8b6b9e9b34025100baa67ec">IsSuccess</a>());</div>
<div class="line"></div>
<div class="line">    int64_t vertexSize = -1;</div>
<div class="line">    openResult = <a name="a17"></a><a class="code" href="namespacenn_1_1fs.html#aba29e01d386e809349d60eccdb15ff21">nn::fs::GetFileSize</a>(&amp;vertexSize, vertexSpirvFile);</div>
<div class="line">    <a class="code" href="nn___assert_8h.html#ade59d1d911907a16c0241f8fe3b31542">NN_ASSERT</a>(openResult.<a class="code" href="classnn_1_1_result.html#a80792d8ec8b6b9e9b34025100baa67ec">IsSuccess</a>());</div>
<div class="line"></div>
<div class="line">    std::unique_ptr&lt; uint32_t &gt; pVertexData(<span class="keyword">new</span> uint32_t[vertexSize / <span class="keyword">sizeof</span>(uint32_t)]);</div>
<div class="line">    <a name="a18"></a><a class="code" href="namespacenn_1_1fs.html#a81801a404563984f8c6cc1483cc6d730">nn::fs::ReadFile</a>(vertexSpirvFile, 0, pVertexData.get(), vertexSize);</div>
<div class="line">    <a name="a19"></a><a class="code" href="namespacenn_1_1fs.html#ac8bd9e828751bd4f953acfa765278f84">nn::fs::CloseFile</a>(vertexSpirvFile);</div>
<div class="line"></div>
<div class="line">    g_AppData.m_pShaderStages[0].sType = VK_STRUCTURE_TYPE_PIPELINE_SHADER_STAGE_CREATE_INFO;</div>
<div class="line">    g_AppData.m_pShaderStages[0].pNext = NULL;</div>
<div class="line">    g_AppData.m_pShaderStages[0].pSpecializationInfo = NULL;</div>
<div class="line">    g_AppData.m_pShaderStages[0].flags = 0;</div>
<div class="line">    g_AppData.m_pShaderStages[0].stage = VK_SHADER_STAGE_VERTEX_BIT;</div>
<div class="line">    g_AppData.m_pShaderStages[0].pName = <span class="stringliteral">&quot;main&quot;</span>;</div>
<div class="line"></div>
<div class="line">    moduleCreateInfo.sType = VK_STRUCTURE_TYPE_SHADER_MODULE_CREATE_INFO;</div>
<div class="line">    moduleCreateInfo.pNext = NULL;</div>
<div class="line">    moduleCreateInfo.flags = 0;</div>
<div class="line">    moduleCreateInfo.codeSize = vertexSize;</div>
<div class="line">    moduleCreateInfo.pCode = pVertexData.get();</div>
<div class="line">    result = vkCreateShaderModule(g_AppData.m_Device, &amp;moduleCreateInfo, NULL, &amp;g_AppData.m_pShaderStages[0].module);</div>
<div class="line">    <a class="code" href="nn___assert_8h.html#a55d6b188692ffffd64e69532738ed2fc">NN_ASSERT_EQUAL</a>(result, VK_SUCCESS);</div>
<div class="line"></div>
<div class="line">    <a class="code" href="structnn_1_1fs_1_1_file_handle.html">nn::fs::FileHandle</a> fragmentSpirvFile;</div>
<div class="line">    openResult = <a class="code" href="namespacenn_1_1fs.html#a0f2b5b30657b1ffaf1dec49bfb36462b">nn::fs::OpenFile</a>(&amp;fragmentSpirvFile, <span class="stringliteral">&quot;Contents:/fragment_shader.spv&quot;</span>, <a class="code" href="namespacenn_1_1fs.html#a4c97b79cce78a95c2333dbc9053b9393afde4472d2b455879cad02aade386ac0d">nn::fs::OpenMode_Read</a>);</div>
<div class="line">    <a class="code" href="nn___assert_8h.html#ade59d1d911907a16c0241f8fe3b31542">NN_ASSERT</a>(openResult.<a class="code" href="classnn_1_1_result.html#a80792d8ec8b6b9e9b34025100baa67ec">IsSuccess</a>());</div>
<div class="line"></div>
<div class="line">    int64_t fragmentSize = -1;</div>
<div class="line">    openResult = <a class="code" href="namespacenn_1_1fs.html#aba29e01d386e809349d60eccdb15ff21">nn::fs::GetFileSize</a>(&amp;fragmentSize, fragmentSpirvFile);</div>
<div class="line">    <a class="code" href="nn___assert_8h.html#ade59d1d911907a16c0241f8fe3b31542">NN_ASSERT</a>(openResult.<a class="code" href="classnn_1_1_result.html#a80792d8ec8b6b9e9b34025100baa67ec">IsSuccess</a>());</div>
<div class="line"></div>
<div class="line">    std::unique_ptr&lt; uint32_t &gt; pFragmentData(<span class="keyword">new</span> uint32_t[fragmentSize / <span class="keyword">sizeof</span>(uint32_t)]);</div>
<div class="line">    <a class="code" href="namespacenn_1_1fs.html#a81801a404563984f8c6cc1483cc6d730">nn::fs::ReadFile</a>(fragmentSpirvFile, 0, pFragmentData.get(), fragmentSize);</div>
<div class="line">    <a class="code" href="namespacenn_1_1fs.html#ac8bd9e828751bd4f953acfa765278f84">nn::fs::CloseFile</a>(fragmentSpirvFile);</div>
<div class="line"></div>
<div class="line">    g_AppData.m_pShaderStages[1].sType = VK_STRUCTURE_TYPE_PIPELINE_SHADER_STAGE_CREATE_INFO;</div>
<div class="line">    g_AppData.m_pShaderStages[1].pNext = NULL;</div>
<div class="line">    g_AppData.m_pShaderStages[1].pSpecializationInfo = NULL;</div>
<div class="line">    g_AppData.m_pShaderStages[1].flags = 0;</div>
<div class="line">    g_AppData.m_pShaderStages[1].stage = VK_SHADER_STAGE_FRAGMENT_BIT;</div>
<div class="line">    g_AppData.m_pShaderStages[1].pName = <span class="stringliteral">&quot;main&quot;</span>;</div>
<div class="line"></div>
<div class="line">    moduleCreateInfo.sType = VK_STRUCTURE_TYPE_SHADER_MODULE_CREATE_INFO;</div>
<div class="line">    moduleCreateInfo.pNext = NULL;</div>
<div class="line">    moduleCreateInfo.flags = 0;</div>
<div class="line">    moduleCreateInfo.codeSize = fragmentSize;</div>
<div class="line">    moduleCreateInfo.pCode = pFragmentData.get();</div>
<div class="line">    result = vkCreateShaderModule(g_AppData.m_Device, &amp;moduleCreateInfo, NULL, &amp;g_AppData.m_pShaderStages[1].module);</div>
<div class="line">    <a class="code" href="nn___assert_8h.html#a55d6b188692ffffd64e69532738ed2fc">NN_ASSERT_EQUAL</a>(result, VK_SUCCESS);</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">bool</span> InitializeTexture()</div>
<div class="line">{</div>
<div class="line">    VkResult result;</div>
<div class="line"></div>
<div class="line">    {</div>
<div class="line">        VkImageCreateInfo info;</div>
<div class="line">        info.sType = VK_STRUCTURE_TYPE_IMAGE_CREATE_INFO;</div>
<div class="line">        info.pNext = NULL;</div>
<div class="line">        info.flags = 0;</div>
<div class="line">        info.arrayLayers = 1;</div>
<div class="line">        info.extent.width = 512;</div>
<div class="line">        info.extent.height = 512;</div>
<div class="line">        info.extent.depth = 1;</div>
<div class="line">        info.format = VK_FORMAT_R8G8B8A8_UNORM;</div>
<div class="line">        info.imageType = VK_IMAGE_TYPE_2D;</div>
<div class="line">        info.initialLayout = VK_IMAGE_LAYOUT_PREINITIALIZED;</div>
<div class="line">        info.mipLevels = 1;</div>
<div class="line">        info.pQueueFamilyIndices = NULL;</div>
<div class="line">        info.queueFamilyIndexCount = 0;</div>
<div class="line">        info.samples = VK_SAMPLE_COUNT_1_BIT;</div>
<div class="line">        info.sharingMode = VK_SHARING_MODE_EXCLUSIVE;</div>
<div class="line">        info.tiling = VK_IMAGE_TILING_LINEAR;</div>
<div class="line">        info.usage = VK_IMAGE_USAGE_SAMPLED_BIT;</div>
<div class="line"></div>
<div class="line">        VkFormatProperties formatProperties;</div>
<div class="line">        vkGetPhysicalDeviceFormatProperties(g_AppData.m_PhysicalDevice, info.format, &amp;formatProperties);</div>
<div class="line"></div>
<div class="line">            <span class="comment">/* Asserts if physical device doesn&#39;t support linear textures of specified format */</span></div>
<div class="line">        <a class="code" href="nn___assert_8h.html#a55d6b188692ffffd64e69532738ed2fc">NN_ASSERT_EQUAL</a>((formatProperties.linearTilingFeatures &amp; (VK_FORMAT_FEATURE_SAMPLED_IMAGE_BIT)),</div>
<div class="line">            static_cast&lt; VkFormatFeatureFlags &gt;(VK_FORMAT_FEATURE_SAMPLED_IMAGE_BIT));</div>
<div class="line"></div>
<div class="line">        result = vkCreateImage(g_AppData.m_Device, &amp;info, NULL, &amp;g_AppData.m_TextureImage);</div>
<div class="line">        <a class="code" href="nn___assert_8h.html#a55d6b188692ffffd64e69532738ed2fc">NN_ASSERT_EQUAL</a>(result, VK_SUCCESS);</div>
<div class="line"></div>
<div class="line">        VkImageSubresource subresource;</div>
<div class="line">        subresource.arrayLayer = 0;</div>
<div class="line">        subresource.mipLevel = 0;</div>
<div class="line">        subresource.aspectMask = VK_IMAGE_ASPECT_COLOR_BIT;</div>
<div class="line"></div>
<div class="line">        VkSubresourceLayout layout;</div>
<div class="line">        vkGetImageSubresourceLayout(g_AppData.m_Device, g_AppData.m_TextureImage, &amp;subresource, &amp;layout);</div>
<div class="line"></div>
<div class="line">        VkMemoryRequirements memReq;</div>
<div class="line">        vkGetImageMemoryRequirements(g_AppData.m_Device, g_AppData.m_TextureImage, &amp;memReq);</div>
<div class="line"></div>
<div class="line">        VkMemoryAllocateInfo allocInfo;</div>
<div class="line">        allocInfo.sType = VK_STRUCTURE_TYPE_MEMORY_ALLOCATE_INFO;</div>
<div class="line">        allocInfo.pNext = NULL;</div>
<div class="line">        allocInfo.memoryTypeIndex = 0;</div>
<div class="line">        allocInfo.allocationSize = memReq.size;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (!SelectMemoryType(memReq.memoryTypeBits, VK_MEMORY_PROPERTY_HOST_VISIBLE_BIT | VK_MEMORY_PROPERTY_HOST_COHERENT_BIT, &amp;allocInfo.memoryTypeIndex))</div>
<div class="line">        {</div>
<div class="line">            <a class="code" href="nn___assert_8h.html#ade59d1d911907a16c0241f8fe3b31542">NN_ASSERT</a>(<span class="keyword">false</span>, <span class="stringliteral">&quot;Failed to select memory type\n&quot;</span>);</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        result = vkAllocateMemory(g_AppData.m_Device, &amp;allocInfo, NULL, &amp;g_AppData.m_TextureMemory);</div>
<div class="line">        <a class="code" href="nn___assert_8h.html#a55d6b188692ffffd64e69532738ed2fc">NN_ASSERT_EQUAL</a>(result, VK_SUCCESS);</div>
<div class="line"></div>
<div class="line">        uint8_t* pData = NULL;</div>
<div class="line"></div>
<div class="line">        result = vkMapMemory(g_AppData.m_Device, g_AppData.m_TextureMemory, 0, memReq.size, 0, (<span class="keywordtype">void</span>**)&amp;pData);</div>
<div class="line">        <a class="code" href="nn___assert_8h.html#a55d6b188692ffffd64e69532738ed2fc">NN_ASSERT_EQUAL</a>(result, VK_SUCCESS);</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">for</span> (uint32_t yOff = 0; yOff &lt; 512; yOff++)</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">for</span> (uint32_t xOff = 0; xOff &lt; 512; xOff++)</div>
<div class="line">            {</div>
<div class="line">                uint8_t value = ((xOff / 32) &amp; 1) ^ ((yOff / 32) &amp; 1) ? 0xFF : 0x80;</div>
<div class="line">                pData[4 * xOff + 0] = value;</div>
<div class="line">                pData[4 * xOff + 1] = value;</div>
<div class="line">                pData[4 * xOff + 2] = value;</div>
<div class="line">                pData[4 * xOff + 3] = 0xFF;</div>
<div class="line">            }</div>
<div class="line">            pData += layout.rowPitch;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        vkUnmapMemory(g_AppData.m_Device, g_AppData.m_TextureMemory);</div>
<div class="line"></div>
<div class="line">        result = vkBindImageMemory(g_AppData.m_Device, g_AppData.m_TextureImage, g_AppData.m_TextureMemory, 0);</div>
<div class="line">        <a class="code" href="nn___assert_8h.html#a55d6b188692ffffd64e69532738ed2fc">NN_ASSERT_EQUAL</a>(result, VK_SUCCESS);</div>
<div class="line"></div>
<div class="line">            <span class="comment">/* Need an image barrier to transition the texture data */</span></div>
<div class="line">        SetImageLayoutTransition(g_AppData.m_TextureImage, VK_IMAGE_ASPECT_COLOR_BIT,</div>
<div class="line">            VK_IMAGE_LAYOUT_PREINITIALIZED, VK_IMAGE_LAYOUT_GENERAL);</div>
<div class="line"></div>
<div class="line">        VkImageViewCreateInfo viewInfo;</div>
<div class="line">        viewInfo.sType = VK_STRUCTURE_TYPE_IMAGE_VIEW_CREATE_INFO;</div>
<div class="line">        viewInfo.pNext = NULL;</div>
<div class="line">        viewInfo.flags = 0;</div>
<div class="line">        viewInfo.components.r = VK_COMPONENT_SWIZZLE_R;</div>
<div class="line">        viewInfo.components.g = VK_COMPONENT_SWIZZLE_G;</div>
<div class="line">        viewInfo.components.b = VK_COMPONENT_SWIZZLE_B;</div>
<div class="line">        viewInfo.components.a = VK_COMPONENT_SWIZZLE_A;</div>
<div class="line">        viewInfo.format = info.format;</div>
<div class="line">        viewInfo.image = g_AppData.m_TextureImage;</div>
<div class="line">        viewInfo.subresourceRange.aspectMask = VK_IMAGE_ASPECT_COLOR_BIT;</div>
<div class="line">        viewInfo.subresourceRange.baseArrayLayer = 0;</div>
<div class="line">        viewInfo.subresourceRange.baseMipLevel = 0;</div>
<div class="line">        viewInfo.subresourceRange.layerCount = 1;</div>
<div class="line">        viewInfo.subresourceRange.levelCount = 1;</div>
<div class="line">        viewInfo.viewType = VK_IMAGE_VIEW_TYPE_2D;</div>
<div class="line"></div>
<div class="line">        result = vkCreateImageView(g_AppData.m_Device, &amp;viewInfo, NULL, &amp;g_AppData.m_TextureImageView);</div>
<div class="line">        <a class="code" href="nn___assert_8h.html#a55d6b188692ffffd64e69532738ed2fc">NN_ASSERT_EQUAL</a>(result, VK_SUCCESS);</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    {</div>
<div class="line">        VkSamplerCreateInfo info;</div>
<div class="line">        info.sType = VK_STRUCTURE_TYPE_SAMPLER_CREATE_INFO;</div>
<div class="line">        info.addressModeU = VK_SAMPLER_ADDRESS_MODE_REPEAT;</div>
<div class="line">        info.addressModeV = VK_SAMPLER_ADDRESS_MODE_REPEAT;</div>
<div class="line">        info.addressModeW = VK_SAMPLER_ADDRESS_MODE_REPEAT;</div>
<div class="line">        info.anisotropyEnable = VK_FALSE;</div>
<div class="line">        info.borderColor = VK_BORDER_COLOR_FLOAT_OPAQUE_BLACK;</div>
<div class="line">        info.compareEnable = VK_FALSE;</div>
<div class="line">        info.compareOp = VK_COMPARE_OP_ALWAYS;</div>
<div class="line">        info.flags = 0;</div>
<div class="line">        info.magFilter = VK_FILTER_LINEAR;</div>
<div class="line">        info.minFilter = VK_FILTER_LINEAR;</div>
<div class="line">        info.maxAnisotropy = 1.0f;</div>
<div class="line">        info.maxLod = 0;</div>
<div class="line">        info.minLod = 0;</div>
<div class="line">        info.mipLodBias = 0;</div>
<div class="line">        info.mipmapMode = VK_SAMPLER_MIPMAP_MODE_NEAREST;</div>
<div class="line">        info.pNext = NULL;</div>
<div class="line">        info.unnormalizedCoordinates = VK_FALSE;</div>
<div class="line"></div>
<div class="line">        result = vkCreateSampler(g_AppData.m_Device, &amp;info, NULL, &amp;g_AppData.m_TextureSampler);</div>
<div class="line">        <a class="code" href="nn___assert_8h.html#a55d6b188692ffffd64e69532738ed2fc">NN_ASSERT_EQUAL</a>(result, VK_SUCCESS);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">}<span class="comment">//NOLINT(impl/function_size)</span></div>
<div class="line"></div>
<div class="line"><span class="keywordtype">bool</span> InitializeScene()</div>
<div class="line">{</div>
<div class="line">    VkResult result;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (!InitializeShaders())</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (!InitializeTexture())</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    {</div>
<div class="line">        VkPipelineCacheCreateInfo info;</div>
<div class="line">        info.sType = VK_STRUCTURE_TYPE_PIPELINE_CACHE_CREATE_INFO;</div>
<div class="line">        info.pNext = NULL;</div>
<div class="line">        info.initialDataSize = 0;</div>
<div class="line">        info.pInitialData = NULL;</div>
<div class="line">        info.flags = 0;</div>
<div class="line"></div>
<div class="line">        result = vkCreatePipelineCache(g_AppData.m_Device, &amp;info, NULL, &amp;g_AppData.m_PipelineCache);</div>
<div class="line">        <a class="code" href="nn___assert_8h.html#a55d6b188692ffffd64e69532738ed2fc">NN_ASSERT_EQUAL</a>(result, VK_SUCCESS);</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    {</div>
<div class="line">        VkDescriptorPoolSize typeCount[1];</div>
<div class="line">        typeCount[0].type = VK_DESCRIPTOR_TYPE_COMBINED_IMAGE_SAMPLER;</div>
<div class="line">        typeCount[0].descriptorCount = 1;</div>
<div class="line"></div>
<div class="line">        VkDescriptorPoolCreateInfo info;</div>
<div class="line">        info.sType = VK_STRUCTURE_TYPE_DESCRIPTOR_POOL_CREATE_INFO;</div>
<div class="line">        info.pNext = NULL;</div>
<div class="line">        info.flags = 0;</div>
<div class="line">        info.maxSets = g_NumDescriptorSets;</div>
<div class="line">        info.poolSizeCount = <span class="keyword">sizeof</span>(typeCount) / <span class="keyword">sizeof</span>(typeCount[0]);</div>
<div class="line">        info.pPoolSizes = typeCount;</div>
<div class="line">        result = vkCreateDescriptorPool(g_AppData.m_Device, &amp;info, NULL, &amp;g_AppData.m_DescriptorPool);</div>
<div class="line">        <a class="code" href="nn___assert_8h.html#a55d6b188692ffffd64e69532738ed2fc">NN_ASSERT_EQUAL</a>(result, VK_SUCCESS);</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    {</div>
<div class="line">        VkDescriptorSetLayoutBinding binding;</div>
<div class="line">        binding.binding = 0;</div>
<div class="line">        binding.descriptorCount = 1;</div>
<div class="line">        binding.descriptorType = VK_DESCRIPTOR_TYPE_COMBINED_IMAGE_SAMPLER;</div>
<div class="line">        binding.pImmutableSamplers = NULL; <span class="comment">/* We will set samplers dynamically */</span></div>
<div class="line">        binding.stageFlags = VK_SHADER_STAGE_FRAGMENT_BIT;</div>
<div class="line"></div>
<div class="line">        VkDescriptorSetLayoutCreateInfo info;</div>
<div class="line">        info.sType = VK_STRUCTURE_TYPE_DESCRIPTOR_SET_LAYOUT_CREATE_INFO;</div>
<div class="line">        info.pNext = NULL;</div>
<div class="line">        info.flags = 0;</div>
<div class="line">        info.bindingCount = 1;</div>
<div class="line">        info.pBindings = &amp;binding;</div>
<div class="line">        result = vkCreateDescriptorSetLayout(g_AppData.m_Device, &amp;info, NULL, &amp;g_AppData.m_DescriptorSetLayout);</div>
<div class="line">        <a class="code" href="nn___assert_8h.html#a55d6b188692ffffd64e69532738ed2fc">NN_ASSERT_EQUAL</a>(result, VK_SUCCESS);</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    {</div>
<div class="line">        VkDescriptorSetAllocateInfo info;</div>
<div class="line">        info.sType = VK_STRUCTURE_TYPE_DESCRIPTOR_SET_ALLOCATE_INFO;</div>
<div class="line">        info.pNext = NULL;</div>
<div class="line">        info.descriptorPool = g_AppData.m_DescriptorPool;</div>
<div class="line">        info.descriptorSetCount = 1;</div>
<div class="line">        info.pSetLayouts = &amp;g_AppData.m_DescriptorSetLayout;</div>
<div class="line"></div>
<div class="line">        result = vkAllocateDescriptorSets(g_AppData.m_Device, &amp;info, &amp;g_AppData.m_DescriptorSet);</div>
<div class="line">        <a class="code" href="nn___assert_8h.html#a55d6b188692ffffd64e69532738ed2fc">NN_ASSERT_EQUAL</a>(result, VK_SUCCESS);</div>
<div class="line"></div>
<div class="line">        VkDescriptorImageInfo imageDesc;</div>
<div class="line">        imageDesc.imageLayout = VK_IMAGE_LAYOUT_GENERAL;</div>
<div class="line">        imageDesc.imageView = g_AppData.m_TextureImageView;</div>
<div class="line">        imageDesc.sampler = g_AppData.m_TextureSampler;</div>
<div class="line"></div>
<div class="line">        VkWriteDescriptorSet descWrite;</div>
<div class="line">        descWrite.sType = VK_STRUCTURE_TYPE_WRITE_DESCRIPTOR_SET;</div>
<div class="line">        descWrite.pNext = NULL;</div>
<div class="line">        descWrite.dstSet = g_AppData.m_DescriptorSet;</div>
<div class="line">        descWrite.dstBinding = 0;</div>
<div class="line">        descWrite.dstArrayElement = 0;</div>
<div class="line">        descWrite.descriptorCount = 1;</div>
<div class="line">        descWrite.descriptorType = VK_DESCRIPTOR_TYPE_COMBINED_IMAGE_SAMPLER;</div>
<div class="line">        descWrite.pBufferInfo = NULL;</div>
<div class="line">        descWrite.pTexelBufferView = NULL;</div>
<div class="line">        descWrite.pImageInfo = &amp;imageDesc;</div>
<div class="line">        vkUpdateDescriptorSets(g_AppData.m_Device, 1, &amp;descWrite, 0, NULL);</div>
<div class="line">    }</div>
<div class="line">    {</div>
<div class="line">        VkPipelineLayoutCreateInfo info;</div>
<div class="line">        info.sType = VK_STRUCTURE_TYPE_PIPELINE_LAYOUT_CREATE_INFO;</div>
<div class="line">        info.pNext = NULL;</div>
<div class="line">        info.flags = 0;</div>
<div class="line">        info.pushConstantRangeCount = 0;</div>
<div class="line">        info.pPushConstantRanges = NULL;</div>
<div class="line">        info.setLayoutCount = g_NumDescriptorSets;</div>
<div class="line">        info.pSetLayouts = &amp;g_AppData.m_DescriptorSetLayout;</div>
<div class="line"></div>
<div class="line">        result = vkCreatePipelineLayout(g_AppData.m_Device, &amp;info, NULL, &amp;g_AppData.m_PipelineLayout);</div>
<div class="line">        <a class="code" href="nn___assert_8h.html#a55d6b188692ffffd64e69532738ed2fc">NN_ASSERT_EQUAL</a>(result, VK_SUCCESS);</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    {</div>
<div class="line">        VkPipelineColorBlendAttachmentState attachments[1];</div>
<div class="line">        attachments[0].colorWriteMask = 0xf;</div>
<div class="line">        attachments[0].blendEnable = VK_FALSE;</div>
<div class="line">        attachments[0].alphaBlendOp = VK_BLEND_OP_ADD;</div>
<div class="line">        attachments[0].colorBlendOp = VK_BLEND_OP_ADD;</div>
<div class="line">        attachments[0].srcColorBlendFactor = VK_BLEND_FACTOR_ONE;</div>
<div class="line">        attachments[0].dstColorBlendFactor = VK_BLEND_FACTOR_ZERO;</div>
<div class="line">        attachments[0].srcAlphaBlendFactor = VK_BLEND_FACTOR_ONE;</div>
<div class="line">        attachments[0].dstAlphaBlendFactor = VK_BLEND_FACTOR_ZERO;</div>
<div class="line"></div>
<div class="line">        VkPipelineColorBlendStateCreateInfo colorBlendStateInfo;</div>
<div class="line">        colorBlendStateInfo.sType = VK_STRUCTURE_TYPE_PIPELINE_COLOR_BLEND_STATE_CREATE_INFO;</div>
<div class="line">        colorBlendStateInfo.pNext = NULL;</div>
<div class="line">        colorBlendStateInfo.flags = 0;</div>
<div class="line">        colorBlendStateInfo.attachmentCount = 1;</div>
<div class="line">        colorBlendStateInfo.pAttachments = attachments;</div>
<div class="line">        colorBlendStateInfo.logicOpEnable = VK_FALSE;</div>
<div class="line">        colorBlendStateInfo.logicOp = VK_LOGIC_OP_NO_OP;</div>
<div class="line">        colorBlendStateInfo.blendConstants[0] = 1.0f;</div>
<div class="line">        colorBlendStateInfo.blendConstants[1] = 1.0f;</div>
<div class="line">        colorBlendStateInfo.blendConstants[2] = 1.0f;</div>
<div class="line">        colorBlendStateInfo.blendConstants[3] = 1.0f;</div>
<div class="line"></div>
<div class="line">        VkPipelineDepthStencilStateCreateInfo depthStencilStateInfo;</div>
<div class="line">        depthStencilStateInfo.sType = VK_STRUCTURE_TYPE_PIPELINE_DEPTH_STENCIL_STATE_CREATE_INFO;</div>
<div class="line">        depthStencilStateInfo.pNext = NULL;</div>
<div class="line">        depthStencilStateInfo.flags = 0;</div>
<div class="line">        depthStencilStateInfo.depthTestEnable = VK_TRUE;</div>
<div class="line">        depthStencilStateInfo.depthWriteEnable = VK_TRUE;</div>
<div class="line">        depthStencilStateInfo.depthCompareOp = VK_COMPARE_OP_LESS_OR_EQUAL;</div>
<div class="line">        depthStencilStateInfo.depthBoundsTestEnable = VK_FALSE;</div>
<div class="line">        depthStencilStateInfo.stencilTestEnable = VK_FALSE;</div>
<div class="line">        depthStencilStateInfo.back.failOp = VK_STENCIL_OP_KEEP;</div>
<div class="line">        depthStencilStateInfo.back.passOp = VK_STENCIL_OP_KEEP;</div>
<div class="line">        depthStencilStateInfo.back.compareOp = VK_COMPARE_OP_ALWAYS;</div>
<div class="line">        depthStencilStateInfo.back.compareMask = 0;</div>
<div class="line">        depthStencilStateInfo.back.reference = 0;</div>
<div class="line">        depthStencilStateInfo.back.depthFailOp = VK_STENCIL_OP_KEEP;</div>
<div class="line">        depthStencilStateInfo.back.writeMask = 0;</div>
<div class="line">        depthStencilStateInfo.minDepthBounds = 0;</div>
<div class="line">        depthStencilStateInfo.maxDepthBounds = 0;</div>
<div class="line">        depthStencilStateInfo.front = depthStencilStateInfo.back;</div>
<div class="line"></div>
<div class="line">        VkDynamicState dynamicStates[VK_DYNAMIC_STATE_RANGE_SIZE];</div>
<div class="line">        VkPipelineDynamicStateCreateInfo dynamicStateInfo;</div>
<div class="line">        dynamicStateInfo.sType = VK_STRUCTURE_TYPE_PIPELINE_DYNAMIC_STATE_CREATE_INFO;</div>
<div class="line">        dynamicStateInfo.pNext = NULL;</div>
<div class="line">        dynamicStateInfo.flags = 0;</div>
<div class="line">        dynamicStateInfo.dynamicStateCount = 0;</div>
<div class="line">        dynamicStateInfo.pDynamicStates = dynamicStates;</div>
<div class="line">        dynamicStates[dynamicStateInfo.dynamicStateCount++] = VK_DYNAMIC_STATE_VIEWPORT;</div>
<div class="line">        dynamicStates[dynamicStateInfo.dynamicStateCount++] = VK_DYNAMIC_STATE_SCISSOR;</div>
<div class="line"></div>
<div class="line">        VkPipelineInputAssemblyStateCreateInfo inputAssemblyStateInfo;</div>
<div class="line">        inputAssemblyStateInfo.sType = VK_STRUCTURE_TYPE_PIPELINE_INPUT_ASSEMBLY_STATE_CREATE_INFO;</div>
<div class="line">        inputAssemblyStateInfo.pNext = NULL;</div>
<div class="line">        inputAssemblyStateInfo.flags = 0;</div>
<div class="line">        inputAssemblyStateInfo.primitiveRestartEnable = VK_FALSE;</div>
<div class="line">        inputAssemblyStateInfo.topology = VK_PRIMITIVE_TOPOLOGY_TRIANGLE_LIST;</div>
<div class="line"></div>
<div class="line">        VkVertexInputBindingDescription bufferBindings[1];</div>
<div class="line">        bufferBindings[0].binding = 0;</div>
<div class="line">        bufferBindings[0].inputRate = VK_VERTEX_INPUT_RATE_VERTEX;</div>
<div class="line">        bufferBindings[0].stride = <span class="keyword">sizeof</span>(float) * 9; <span class="comment">/* Buffer Stride */</span></div>
<div class="line"></div>
<div class="line">        VkVertexInputAttributeDescription attribDescs[3];</div>
<div class="line">        attribDescs[0].binding = 0; <span class="comment">/* Buffer Binding */</span></div>
<div class="line">        attribDescs[0].format = VK_FORMAT_R32G32B32_SFLOAT;</div>
<div class="line">        attribDescs[0].location = 0; <span class="comment">/* Shader location */</span></div>
<div class="line">        attribDescs[0].offset = 0;</div>
<div class="line">        attribDescs[1].binding = 0; <span class="comment">/* Buffer Binding */</span></div>
<div class="line">        attribDescs[1].format = VK_FORMAT_R32G32B32A32_SFLOAT;</div>
<div class="line">        attribDescs[1].location = 1; <span class="comment">/* Shader location */</span></div>
<div class="line">        attribDescs[1].offset = <span class="keyword">sizeof</span>(float) * 3;</div>
<div class="line">        attribDescs[2].binding = 0; <span class="comment">/* Buffer Binding */</span></div>
<div class="line">        attribDescs[2].format = VK_FORMAT_R32G32_SFLOAT;</div>
<div class="line">        attribDescs[2].location = 2; <span class="comment">/* Shader location */</span></div>
<div class="line">        attribDescs[2].offset = <span class="keyword">sizeof</span>(float) * 7;</div>
<div class="line"></div>
<div class="line"></div>
<div class="line">        VkPipelineVertexInputStateCreateInfo vertexInputStateInfo;</div>
<div class="line">        memset(&amp;vertexInputStateInfo, 0, <span class="keyword">sizeof</span>(VkPipelineVertexInputStateCreateInfo));</div>
<div class="line">        vertexInputStateInfo.sType = VK_STRUCTURE_TYPE_PIPELINE_VERTEX_INPUT_STATE_CREATE_INFO;</div>
<div class="line">        vertexInputStateInfo.pNext = NULL;</div>
<div class="line">        vertexInputStateInfo.flags = 0;</div>
<div class="line">        vertexInputStateInfo.vertexBindingDescriptionCount = <span class="keyword">sizeof</span>(bufferBindings) / <span class="keyword">sizeof</span>(bufferBindings[0]);</div>
<div class="line">        vertexInputStateInfo.pVertexBindingDescriptions = bufferBindings;</div>
<div class="line">        vertexInputStateInfo.vertexAttributeDescriptionCount = <span class="keyword">sizeof</span>(attribDescs) / <span class="keyword">sizeof</span>(attribDescs[0]);</div>
<div class="line">        vertexInputStateInfo.pVertexAttributeDescriptions = attribDescs;</div>
<div class="line"></div>
<div class="line">        VkPipelineMultisampleStateCreateInfo multisampleStateInfo;</div>
<div class="line">        multisampleStateInfo.sType = VK_STRUCTURE_TYPE_PIPELINE_MULTISAMPLE_STATE_CREATE_INFO;</div>
<div class="line">        multisampleStateInfo.pNext = NULL;</div>
<div class="line">        multisampleStateInfo.flags = 0;</div>
<div class="line">        multisampleStateInfo.pSampleMask = NULL;</div>
<div class="line">        multisampleStateInfo.rasterizationSamples = VK_SAMPLE_COUNT_1_BIT;</div>
<div class="line">        multisampleStateInfo.sampleShadingEnable = VK_FALSE;</div>
<div class="line">        multisampleStateInfo.alphaToCoverageEnable = VK_FALSE;</div>
<div class="line">        multisampleStateInfo.alphaToOneEnable = VK_FALSE;</div>
<div class="line">        multisampleStateInfo.minSampleShading = 0.0;</div>
<div class="line"></div>
<div class="line">        VkPipelineRasterizationStateCreateInfo rasterizationStateInfo;</div>
<div class="line">        rasterizationStateInfo.sType = VK_STRUCTURE_TYPE_PIPELINE_RASTERIZATION_STATE_CREATE_INFO;</div>
<div class="line">        rasterizationStateInfo.pNext = NULL;</div>
<div class="line">        rasterizationStateInfo.flags = 0;</div>
<div class="line">        rasterizationStateInfo.polygonMode = VK_POLYGON_MODE_FILL;</div>
<div class="line">        rasterizationStateInfo.cullMode = VK_CULL_MODE_BACK_BIT;</div>
<div class="line">        rasterizationStateInfo.frontFace = VK_FRONT_FACE_CLOCKWISE;</div>
<div class="line">        rasterizationStateInfo.rasterizerDiscardEnable = VK_FALSE;</div>
<div class="line">        rasterizationStateInfo.depthBiasEnable = VK_FALSE;</div>
<div class="line">        rasterizationStateInfo.depthClampEnable = VK_TRUE;</div>
<div class="line">        rasterizationStateInfo.lineWidth = 1.0f;</div>
<div class="line"></div>
<div class="line">        VkPipelineViewportStateCreateInfo viewportStateInfo;</div>
<div class="line">        viewportStateInfo.sType = VK_STRUCTURE_TYPE_PIPELINE_VIEWPORT_STATE_CREATE_INFO;</div>
<div class="line">        viewportStateInfo.pNext = NULL;</div>
<div class="line">        viewportStateInfo.flags = 0;</div>
<div class="line">        viewportStateInfo.viewportCount = 1;</div>
<div class="line">        viewportStateInfo.scissorCount = 1;</div>
<div class="line">            <span class="comment">/* These are part of the dynamic state */</span></div>
<div class="line">        viewportStateInfo.pViewports = NULL;</div>
<div class="line">        viewportStateInfo.pScissors = NULL;</div>
<div class="line"></div>
<div class="line">        VkGraphicsPipelineCreateInfo info;</div>
<div class="line">        info.sType = VK_STRUCTURE_TYPE_GRAPHICS_PIPELINE_CREATE_INFO;</div>
<div class="line">        info.pNext = NULL;</div>
<div class="line">        info.layout = g_AppData.m_PipelineLayout;</div>
<div class="line">        info.basePipelineHandle = VK_NULL_HANDLE;</div>
<div class="line">        info.basePipelineIndex = 0;</div>
<div class="line">        info.flags = 0;</div>
<div class="line">        info.pColorBlendState = &amp;colorBlendStateInfo;</div>
<div class="line">        info.pDepthStencilState = &amp;depthStencilStateInfo;</div>
<div class="line">        info.pDynamicState = &amp;dynamicStateInfo;</div>
<div class="line">        info.pInputAssemblyState = &amp;inputAssemblyStateInfo;</div>
<div class="line">        info.pMultisampleState = &amp;multisampleStateInfo;</div>
<div class="line">        info.pRasterizationState = &amp;rasterizationStateInfo;</div>
<div class="line">        info.stageCount = 2;</div>
<div class="line">        info.pStages = g_AppData.m_pShaderStages;</div>
<div class="line">        info.pTessellationState = NULL;</div>
<div class="line">        info.pVertexInputState = &amp;vertexInputStateInfo;</div>
<div class="line">        info.pViewportState = &amp;viewportStateInfo;</div>
<div class="line">        info.renderPass = g_AppData.m_RenderPass;</div>
<div class="line">        info.subpass = 0;</div>
<div class="line"></div>
<div class="line">        result = vkCreateGraphicsPipelines(g_AppData.m_Device, g_AppData.m_PipelineCache, 1, &amp;info, NULL, &amp;g_AppData.m_Pipeline);</div>
<div class="line">        <a class="code" href="nn___assert_8h.html#a55d6b188692ffffd64e69532738ed2fc">NN_ASSERT_EQUAL</a>(result, VK_SUCCESS);</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Setup Viewport */</span></div>
<div class="line">    g_AppData.m_Viewport.x = 0;</div>
<div class="line">    g_AppData.m_Viewport.y = 0;</div>
<div class="line">    g_AppData.m_Viewport.width = <span class="keyword">static_cast&lt;</span> <span class="keywordtype">float</span> <span class="keyword">&gt;</span>(g_AppData.m_SwapChainExtent.width);</div>
<div class="line">    g_AppData.m_Viewport.height = <span class="keyword">static_cast&lt;</span> <span class="keywordtype">float</span> <span class="keyword">&gt;</span>(g_AppData.m_SwapChainExtent.height);</div>
<div class="line">    g_AppData.m_Viewport.minDepth = 0.0f;</div>
<div class="line">    g_AppData.m_Viewport.maxDepth = 1.0f;</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Setup Scissor */</span></div>
<div class="line">    g_AppData.m_Scissor.offset.x = 0;</div>
<div class="line">    g_AppData.m_Scissor.offset.y = 0;</div>
<div class="line">    g_AppData.m_Scissor.extent.width = g_AppData.m_SwapChainExtent.width;</div>
<div class="line">    g_AppData.m_Scissor.extent.height = g_AppData.m_SwapChainExtent.height;</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Setup Vertex Buffer */</span></div>
<div class="line">    g_AppData.m_VertexCount = 3;</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordtype">float</span> vertexData[] = {</div>
<div class="line">            -1.0f, -1.0f, 0.0f, 1.0f, 0.0f, 0.0f, 1.0f, 0.0f, 0.0f,</div>
<div class="line">            0.0f, 1.0f, 0.0f, 0.0f, 1.0f, 0.0f, 1.0f, 0.5f, 1.0f,</div>
<div class="line">            1.0f, -1.0f, 0.0f, 0.0f, 0.0f, 1.0f, 1.0f, 1.0f, 0.0f,</div>
<div class="line">        };</div>
<div class="line"></div>
<div class="line">        result = CreateBuffer(&amp;g_AppData.m_VertexBuffer, &amp;g_AppData.m_VertexBufferMem, <span class="keyword">sizeof</span>(vertexData),</div>
<div class="line">            vertexData, VK_BUFFER_USAGE_VERTEX_BUFFER_BIT);</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">}<span class="comment">//NOLINT(impl/function_size)</span></div>
<div class="line"></div>
<div class="line"><span class="keywordtype">bool</span> InitializeVulkan()</div>
<div class="line">{</div>
<div class="line">    VkResult result;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (!InitializeExtensions())</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">if</span> (!InitializeInstance())</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">if</span> (!InitializePhysicalDevice())</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">if</span> (!InitializeLogicalDevice())</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">if</span> (!RegisterDebugCallback())</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">if</span> (!InitializeQueue())</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">if</span> (!InitializeCommandBuffer())</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    {</div>
<div class="line">        VkCommandBufferBeginInfo info = {};</div>
<div class="line">        info.sType = VK_STRUCTURE_TYPE_COMMAND_BUFFER_BEGIN_INFO;</div>
<div class="line">        info.pNext = NULL;</div>
<div class="line">        info.flags = 0;</div>
<div class="line">        info.pInheritanceInfo = NULL;</div>
<div class="line">        result = vkBeginCommandBuffer(g_AppData.m_CommandBuffer, &amp;info);</div>
<div class="line">        <a class="code" href="nn___assert_8h.html#a55d6b188692ffffd64e69532738ed2fc">NN_ASSERT_EQUAL</a>(result, VK_SUCCESS);</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (!InitializeSwapchain())</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">if</span> (!InitializeDepthBuffer())</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">if</span> (!InitializeRenderPass())</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">if</span> (!InitializeFrameBuffer())</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">if</span> (!InitializeScene())</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Close off any commands and send */</span></div>
<div class="line">    result = vkEndCommandBuffer(g_AppData.m_CommandBuffer);</div>
<div class="line">    <a class="code" href="nn___assert_8h.html#a55d6b188692ffffd64e69532738ed2fc">NN_ASSERT_EQUAL</a>(result, VK_SUCCESS);</div>
<div class="line"></div>
<div class="line">    {</div>
<div class="line">        VkFenceCreateInfo fenceInfo = {};</div>
<div class="line">        fenceInfo.sType = VK_STRUCTURE_TYPE_FENCE_CREATE_INFO;</div>
<div class="line">        fenceInfo.pNext = NULL;</div>
<div class="line">        fenceInfo.flags = 0;</div>
<div class="line">        result = vkCreateFence(g_AppData.m_Device, &amp;fenceInfo, NULL, &amp;g_AppData.m_Fence);</div>
<div class="line">        <a class="code" href="nn___assert_8h.html#a55d6b188692ffffd64e69532738ed2fc">NN_ASSERT_EQUAL</a>(result, VK_SUCCESS);</div>
<div class="line"></div>
<div class="line">        VkSubmitInfo info = {};</div>
<div class="line">        info.sType = VK_STRUCTURE_TYPE_SUBMIT_INFO;</div>
<div class="line">        info.pNext = NULL;</div>
<div class="line">        info.commandBufferCount = 1;</div>
<div class="line">        info.pCommandBuffers = &amp;g_AppData.m_CommandBuffer;</div>
<div class="line">        info.signalSemaphoreCount = 0;</div>
<div class="line">        info.waitSemaphoreCount = 0;</div>
<div class="line">        result = vkQueueSubmit(g_AppData.m_Queue, 1, &amp;info, g_AppData.m_Fence);</div>
<div class="line">        <a class="code" href="nn___assert_8h.html#a55d6b188692ffffd64e69532738ed2fc">NN_ASSERT_EQUAL</a>(result, VK_SUCCESS);</div>
<div class="line"></div>
<div class="line">        result = vkQueueWaitIdle(g_AppData.m_Queue);</div>
<div class="line">        <a class="code" href="nn___assert_8h.html#a55d6b188692ffffd64e69532738ed2fc">NN_ASSERT_EQUAL</a>(result, VK_SUCCESS);</div>
<div class="line"></div>
<div class="line">            <span class="comment">/* A fence is necessary to guarantee the command buffer is done */</span></div>
<div class="line">        result = vkWaitForFences(g_AppData.m_Device, 1, &amp;g_AppData.m_Fence, VK_TRUE, 10000000000ull);</div>
<div class="line">        <a class="code" href="nn___assert_8h.html#a55d6b188692ffffd64e69532738ed2fc">NN_ASSERT_EQUAL</a>(result, VK_SUCCESS);</div>
<div class="line"></div>
<div class="line">        result = vkResetFences(g_AppData.m_Device, 1, &amp;g_AppData.m_Fence);</div>
<div class="line">        <a class="code" href="nn___assert_8h.html#a55d6b188692ffffd64e69532738ed2fc">NN_ASSERT_EQUAL</a>(result, VK_SUCCESS);</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> UpdateScene()</div>
<div class="line">{</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> DrawScene()</div>
<div class="line">{</div>
<div class="line">    VkResult result;</div>
<div class="line"></div>
<div class="line">        <span class="comment">/*  Assume we&#39;ve submitted and synced and reset Command Buffers */</span></div>
<div class="line">    result = vkResetCommandBuffer(g_AppData.m_CommandBuffer, 0);</div>
<div class="line">    <a class="code" href="nn___assert_8h.html#a55d6b188692ffffd64e69532738ed2fc">NN_ASSERT_EQUAL</a>(result, VK_SUCCESS);</div>
<div class="line"></div>
<div class="line">    VkSemaphore presentSemaphore;</div>
<div class="line">    {</div>
<div class="line">        VkSemaphoreCreateInfo info = {};</div>
<div class="line">        info.sType = VK_STRUCTURE_TYPE_SEMAPHORE_CREATE_INFO;</div>
<div class="line">        info.pNext = NULL;</div>
<div class="line">        info.flags = 0;</div>
<div class="line">        result = vkCreateSemaphore(g_AppData.m_Device, &amp;info, NULL, &amp;presentSemaphore);</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    result = vkAcquireNextImageKHR(g_AppData.m_Device, g_AppData.m_SwapChainKhr, UINT64_MAX, presentSemaphore, VK_NULL_HANDLE, &amp;g_AppData.m_CurrentBuffer);</div>
<div class="line">    <a class="code" href="nn___assert_8h.html#a55d6b188692ffffd64e69532738ed2fc">NN_ASSERT_EQUAL</a>(result, VK_SUCCESS);</div>
<div class="line"></div>
<div class="line">    {</div>
<div class="line">        VkCommandBufferBeginInfo beginInfo = {};</div>
<div class="line">        beginInfo.sType = VK_STRUCTURE_TYPE_COMMAND_BUFFER_BEGIN_INFO;</div>
<div class="line">        beginInfo.pNext = NULL;</div>
<div class="line">        beginInfo.flags = VK_COMMAND_BUFFER_USAGE_ONE_TIME_SUBMIT_BIT;</div>
<div class="line">        beginInfo.pInheritanceInfo = NULL; <span class="comment">/* Unused by Primary CBs */</span></div>
<div class="line">        result = vkBeginCommandBuffer(g_AppData.m_CommandBuffer, &amp;beginInfo);</div>
<div class="line">        <a class="code" href="nn___assert_8h.html#a55d6b188692ffffd64e69532738ed2fc">NN_ASSERT_EQUAL</a>(result, VK_SUCCESS);</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    SetImageLayoutTransition(g_AppData.m_pSwapChainImages[g_AppData.m_CurrentBuffer], VK_IMAGE_ASPECT_COLOR_BIT,</div>
<div class="line">        VK_IMAGE_LAYOUT_PRESENT_SRC_KHR, VK_IMAGE_LAYOUT_COLOR_ATTACHMENT_OPTIMAL);</div>
<div class="line"></div>
<div class="line">    {</div>
<div class="line">        VkClearValue clearValues[2];</div>
<div class="line">        clearValues[0].color.float32[0] = 0.2f;</div>
<div class="line">        clearValues[0].color.float32[1] = 0.2f;</div>
<div class="line">        clearValues[0].color.float32[2] = 0.2f;</div>
<div class="line">        clearValues[0].color.float32[3] = 0.2f;</div>
<div class="line">        clearValues[1].depthStencil.depth = 1.0f;</div>
<div class="line">        clearValues[1].depthStencil.stencil = 0;</div>
<div class="line"></div>
<div class="line">        VkRenderPassBeginInfo info = {};</div>
<div class="line">        info.sType = VK_STRUCTURE_TYPE_RENDER_PASS_BEGIN_INFO;</div>
<div class="line">        info.pNext = NULL;</div>
<div class="line">        info.renderPass = g_AppData.m_RenderPass;</div>
<div class="line">        info.framebuffer = g_AppData.m_pFramebuffers[g_AppData.m_CurrentBuffer];</div>
<div class="line">        info.renderArea.offset.x = 0;</div>
<div class="line">        info.renderArea.offset.y = 0;</div>
<div class="line">        info.renderArea.extent = g_AppData.m_SwapChainExtent;</div>
<div class="line">        info.clearValueCount = 2;</div>
<div class="line">        info.pClearValues = clearValues;</div>
<div class="line"></div>
<div class="line">        vkCmdBeginRenderPass(g_AppData.m_CommandBuffer, &amp;info, VK_SUBPASS_CONTENTS_INLINE);</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    vkCmdBindPipeline(g_AppData.m_CommandBuffer, VK_PIPELINE_BIND_POINT_GRAPHICS, g_AppData.m_Pipeline);</div>
<div class="line">    vkCmdBindDescriptorSets(g_AppData.m_CommandBuffer, VK_PIPELINE_BIND_POINT_GRAPHICS, g_AppData.m_PipelineLayout, 0, 1, &amp;g_AppData.m_DescriptorSet, 0, NULL);</div>
<div class="line">    <span class="keyword">const</span> VkDeviceSize offsets[1] = { 0 };</div>
<div class="line">    vkCmdBindVertexBuffers(g_AppData.m_CommandBuffer, 0, 1, &amp;g_AppData.m_VertexBuffer, offsets);</div>
<div class="line">    vkCmdSetViewport(g_AppData.m_CommandBuffer, 0, 1, &amp;g_AppData.m_Viewport);</div>
<div class="line">    vkCmdSetScissor(g_AppData.m_CommandBuffer, 0, 1, &amp;g_AppData.m_Scissor);</div>
<div class="line">    vkCmdDraw(g_AppData.m_CommandBuffer, g_AppData.m_VertexCount, 1, 0, 0);</div>
<div class="line"></div>
<div class="line">    vkCmdEndRenderPass(g_AppData.m_CommandBuffer);</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Transition the swapchain image so it can be presented */</span></div>
<div class="line">    SetImageLayoutTransition(g_AppData.m_pSwapChainImages[g_AppData.m_CurrentBuffer], VK_IMAGE_ASPECT_COLOR_BIT, VK_IMAGE_LAYOUT_COLOR_ATTACHMENT_OPTIMAL, VK_IMAGE_LAYOUT_PRESENT_SRC_KHR);</div>
<div class="line"></div>
<div class="line">    {</div>
<div class="line">            <span class="comment">/* Flush query/timestamp writes */</span></div>
<div class="line">        VkMemoryBarrier memoryBarrier;</div>
<div class="line">        memoryBarrier.sType = VK_STRUCTURE_TYPE_MEMORY_BARRIER;</div>
<div class="line">        memoryBarrier.pNext = <span class="keyword">nullptr</span>;</div>
<div class="line">        memoryBarrier.srcAccessMask = VK_ACCESS_TRANSFER_WRITE_BIT;</div>
<div class="line">        memoryBarrier.dstAccessMask = VK_ACCESS_HOST_READ_BIT;</div>
<div class="line">        vkCmdPipelineBarrier(g_AppData.m_CommandBuffer, VK_PIPELINE_STAGE_TRANSFER_BIT, VK_PIPELINE_STAGE_HOST_BIT, 0, 1, &amp;memoryBarrier, 0, <span class="keyword">nullptr</span>, 0, <span class="keyword">nullptr</span>);</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    result = vkEndCommandBuffer(g_AppData.m_CommandBuffer);</div>
<div class="line">    <a class="code" href="nn___assert_8h.html#a55d6b188692ffffd64e69532738ed2fc">NN_ASSERT_EQUAL</a>(result, VK_SUCCESS);</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Pipelilne flags are required if we have a semaphore. */</span></div>
<div class="line">    VkPipelineStageFlags pipelineStageMask = VK_PIPELINE_STAGE_BOTTOM_OF_PIPE_BIT;</div>
<div class="line">    VkSubmitInfo submitInfo = {};</div>
<div class="line">    submitInfo.sType = VK_STRUCTURE_TYPE_SUBMIT_INFO;</div>
<div class="line">    submitInfo.pNext = NULL;</div>
<div class="line">    submitInfo.waitSemaphoreCount = 1;</div>
<div class="line">    submitInfo.pWaitSemaphores = &amp;presentSemaphore;</div>
<div class="line">    submitInfo.pWaitDstStageMask = &amp;pipelineStageMask;</div>
<div class="line">    submitInfo.commandBufferCount = 1;</div>
<div class="line">    submitInfo.pCommandBuffers = &amp;g_AppData.m_CommandBuffer;</div>
<div class="line">    submitInfo.signalSemaphoreCount = 0;</div>
<div class="line">    submitInfo.pSignalSemaphores = NULL;</div>
<div class="line">    result = vkQueueSubmit(g_AppData.m_Queue, 1, &amp;submitInfo, g_AppData.m_Fence);</div>
<div class="line">    <a class="code" href="nn___assert_8h.html#a55d6b188692ffffd64e69532738ed2fc">NN_ASSERT_EQUAL</a>(result, VK_SUCCESS);</div>
<div class="line"></div>
<div class="line">    VkPresentInfoKHR presentInfo = {};</div>
<div class="line">    presentInfo.sType = VK_STRUCTURE_TYPE_PRESENT_INFO_KHR;</div>
<div class="line">    presentInfo.pNext = NULL;</div>
<div class="line">    presentInfo.swapchainCount = 1;</div>
<div class="line">    presentInfo.pSwapchains = &amp;g_AppData.m_SwapChainKhr;</div>
<div class="line">    presentInfo.pImageIndices = &amp;g_AppData.m_CurrentBuffer;</div>
<div class="line">    presentInfo.waitSemaphoreCount = 0;</div>
<div class="line">    presentInfo.pWaitSemaphores = NULL;</div>
<div class="line">    presentInfo.pResults = NULL;</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Use the draw fence to sync before presenting. */</span></div>
<div class="line">    result = vkWaitForFences(g_AppData.m_Device, 1, &amp;g_AppData.m_Fence, VK_TRUE, 10000000000ull);</div>
<div class="line">    <a class="code" href="nn___assert_8h.html#a55d6b188692ffffd64e69532738ed2fc">NN_ASSERT_EQUAL</a>(result, VK_SUCCESS);</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Reset the fence */</span></div>
<div class="line">    result = vkResetFences(g_AppData.m_Device, 1, &amp;g_AppData.m_Fence);</div>
<div class="line">    <a class="code" href="nn___assert_8h.html#a55d6b188692ffffd64e69532738ed2fc">NN_ASSERT_EQUAL</a>(result, VK_SUCCESS);</div>
<div class="line"></div>
<div class="line">    result = vkQueuePresentKHR(g_AppData.m_Queue, &amp;presentInfo);</div>
<div class="line">    <a class="code" href="nn___assert_8h.html#a55d6b188692ffffd64e69532738ed2fc">NN_ASSERT_EQUAL</a>(result, VK_SUCCESS);</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> FinalizeVulkan()</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; g_MaxSwaps; ++i)</div>
<div class="line">    {</div>
<div class="line">        vkDestroyFramebuffer(g_AppData.m_Device, g_AppData.m_pFramebuffers[i], NULL);</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    vkDestroyFence(g_AppData.m_Device, g_AppData.m_Fence, NULL);</div>
<div class="line"></div>
<div class="line">    vkDestroyDescriptorPool(g_AppData.m_Device, g_AppData.m_DescriptorPool, NULL);</div>
<div class="line">    vkDestroyDescriptorSetLayout(g_AppData.m_Device, g_AppData.m_DescriptorSetLayout, NULL);</div>
<div class="line"></div>
<div class="line">    vkFreeCommandBuffers(g_AppData.m_Device, g_AppData.m_CommandPool, 1, &amp;g_AppData.m_CommandBuffer);</div>
<div class="line">    vkDestroyCommandPool(g_AppData.m_Device, g_AppData.m_CommandPool, NULL);</div>
<div class="line"></div>
<div class="line">    vkDestroyPipeline(g_AppData.m_Device, g_AppData.m_Pipeline, NULL);</div>
<div class="line">    vkDestroyPipelineCache(g_AppData.m_Device, g_AppData.m_PipelineCache, NULL);</div>
<div class="line">    vkDestroyPipelineLayout(g_AppData.m_Device, g_AppData.m_PipelineLayout, NULL);</div>
<div class="line"></div>
<div class="line">    vkDestroyRenderPass(g_AppData.m_Device, g_AppData.m_RenderPass, NULL);</div>
<div class="line"></div>
<div class="line">    vkDestroyBuffer(g_AppData.m_Device, g_AppData.m_VertexBuffer, NULL);</div>
<div class="line">    vkFreeMemory(g_AppData.m_Device, g_AppData.m_VertexBufferMem, NULL);</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; g_AppData.m_SwapchainImageCount; i++)</div>
<div class="line">    {</div>
<div class="line">        vkDestroyImageView(g_AppData.m_Device, g_AppData.m_pColorImageView[i], NULL);</div>
<div class="line">        vkDestroyImage(g_AppData.m_Device, g_AppData.m_pSwapChainImages[i], NULL);</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    free(g_AppData.m_pSwapChainImages);</div>
<div class="line"></div>
<div class="line">    vkDestroyImageView(g_AppData.m_Device, g_AppData.m_TextureImageView, NULL);</div>
<div class="line">    vkDestroyImage(g_AppData.m_Device, g_AppData.m_TextureImage, NULL);</div>
<div class="line">    vkFreeMemory(g_AppData.m_Device, g_AppData.m_TextureMemory, NULL);</div>
<div class="line">    vkDestroySampler(g_AppData.m_Device, g_AppData.m_TextureSampler, NULL);</div>
<div class="line"></div>
<div class="line">    vkDestroyImageView(g_AppData.m_Device, g_AppData.m_DepthBufferImageView, NULL);</div>
<div class="line">    vkDestroyImage(g_AppData.m_Device, g_AppData.m_DepthBufferImage, NULL);</div>
<div class="line">    vkFreeMemory(g_AppData.m_Device, g_AppData.m_DepthBufferMemory, NULL);</div>
<div class="line"></div>
<div class="line">    vkDestroyDevice(g_AppData.m_Device, NULL);</div>
<div class="line">    pVkDestroyDebugReportCallbackEXT(g_AppData.m_Instance, g_AppData.m_DebugCallbackEXT, NULL);</div>
<div class="line">    vkDestroySurfaceKHR(g_AppData.m_Instance, g_AppData.m_SurfaceKhr, NULL);</div>
<div class="line"></div>
<div class="line">    vkDestroyInstance(g_AppData.m_Instance, NULL);</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keyword">namespace</span></div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">void</span>* Allocate(<span class="keywordtype">size_t</span> size, <span class="keywordtype">size_t</span> alignment, <span class="keywordtype">void</span>*)</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">return</span> aligned_alloc(alignment, <a name="a20"></a><a class="code" href="namespacenn_1_1util.html#a20f6772d3ae70168e07e0f39d416d72e">nn::util::align_up</a>(size, alignment));</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordtype">void</span> <a class="code" href="namespacenns_1_1g3d.html#ac23ca3ba1949451319eb3bbaec93a93d">Free</a>(<span class="keywordtype">void</span>* addr, <span class="keywordtype">void</span>*)</div>
<div class="line">    {</div>
<div class="line">        free(addr);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordtype">void</span>* Reallocate(<span class="keywordtype">void</span>* addr, <span class="keywordtype">size_t</span> newSize, <span class="keywordtype">void</span>*)</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">return</span> realloc(addr, newSize);</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">}; <span class="comment">// end anonymous namespace</span></div>
<div class="line"></div>
<div class="line"><span class="keyword">extern</span> <span class="stringliteral">&quot;C&quot;</span> <span class="keywordtype">void</span> <a name="a21"></a><a class="code" href="_socket_resolver_8cpp.html#ae79180f8ae90e05743b47a872f305a52">nnMain</a>()</div>
<div class="line">{</div>
<div class="line">    <a class="code" href="classnn_1_1_result.html">nn::Result</a> result;</div>
<div class="line"></div>
<div class="line">    <a name="a22"></a><a class="code" href="namespacenv.html#a7d85cfdd1bae1b635cc66b8d58077688">nv::SetGraphicsAllocator</a>(Allocate, Free, Reallocate, NULL);</div>
<div class="line"></div>
<div class="line">    <a name="a23"></a><a class="code" href="namespacenv.html#a5ef00427dfc2493551bb66b37731bb35">nv::SetGraphicsDevtoolsAllocator</a>(Allocate, Free, Reallocate, NULL);</div>
<div class="line"></div>
<div class="line">    <a name="a24"></a><a class="code" href="namespacenv.html#aacadc57952b370f2286108f5835ce726">nv::InitializeGraphics</a>(malloc(g_GraphicsSystemMemorySize), g_GraphicsSystemMemorySize);</div>
<div class="line"></div>
<div class="line">    <span class="keywordtype">size_t</span> cacheSize = 0;</div>
<div class="line">    result = <a name="a25"></a><a class="code" href="namespacenn_1_1fs.html#a5df6e3385c795a5bd046790ef7f17f2d">nn::fs::QueryMountRomCacheSize</a>(&amp;cacheSize);</div>
<div class="line">    <a class="code" href="nn___assert_8h.html#ade59d1d911907a16c0241f8fe3b31542">NN_ASSERT</a>(result.<a class="code" href="classnn_1_1_result.html#a80792d8ec8b6b9e9b34025100baa67ec">IsSuccess</a>());</div>
<div class="line"></div>
<div class="line">    <span class="keywordtype">void</span>* mountRomCacheBuffer = malloc(cacheSize);</div>
<div class="line">    <a name="a26"></a><a class="code" href="nn___assert_8h.html#a0473ebccccc250efd6100a9bbfec406b">NN_ASSERT_NOT_NULL</a>(mountRomCacheBuffer);</div>
<div class="line"></div>
<div class="line">    result = <a name="a27"></a><a class="code" href="namespacenn_1_1fs.html#a2e453fe1fbf8f818dc45bbd2897105cd">nn::fs::MountRom</a>(<span class="stringliteral">&quot;Contents&quot;</span>, mountRomCacheBuffer, cacheSize);</div>
<div class="line">    <a class="code" href="nn___assert_8h.html#ade59d1d911907a16c0241f8fe3b31542">NN_ASSERT</a>(result.<a class="code" href="classnn_1_1_result.html#a80792d8ec8b6b9e9b34025100baa67ec">IsSuccess</a>());</div>
<div class="line"></div>
<div class="line">    <a name="a28"></a><a class="code" href="namespacenn_1_1vi.html#acecc11f3b92d6d1e0c6b5d056d4b05fd">nn::vi::Initialize</a>();</div>
<div class="line">    InitializeLayer();</div>
<div class="line"></div>
<div class="line">    <span class="keywordtype">bool</span> success = InitializeVulkan();</div>
<div class="line">    <a class="code" href="nn___assert_8h.html#ade59d1d911907a16c0241f8fe3b31542">NN_ASSERT</a>(success, <span class="stringliteral">&quot;InitializeVulkan Failed!\n&quot;</span>);</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Initialize input for user exit */</span></div>
<div class="line">    <a name="a29"></a><a class="code" href="namespacenn_1_1hid.html#a1d814d34915eac7cfc9b9f92ac3ccc40">nn::hid::InitializeTouchScreen</a>();</div>
<div class="line">    <a name="_a30"></a><a class="code" href="structnn_1_1hid_1_1_touch_screen_state.html">nn::hid::TouchScreenState&lt;1&gt;</a> touchScreenState;</div>
<div class="line">    <span class="keywordtype">int</span> touchCount = 0;</div>
<div class="line"></div>
<div class="line">    <a class="code" href="nn___log_8h.html#aa8c0b58247a2078e37f2fe0974b98a61">NN_LOG</a>(<span class="stringliteral">&quot;----------------------------------------------------------------------------------------\n&quot;</span>);</div>
<div class="line">    <a class="code" href="nn___log_8h.html#aa8c0b58247a2078e37f2fe0974b98a61">NN_LOG</a>(<span class="stringliteral">&quot;Clicking the window on Windows or touching the Touch Screen on NX will exit the program.\n&quot;</span>);</div>
<div class="line">    <a class="code" href="nn___log_8h.html#aa8c0b58247a2078e37f2fe0974b98a61">NN_LOG</a>(<span class="stringliteral">&quot;----------------------------------------------------------------------------------------\n&quot;</span>);</div>
<div class="line">    <span class="keywordflow">while</span> (1)</div>
<div class="line">    {</div>
<div class="line">        UpdateScene();</div>
<div class="line">        DrawScene();</div>
<div class="line"></div>
<div class="line">        touchCount = <a name="a31"></a><a class="code" href="namespacenn_1_1hid.html#a25c328faac65ac47bec4b4cf6a2e1422">nn::hid::GetTouchScreenStates</a>(&amp;touchScreenState, 1);</div>
<div class="line">        <span class="keywordflow">if</span> (touchScreenState.<a name="a32"></a><a class="code" href="structnn_1_1hid_1_1_touch_screen_state.html#ac4b8fc65076b1bd75607fb477ec9814b">count</a> &gt; 0)</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    FinalizeVulkan();</div>
<div class="line"></div>
<div class="line">    <a name="a33"></a><a class="code" href="namespacenn_1_1vi.html#a76acdc780c2ad611533182993df1cebe">nn::vi::DestroyLayer</a>(g_pLayer);</div>
<div class="line">    <a name="a34"></a><a class="code" href="namespacenn_1_1vi.html#a68ddf473ecdaf1c52996a2f7fad2ef61">nn::vi::CloseDisplay</a>(g_pDisplay);</div>
<div class="line">    <a name="a35"></a><a class="code" href="namespacenn_1_1vi.html#a7451676fd7f7b48369ff4c01a1fa91dd">nn::vi::Finalize</a>();</div>
<div class="line">}</div>
</div><!-- fragment --> </div><!-- contents -->
<!-- HTML footer for doxygen 1.8.8-->
<!-- start footer part -->
</body>
</html>
