<!-- HTML header for doxygen 1.8.8-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.10"/>
<title>NintendoSDK API Reference: MovieDecoderPlayer.cpp</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="openclose.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="stylesheet.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">NintendoSDK API Reference
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- 構築: Doxygen 1.8.10 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'検索');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>総合概要</span></a></li>
      <li><a href="pages.html"><span>諸情報</span></a></li>
      <li><a href="modules.html"><span>モジュール</span></a></li>
      <li><a href="namespaces.html"><span>名前空間</span></a></li>
      <li><a href="annotated.html"><span>クラス</span></a></li>
      <li><a href="files.html"><span>ファイル</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="検索" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">MovieDecoderPlayer.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<p>ソースコードの説明は、<a class="el" href="_page_sample_movie_decoder_player.html">MovieDecoderPlayer</a> および <a class="el" href="_movie_decoder_player_8cpp.html" title="movie API による動画再生サンプル ">MovieDecoderPlayer.cpp</a> を参照してください。</p>
<div class="fragment"><div class="line"><span class="comment">/*--------------------------------------------------------------------------------*</span></div>
<div class="line"><span class="comment">  Copyright (C)Nintendo All rights reserved.</span></div>
<div class="line"><span class="comment"></span></div>
<div class="line"><span class="comment">  These coded instructions, statements, and computer programs contain proprietary</span></div>
<div class="line"><span class="comment">  information of Nintendo and/or its licensed developers and are protected by</span></div>
<div class="line"><span class="comment">  national and international copyright laws. They may not be disclosed to third</span></div>
<div class="line"><span class="comment">  parties or copied or duplicated in any form, in whole or in part, without the</span></div>
<div class="line"><span class="comment">  prior written consent of Nintendo.</span></div>
<div class="line"><span class="comment"></span></div>
<div class="line"><span class="comment">  The content herein is highly confidential and should be handled accordingly.</span></div>
<div class="line"><span class="comment"> *--------------------------------------------------------------------------------*/</span></div>
<div class="line"><span class="preprocessor">#include &quot;MovieDecoderPlayer.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="_utils_8h.html">movie/Utils.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="_common_8h.html">movie/Common.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="_status_8h.html">movie/Status.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;nn/nn_SdkLog.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="init_8h.html">nn/init.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="lmem___exp_heap_8h.html">nn/lmem/lmem_ExpHeap.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="nn___abort_8h.html">nn/nn_Abort.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="nn___assert_8h.html">nn/nn_Assert.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="nn___log_8h.html">nn/nn_Log.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="fs___sd_card_for_debug_8h.html">nn/fs/fs_SdCardForDebug.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;string&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;cinttypes&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;stddef.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;memory&gt;</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="mem___standard_allocator_8h.html">nn/mem/mem_StandardAllocator.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="nv___memory_management_8h.html">nv/nv_MemoryManagement.h</a>&gt;</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#include &quot;ByteStreamReader.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &lt;nns/mm.h&gt;</span></div>
<div class="line"></div>
<div class="line"><span class="keyword">const</span> <span class="keywordtype">int</span> FsHeapSize = 512 * 1024;</div>
<div class="line"><span class="keyword">const</span> <span class="keywordtype">int</span> mmHeapSize = 512 &lt;&lt; 20;</div>
<div class="line"></div>
<div class="line">uint8_t                     g_FsHeapBuffer[FsHeapSize];</div>
<div class="line"><a class="code" href="namespacenn_1_1lmem.html#ab893a05f9834a881447ea604c7d60400">nn::lmem::HeapHandle</a>        g_FsHeap;</div>
<div class="line"><span class="keywordtype">char</span>                        g_mmHeapBuffer[mmHeapSize];</div>
<div class="line"></div>
<div class="line"><span class="keyword">const</span> <span class="keywordtype">size_t</span>  g_GraphicsSystemMemorySize = 8 * 1024 * 1024;</div>
<div class="line">uint8_t g_GraphicsHeap[ g_GraphicsSystemMemorySize ] __attribute__(( aligned(4096) ));</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">bool</span> g_TrackMemoryAllocation = <span class="keyword">false</span>;</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> FsInitHeap()</div>
<div class="line">{</div>
<div class="line">    g_FsHeap = <a name="a0"></a><a class="code" href="namespacenn_1_1lmem.html#a3d46d370c3b53aed4a127962761ed0fc">nn::lmem::CreateExpHeap</a>(g_FsHeapBuffer, FsHeapSize, <a name="a1"></a><a class="code" href="namespacenn_1_1lmem.html#a5200a4ef197dbd700f31a3111eacf5b2a74d1c66b53b6339b870393957e6d1a83">nn::lmem::CreationOption_DebugFill</a>);</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span>* FsAllocate(<span class="keywordtype">size_t</span> size)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">return</span> <a name="a2"></a><a class="code" href="namespacenn_1_1lmem.html#a96055cfc77bfd3eac47da134a3746aa9">nn::lmem::AllocateFromExpHeap</a>(g_FsHeap, size);</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> FsDeallocate(<span class="keywordtype">void</span>* p, <span class="keywordtype">size_t</span> size)</div>
<div class="line">{</div>
<div class="line">    <a name="a3"></a><a class="code" href="nn___macro_8h.html#af2d1673769927c5eae977d8dde3ce106">NN_UNUSED</a>(size);</div>
<div class="line">    <span class="keywordflow">return</span> <a name="a4"></a><a class="code" href="namespacenn_1_1lmem.html#aa8b756491ff15ef5937719943d7146a5">nn::lmem::FreeToExpHeap</a>(g_FsHeap, p);</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keyword">static</span> MemoryTracker &amp;MovieMemoryTracker()</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">static</span> MemoryTracker g_MovieMemoryTracker;</div>
<div class="line">    <span class="keywordflow">return</span> g_MovieMemoryTracker;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keyword">static</span> MemoryTracker &amp;CoreMemoryTracker()</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">static</span> MemoryTracker g_CoreMemoryTracker;</div>
<div class="line">    <span class="keywordflow">return</span> g_CoreMemoryTracker;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keyword">static</span> MemoryTracker &amp;MallocMemoryTracker()</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">static</span> MemoryTracker g_MallocMemoryTracker;</div>
<div class="line">    <span class="keywordflow">return</span> g_MallocMemoryTracker;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keyword">static</span> MemoryTracker &amp;NewMemoryTracker()</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">static</span> MemoryTracker g_NewMemoryTracker;</div>
<div class="line">    <span class="keywordflow">return</span> g_NewMemoryTracker;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keyword">static</span> <a name="_a5"></a><a class="code" href="classnn_1_1mem_1_1_standard_allocator.html">nn::mem::StandardAllocator</a> &amp;GlobalAllocator()</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">static</span> <a class="code" href="classnn_1_1mem_1_1_standard_allocator.html">nn::mem::StandardAllocator</a> g_MultimediaAllocator(g_mmHeapBuffer, <span class="keyword">sizeof</span>(g_mmHeapBuffer));</div>
<div class="line">    <span class="keywordflow">return</span> g_MultimediaAllocator;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span>* MovieAllocate(<span class="keywordtype">size_t</span> size, <span class="keywordtype">size_t</span> alignment, <span class="keywordtype">void</span> *userPtr)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">void</span> *address = GlobalAllocator().Allocate(size, alignment);</div>
<div class="line">    <span class="keyword">static</span> <span class="keywordtype">size_t</span> totalAllocatedSize = 0;</div>
<div class="line">    totalAllocatedSize += size;</div>
<div class="line">    <span class="keywordflow">if</span>( g_TrackMemoryAllocation )</div>
<div class="line">    {</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">char</span>* threadName = <a name="a6"></a><a class="code" href="namespacenn_1_1os.html#a2941b0122ed1f1af2d7007af285d83b5">::nn::os::GetThreadNamePointer</a>(::<a name="a7"></a><a class="code" href="namespacenn_1_1os.html#ad106866a5b13bc3d430104333966b479">nn::os::GetCurrentThread</a>());</div>
<div class="line">        <span class="keyword">static_cast&lt;</span>MemoryTracker*<span class="keyword">&gt;</span>( userPtr )-&gt;Track(address, size, threadName);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">return</span> address;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> MovieDeallocate(<span class="keywordtype">void</span> *address, <span class="keywordtype">void</span> *userPtr)</div>
<div class="line">{</div>
<div class="line">    GlobalAllocator().Free(address);</div>
<div class="line">    <span class="keywordflow">if</span>( g_TrackMemoryAllocation )</div>
<div class="line">    {</div>
<div class="line">        <span class="keyword">static_cast&lt;</span>MemoryTracker*<span class="keyword">&gt;</span>( userPtr )-&gt;Untrack(address);</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> *MovieReallocate(<span class="keywordtype">void</span>* address, <span class="keywordtype">size_t</span> newSize, <span class="keywordtype">void</span> *userPtr)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">if</span>( g_TrackMemoryAllocation )</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">if</span>( address != <span class="keyword">nullptr</span>)</div>
<div class="line">        {</div>
<div class="line">            <span class="keyword">static_cast&lt;</span> MemoryTracker* <span class="keyword">&gt;</span>( userPtr )-&gt;Untrack(address);</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordtype">void</span> *memory = GlobalAllocator().Reallocate(address, newSize);</div>
<div class="line">    <span class="keywordflow">if</span>( g_TrackMemoryAllocation )</div>
<div class="line">    {</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">char</span>* threadName = <a class="code" href="namespacenn_1_1os.html#a2941b0122ed1f1af2d7007af285d83b5">::nn::os::GetThreadNamePointer</a>(::<a class="code" href="namespacenn_1_1os.html#ad106866a5b13bc3d430104333966b479">nn::os::GetCurrentThread</a>());</div>
<div class="line">        <span class="keyword">static_cast&lt;</span>MemoryTracker*<span class="keyword">&gt;</span>( userPtr )-&gt;Track(memory, newSize, threadName);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">return</span> memory;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keyword">extern</span> <span class="stringliteral">&quot;C&quot;</span> <span class="keywordtype">void</span>* malloc(<span class="keywordtype">size_t</span> size)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">return</span> MovieAllocate(size, 8, &amp;MallocMemoryTracker());</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keyword">extern</span> <span class="stringliteral">&quot;C&quot;</span> <span class="keywordtype">void</span> free(<span class="keywordtype">void</span>* address)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">if</span>( address != <span class="keyword">nullptr</span> )</div>
<div class="line">        MovieDeallocate(address, &amp;MallocMemoryTracker());</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keyword">extern</span> <span class="stringliteral">&quot;C&quot;</span> <span class="keywordtype">void</span>* calloc(<span class="keywordtype">size_t</span> num, <span class="keywordtype">size_t</span> size)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">size_t</span> sum = num * size;</div>
<div class="line">    <span class="keywordtype">void</span>* address = malloc(sum);</div>
<div class="line">    <span class="keywordflow">if</span>( address != <span class="keyword">nullptr</span> )</div>
<div class="line">        ::std::memset(address, 0, sum);</div>
<div class="line">    <span class="keywordflow">return</span> address;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keyword">extern</span> <span class="stringliteral">&quot;C&quot;</span> <span class="keywordtype">void</span>* realloc(<span class="keywordtype">void</span>* address, <span class="keywordtype">size_t</span> newSize)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">return</span> MovieReallocate(address, newSize, &amp;MallocMemoryTracker());</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keyword">extern</span> <span class="stringliteral">&quot;C&quot;</span> <span class="keywordtype">void</span>* aligned_alloc(<span class="keywordtype">size_t</span> alignment, <span class="keywordtype">size_t</span> size)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">return</span> MovieAllocate(size, alignment, &amp;MallocMemoryTracker());</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span>* <span class="keyword">operator</span> <span class="keyword">new</span>( ::std::size_t size, const ::std::nothrow_t&amp; ) <span class="keywordflow">throw</span>( )</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">return</span> MovieAllocate(static_cast&lt;int&gt;( size ), 8, &amp;NewMemoryTracker());</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span>* <span class="keyword">operator</span> <span class="keyword">new</span>[](::std::size_t size, const ::std::nothrow_t&amp;) <span class="keywordflow">throw</span>( )</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">return</span> <span class="keyword">operator</span> <span class="keyword">new</span>( size, ::std::nothrow_t() );</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span>* <span class="keyword">operator</span> <span class="keyword">new</span>( ::std::size_t size ) <span class="keywordflow">throw</span>( ::std::bad_alloc )</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">return</span> <span class="keyword">operator</span> <span class="keyword">new</span>( size, ::std::nothrow_t() );</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span>* <span class="keyword">operator</span> <span class="keyword">new</span>[](::std::size_t size) <span class="keywordflow">throw</span>( ::std::bad_alloc )</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">return</span> <span class="keyword">operator</span> <span class="keyword">new</span>( size, ::std::nothrow_t() );</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> <span class="keyword">operator</span> <span class="keyword">delete</span>( <span class="keywordtype">void</span>* address ) <span class="keywordflow">throw</span>( )</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">if</span>( address != <span class="keyword">nullptr</span> )</div>
<div class="line">        MovieDeallocate(address, &amp;NewMemoryTracker());</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> <span class="keyword">operator</span> <span class="keyword">delete</span>[](<span class="keywordtype">void</span>* address) <span class="keywordflow">throw</span>( )</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">operator</span> <span class="keyword">delete</span>( address );</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="comment">/* Process startup setup */</span></div>
<div class="line"><span class="keyword">extern</span> <span class="stringliteral">&quot;C&quot;</span> <span class="keywordtype">void</span> <a name="a8"></a><a class="code" href="_movie_decoder_player_8cpp.html#a3be3d0349dea9f2f48dd1994be86dafc">nninitStartup</a>()</div>
<div class="line">{</div>
<div class="line">    FsInitHeap();</div>
<div class="line">    <a name="a9"></a><a class="code" href="namespacenn_1_1fs.html#ac021c163ba94a44a2b53cb848c462930">nn::fs::SetAllocator</a>(FsAllocate, FsDeallocate);</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="comment">/* MovieDecoderPlayer Player Usage */</span></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> Usage()</div>
<div class="line">{</div>
<div class="line">    NN_SDK_LOG( <span class="stringliteral">&quot;\n MovieDecoderPlayer ::Invalid options, refer Readme.MovieDecoderPlayer.txt \n&quot;</span>);</div>
<div class="line">}</div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> PrintMemoryUsageStats()</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">if</span>( g_TrackMemoryAllocation )</div>
<div class="line">    {</div>
<div class="line">        <a name="a10"></a><a class="code" href="nn___log_8h.html#aa8c0b58247a2078e37f2fe0974b98a61">NN_LOG</a>(<span class="stringliteral">&quot;\n [Movie] memory allocator statistics \n&quot;</span>);</div>
<div class="line">        MovieMemoryTracker().OutputUsage();</div>
<div class="line">        <a class="code" href="nn___log_8h.html#aa8c0b58247a2078e37f2fe0974b98a61">NN_LOG</a>(<span class="stringliteral">&quot;\n [Core] memory allocator statistics \n&quot;</span>);</div>
<div class="line">        CoreMemoryTracker().OutputUsage();</div>
<div class="line">        <a class="code" href="nn___log_8h.html#aa8c0b58247a2078e37f2fe0974b98a61">NN_LOG</a>(<span class="stringliteral">&quot;\n [Malloc] memory allocator statistics \n&quot;</span>);</div>
<div class="line">        MallocMemoryTracker().OutputUsage();</div>
<div class="line">        <a class="code" href="nn___log_8h.html#aa8c0b58247a2078e37f2fe0974b98a61">NN_LOG</a>(<span class="stringliteral">&quot;\n [New] memory allocator statistics \n&quot;</span>);</div>
<div class="line">        NewMemoryTracker().OutputUsage();</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="comment">/* Process main entry */</span></div>
<div class="line"><span class="keyword">extern</span> <span class="stringliteral">&quot;C&quot;</span> <span class="keywordtype">void</span> <a name="a11"></a><a class="code" href="_socket_resolver_8cpp.html#ae79180f8ae90e05743b47a872f305a52">nnMain</a>()</div>
<div class="line">{</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordtype">int</span> argc = <a name="a12"></a><a class="code" href="namespacenn_1_1os.html#acf2fa6b7b7074a51d0b2de1664cc7bb5">nn::os::GetHostArgc</a>();</div>
<div class="line">        <span class="keywordtype">char</span>** argv = <a name="a13"></a><a class="code" href="namespacenn_1_1os.html#abd77e6bf19be140867869cc759fa492c">nn::os::GetHostArgv</a>();</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Set allocator callback functions */</span></div>
<div class="line">        <a name="a14"></a><a class="code" href="namespacemovie.html#a1e3325e363470d39e3732a11bfaac62e">movie::SetAllocator</a>(MovieAllocate, MovieDeallocate, MovieReallocate, &amp;MovieMemoryTracker());</div>
<div class="line">        <span class="comment">// Donate memory for graphics driver to work in</span></div>
<div class="line">        <a name="a15"></a><a class="code" href="namespacenv.html#aacadc57952b370f2286108f5835ce726">nv::InitializeGraphics</a>(g_GraphicsHeap, g_GraphicsSystemMemorySize);</div>
<div class="line">        <a name="a16"></a><a class="code" href="namespacenv.html#a7d85cfdd1bae1b635cc66b8d58077688">nv::SetGraphicsAllocator</a>(MovieAllocate, MovieDeallocate, MovieReallocate, &amp;CoreMemoryTracker());</div>
<div class="line">        <a name="a17"></a><a class="code" href="namespacenv.html#a5ef00427dfc2493551bb66b37731bb35">nv::SetGraphicsDevtoolsAllocator</a>(MovieAllocate, MovieDeallocate, MovieReallocate, &amp;CoreMemoryTracker());</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span>( argc &lt;= 1 )</div>
<div class="line">        {</div>
<div class="line">            Usage();</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line">        int32_t playbackAgingRepeatCount = 0;</div>
<div class="line">        <span class="keywordtype">bool</span> runPlaybackAgingTest = <span class="keyword">false</span>;</div>
<div class="line">        uint64_t coreMask = 0;</div>
<div class="line">        int32_t resetCount = 0;</div>
<div class="line">        <span class="keywordflow">do</span></div>
<div class="line">        {</div>
<div class="line">            <span class="keywordtype">bool</span> invalidOptions = <span class="keyword">false</span>;</div>
<div class="line">            <span class="keywordtype">bool</span> loopPlayback = <span class="keyword">false</span>;</div>
<div class="line">            StreamFormat streamFormat = StreamFormat::StreamFormat_Unknown;</div>
<div class="line">            <a class="code" href="namespacemovie.html#ab5ee2cf437465786112d30f8a80bb979">movie::ContainerType</a> container = <a name="a18"></a><a class="code" href="namespacemovie.html#ab5ee2cf437465786112d30f8a80bb979aef2591807cf17783b9908d9a9f1b05c9">movie::ContainerType_Unknown</a>;</div>
<div class="line">            <a class="code" href="namespacemovie.html#a3d945ea69005414e3972a5a6693ed37e">movie::DecoderMode</a> videoDecoderMode = <a name="a19"></a><a class="code" href="namespacemovie.html#a3d945ea69005414e3972a5a6693ed37ea4088c77447f4bd44941d54ca8a5fa385">movie::DecoderMode_NativeTexture</a>;</div>
<div class="line">            <a class="code" href="namespacemovie.html#a3d945ea69005414e3972a5a6693ed37e">movie::DecoderMode</a> audioDecoderMode = <a name="a20"></a><a class="code" href="namespacemovie.html#a3d945ea69005414e3972a5a6693ed37ea10fa5580cba06502c2a91c41be94592c">movie::DecoderMode_Cpu</a>;</div>
<div class="line">            <a class="code" href="namespacemovie.html#ac02fee064f0db5847a949db9245d1723">movie::DecoderOutputFormat</a> videoDecoderOutputFormat = <a name="a21"></a><a class="code" href="namespacemovie.html#ac02fee064f0db5847a949db9245d1723a1114af19ee8f9f7b2cdef345686d321e">movie::DecoderOutputFormat_VideoColorAbgr</a>;</div>
<div class="line">            <a class="code" href="namespacemovie.html#ac02fee064f0db5847a949db9245d1723">movie::DecoderOutputFormat</a> audioDecoderOutputFormat = <a name="a22"></a><a class="code" href="namespacemovie.html#ac02fee064f0db5847a949db9245d1723ab3f5760b55c01155fca3ec856858efcd">movie::DecoderOutputFormat_AudioPcm16</a>;</div>
<div class="line">            <span class="keywordflow">for</span>( <span class="keywordtype">int</span> options = 0; options &lt; argc; options++ )</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">if</span>( !strcmp(argv[ options ], <span class="stringliteral">&quot;-me&quot;</span>) )</div>
<div class="line">                {</div>
<div class="line">                    options++;</div>
<div class="line">                    invalidOptions = <span class="keyword">true</span>;</div>
<div class="line">                    <span class="keywordflow">if</span>( options &lt; argc )</div>
<div class="line">                    {</div>
<div class="line">                        <span class="keywordflow">if</span>( ( !strcmp(argv[ options ], <span class="stringliteral">&quot;mp4&quot;</span>) ) || ( !strcmp(argv[ options ], <span class="stringliteral">&quot;m4a&quot;</span>) ) )</div>
<div class="line">                        {</div>
<div class="line">                            container = <a name="a23"></a><a class="code" href="namespacemovie.html#ab5ee2cf437465786112d30f8a80bb979a97b6a5b72b5297c1de0c7828cd8ff719">movie::ContainerType_Mpeg4</a>;</div>
<div class="line">                            invalidOptions = <span class="keyword">false</span>;</div>
<div class="line">                        }</div>
<div class="line">                        <span class="keywordflow">else</span> <span class="keywordflow">if</span>( ( !strcmp(argv[ options ], <span class="stringliteral">&quot;webm&quot;</span>) ) )</div>
<div class="line">                        {</div>
<div class="line">                            container = <a name="a24"></a><a class="code" href="namespacemovie.html#ab5ee2cf437465786112d30f8a80bb979a55ab128351682dc87f8e1227f4cca22d">movie::ContainerType_WebM</a>;</div>
<div class="line">                            invalidOptions = <span class="keyword">false</span>;</div>
<div class="line">                        }</div>
<div class="line">                        <span class="keywordflow">else</span> <span class="keywordflow">if</span>( ( !strcmp(argv[ options ], <span class="stringliteral">&quot;mkv&quot;</span>) ) )</div>
<div class="line">                        {</div>
<div class="line">                            container = <a name="a25"></a><a class="code" href="namespacemovie.html#ab5ee2cf437465786112d30f8a80bb979a28f2687be45cc1a08b51ca32a2200e7b">movie::ContainerType_Matroska</a>;</div>
<div class="line">                            invalidOptions = <span class="keyword">false</span>;</div>
<div class="line">                        }</div>
<div class="line">                        <span class="keywordflow">else</span> <span class="keywordflow">if</span>( ( !strcmp(argv[ options ], <span class="stringliteral">&quot;ogg&quot;</span>) ) )</div>
<div class="line">                        {</div>
<div class="line">                            container = movie::ContainerType_Ogg;</div>
<div class="line">                            invalidOptions = <span class="keyword">false</span>;</div>
<div class="line">                        }</div>
<div class="line">                        <span class="keywordflow">else</span> <span class="keywordflow">if</span>( ( !strcmp(argv[ options ], <span class="stringliteral">&quot;ivf&quot;</span>) ) )</div>
<div class="line">                        {</div>
<div class="line">                            streamFormat = StreamFormat_ivf;</div>
<div class="line">                            invalidOptions = <span class="keyword">false</span>;</div>
<div class="line">                        }</div>
<div class="line">                        <span class="keywordflow">else</span> <span class="keywordflow">if</span>( ( !strcmp(argv[ options ], <span class="stringliteral">&quot;h264&quot;</span>) ) )</div>
<div class="line">                        {</div>
<div class="line">                            streamFormat = StreamFormat_h264;</div>
<div class="line">                            invalidOptions = <span class="keyword">false</span>;</div>
<div class="line">                        }</div>
<div class="line">                        <span class="keywordflow">else</span></div>
<div class="line">                            <span class="keywordflow">break</span>;</div>
<div class="line">                    }</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">else</span> <span class="keywordflow">if</span>( !strcmp(argv[ options ], <span class="stringliteral">&quot;-l&quot;</span>) )</div>
<div class="line">                {</div>
<div class="line">                    options++;</div>
<div class="line">                    invalidOptions = <span class="keyword">true</span>;</div>
<div class="line">                    <span class="keywordflow">if</span>( options &lt; argc )</div>
<div class="line">                    {</div>
<div class="line">                        <span class="keywordflow">if</span>( ( !strcmp(argv[ options ], <span class="stringliteral">&quot;0&quot;</span>) ) || ( !strcmp(argv[ options ], <span class="stringliteral">&quot;1&quot;</span>) ) )</div>
<div class="line">                        {</div>
<div class="line">                            loopPlayback = atoi(argv[ options ]);</div>
<div class="line">                            invalidOptions = <span class="keyword">false</span>;</div>
<div class="line">                        }</div>
<div class="line">                        <span class="keywordflow">else</span></div>
<div class="line">                            <span class="keywordflow">break</span>;</div>
<div class="line">                    }</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">else</span> <span class="keywordflow">if</span>( !strcmp(argv[ options ], <span class="stringliteral">&quot;-aging&quot;</span>) )</div>
<div class="line">                {</div>
<div class="line">                    options++;</div>
<div class="line">                    invalidOptions = <span class="keyword">true</span>;</div>
<div class="line">                    <span class="keywordflow">if</span>( options &lt; argc )</div>
<div class="line">                    {</div>
<div class="line">                        <span class="keywordflow">if</span>( ( !strcmp(argv[ options ], <span class="stringliteral">&quot;0&quot;</span>) ) || ( !strcmp(argv[ options ], <span class="stringliteral">&quot;1&quot;</span>) ) )</div>
<div class="line">                        {</div>
<div class="line">                            runPlaybackAgingTest = atoi(argv[ options ]);</div>
<div class="line">                            invalidOptions = <span class="keyword">false</span>;</div>
<div class="line">                        }</div>
<div class="line">                        <span class="keywordflow">else</span></div>
<div class="line">                            <span class="keywordflow">break</span>;</div>
<div class="line">                    }</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">else</span> <span class="keywordflow">if</span>( !strcmp(argv[ options ], <span class="stringliteral">&quot;-core&quot;</span>) )</div>
<div class="line">                {</div>
<div class="line">                    options++;</div>
<div class="line">                    invalidOptions = <span class="keyword">true</span>;</div>
<div class="line">                    <span class="keywordflow">if</span>( options &lt; argc )</div>
<div class="line">                    {</div>
<div class="line">                        <span class="keywordflow">if</span>( ( !strcmp(argv[ options ], <span class="stringliteral">&quot;1&quot;</span>) ) || ( !strcmp(argv[ options ], <span class="stringliteral">&quot;2&quot;</span>) ) || ( !strcmp(argv[ options ], <span class="stringliteral">&quot;4&quot;</span>) ) )</div>
<div class="line">                        {</div>
<div class="line">                            coreMask = atoi(argv[ options ]);</div>
<div class="line">                            invalidOptions = <span class="keyword">false</span>;</div>
<div class="line">                        }</div>
<div class="line">                        <span class="keywordflow">else</span></div>
<div class="line">                            <span class="keywordflow">break</span>;</div>
<div class="line">                    }</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">else</span> <span class="keywordflow">if</span>( !strcmp(argv[ options ], <span class="stringliteral">&quot;-reset&quot;</span>) )</div>
<div class="line">                {</div>
<div class="line">                    options++;</div>
<div class="line">                    invalidOptions = <span class="keyword">true</span>;</div>
<div class="line">                    <span class="keywordflow">if</span>( options &lt; argc )</div>
<div class="line">                    {</div>
<div class="line">                        resetCount = atoi(argv[ options ]);</div>
<div class="line">                        invalidOptions = <span class="keyword">false</span>;</div>
<div class="line">                    }</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">else</span> <span class="keywordflow">if</span>( !strcmp(argv[ options ], <span class="stringliteral">&quot;-t&quot;</span>) )</div>
<div class="line">                {</div>
<div class="line">                    options++;</div>
<div class="line">                    invalidOptions = <span class="keyword">true</span>;</div>
<div class="line">                    <span class="keywordflow">if</span>( ( !strcmp(argv[ options ], <span class="stringliteral">&quot;0&quot;</span>) ) || ( !strcmp(argv[ options ], <span class="stringliteral">&quot;1&quot;</span>) ) )</div>
<div class="line">                    {</div>
<div class="line">                        g_TrackMemoryAllocation = atoi(argv[ options ]);</div>
<div class="line">                        invalidOptions = <span class="keyword">false</span>;</div>
<div class="line">                    }</div>
<div class="line">                    <span class="keywordflow">else</span></div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">else</span> <span class="keywordflow">if</span>( !strcmp(argv[ options ], <span class="stringliteral">&quot;-dm&quot;</span>) )</div>
<div class="line">                {</div>
<div class="line">                    options++;</div>
<div class="line">                    invalidOptions = <span class="keyword">true</span>;</div>
<div class="line">                    <span class="keywordflow">if</span>( ( !strcmp(argv[ options ], <span class="stringliteral">&quot;1&quot;</span>) ) || ( !strcmp(argv[ options ], <span class="stringliteral">&quot;2&quot;</span>) ) )</div>
<div class="line">                    {</div>
<div class="line">                        <span class="keywordflow">if</span>( 1 == atoi(argv[ options ]) )</div>
<div class="line">                        {</div>
<div class="line">                            videoDecoderMode = <a class="code" href="namespacemovie.html#a3d945ea69005414e3972a5a6693ed37ea10fa5580cba06502c2a91c41be94592c">movie::DecoderMode_Cpu</a>;</div>
<div class="line">                            videoDecoderOutputFormat = <a name="a26"></a><a class="code" href="namespacemovie.html#ac02fee064f0db5847a949db9245d1723a6a27761a9c75c5e8f7f27b4f9e9305c3">movie::DecoderOutputFormat_VideoColorNv12</a>;</div>
<div class="line">                        }</div>
<div class="line">                        invalidOptions = <span class="keyword">false</span>;</div>
<div class="line">                    }</div>
<div class="line">                    <span class="keywordflow">else</span></div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">if</span>( ( invalidOptions == <span class="keyword">true</span> )</div>
<div class="line">                || ( ( streamFormat == StreamFormat::StreamFormat_Unknown ) &amp;&amp; ( container == <a class="code" href="namespacemovie.html#ab5ee2cf437465786112d30f8a80bb979aef2591807cf17783b9908d9a9f1b05c9">movie::ContainerType::ContainerType_Unknown</a> ) ) )</div>
<div class="line">            {</div>
<div class="line">                Usage();</div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">            }</div>
<div class="line"></div>
<div class="line">            <span class="keywordflow">if</span>( loopPlayback == <span class="keyword">true</span> )</div>
<div class="line">                runPlaybackAgingTest = <span class="keyword">false</span>;</div>
<div class="line">            <span class="keywordtype">bool</span> doesMediaFileExists = <span class="keyword">false</span>;</div>
<div class="line">            <span class="keywordtype">bool</span> sdcardMounted = <span class="keyword">false</span>;</div>
<div class="line">            std::string path = argv[ 1 ];</div>
<div class="line">            <span class="keywordflow">if</span>( <span class="keyword">false</span> == path.empty() )</div>
<div class="line">            {</div>
<div class="line">                std::string delimiter = <span class="stringliteral">&quot;:&quot;</span>;</div>
<div class="line">                std::string token = path.substr(0, path.find(delimiter));</div>
<div class="line">                <span class="keywordflow">if</span>( token == <span class="stringliteral">&quot;sdcard&quot;</span> )</div>
<div class="line">                {</div>
<div class="line">                    <a name="_a27"></a><a class="code" href="classnn_1_1_result.html">nn::Result</a> resultSdcardMount = <a name="a28"></a><a class="code" href="namespacenn_1_1fs.html#a196ef874060b922b93756ddff212fefa">nn::fs::MountSdCardForDebug</a>(<span class="stringliteral">&quot;sdcard&quot;</span>);</div>
<div class="line">                    <span class="keywordflow">if</span>( resultSdcardMount.<a name="a29"></a><a class="code" href="classnn_1_1_result.html#a5d119d9cb4918fc3cd09215437b91c13">IsFailure</a>() )</div>
<div class="line">                    {</div>
<div class="line">                        NN_SDK_LOG(<span class="stringliteral">&quot;\n nn::fs::SD card mount failure. Module:%d, Description:%d\n&quot;</span>,</div>
<div class="line">                            resultSdcardMount.<a name="a30"></a><a class="code" href="classnn_1_1_result.html#a77240fc1cc27829bc388d34c97357693">GetModule</a>(),</div>
<div class="line">                            resultSdcardMount.<a name="a31"></a><a class="code" href="classnn_1_1_result.html#a800c5bb9b58c3f2b76223ea43904120b">GetDescription</a>());</div>
<div class="line">                        <span class="keywordflow">return</span>;</div>
<div class="line">                    }</div>
<div class="line">                    sdcardMounted = <span class="keyword">true</span>;</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">else</span></div>
<div class="line">                {</div>
<div class="line">                    <a class="code" href="classnn_1_1_result.html">nn::Result</a> resultHostMount = <a name="a32"></a><a class="code" href="namespacenn_1_1fs.html#a2ea39d2487ac28bc767cd699eeeebe11">nn::fs::MountHostRoot</a>();</div>
<div class="line">                    <span class="keywordflow">if</span>( resultHostMount.<a class="code" href="classnn_1_1_result.html#a5d119d9cb4918fc3cd09215437b91c13">IsFailure</a>() )</div>
<div class="line">                    {</div>
<div class="line">                        NN_SDK_LOG(<span class="stringliteral">&quot;\n nn::fs::Host root mount failure. Module:%d, Description:%d\n&quot;</span>,</div>
<div class="line">                            resultHostMount.<a class="code" href="classnn_1_1_result.html#a77240fc1cc27829bc388d34c97357693">GetModule</a>(),</div>
<div class="line">                            resultHostMount.<a class="code" href="classnn_1_1_result.html#a800c5bb9b58c3f2b76223ea43904120b">GetDescription</a>());</div>
<div class="line">                        <span class="keywordflow">return</span>;</div>
<div class="line">                    }</div>
<div class="line">                }</div>
<div class="line">                <a name="_a33"></a><a class="code" href="structnn_1_1fs_1_1_file_handle.html">nn::fs::FileHandle</a> fileHandle;</div>
<div class="line">                fileHandle.<a name="a34"></a>handle = NULL;</div>
<div class="line">                <a class="code" href="classnn_1_1_result.html">nn::Result</a> result = <a name="a35"></a><a class="code" href="namespacenn_1_1fs.html#a0f2b5b30657b1ffaf1dec49bfb36462b">nn::fs::OpenFile</a>(&amp;fileHandle, path.c_str(), <a name="a36"></a><a class="code" href="namespacenn_1_1fs.html#a4c97b79cce78a95c2333dbc9053b9393afde4472d2b455879cad02aade386ac0d">nn::fs::OpenMode_Read</a>);</div>
<div class="line">                <span class="keywordflow">if</span>( result.<a name="a37"></a><a class="code" href="classnn_1_1_result.html#a80792d8ec8b6b9e9b34025100baa67ec">IsSuccess</a>() )</div>
<div class="line">                {</div>
<div class="line">                    doesMediaFileExists = <span class="keyword">true</span>;</div>
<div class="line">                    <a name="a38"></a><a class="code" href="namespacenn_1_1fs.html#ac8bd9e828751bd4f953acfa765278f84">nn::fs::CloseFile</a>(fileHandle);</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">if</span>( doesMediaFileExists == <span class="keyword">false</span> )</div>
<div class="line">            {</div>
<div class="line">                NN_SDK_LOG(<span class="stringliteral">&quot;\n MovieDecoderPlayer:: Cannot open input [%s] file Terminating Application !\n&quot;</span>, path.c_str());</div>
<div class="line">                <span class="keywordflow">if</span>( sdcardMounted == <span class="keyword">true</span> )</div>
<div class="line">                    <a name="a39"></a><a class="code" href="namespacenn_1_1fs.html#ac8a95249afd4a87a55d319dfecb0466c">nn::fs::Unmount</a>(<span class="stringliteral">&quot;sdcard&quot;</span>);</div>
<div class="line">                <span class="keywordflow">else</span></div>
<div class="line">                    <a name="a40"></a><a class="code" href="namespacenn_1_1fs.html#ade5d6e6459dca7d8274564bcfc5de757">nn::fs::UnmountHostRoot</a>();</div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">            }</div>
<div class="line">            NN_SDK_LOG(<span class="stringliteral">&quot;\n MovieDecoderPlayer:: Input File Name : %s\n&quot;</span>, path.c_str());</div>
<div class="line">            <span class="keywordflow">if</span>( videoDecoderMode == <a class="code" href="namespacemovie.html#a3d945ea69005414e3972a5a6693ed37ea4088c77447f4bd44941d54ca8a5fa385">movie::DecoderMode_NativeTexture</a> )</div>
<div class="line">                <a class="code" href="nn___log_8h.html#aa8c0b58247a2078e37f2fe0974b98a61">NN_LOG</a>(<span class="stringliteral">&quot;\n Using [movie::DecoderMode_NativeTexture] mode for video decoder \n&quot;</span>);</div>
<div class="line">            <span class="keywordflow">else</span></div>
<div class="line">                <a class="code" href="nn___log_8h.html#aa8c0b58247a2078e37f2fe0974b98a61">NN_LOG</a>(<span class="stringliteral">&quot;\n Using [movie::DecoderMode_Cpu] mode for video decoder \n&quot;</span>);</div>
<div class="line">            <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5">movie::Status</a> movieStatus = <a name="a41"></a><a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5a578dbc51cacf7873a3e40667603e58be">movie::Status_Success</a>;</div>
<div class="line">            std::unique_ptr&lt;MovieDecoderPlayer&gt; movieDecoderPlayer { <span class="keyword">new</span> MovieDecoderPlayer{} };</div>
<div class="line">            <span class="keywordflow">if</span>( movieDecoderPlayer == <span class="keyword">nullptr</span> )</div>
<div class="line">            {</div>
<div class="line">                NN_SDK_LOG(<span class="stringliteral">&quot;\n Failed to create  MovieDecoderPlayer, Error : Status_OutOfMemory - Terminating Application ! \n&quot;</span>);</div>
<div class="line">                <span class="keywordflow">if</span>( sdcardMounted == <span class="keyword">true</span> )</div>
<div class="line">                    <a class="code" href="namespacenn_1_1fs.html#ac8a95249afd4a87a55d319dfecb0466c">nn::fs::Unmount</a>(<span class="stringliteral">&quot;sdcard&quot;</span>);</div>
<div class="line">                <span class="keywordflow">else</span></div>
<div class="line">                    <a class="code" href="namespacenn_1_1fs.html#ade5d6e6459dca7d8274564bcfc5de757">nn::fs::UnmountHostRoot</a>();</div>
<div class="line">                <a name="a42"></a><a class="code" href="namespacenv.html#a368247e862f5ffc59a38af42658d7b38">nv::FinalizeGraphics</a>();</div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">            }</div>
<div class="line">            movieDecoderPlayer-&gt;m_SdcardMounted = sdcardMounted;</div>
<div class="line">            movieStatus = movieDecoderPlayer-&gt;Initialize(coreMask);</div>
<div class="line">            <span class="keywordflow">if</span>( movieStatus != <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5a578dbc51cacf7873a3e40667603e58be">movie::Status_Success</a> )</div>
<div class="line">            {</div>
<div class="line">                NN_SDK_LOG(<span class="stringliteral">&quot;\n Failed to initialize  MovieDecoderPlayer, Error : 0x%x - Terminating Application ! \n&quot;</span>, movieStatus);</div>
<div class="line">                movieDecoderPlayer-&gt;HandleErrorExit();</div>
<div class="line">                movieDecoderPlayer.reset();</div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">            }</div>
<div class="line">            movieDecoderPlayer-&gt;m_LoopPlayback = loopPlayback;</div>
<div class="line">            <span class="comment">// Check for raw streams</span></div>
<div class="line">            <span class="keywordflow">if</span>( ( streamFormat == StreamFormat_ivf ) || ( streamFormat == StreamFormat_h264 ) )</div>
<div class="line">            {</div>
<div class="line">                movieDecoderPlayer-&gt;m_ByteStreamReader = <span class="keyword">new</span> ByteStreamReader();</div>
<div class="line">                <span class="keywordflow">if</span>( movieDecoderPlayer-&gt;m_ByteStreamReader == NULL )</div>
<div class="line">                {</div>
<div class="line">                    NN_SDK_LOG(<span class="stringliteral">&quot;\n Failed to create IVF stream reader - Terminating Application ! \n&quot;</span>);</div>
<div class="line">                    movieDecoderPlayer-&gt;HandleErrorExit();</div>
<div class="line">                    movieDecoderPlayer.reset();</div>
<div class="line">                    <span class="keywordflow">return</span>;</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">else</span></div>
<div class="line">                {</div>
<div class="line">                    movieStatus = movieDecoderPlayer-&gt;m_ByteStreamReader-&gt;Open(path.c_str(), streamFormat);</div>
<div class="line">                    <span class="keywordflow">if</span>( movieStatus == <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5a578dbc51cacf7873a3e40667603e58be">movie::Status_Success</a> )</div>
<div class="line">                    {</div>
<div class="line">                        movieStatus = movieDecoderPlayer-&gt;m_ByteStreamReader-&gt;Prepare();</div>
<div class="line">                        <span class="keywordflow">if</span>( movieStatus == <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5a578dbc51cacf7873a3e40667603e58be">movie::Status_Success</a> )</div>
<div class="line">                        {</div>
<div class="line">                            movieStatus = movieDecoderPlayer-&gt;m_ByteStreamReader-&gt;GetStreamProperties(&amp;movieDecoderPlayer-&gt;m_VideoDecoderType,</div>
<div class="line">                                &amp;movieDecoderPlayer-&gt;m_Width,</div>
<div class="line">                                &amp;movieDecoderPlayer-&gt;m_Height,</div>
<div class="line">                                &amp;movieDecoderPlayer-&gt;m_VideoFrameRate);</div>
<div class="line">                            <span class="keywordflow">if</span>( movieStatus == <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5a578dbc51cacf7873a3e40667603e58be">movie::Status_Success</a> )</div>
<div class="line">                            {</div>
<div class="line">                                movieStatus = movieDecoderPlayer-&gt;CreateDecoder(&amp;movieDecoderPlayer-&gt;m_VideoDecoder,</div>
<div class="line">                                    movieDecoderPlayer-&gt;m_VideoDecoderType,</div>
<div class="line">                                    videoDecoderMode,</div>
<div class="line">                                    videoDecoderOutputFormat);</div>
<div class="line">                                <span class="keywordflow">if</span>( movieStatus == <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5a578dbc51cacf7873a3e40667603e58be">movie::Status_Success</a> )</div>
<div class="line">                                {</div>
<div class="line">                                    <a name="_a43"></a><a class="code" href="classmovie_1_1_media_data.html">movie::MediaData</a> config;</div>
<div class="line">                                    movieDecoderPlayer-&gt;m_VideoDecoderCreated = <span class="keyword">true</span>;</div>
<div class="line">                                    <span class="keywordflow">if</span>( movieDecoderPlayer-&gt;m_VideoDecoderType == <a name="a44"></a><a class="code" href="namespacemovie.html#a13e52fd4ee5ac91b6966c5afb314373ca1313bb0e49ad71e6828ec8ade6003d4e">movie::DecoderType_VideoVp8</a> )</div>
<div class="line">                                    {</div>
<div class="line">                                        <a name="a45"></a><a class="code" href="namespacemovie.html#a61d2a7a180fa66560d7d36ab7b878bc7">CreateVp8DecoderConfigurationData</a>(movieDecoderPlayer-&gt;m_Width, movieDecoderPlayer-&gt;m_Height,</div>
<div class="line">                                            movieDecoderPlayer-&gt;m_VideoFrameRate,</div>
<div class="line">                                            &amp;config);</div>
<div class="line">                                    }</div>
<div class="line">                                    <span class="keywordflow">else</span> <span class="keywordflow">if</span>( movieDecoderPlayer-&gt;m_VideoDecoderType == <a name="a46"></a><a class="code" href="namespacemovie.html#a13e52fd4ee5ac91b6966c5afb314373ca3596c2d49a5a2c15cd3165b45055accd">movie::DecoderType_VideoVp9</a> )</div>
<div class="line">                                    {</div>
<div class="line">                                        <a name="a47"></a><a class="code" href="namespacemovie.html#add2e72bcf1715445c5afc4e504abfc78">CreateVp9DecoderConfigurationData</a>(movieDecoderPlayer-&gt;m_Width,</div>
<div class="line">                                            movieDecoderPlayer-&gt;m_Height,</div>
<div class="line">                                            movieDecoderPlayer-&gt;m_VideoFrameRate</div>
<div class="line">                                            , &amp;config);</div>
<div class="line">                                    }</div>
<div class="line">                                    <span class="keywordflow">else</span> <span class="keywordflow">if</span>( movieDecoderPlayer-&gt;m_VideoDecoderType == <a name="a48"></a><a class="code" href="namespacemovie.html#a13e52fd4ee5ac91b6966c5afb314373cab217d89283577ce5f43ca1a91a6218fa">movie::DecoderType_VideoAvc</a> )</div>
<div class="line">                                    {</div>
<div class="line">                                        <a name="a49"></a><a class="code" href="namespacemovie.html#aadc96942f542a704e7a56b7ff6b82204">CreateH264DecoderConfigurationData</a>(movieDecoderPlayer-&gt;m_ByteStreamReader-&gt;m_H264Sps,</div>
<div class="line">                                            movieDecoderPlayer-&gt;m_ByteStreamReader-&gt;m_H264SpsSize,</div>
<div class="line">                                            movieDecoderPlayer-&gt;m_ByteStreamReader-&gt;m_H264Pps,</div>
<div class="line">                                            movieDecoderPlayer-&gt;m_ByteStreamReader-&gt;m_H264PpsSize,</div>
<div class="line">                                            &amp;config);</div>
<div class="line">                                    }</div>
<div class="line">                                    <span class="keywordflow">else</span></div>
<div class="line">                                        movieStatus = <a name="a50"></a><a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5a819d55a4ad4bd1ac42bc65771cdc6792">movie::Status_UnknownError</a>;</div>
<div class="line">                                    <span class="keywordflow">if</span>( movieStatus == <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5a578dbc51cacf7873a3e40667603e58be">movie::Status_Success</a> )</div>
<div class="line">                                    {</div>
<div class="line">                                        movieStatus = movieDecoderPlayer-&gt;ConfigureDecoder(movieDecoderPlayer-&gt;m_VideoDecoder,</div>
<div class="line">                                            &amp;movieDecoderPlayer-&gt;m_VideoDecoderEvents,</div>
<div class="line">                                            &amp;config);</div>
<div class="line">                                    }</div>
<div class="line">                                    movieDecoderPlayer-&gt;ResetVideoDecodeComplete();</div>
<div class="line">                                    movieDecoderPlayer-&gt;m_VideoTrackIndex = 0;</div>
<div class="line">                                    movieDecoderPlayer-&gt;m_TrackFormat.push_back(config);</div>
<div class="line">                                }</div>
<div class="line">                            }</div>
<div class="line">                        }</div>
<div class="line">                    }</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">else</span> <span class="keywordflow">if</span>( container != <a class="code" href="namespacemovie.html#ab5ee2cf437465786112d30f8a80bb979aef2591807cf17783b9908d9a9f1b05c9">movie::ContainerType_Unknown</a> )</div>
<div class="line">            {</div>
<div class="line">                <span class="comment">// Create extractor to parse media data</span></div>
<div class="line">                movieStatus = movieDecoderPlayer-&gt;CreateExtractor(path.c_str(),</div>
<div class="line">                    container,</div>
<div class="line">                    &amp;movieDecoderPlayer-&gt;m_Extractor,</div>
<div class="line">                    &amp;movieDecoderPlayer-&gt;m_ClientReader);</div>
<div class="line">                <span class="keywordflow">if</span>( movieStatus == <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5a578dbc51cacf7873a3e40667603e58be">movie::Status_Success</a> )</div>
<div class="line">                {</div>
<div class="line">                    <span class="comment">// Create audio and video decoder for decoding media data</span></div>
<div class="line">                    movieStatus = movieDecoderPlayer-&gt;CreateDecoders(movieDecoderPlayer-&gt;m_Extractor,</div>
<div class="line">                        audioDecoderMode,</div>
<div class="line">                        audioDecoderOutputFormat,</div>
<div class="line">                        videoDecoderMode,</div>
<div class="line">                        videoDecoderOutputFormat);</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">else</span></div>
<div class="line">                movieStatus = <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5a819d55a4ad4bd1ac42bc65771cdc6792">movie::Status_UnknownError</a>;</div>
<div class="line">            <span class="keywordflow">if</span>( movieStatus != <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5a578dbc51cacf7873a3e40667603e58be">movie::Status_Success</a> )</div>
<div class="line">            {</div>
<div class="line">                NN_SDK_LOG(<span class="stringliteral">&quot;\n Failed to createDecoders and Extractor, Error : 0x%x - Terminating Application ! \n&quot;</span>, movieStatus);</div>
<div class="line">                movieDecoderPlayer-&gt;HandleErrorExit();</div>
<div class="line">                movieDecoderPlayer.reset();</div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">            }</div>
<div class="line">            <span class="comment">// Create audio and video renderer for rendering decoded audio and video data</span></div>
<div class="line">            movieStatus = movieDecoderPlayer-&gt;CreateAudioVideoRenderer();</div>
<div class="line">            <span class="keywordflow">if</span>( movieStatus == <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5a578dbc51cacf7873a3e40667603e58be">movie::Status_Success</a> )</div>
<div class="line">            {</div>
<div class="line">                <span class="comment">// Setup AudioOut audio renderer</span></div>
<div class="line">                <span class="keywordflow">if</span>( movieDecoderPlayer-&gt;IsAudioDecoderCreated() )</div>
<div class="line">                {</div>
<div class="line">                    NN_SDK_LOG(<span class="stringliteral">&quot;\n MovieDecoderPlayer:: Create AudioOut renderer \n&quot;</span>);</div>
<div class="line">                    movieStatus = movieDecoderPlayer-&gt;m_MovieAudioOutputHandler-&gt;Initialize(movieDecoderPlayer-&gt;m_MediaClock);</div>
<div class="line">                    <span class="keywordflow">if</span>( movieStatus == <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5a578dbc51cacf7873a3e40667603e58be">movie::Status_Success</a> )</div>
<div class="line">                    {</div>
<div class="line">                        <span class="keywordflow">if</span>( ( container == <a class="code" href="namespacemovie.html#ab5ee2cf437465786112d30f8a80bb979a28f2687be45cc1a08b51ca32a2200e7b">movie::ContainerType_Matroska</a> ) || ( container == <a class="code" href="namespacemovie.html#ab5ee2cf437465786112d30f8a80bb979a55ab128351682dc87f8e1227f4cca22d">movie::ContainerType_WebM</a> ) ||</div>
<div class="line">                            ( container == movie::ContainerType_Ogg ) )</div>
<div class="line">                        {</div>
<div class="line">                            movieDecoderPlayer-&gt;m_VariableSizeAudioFrames = <span class="keyword">true</span>;</div>
<div class="line">                        }</div>
<div class="line">                    }</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">if</span>( movieStatus == <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5a578dbc51cacf7873a3e40667603e58be">movie::Status_Success</a> )</div>
<div class="line">                {</div>
<div class="line">                    <span class="keywordflow">if</span>( movieDecoderPlayer-&gt;IsVideoDecoderCreated() )</div>
<div class="line">                    {</div>
<div class="line">                        NN_SDK_LOG(<span class="stringliteral">&quot;\n MovieDecoderPlayer:: Create Video renderer \n&quot;</span>);</div>
<div class="line">                        movieStatus = movieDecoderPlayer-&gt;m_MovieVideoOutputHandler-&gt;Initialize(movieDecoderPlayer-&gt;m_MediaClock, <span class="keyword">nullptr</span>);</div>
<div class="line">                        <span class="keywordflow">if</span>( movieStatus == <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5a578dbc51cacf7873a3e40667603e58be">movie::Status_Success</a> )</div>
<div class="line">                        {</div>
<div class="line">                            <span class="keywordflow">if</span>( movieDecoderPlayer-&gt;IsAudioDecoderCreated() )</div>
<div class="line">                                movieDecoderPlayer-&gt;m_VideoFrameRate = -1;</div>
<div class="line">                        }</div>
<div class="line">                    }</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">if</span>( movieStatus != <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5a578dbc51cacf7873a3e40667603e58be">movie::Status_Success</a> )</div>
<div class="line">            {</div>
<div class="line">                NN_SDK_LOG(<span class="stringliteral">&quot;\n Failed to create AudioVideoRenderer, Error : 0x%x - Terminating Application ! \n&quot;</span>, movieStatus);</div>
<div class="line">                movieDecoderPlayer-&gt;HandleErrorExit();</div>
<div class="line">                movieDecoderPlayer.reset();</div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">            }</div>
<div class="line">            NN_SDK_LOG(<span class="stringliteral">&quot;\n MovieDecoderPlayer:: Start Input Reader Thread \n&quot;</span>);</div>
<div class="line">            <span class="comment">// Start audio input reader thread</span></div>
<div class="line">            movieDecoderPlayer-&gt;StartAudioInputReaderThread();</div>
<div class="line">            <span class="comment">// Start video input reader thread</span></div>
<div class="line">            movieDecoderPlayer-&gt;StartVideoInputReaderThread();</div>
<div class="line">            <span class="comment">// Start worker thread to receive decoder events</span></div>
<div class="line">            movieDecoderPlayer-&gt;StartAudioVideoWorkerThread();</div>
<div class="line">            NN_SDK_LOG(<span class="stringliteral">&quot;\n MovieDecoderPlayer:: start Codecs.\n&quot;</span>);</div>
<div class="line">            <span class="comment">// Start decoders</span></div>
<div class="line">            <span class="keywordflow">if</span>( movieDecoderPlayer-&gt;m_AudioDecoder != NULL )</div>
<div class="line">                movieStatus = movieDecoderPlayer-&gt;StartDecoder(movieDecoderPlayer-&gt;m_AudioDecoder);</div>
<div class="line">            <span class="keywordflow">if</span>( movieDecoderPlayer-&gt;m_VideoDecoder != NULL )</div>
<div class="line">                movieStatus = movieDecoderPlayer-&gt;StartDecoder(movieDecoderPlayer-&gt;m_VideoDecoder);</div>
<div class="line">            <span class="keywordflow">if</span>( movieStatus != <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5a578dbc51cacf7873a3e40667603e58be">movie::Status_Success</a> )</div>
<div class="line">            {</div>
<div class="line">                NN_SDK_LOG(<span class="stringliteral">&quot;\n Failed to  StartDecoders , Error : 0x%x - Terminating Application ! \n&quot;</span>, movieStatus);</div>
<div class="line">                movieDecoderPlayer-&gt;HandleErrorExit();</div>
<div class="line">                movieDecoderPlayer.reset();</div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">if</span>( movieDecoderPlayer-&gt;m_Extractor != NULL )</div>
<div class="line">            {</div>
<div class="line">                NN_SDK_LOG(<span class="stringliteral">&quot;\n MovieDecoderPlayer:: Wait for cache fill \n&quot;</span>);</div>
<div class="line">                movieStatus = movieDecoderPlayer-&gt;m_Extractor-&gt;SeekTo(0ll);</div>
<div class="line">                <span class="keywordflow">if</span>( movieStatus == <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5a578dbc51cacf7873a3e40667603e58be">movie::Status_Success</a> )</div>
<div class="line">                {</div>
<div class="line">                    int64_t startTimeUs = 0ll;</div>
<div class="line">                    int64_t endTimeUs = 0ll;</div>
<div class="line">                    <span class="comment">// Cache 5 seconds worth of data</span></div>
<div class="line">                    int64_t cacheTimeUs = 5000000ll;</div>
<div class="line">                    <span class="comment">// Wait maximum of 5 Seconds</span></div>
<div class="line">                    <span class="keywordtype">int</span> sleepTimeMs = 10;</div>
<div class="line">                    <span class="keywordtype">int</span> waitCount = 500;</div>
<div class="line">                    <span class="keywordflow">while</span>( waitCount &gt; 0 )</div>
<div class="line">                    {</div>
<div class="line">                        movieStatus = movieDecoderPlayer-&gt;m_Extractor-&gt;GetBufferedRange(&amp;startTimeUs, &amp;endTimeUs);</div>
<div class="line">                        <span class="keywordflow">if</span>( ( movieStatus != <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5a578dbc51cacf7873a3e40667603e58be">movie::Status_Success</a> ) || ( endTimeUs &gt;= cacheTimeUs ) )</div>
<div class="line">                            <span class="keywordflow">break</span>;</div>
<div class="line">                        waitCount--;</div>
<div class="line">                        <a name="a51"></a><a class="code" href="namespacenn_1_1os.html#a96b335e87af44c60a0d6dca75f11c9d2">nn::os::SleepThread</a>(<a name="a52"></a><a class="code" href="classnn_1_1_time_span.html#a1b8582b5180ce7992fc82a148c7f8c90">nn::TimeSpan::FromMilliSeconds</a>(sleepTimeMs));</div>
<div class="line">                    }</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">if</span>( movieDecoderPlayer-&gt;m_VideoDecoder == <span class="keyword">nullptr</span> )</div>
<div class="line">                movieDecoderPlayer-&gt;m_VideoFormatChangeEventReceived = <span class="keyword">true</span>;</div>
<div class="line">            <span class="keywordflow">if</span>( movieDecoderPlayer-&gt;m_AudioDecoder == <span class="keyword">nullptr</span> )</div>
<div class="line">                movieDecoderPlayer-&gt;m_AudioFormatChangeEventReceived = <span class="keyword">true</span>;</div>
<div class="line">            <span class="comment">// Wait for audio and video FormatChange events.</span></div>
<div class="line">            movieDecoderPlayer-&gt;WaitForFormatChange();</div>
<div class="line">            <span class="keywordflow">if</span>( movieDecoderPlayer-&gt;IsAudioDecoderCreated() )</div>
<div class="line">            {</div>
<div class="line">                movieStatus = movieDecoderPlayer-&gt;m_MovieAudioOutputHandler-&gt;Open(movieDecoderPlayer-&gt;m_AudioDecoder,</div>
<div class="line">                    movieDecoderPlayer-&gt;m_SampleRate,</div>
<div class="line">                    movieDecoderPlayer-&gt;m_NumChannels,</div>
<div class="line">                    movieDecoderPlayer-&gt;m_VariableSizeAudioFrames);</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">if</span>( movieDecoderPlayer-&gt;IsVideoDecoderCreated() )</div>
<div class="line">            {</div>
<div class="line">                movieStatus = movieDecoderPlayer-&gt;m_MovieVideoOutputHandler-&gt;Open(movieDecoderPlayer-&gt;m_VideoDecoder,</div>
<div class="line">                    movieDecoderPlayer-&gt;m_Width,</div>
<div class="line">                    movieDecoderPlayer-&gt;m_Height);</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">if</span>( movieStatus != <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5a578dbc51cacf7873a3e40667603e58be">movie::Status_Success</a> )</div>
<div class="line">            {</div>
<div class="line">                NN_SDK_LOG(<span class="stringliteral">&quot;\n Failed to open audio and video renderer, Error : 0x%x - Terminating Application ! \n&quot;</span>, movieStatus);</div>
<div class="line">                movieDecoderPlayer-&gt;HandleErrorExit();</div>
<div class="line">                movieDecoderPlayer.reset();</div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">            }</div>
<div class="line">            <a class="code" href="nn___log_8h.html#aa8c0b58247a2078e37f2fe0974b98a61">NN_LOG</a>(<span class="stringliteral">&quot;\n MovieDecoderPlayer:: Playback is Started \n&quot;</span>);</div>
<div class="line">            <span class="comment">// Wait till we have sufficient audio and video output buffers to start playback</span></div>
<div class="line">            <span class="comment">// Wait maximum of one second</span></div>
<div class="line">            <span class="keywordtype">int</span> startPlaybackCount = 0;</div>
<div class="line">            <span class="keywordflow">while</span>( 1 )</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">if</span>( <span class="keyword">true</span> == movieDecoderPlayer-&gt;StartPlayback() || ( startPlaybackCount &gt;= 200 ) )</div>
<div class="line">                {</div>
<div class="line">                    <span class="keywordflow">if</span>( movieDecoderPlayer-&gt;m_MovieAudioOutputHandler != NULL )</div>
<div class="line">                    {</div>
<div class="line">                        movieStatus = movieDecoderPlayer-&gt;m_MovieAudioOutputHandler-&gt;Start();</div>
<div class="line">                        <span class="keywordflow">if</span>( movieStatus != <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5a578dbc51cacf7873a3e40667603e58be">movie::Status_Success</a> )</div>
<div class="line">                        {</div>
<div class="line">                            movieDecoderPlayer-&gt;SetVideoDecodeComplete();</div>
<div class="line">                            movieDecoderPlayer-&gt;SetAudioDecodeComplete();</div>
<div class="line">                            <span class="keywordflow">break</span>;</div>
<div class="line">                        }</div>
<div class="line">                    }</div>
<div class="line">                    <span class="keywordflow">if</span>( movieDecoderPlayer-&gt;m_MovieVideoOutputHandler != NULL )</div>
<div class="line">                    {</div>
<div class="line">                        movieStatus = movieDecoderPlayer-&gt;m_MovieVideoOutputHandler-&gt;Start(movieDecoderPlayer-&gt;m_Width,</div>
<div class="line">                            movieDecoderPlayer-&gt;m_Height);</div>
<div class="line">                        <span class="keywordflow">if</span>( movieStatus != <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5a578dbc51cacf7873a3e40667603e58be">movie::Status_Success</a> )</div>
<div class="line">                        {</div>
<div class="line">                            movieDecoderPlayer-&gt;SetVideoDecodeComplete();</div>
<div class="line">                            movieDecoderPlayer-&gt;SetAudioDecodeComplete();</div>
<div class="line">                            <span class="keywordflow">break</span>;</div>
<div class="line">                        }</div>
<div class="line">                    }</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                }</div>
<div class="line">                startPlaybackCount++;</div>
<div class="line">                <a class="code" href="namespacenn_1_1os.html#a96b335e87af44c60a0d6dca75f11c9d2">nn::os::SleepThread</a>(<a class="code" href="classnn_1_1_time_span.html#a1b8582b5180ce7992fc82a148c7f8c90">nn::TimeSpan::FromMilliSeconds</a>(5));</div>
<div class="line">            }</div>
<div class="line">            movieDecoderPlayer-&gt;m_PlaybackTime = Clock::GetNowUs();</div>
<div class="line">            <span class="comment">// Wait till playback is complete</span></div>
<div class="line">            <span class="keywordtype">int</span> logCount = 0;</div>
<div class="line">            <a class="code" href="nn___log_8h.html#aa8c0b58247a2078e37f2fe0974b98a61">NN_LOG</a>(<span class="stringliteral">&quot;\n ******* Waiting for Playback to complete ******* \n&quot;</span>);</div>
<div class="line">            <span class="keywordflow">while</span>( 1 )</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordtype">bool</span> isPlaybackComplete = movieDecoderPlayer-&gt;IsPlaybackComplete();</div>
<div class="line">                <span class="keywordflow">if</span>( isPlaybackComplete == <span class="keyword">true</span> )</div>
<div class="line">                {</div>
<div class="line">                    <span class="keywordflow">if</span>( loopPlayback == <span class="keyword">true</span> )</div>
<div class="line">                    {</div>
<div class="line">                        <span class="keywordflow">if</span>( <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5a578dbc51cacf7873a3e40667603e58be">movie::Status_Success</a> != movieDecoderPlayer-&gt;HandleLoopBack() )</div>
<div class="line">                            <span class="keywordflow">break</span>;</div>
<div class="line">                    }</div>
<div class="line">                    <span class="keywordflow">else</span></div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                }</div>
<div class="line">                logCount++;</div>
<div class="line">                <span class="comment">// Log once in 5 seconds</span></div>
<div class="line">                <span class="keywordflow">if</span>( logCount == 50 )</div>
<div class="line">                {</div>
<div class="line">                    NN_SDK_LOG(<span class="stringliteral">&quot;\n ******* Waiting for Playback to complete ******* \n&quot;</span>);</div>
<div class="line">                    logCount = 0;</div>
<div class="line">                }</div>
<div class="line">                <a class="code" href="namespacenn_1_1os.html#a96b335e87af44c60a0d6dca75f11c9d2">nn::os::SleepThread</a>(<a class="code" href="classnn_1_1_time_span.html#a1b8582b5180ce7992fc82a148c7f8c90">nn::TimeSpan::FromMilliSeconds</a>(100));</div>
<div class="line">                <span class="keywordflow">if</span>( resetCount &gt; 0 )</div>
<div class="line">                {</div>
<div class="line">                    <a class="code" href="namespacenn_1_1os.html#a96b335e87af44c60a0d6dca75f11c9d2">nn::os::SleepThread</a>(<a name="a53"></a><a class="code" href="classnn_1_1_time_span.html#adc879772bbd4cd05381326fe0dd58b97">nn::TimeSpan::FromSeconds</a>(10));</div>
<div class="line">                    movieDecoderPlayer-&gt;Reset();</div>
<div class="line">                    --resetCount;</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">            movieDecoderPlayer-&gt;m_PlaybackTime = ( Clock::GetNowUs() - movieDecoderPlayer-&gt;m_PlaybackTime ) / 1000;</div>
<div class="line">            <a class="code" href="nn___log_8h.html#aa8c0b58247a2078e37f2fe0974b98a61">NN_LOG</a>(<span class="stringliteral">&quot; \n ******* Total Playback Time = : %lld msec \n&quot;</span>, movieDecoderPlayer-&gt;m_PlaybackTime);</div>
<div class="line">            <span class="comment">// Finalize resources</span></div>
<div class="line">            movieDecoderPlayer-&gt;Finalize();</div>
<div class="line">            <span class="keywordflow">if</span>( ( runPlaybackAgingTest == <span class="keyword">true</span> ) &amp;&amp; ( playbackAgingRepeatCount &gt; 0 ) )</div>
<div class="line">                NN_SDK_LOG(<span class="stringliteral">&quot;\n MovieDecoderPlayer:: Aging test PlayBack repeat count : %d \n&quot;</span>, ++playbackAgingRepeatCount);</div>
<div class="line">        } <span class="keywordflow">while</span>( runPlaybackAgingTest == <span class="keyword">true</span> );</div>
<div class="line">        <a class="code" href="namespacenv.html#a368247e862f5ffc59a38af42658d7b38">nv::FinalizeGraphics</a>();</div>
<div class="line">    }</div>
<div class="line">    PrintMemoryUsageStats();</div>
<div class="line">}<span class="comment">//NOLINT(impl/function_size)</span></div>
<div class="line"></div>
<div class="line">MovieDecoderPlayer::MovieDecoderPlayer()</div>
<div class="line">{</div>
<div class="line">    m_Extractor = NULL;</div>
<div class="line">    m_VideoDecoder = NULL;</div>
<div class="line">    m_AudioDecoder = NULL;</div>
<div class="line">    m_MovieAudioOutputHandler = NULL;</div>
<div class="line">    m_MovieVideoOutputHandler = NULL;</div>
<div class="line">    m_ByteStreamReader = NULL;</div>
<div class="line">    m_AudioDecoderType = movie::DecoderType::DecoderType_Unknown;</div>
<div class="line">    m_VideoDecoderType = movie::DecoderType::DecoderType_Unknown;</div>
<div class="line">    m_ThreadStackSize = 1024 * 256;</div>
<div class="line">    m_Tracks = 0;</div>
<div class="line">    m_Width = -1;</div>
<div class="line">    m_Height = -1;</div>
<div class="line">    m_NumChannels = -1;</div>
<div class="line">    m_SampleRate = -1;</div>
<div class="line">    m_AudioTrackIndex = -1;</div>
<div class="line">    m_VideoTrackIndex = -2;</div>
<div class="line">    m_VideoFrameRate = -1.0;</div>
<div class="line">    m_TrackDurationUs = -1;</div>
<div class="line">    SetAudioDecodeComplete();</div>
<div class="line">    SetVideoDecodeComplete();</div>
<div class="line">    m_AudioDecoderCreated = <span class="keyword">false</span>;</div>
<div class="line">    m_VideoDecoderCreated = <span class="keyword">false</span>;</div>
<div class="line">    m_AudioOutputBufferReceived = 0;</div>
<div class="line">    m_VideoOutputBufferReceived = 0;</div>
<div class="line">    m_ClientReader = NULL;</div>
<div class="line">    m_MediaClock = <span class="keyword">nullptr</span>;</div>
<div class="line">    m_PlaybackComplete = <span class="keyword">false</span>;</div>
<div class="line">    m_PlaybackTime = 0;</div>
<div class="line">    m_VideoPresentationTimeUs = 0;</div>
<div class="line">    m_VariableSizeAudioFrames = <span class="keyword">false</span>;</div>
<div class="line">    <a name="a54"></a><a class="code" href="namespacenn_1_1os.html#a8d0a550df15490a884932a062dc26533">nn::os::InitializeMutex</a>( &amp;m_VideoListMutex, <span class="keyword">false</span>, 0 );</div>
<div class="line">    <a class="code" href="namespacenn_1_1os.html#a8d0a550df15490a884932a062dc26533">nn::os::InitializeMutex</a>( &amp;m_AudioListMutex, <span class="keyword">false</span>, 0 );</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5">movie::Status</a> <a name="a55"></a><a class="code" href="namespacenn_1_1htcs.html#a7eab72b8843a2a9ff763f52b78da680e">MovieDecoderPlayer::Initialize</a>(uint64_t coreMask)</div>
<div class="line">{</div>
<div class="line">    <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5">movie::Status</a> movieStatus = <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5a578dbc51cacf7873a3e40667603e58be">movie::Status_Success</a>;</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Maximum number of messages in Audio and Video input reader of message queue.</span></div>
<div class="line">    m_BufferSize = 128;</div>
<div class="line">    m_LoopCount = 0;</div>
<div class="line">    m_PlaybackComplete = <span class="keyword">false</span>;</div>
<div class="line">    m_PlaybackTime = 0;</div>
<div class="line">    m_VideoPresentationTimeUs = 0;</div>
<div class="line">    m_AudioFormatChangeEventReceived = <span class="keyword">false</span>;</div>
<div class="line">    m_VideoFormatChangeEventReceived = <span class="keyword">false</span>;</div>
<div class="line">    <span class="keywordflow">if</span>( coreMask )<span class="comment">//set only valid core mask</span></div>
<div class="line">        <a name="a56"></a><a class="code" href="namespacemovie.html#aca965a353514c4650118a5bf46f34df9">movie::SetCoreMask</a>(coreMask);</div>
<div class="line">    <span class="comment">// Initialize Event for audio video worker thread</span></div>
<div class="line">    <a name="a57"></a><a class="code" href="namespacenn_1_1os.html#af07abef747ac6b51112b9e800ba9632c">nn::os::InitializeEvent</a>( &amp;m_AudioVideoWorkerThreadExitEvent, <span class="keyword">false</span>, <a name="a58"></a><a class="code" href="namespacenn_1_1os.html#a11ab71d44973a4135958c420e5682452a8b702480f5120eeeb01e7102227285da">nn::os::EventClearMode_ManualClear</a> );</div>
<div class="line">    <span class="comment">// Initialize MultiWaitHolder for AudioVideoWorkerThread</span></div>
<div class="line">    <a name="a59"></a><a class="code" href="namespacenn_1_1os.html#a4f8d998425d067cb5fec2604ae7845dc">nn::os::InitializeMultiWaitHolder</a>(&amp;m_AudioVideoWorkerThreadExitEventHolder, &amp;m_AudioVideoWorkerThreadExitEvent);</div>
<div class="line">    <span class="comment">// Initialize MultiWait for AudioVideoWorkerThread</span></div>
<div class="line">    <a name="a60"></a><a class="code" href="namespacenn_1_1os.html#a48e6662e7fdf9f78bcae79ba94d64a93">nn::os::InitializeMultiWait</a>(&amp;m_AudioVideoWorkerMultiWait);</div>
<div class="line">    <span class="comment">// Initialize Events to register with audio decoder</span></div>
<div class="line">    <a class="code" href="namespacenn_1_1os.html#af07abef747ac6b51112b9e800ba9632c">nn::os::InitializeEvent</a>(&amp;m_AudioDecoderEventTypes.errorEvent, <span class="keyword">false</span>, <a class="code" href="namespacenn_1_1os.html#a11ab71d44973a4135958c420e5682452a8b702480f5120eeeb01e7102227285da">nn::os::EventClearMode_ManualClear</a>);</div>
<div class="line">    <a class="code" href="namespacenn_1_1os.html#af07abef747ac6b51112b9e800ba9632c">nn::os::InitializeEvent</a>(&amp;m_AudioDecoderEventTypes.formatChangedEvent, <span class="keyword">false</span>, <a class="code" href="namespacenn_1_1os.html#a11ab71d44973a4135958c420e5682452a8b702480f5120eeeb01e7102227285da">nn::os::EventClearMode_ManualClear</a>);</div>
<div class="line">    <a class="code" href="namespacenn_1_1os.html#af07abef747ac6b51112b9e800ba9632c">nn::os::InitializeEvent</a>(&amp;m_AudioDecoderEventTypes.inputBufferAvailableEvent, <span class="keyword">false</span>, <a class="code" href="namespacenn_1_1os.html#a11ab71d44973a4135958c420e5682452a8b702480f5120eeeb01e7102227285da">nn::os::EventClearMode_ManualClear</a>);</div>
<div class="line">    <a class="code" href="namespacenn_1_1os.html#af07abef747ac6b51112b9e800ba9632c">nn::os::InitializeEvent</a>(&amp;m_AudioDecoderEventTypes.outputBufferAvailableEvent, <span class="keyword">false</span>, <a class="code" href="namespacenn_1_1os.html#a11ab71d44973a4135958c420e5682452a8b702480f5120eeeb01e7102227285da">nn::os::EventClearMode_ManualClear</a>);</div>
<div class="line">    <span class="comment">// Fill movie::DecoderEvents structure with audio events (for audio decoder)</span></div>
<div class="line">    m_AudioDecoderEvents.errorEvent = &amp;m_AudioDecoderEventTypes.errorEvent;</div>
<div class="line">    m_AudioDecoderEvents.formatChangedEvent = &amp;m_AudioDecoderEventTypes.formatChangedEvent;</div>
<div class="line">    m_AudioDecoderEvents.inputBufferAvailableEvent = &amp;m_AudioDecoderEventTypes.inputBufferAvailableEvent;</div>
<div class="line">    m_AudioDecoderEvents.outputBufferAvailableEvent = &amp;m_AudioDecoderEventTypes.outputBufferAvailableEvent;</div>
<div class="line">    <span class="comment">// Initialize AudioDecoderMultiWaitHolder with audio events (Used by movie decoder player thread to listen for audio events)</span></div>
<div class="line">    <a class="code" href="namespacenn_1_1os.html#a4f8d998425d067cb5fec2604ae7845dc">nn::os::InitializeMultiWaitHolder</a>(&amp;m_AudioDecoderMultiWaitHolderTypes.errorEventHolder, &amp;m_AudioDecoderEventTypes.errorEvent);</div>
<div class="line">    <a class="code" href="namespacenn_1_1os.html#a4f8d998425d067cb5fec2604ae7845dc">nn::os::InitializeMultiWaitHolder</a>(&amp;m_AudioDecoderMultiWaitHolderTypes.formatChangedEventHolder, &amp;m_AudioDecoderEventTypes.formatChangedEvent);</div>
<div class="line">    <a class="code" href="namespacenn_1_1os.html#a4f8d998425d067cb5fec2604ae7845dc">nn::os::InitializeMultiWaitHolder</a>(&amp;m_AudioDecoderMultiWaitHolderTypes.inputBufferAvailableEventHolder, &amp;m_AudioDecoderEventTypes.inputBufferAvailableEvent);</div>
<div class="line">    <a class="code" href="namespacenn_1_1os.html#a4f8d998425d067cb5fec2604ae7845dc">nn::os::InitializeMultiWaitHolder</a>(&amp;m_AudioDecoderMultiWaitHolderTypes.outputBufferAvailableEventHolder, &amp;m_AudioDecoderEventTypes.outputBufferAvailableEvent);</div>
<div class="line">    <span class="comment">// Initialize Events to register with video decoder</span></div>
<div class="line">    <a class="code" href="namespacenn_1_1os.html#af07abef747ac6b51112b9e800ba9632c">nn::os::InitializeEvent</a>(&amp;m_VideoDecoderEventTypes.errorEvent, <span class="keyword">false</span>, <a class="code" href="namespacenn_1_1os.html#a11ab71d44973a4135958c420e5682452a8b702480f5120eeeb01e7102227285da">nn::os::EventClearMode_ManualClear</a>);</div>
<div class="line">    <a class="code" href="namespacenn_1_1os.html#af07abef747ac6b51112b9e800ba9632c">nn::os::InitializeEvent</a>(&amp;m_VideoDecoderEventTypes.formatChangedEvent, <span class="keyword">false</span>, <a class="code" href="namespacenn_1_1os.html#a11ab71d44973a4135958c420e5682452a8b702480f5120eeeb01e7102227285da">nn::os::EventClearMode_ManualClear</a>);</div>
<div class="line">    <a class="code" href="namespacenn_1_1os.html#af07abef747ac6b51112b9e800ba9632c">nn::os::InitializeEvent</a>(&amp;m_VideoDecoderEventTypes.inputBufferAvailableEvent, <span class="keyword">false</span>, <a class="code" href="namespacenn_1_1os.html#a11ab71d44973a4135958c420e5682452a8b702480f5120eeeb01e7102227285da">nn::os::EventClearMode_ManualClear</a>);</div>
<div class="line">    <a class="code" href="namespacenn_1_1os.html#af07abef747ac6b51112b9e800ba9632c">nn::os::InitializeEvent</a>(&amp;m_VideoDecoderEventTypes.outputBufferAvailableEvent, <span class="keyword">false</span>, <a class="code" href="namespacenn_1_1os.html#a11ab71d44973a4135958c420e5682452a8b702480f5120eeeb01e7102227285da">nn::os::EventClearMode_ManualClear</a>);</div>
<div class="line">    <span class="comment">// Fill movie::DecoderEvents structure with video events (for video decoder)</span></div>
<div class="line">    m_VideoDecoderEvents.errorEvent = &amp;m_VideoDecoderEventTypes.errorEvent;</div>
<div class="line">    m_VideoDecoderEvents.formatChangedEvent = &amp;m_VideoDecoderEventTypes.formatChangedEvent;</div>
<div class="line">    m_VideoDecoderEvents.inputBufferAvailableEvent = &amp;m_VideoDecoderEventTypes.inputBufferAvailableEvent;</div>
<div class="line">    m_VideoDecoderEvents.outputBufferAvailableEvent = &amp;m_VideoDecoderEventTypes.outputBufferAvailableEvent;</div>
<div class="line">    <span class="comment">// Initialize VideoDecoderMultiWaitHolderTypes with video events (Used by movie decoder player thread to listen for video events)</span></div>
<div class="line">    <a class="code" href="namespacenn_1_1os.html#a4f8d998425d067cb5fec2604ae7845dc">nn::os::InitializeMultiWaitHolder</a>(&amp;m_VideoDecoderMultiWaitHolderTypes.errorEventHolder, &amp;m_VideoDecoderEventTypes.errorEvent);</div>
<div class="line">    <a class="code" href="namespacenn_1_1os.html#a4f8d998425d067cb5fec2604ae7845dc">nn::os::InitializeMultiWaitHolder</a>(&amp;m_VideoDecoderMultiWaitHolderTypes.formatChangedEventHolder, &amp;m_VideoDecoderEventTypes.formatChangedEvent);</div>
<div class="line">    <a class="code" href="namespacenn_1_1os.html#a4f8d998425d067cb5fec2604ae7845dc">nn::os::InitializeMultiWaitHolder</a>(&amp;m_VideoDecoderMultiWaitHolderTypes.inputBufferAvailableEventHolder, &amp;m_VideoDecoderEventTypes.inputBufferAvailableEvent);</div>
<div class="line">    <a class="code" href="namespacenn_1_1os.html#a4f8d998425d067cb5fec2604ae7845dc">nn::os::InitializeMultiWaitHolder</a>(&amp;m_VideoDecoderMultiWaitHolderTypes.outputBufferAvailableEventHolder, &amp;m_VideoDecoderEventTypes.outputBufferAvailableEvent);</div>
<div class="line">    <span class="comment">// Initialize Events for Player to wait for format changes.</span></div>
<div class="line">    <a class="code" href="namespacenn_1_1os.html#af07abef747ac6b51112b9e800ba9632c">nn::os::InitializeEvent</a>(&amp;m_FormatChangedPlayerEvent, <span class="keyword">false</span>, <a class="code" href="namespacenn_1_1os.html#a11ab71d44973a4135958c420e5682452a8b702480f5120eeeb01e7102227285da">nn::os::EventClearMode_ManualClear</a>);</div>
<div class="line">    m_VideoInputMessageBuffer = <span class="keyword">new</span> uintptr_t[m_BufferSize];</div>
<div class="line">    <span class="keywordflow">if</span>( m_VideoInputMessageBuffer == NULL )</div>
<div class="line">        <span class="keywordflow">return</span> <a name="a61"></a><a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5a6de6894a9e777a43a2bebebd1b76667c">movie::Status_OutOfMemory</a>;</div>
<div class="line">    m_AudioInputMessageBuffer = <span class="keyword">new</span> uintptr_t[ m_BufferSize ];</div>
<div class="line">    <span class="keywordflow">if</span>( m_AudioInputMessageBuffer == NULL )</div>
<div class="line">        <span class="keywordflow">return</span> <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5a6de6894a9e777a43a2bebebd1b76667c">movie::Status_OutOfMemory</a>;</div>
<div class="line">    <span class="comment">// Initialize MessageQueue used by movie decoder player</span></div>
<div class="line">    <a name="a62"></a><a class="code" href="namespacenn_1_1os.html#ab7baa013ea5d9d4f9e84eb5d1afcec49">nn::os::InitializeMessageQueue</a>( &amp;m_VideoInputMessageQueue, m_VideoInputMessageBuffer, m_BufferSize );</div>
<div class="line">    <span class="comment">// Initialize MessageQueue used by movie decoder player</span></div>
<div class="line">    <a class="code" href="namespacenn_1_1os.html#ab7baa013ea5d9d4f9e84eb5d1afcec49">nn::os::InitializeMessageQueue</a>(&amp;m_AudioInputMessageQueue, m_AudioInputMessageBuffer, m_BufferSize);</div>
<div class="line">    <span class="comment">// Create Audio and Video InputReader threads</span></div>
<div class="line">    movieStatus = CreateThreadForVideoInputReader();</div>
<div class="line">    <span class="keywordflow">if</span>( movieStatus == <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5a578dbc51cacf7873a3e40667603e58be">movie::Status_Success</a> )</div>
<div class="line">    {</div>
<div class="line">        <span class="comment">// Create AudioInputReader thread</span></div>
<div class="line">        movieStatus = CreateThreadForAudioInputReader();</div>
<div class="line">        <span class="keywordflow">if</span>( movieStatus == <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5a578dbc51cacf7873a3e40667603e58be">movie::Status_Success</a> )</div>
<div class="line">        {</div>
<div class="line">            <span class="comment">// Create AudioVideoWorker thread</span></div>
<div class="line">            movieStatus = CreateThreadForAudioVideoWorker();</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">    m_MediaClock = <span class="keyword">new</span> MediaClock();</div>
<div class="line">    <span class="keywordflow">if</span>( m_MediaClock == <span class="keyword">nullptr</span> )</div>
<div class="line">        movieStatus = <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5a6de6894a9e777a43a2bebebd1b76667c">movie::Status_OutOfMemory</a>;</div>
<div class="line"></div>
<div class="line">    m_AudioInputReadThreadStarted = <span class="keyword">false</span>;</div>
<div class="line">    m_VideoInputReadThreadStarted = <span class="keyword">false</span>;</div>
<div class="line">    m_AudioVideoWorkerThreadStarted = <span class="keyword">false</span>;</div>
<div class="line">    <span class="keywordflow">return</span> movieStatus;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> <a name="a63"></a><a class="code" href="namespacenn_1_1htcs.html#abf5eb36f3563222450920fad56fdaf61">MovieDecoderPlayer::Finalize</a>()</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// Stop decoder and finalize resources</span></div>
<div class="line">    <span class="keywordflow">if</span>( m_AudioDecoder != NULL )</div>
<div class="line">        StopDecoder(m_AudioDecoder);</div>
<div class="line">    <span class="keywordflow">if</span>( m_VideoDecoder != NULL )</div>
<div class="line">        StopDecoder(m_VideoDecoder);</div>
<div class="line">    StopAndDestroyVideoInputReaderThread();</div>
<div class="line">    StopAndDestroyAudioInputReaderThread();</div>
<div class="line">    StopAudioVideoRenderer();</div>
<div class="line">    DestroypAudioVideoRenderer();</div>
<div class="line">    <span class="keywordflow">if</span>( m_AudioDecoder != NULL )</div>
<div class="line">    {</div>
<div class="line">        DestroyDecoder(m_AudioDecoder);</div>
<div class="line">        m_AudioDecoder = NULL;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">if</span>( m_VideoDecoder != NULL )</div>
<div class="line">    {</div>
<div class="line">        DestroyDecoder(m_VideoDecoder);</div>
<div class="line">        m_VideoDecoder = NULL;</div>
<div class="line">    }</div>
<div class="line">    m_TrackFormat.clear();</div>
<div class="line">    <span class="keywordflow">if</span>( m_Extractor != NULL )</div>
<div class="line">    {</div>
<div class="line">        DestroyExtractor(m_Extractor);</div>
<div class="line">        m_Extractor = NULL;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">if</span>( m_ClientReader != NULL )</div>
<div class="line">    {</div>
<div class="line">        <span class="keyword">delete</span> m_ClientReader;</div>
<div class="line">        m_ClientReader = NULL;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">if</span>( m_ByteStreamReader != NULL )</div>
<div class="line">    {</div>
<div class="line">        m_ByteStreamReader-&gt;Close();</div>
<div class="line">        <span class="keyword">delete</span> m_ByteStreamReader;</div>
<div class="line">        m_ByteStreamReader = NULL;</div>
<div class="line">    }</div>
<div class="line">    StopAndDestroyAudioVideoWorkerThread();</div>
<div class="line">    <span class="keywordflow">if</span>( m_AudioVideoWorkerThreadStack != NULL )</div>
<div class="line">    {</div>
<div class="line">        free(m_AudioVideoWorkerThreadStack);</div>
<div class="line">        m_AudioVideoWorkerThreadStack = NULL;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">if</span>( m_VideoInputReadThreadStack != NULL )</div>
<div class="line">    {</div>
<div class="line">        free(m_VideoInputReadThreadStack);</div>
<div class="line">        m_VideoInputReadThreadStack = NULL;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">if</span>( m_AudioInputReadThreadStack != NULL )</div>
<div class="line">    {</div>
<div class="line">        free(m_AudioInputReadThreadStack);</div>
<div class="line">        m_AudioInputReadThreadStack = NULL;</div>
<div class="line">    }</div>
<div class="line">    <span class="comment">// Finalize AudioVideoWorkerThreadExit event</span></div>
<div class="line">    <a name="a64"></a><a class="code" href="namespacenn_1_1os.html#adae3d14bd5e37dd1feee56bbf1717e37">nn::os::FinalizeEvent</a>( &amp;m_AudioVideoWorkerThreadExitEvent );</div>
<div class="line">    <span class="comment">// Finalize VideoDecoder events</span></div>
<div class="line">    <a class="code" href="namespacenn_1_1os.html#adae3d14bd5e37dd1feee56bbf1717e37">nn::os::FinalizeEvent</a>(&amp;m_VideoDecoderEventTypes.errorEvent);</div>
<div class="line">    <a class="code" href="namespacenn_1_1os.html#adae3d14bd5e37dd1feee56bbf1717e37">nn::os::FinalizeEvent</a>(&amp;m_VideoDecoderEventTypes.formatChangedEvent);</div>
<div class="line">    <a class="code" href="namespacenn_1_1os.html#adae3d14bd5e37dd1feee56bbf1717e37">nn::os::FinalizeEvent</a>(&amp;m_VideoDecoderEventTypes.inputBufferAvailableEvent);</div>
<div class="line">    <a class="code" href="namespacenn_1_1os.html#adae3d14bd5e37dd1feee56bbf1717e37">nn::os::FinalizeEvent</a>(&amp;m_VideoDecoderEventTypes.outputBufferAvailableEvent);</div>
<div class="line">    <span class="comment">// Finalize VideoDecoder MultiWaitHolder</span></div>
<div class="line">    <a name="a65"></a><a class="code" href="namespacenn_1_1os.html#a2de358e6bfa261b74c399b5b59c0da1d">nn::os::FinalizeMultiWaitHolder</a>(&amp;m_VideoDecoderMultiWaitHolderTypes.errorEventHolder);</div>
<div class="line">    <a class="code" href="namespacenn_1_1os.html#a2de358e6bfa261b74c399b5b59c0da1d">nn::os::FinalizeMultiWaitHolder</a>(&amp;m_VideoDecoderMultiWaitHolderTypes.formatChangedEventHolder);</div>
<div class="line">    <a class="code" href="namespacenn_1_1os.html#a2de358e6bfa261b74c399b5b59c0da1d">nn::os::FinalizeMultiWaitHolder</a>(&amp;m_VideoDecoderMultiWaitHolderTypes.inputBufferAvailableEventHolder);</div>
<div class="line">    <a class="code" href="namespacenn_1_1os.html#a2de358e6bfa261b74c399b5b59c0da1d">nn::os::FinalizeMultiWaitHolder</a>(&amp;m_VideoDecoderMultiWaitHolderTypes.outputBufferAvailableEventHolder);</div>
<div class="line">    <span class="comment">// Finalize AudioDecoder events</span></div>
<div class="line">    <a class="code" href="namespacenn_1_1os.html#adae3d14bd5e37dd1feee56bbf1717e37">nn::os::FinalizeEvent</a>(&amp;m_AudioDecoderEventTypes.errorEvent);</div>
<div class="line">    <a class="code" href="namespacenn_1_1os.html#adae3d14bd5e37dd1feee56bbf1717e37">nn::os::FinalizeEvent</a>(&amp;m_AudioDecoderEventTypes.formatChangedEvent);</div>
<div class="line">    <a class="code" href="namespacenn_1_1os.html#adae3d14bd5e37dd1feee56bbf1717e37">nn::os::FinalizeEvent</a>(&amp;m_AudioDecoderEventTypes.inputBufferAvailableEvent);</div>
<div class="line">    <a class="code" href="namespacenn_1_1os.html#adae3d14bd5e37dd1feee56bbf1717e37">nn::os::FinalizeEvent</a>(&amp;m_AudioDecoderEventTypes.outputBufferAvailableEvent);</div>
<div class="line">    <span class="comment">// Finalize AudioDecoder MultiWaitHolder</span></div>
<div class="line">    <a class="code" href="namespacenn_1_1os.html#a2de358e6bfa261b74c399b5b59c0da1d">nn::os::FinalizeMultiWaitHolder</a>(&amp;m_AudioDecoderMultiWaitHolderTypes.errorEventHolder);</div>
<div class="line">    <a class="code" href="namespacenn_1_1os.html#a2de358e6bfa261b74c399b5b59c0da1d">nn::os::FinalizeMultiWaitHolder</a>(&amp;m_AudioDecoderMultiWaitHolderTypes.formatChangedEventHolder);</div>
<div class="line">    <a class="code" href="namespacenn_1_1os.html#a2de358e6bfa261b74c399b5b59c0da1d">nn::os::FinalizeMultiWaitHolder</a>(&amp;m_AudioDecoderMultiWaitHolderTypes.inputBufferAvailableEventHolder);</div>
<div class="line">    <a class="code" href="namespacenn_1_1os.html#a2de358e6bfa261b74c399b5b59c0da1d">nn::os::FinalizeMultiWaitHolder</a>(&amp;m_AudioDecoderMultiWaitHolderTypes.outputBufferAvailableEventHolder);</div>
<div class="line">    <span class="comment">// Finalize AudioVideoWorkerThread MultiWait</span></div>
<div class="line">    <a name="a66"></a><a class="code" href="namespacenn_1_1os.html#a60873f9b623e014948a9ea53a611da4c">nn::os::FinalizeMultiWait</a>(&amp;m_AudioVideoWorkerMultiWait);</div>
<div class="line">    <span class="comment">// Finalize Mutex used by Audio and video list</span></div>
<div class="line">    <a name="a67"></a><a class="code" href="namespacenn_1_1os.html#a8ce43d38754bf3049ab8d60b9d9e0046">nn::os::FinalizeMutex</a>( &amp;m_VideoListMutex );</div>
<div class="line">    <a class="code" href="namespacenn_1_1os.html#a8ce43d38754bf3049ab8d60b9d9e0046">nn::os::FinalizeMutex</a>( &amp;m_AudioListMutex );</div>
<div class="line">    <a class="code" href="namespacenn_1_1os.html#adae3d14bd5e37dd1feee56bbf1717e37">nn::os::FinalizeEvent</a>(&amp;m_FormatChangedPlayerEvent);</div>
<div class="line">    <span class="comment">// Finalize MessageQueue used by movie decoder player</span></div>
<div class="line">    <a name="a68"></a><a class="code" href="namespacenn_1_1os.html#af9c98095075b7ef0570c1a449545e392">nn::os::FinalizeMessageQueue</a>( &amp;m_VideoInputMessageQueue );</div>
<div class="line">    <span class="keywordflow">if</span>( m_VideoInputMessageBuffer != NULL )</div>
<div class="line">        <span class="keyword">delete</span> [] m_VideoInputMessageBuffer;</div>
<div class="line">    <a class="code" href="namespacenn_1_1os.html#af9c98095075b7ef0570c1a449545e392">nn::os::FinalizeMessageQueue</a>(&amp;m_AudioInputMessageQueue);</div>
<div class="line">    <span class="keywordflow">if</span>( m_AudioInputMessageBuffer != NULL )</div>
<div class="line">        <span class="keyword">delete</span>[] m_AudioInputMessageBuffer;</div>
<div class="line">    <span class="keywordflow">if</span>( m_MediaClock != <span class="keyword">nullptr</span> )</div>
<div class="line">    {</div>
<div class="line">        <span class="keyword">delete</span> m_MediaClock;</div>
<div class="line">        m_MediaClock = <span class="keyword">nullptr</span>;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">if</span>( m_SdcardMounted == <span class="keyword">true</span> )</div>
<div class="line">        <a class="code" href="namespacenn_1_1fs.html#ac8a95249afd4a87a55d319dfecb0466c">nn::fs::Unmount</a>(<span class="stringliteral">&quot;sdcard&quot;</span>);</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">        <a class="code" href="namespacenn_1_1fs.html#ade5d6e6459dca7d8274564bcfc5de757">nn::fs::UnmountHostRoot</a>();</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> MovieDecoderPlayer::HandleErrorExit()</div>
<div class="line">{</div>
<div class="line">    <a class="code" href="namespacenn_1_1htcs.html#abf5eb36f3563222450920fad56fdaf61">Finalize</a>();</div>
<div class="line">    <a class="code" href="namespacenv.html#a368247e862f5ffc59a38af42658d7b38">nv::FinalizeGraphics</a>();</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> MovieDecoderPlayer::ResetPlaybackComplete()</div>
<div class="line">{</div>
<div class="line">    ResetAudioDecodeComplete();</div>
<div class="line">    ResetVideoDecodeComplete();</div>
<div class="line">    m_PlaybackComplete = <span class="keyword">false</span>;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">bool</span> MovieDecoderPlayer::IsPlaybackComplete()</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">bool</span> audioPlaybackComplete = <span class="keyword">true</span>;</div>
<div class="line">    <span class="keywordflow">if</span>( m_MovieAudioOutputHandler != NULL )</div>
<div class="line">        audioPlaybackComplete = m_MovieAudioOutputHandler-&gt;AllFramesRendered();</div>
<div class="line">    <span class="keywordtype">bool</span> videoPlaybackComplete = <span class="keyword">true</span>;</div>
<div class="line">    <span class="keywordflow">if</span>( m_MovieVideoOutputHandler != NULL )</div>
<div class="line">        videoPlaybackComplete = m_MovieVideoOutputHandler-&gt;AllFramesRendered();</div>
<div class="line">    <span class="keywordflow">if</span>( ( videoPlaybackComplete == <span class="keyword">true</span> ) &amp;&amp; ( audioPlaybackComplete == <span class="keyword">true</span> ) )</div>
<div class="line">        m_PlaybackComplete = <span class="keyword">true</span>;</div>
<div class="line">    <span class="keywordflow">if</span>( m_PlaybackComplete == <span class="keyword">true</span> )</div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">bool</span> MovieDecoderPlayer::StartPlayback()</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">bool</span> hasSufficientAudioBuffers = <span class="keyword">true</span>;</div>
<div class="line">    <span class="keywordflow">if</span>( IsAudioDecoderCreated() )</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">if</span>( m_AudioOutputBufferReceived &lt; m_AudioOutputBufferCountToStartPlayback )</div>
<div class="line">            hasSufficientAudioBuffers = <span class="keyword">false</span>;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordtype">bool</span> hasSufficientVideoBuffers = <span class="keyword">true</span>;</div>
<div class="line">    <span class="keywordflow">if</span>( IsVideoDecoderCreated() )</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">if</span>( m_VideoOutputBufferReceived &lt; m_VideoOutputBufferCountToStartPlayback )</div>
<div class="line">            hasSufficientVideoBuffers = <span class="keyword">false</span>;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">if</span>( ( hasSufficientAudioBuffers == <span class="keyword">true</span> ) &amp;&amp; ( hasSufficientVideoBuffers == <span class="keyword">true</span> ) )</div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5">movie::Status</a> MovieDecoderPlayer::CreateThreadForVideoInputReader()</div>
<div class="line">{</div>
<div class="line">    <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5">movie::Status</a> movieStatus = <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5a578dbc51cacf7873a3e40667603e58be">movie::Status_Success</a>;</div>
<div class="line">    <a class="code" href="classnn_1_1_result.html">nn::Result</a> nnResult = <a name="_a69"></a><a class="code" href="classnn_1_1_result_success.html">nn::ResultSuccess</a>();</div>
<div class="line">    m_VideoInputReadThreadStack = aligned_alloc(<a name="a70"></a><a class="code" href="namespacenn_1_1os.html#a8b116319f3d483f3805c193661f22150">nn::os::ThreadStackAlignment</a>, m_ThreadStackSize);</div>
<div class="line">    <span class="keywordflow">if</span>( m_VideoInputReadThreadStack == NULL )</div>
<div class="line">        movieStatus = <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5a6de6894a9e777a43a2bebebd1b76667c">movie::Status_OutOfMemory</a>;</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">    {</div>
<div class="line">        m_VideoInputReadThreadDone = <span class="keyword">false</span>;</div>
<div class="line">        nnResult = <a name="a71"></a><a class="code" href="namespacenn_1_1os.html#a75f43e1d3c194c0d2173ef5d95785933">nn::os::CreateThread</a>(&amp;m_VideoInputReadThreadType,</div>
<div class="line">                &amp;VideoInputReadThreadFunction,</div>
<div class="line">                (<span class="keywordtype">void</span>*)<span class="keyword">this</span>,</div>
<div class="line">                m_VideoInputReadThreadStack,</div>
<div class="line">                m_ThreadStackSize,</div>
<div class="line">                <a name="a72"></a><a class="code" href="namespacenn_1_1os.html#a5985811d04e64c0823ed758fd420591d">nn::os::DefaultThreadPriority</a> );</div>
<div class="line">        <span class="keywordflow">if</span>( nnResult.<a class="code" href="classnn_1_1_result.html#a80792d8ec8b6b9e9b34025100baa67ec">IsSuccess</a>() )</div>
<div class="line">        {</div>
<div class="line">            <a name="a73"></a><a class="code" href="namespacenn_1_1os.html#a05cbcb85bd308694ec37eff49be93cf1">nn::os::SetThreadName</a>( &amp;m_VideoInputReadThreadType, <span class="stringliteral">&quot;VideoInputReadThread&quot;</span> );</div>
<div class="line">            m_VideoInputReadThreadCreated = <span class="keyword">true</span>;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">            movieStatus = <a name="a74"></a><a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5ab6b708bf809643033534c87f11bbf1fc">movie::Status_FailedToCreateThread</a>;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">return</span> movieStatus;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5">movie::Status</a> MovieDecoderPlayer::CreateThreadForAudioInputReader()</div>
<div class="line">{</div>
<div class="line">    <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5">movie::Status</a> movieStatus = <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5a578dbc51cacf7873a3e40667603e58be">movie::Status_Success</a>;</div>
<div class="line">    <a class="code" href="classnn_1_1_result.html">nn::Result</a> nnResult = <a class="code" href="classnn_1_1_result_success.html">nn::ResultSuccess</a>();</div>
<div class="line">    m_AudioInputReadThreadStack = aligned_alloc(<a class="code" href="namespacenn_1_1os.html#a8b116319f3d483f3805c193661f22150">nn::os::ThreadStackAlignment</a>, m_ThreadStackSize);</div>
<div class="line">    <span class="keywordflow">if</span>( m_AudioInputReadThreadStack == NULL )</div>
<div class="line">        movieStatus = <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5a6de6894a9e777a43a2bebebd1b76667c">movie::Status_OutOfMemory</a>;</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">    {</div>
<div class="line">        nnResult = <a class="code" href="namespacenn_1_1os.html#a75f43e1d3c194c0d2173ef5d95785933">nn::os::CreateThread</a>(&amp;m_AudioInputReadThreadType,</div>
<div class="line">            &amp;AudioInputReadThreadFunction,</div>
<div class="line">            ( <span class="keywordtype">void</span>* )<span class="keyword">this</span>,</div>
<div class="line">            m_AudioInputReadThreadStack,</div>
<div class="line">            m_ThreadStackSize,</div>
<div class="line">            <a class="code" href="namespacenn_1_1os.html#a5985811d04e64c0823ed758fd420591d">nn::os::DefaultThreadPriority</a>);</div>
<div class="line">        <span class="keywordflow">if</span>( nnResult.<a class="code" href="classnn_1_1_result.html#a80792d8ec8b6b9e9b34025100baa67ec">IsSuccess</a>() )</div>
<div class="line">        {</div>
<div class="line">            <a class="code" href="namespacenn_1_1os.html#a05cbcb85bd308694ec37eff49be93cf1">nn::os::SetThreadName</a>(&amp;m_AudioInputReadThreadType, <span class="stringliteral">&quot;AudioInputReadThread&quot;</span>);</div>
<div class="line">            m_AudioInputReadThreadCreated = <span class="keyword">true</span>;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">            movieStatus = <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5ab6b708bf809643033534c87f11bbf1fc">movie::Status_FailedToCreateThread</a>;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">return</span> movieStatus;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5">movie::Status</a> MovieDecoderPlayer::CreateThreadForAudioVideoWorker()</div>
<div class="line">{</div>
<div class="line">    <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5">movie::Status</a> movieStatus = <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5a578dbc51cacf7873a3e40667603e58be">movie::Status_Success</a>;</div>
<div class="line">    <a class="code" href="classnn_1_1_result.html">nn::Result</a> nnResult = <a class="code" href="classnn_1_1_result_success.html">nn::ResultSuccess</a>();</div>
<div class="line">    m_AudioVideoWorkerThreadStack = aligned_alloc(<a class="code" href="namespacenn_1_1os.html#a8b116319f3d483f3805c193661f22150">nn::os::ThreadStackAlignment</a>, m_ThreadStackSize);</div>
<div class="line">    <span class="keywordflow">if</span>( m_AudioVideoWorkerThreadStack == NULL )</div>
<div class="line">        movieStatus = <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5a6de6894a9e777a43a2bebebd1b76667c">movie::Status_OutOfMemory</a>;</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">    {</div>
<div class="line">        nnResult = <a class="code" href="namespacenn_1_1os.html#a75f43e1d3c194c0d2173ef5d95785933">nn::os::CreateThread</a>(&amp;m_AudioVideoWorkerThreadType,</div>
<div class="line">                &amp;AudioVideoWorkerThreadFunction,</div>
<div class="line">                (<span class="keywordtype">void</span>*)<span class="keyword">this</span>,</div>
<div class="line">            m_AudioVideoWorkerThreadStack,</div>
<div class="line">                m_ThreadStackSize,</div>
<div class="line">                <a class="code" href="namespacenn_1_1os.html#a5985811d04e64c0823ed758fd420591d">nn::os::DefaultThreadPriority</a> );</div>
<div class="line">        <span class="keywordflow">if</span>( nnResult.<a class="code" href="classnn_1_1_result.html#a80792d8ec8b6b9e9b34025100baa67ec">IsSuccess</a>() )</div>
<div class="line">        {</div>
<div class="line">            <a class="code" href="namespacenn_1_1os.html#a05cbcb85bd308694ec37eff49be93cf1">nn::os::SetThreadName</a>( &amp;m_AudioVideoWorkerThreadType, <span class="stringliteral">&quot;AudioVideoWorkerThread&quot;</span> );</div>
<div class="line">            m_AudioVideoWorkerThreadCreated = <span class="keyword">true</span>;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">            movieStatus = <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5ab6b708bf809643033534c87f11bbf1fc">movie::Status_FailedToCreateThread</a>;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">return</span> movieStatus;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> MovieDecoderPlayer:: StartVideoInputReaderThread()</div>
<div class="line">{</div>
<div class="line">    <a name="a75"></a><a class="code" href="namespacenn_1_1os.html#a18eec7c4c4c298f7abaa9ef41d6de76b">nn::os::StartThread</a>( &amp;m_VideoInputReadThreadType );</div>
<div class="line">    m_VideoInputReadThreadStarted = <span class="keyword">true</span>;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> MovieDecoderPlayer::StartAudioInputReaderThread()</div>
<div class="line">{</div>
<div class="line">    <a class="code" href="namespacenn_1_1os.html#a18eec7c4c4c298f7abaa9ef41d6de76b">nn::os::StartThread</a>(&amp;m_AudioInputReadThreadType);</div>
<div class="line">    m_AudioInputReadThreadStarted = <span class="keyword">true</span>;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> MovieDecoderPlayer:: StartAudioVideoWorkerThread()</div>
<div class="line">{</div>
<div class="line">    <a class="code" href="namespacenn_1_1os.html#a18eec7c4c4c298f7abaa9ef41d6de76b">nn::os::StartThread</a>( &amp;m_AudioVideoWorkerThreadType );</div>
<div class="line">    m_AudioVideoWorkerThreadStarted = <span class="keyword">true</span>;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> MovieDecoderPlayer:: StopAndDestroyVideoInputReaderThread()</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">if</span>( m_VideoInputReadThreadCreated == <span class="keyword">true</span> )</div>
<div class="line">    {</div>
<div class="line">        m_VideoInputReadThreadDone = <span class="keyword">true</span>;</div>
<div class="line">        <span class="keywordflow">if</span>( m_VideoInputReadThreadStarted == <span class="keyword">true</span> )</div>
<div class="line">        {</div>
<div class="line">            SignalVideoInputReadThreadExit();</div>
<div class="line">            <a name="a76"></a><a class="code" href="namespacenn_1_1os.html#a8070c91be85c5ccb36b56e9ff3a75b26">nn::os::WaitThread</a>(&amp;m_VideoInputReadThreadType);</div>
<div class="line">        }</div>
<div class="line">        <a name="a77"></a><a class="code" href="namespacenn_1_1os.html#a9dbfcfb82583a9e34431e8c11d2411dd">nn::os::DestroyThread</a>( &amp;m_VideoInputReadThreadType );</div>
<div class="line">        m_VideoInputReadThreadCreated = <span class="keyword">false</span>;</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> MovieDecoderPlayer::StopAndDestroyAudioInputReaderThread()</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">if</span>( m_AudioInputReadThreadCreated == <span class="keyword">true</span> )</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">if</span>( m_AudioInputReadThreadStarted == <span class="keyword">true</span> )</div>
<div class="line">        {</div>
<div class="line">            SignalAudioInputReadThreadExit();</div>
<div class="line">            <a class="code" href="namespacenn_1_1os.html#a8070c91be85c5ccb36b56e9ff3a75b26">nn::os::WaitThread</a>(&amp;m_AudioInputReadThreadType);</div>
<div class="line">        }</div>
<div class="line">        <a class="code" href="namespacenn_1_1os.html#a9dbfcfb82583a9e34431e8c11d2411dd">nn::os::DestroyThread</a>(&amp;m_AudioInputReadThreadType);</div>
<div class="line">        m_AudioInputReadThreadCreated = <span class="keyword">false</span>;</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> MovieDecoderPlayer:: StopAndDestroyAudioVideoWorkerThread()</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">if</span>( m_AudioVideoWorkerThreadCreated == <span class="keyword">true</span> )</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">if</span>( m_AudioVideoWorkerThreadStarted == <span class="keyword">true</span> )</div>
<div class="line">        {</div>
<div class="line">            SignalAudioVideoWorkerThreadExit();</div>
<div class="line">            <a class="code" href="namespacenn_1_1os.html#a8070c91be85c5ccb36b56e9ff3a75b26">nn::os::WaitThread</a>(&amp;m_AudioVideoWorkerThreadType);</div>
<div class="line">        }</div>
<div class="line">        <a class="code" href="namespacenn_1_1os.html#a9dbfcfb82583a9e34431e8c11d2411dd">nn::os::DestroyThread</a>( &amp;m_AudioVideoWorkerThreadType );</div>
<div class="line">        m_AudioVideoWorkerThreadCreated = <span class="keyword">false</span>;</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5">movie::Status</a> MovieDecoderPlayer::CreateAudioVideoRenderer()</div>
<div class="line">{</div>
<div class="line">    <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5">movie::Status</a> movieStatus = <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5a578dbc51cacf7873a3e40667603e58be">movie::Status_Success</a>;</div>
<div class="line">    <span class="keywordflow">if</span>( IsAudioDecoderCreated() )</div>
<div class="line">    {</div>
<div class="line">        m_MovieAudioOutputHandler = <span class="keyword">new</span> MovieAudioOutputHandler();</div>
<div class="line">        <span class="keywordflow">if</span>( m_MovieAudioOutputHandler == NULL )</div>
<div class="line">        {</div>
<div class="line">            movieStatus = <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5a6de6894a9e777a43a2bebebd1b76667c">movie::Status_OutOfMemory</a>;</div>
<div class="line">            <span class="keywordflow">return</span> movieStatus;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">if</span>( IsVideoDecoderCreated() )</div>
<div class="line">    {</div>
<div class="line">        m_MovieVideoOutputHandler = <span class="keyword">new</span> MovieVideoOutputHandler(<span class="keyword">nullptr</span>, m_VideoDecoderMode, m_VideoDecoderOutputFormat);</div>
<div class="line">        <span class="keywordflow">if</span>( m_MovieVideoOutputHandler == NULL )</div>
<div class="line">            movieStatus = <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5a6de6894a9e777a43a2bebebd1b76667c">movie::Status_OutOfMemory</a>;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">return</span> movieStatus;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> MovieDecoderPlayer::StopAudioVideoRenderer()</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">if</span>( m_MovieAudioOutputHandler != NULL )</div>
<div class="line">    {</div>
<div class="line">        m_MovieAudioOutputHandler-&gt;Stop();</div>
<div class="line">        m_MovieAudioOutputHandler-&gt;Close();</div>
<div class="line">        m_MovieAudioOutputHandler-&gt;Finalize();</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">if</span>( m_MovieVideoOutputHandler != NULL )</div>
<div class="line">    {</div>
<div class="line">        m_MovieVideoOutputHandler-&gt;Stop();</div>
<div class="line">        m_MovieVideoOutputHandler-&gt;Close();</div>
<div class="line">        m_MovieVideoOutputHandler-&gt;Finalize();</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> MovieDecoderPlayer::DestroypAudioVideoRenderer()</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">if</span>( m_MovieAudioOutputHandler != NULL )</div>
<div class="line">        <span class="keyword">delete</span> m_MovieAudioOutputHandler;</div>
<div class="line">    <span class="keywordflow">if</span>( m_MovieVideoOutputHandler != NULL )</div>
<div class="line">        <span class="keyword">delete</span> m_MovieVideoOutputHandler;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5">movie::Status</a> MovieDecoderPlayer::CreateExtractor(<span class="keyword">const</span> <span class="keywordtype">char</span>* uri, <a class="code" href="namespacemovie.html#ab5ee2cf437465786112d30f8a80bb979">movie::ContainerType</a> container, <a name="_a78"></a><a class="code" href="classmovie_1_1_extractor.html">movie::Extractor</a>** extractor, <a name="_a79"></a><a class="code" href="classmovie_1_1_client_stream_reader.html">movie::ClientStreamReader</a> **clientReader)</div>
<div class="line">{</div>
<div class="line">    <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5">movie::Status</a> movieStatus = <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5a578dbc51cacf7873a3e40667603e58be">movie::Status_Success</a>;</div>
<div class="line">    <span class="comment">// Creates Extractor with an internal data cache of default size (movie::CacheSize_20MB)</span></div>
<div class="line">    <span class="comment">// Data cache size can be set by creating extractor using a constructor which takes cache size as input parameter</span></div>
<div class="line">    <span class="comment">// Example: Create an extractor for mp4 container type with 10MB of cache</span></div>
<div class="line">    <span class="comment">// movie::Extractor* movieExtractor = new movie::Extractor(movie::ContainerType_Mpeg4, movie::CacheSize_10MB);</span></div>
<div class="line">    std::unique_ptr&lt;movie::Extractor&gt; movieExtractor{ <span class="keyword">new</span> <a class="code" href="classmovie_1_1_extractor.html">movie::Extractor</a>(container) };</div>
<div class="line">    <span class="keywordflow">if</span>( movieExtractor == NULL )</div>
<div class="line">    {</div>
<div class="line">        *extractor = NULL;</div>
<div class="line">        movieStatus = <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5a6de6894a9e777a43a2bebebd1b76667c">movie::Status_OutOfMemory</a>;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">    {</div>
<div class="line">        <a class="code" href="structnn_1_1fs_1_1_file_handle.html">nn::fs::FileHandle</a> fileHandle;</div>
<div class="line">        fileHandle.handle = NULL;</div>
<div class="line">        <a class="code" href="classnn_1_1_result.html">nn::Result</a> result = <a class="code" href="namespacenn_1_1fs.html#a0f2b5b30657b1ffaf1dec49bfb36462b">nn::fs::OpenFile</a>(&amp;fileHandle, uri, <a class="code" href="namespacenn_1_1fs.html#a4c97b79cce78a95c2333dbc9053b9393afde4472d2b455879cad02aade386ac0d">nn::fs::OpenMode_Read</a>);</div>
<div class="line">        <span class="keywordflow">if</span>( result.<a class="code" href="classnn_1_1_result.html#a5d119d9cb4918fc3cd09215437b91c13">IsFailure</a>() )</div>
<div class="line">        {</div>
<div class="line">            NN_SDK_LOG(<span class="stringliteral">&quot;\n Failed to open %s \n \n Terminating PlayerSample MediaDecoderPlayer\n&quot;</span>, uri);</div>
<div class="line">            DestroyExtractor(movieExtractor.release());</div>
<div class="line">            movieStatus = <a name="a80"></a><a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5a165b5a3eba27110e76d741b5060f240e">movie::Status_NotFound</a>;</div>
<div class="line">            <span class="keywordflow">return</span> movieStatus;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">            <a class="code" href="namespacenn_1_1fs.html#ac8bd9e828751bd4f953acfa765278f84">nn::fs::CloseFile</a>(fileHandle);</div>
<div class="line">        <a class="code" href="classmovie_1_1_client_stream_reader.html">movie::ClientStreamReader</a>* movieClientReader = <span class="keyword">new</span> StreamReader();</div>
<div class="line">        <span class="keywordflow">if</span>( movieClientReader == NULL )</div>
<div class="line">        {</div>
<div class="line">            movieStatus = <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5a6de6894a9e777a43a2bebebd1b76667c">movie::Status_OutOfMemory</a>;</div>
<div class="line">            *clientReader = NULL;</div>
<div class="line">            <span class="keywordflow">return</span> movieStatus;</div>
<div class="line">        }</div>
<div class="line">        movieStatus = movieExtractor-&gt;SetDataSource(movieClientReader, uri);</div>
<div class="line">        <span class="keywordflow">if</span>( movieStatus == <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5a578dbc51cacf7873a3e40667603e58be">movie::Status_Success</a> )</div>
<div class="line">        {</div>
<div class="line">            m_Tracks = 0;</div>
<div class="line">            movieStatus = movieExtractor-&gt;GetTrackCount(&amp;m_Tracks);</div>
<div class="line">            <span class="keywordflow">if</span>( movieStatus == <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5a578dbc51cacf7873a3e40667603e58be">movie::Status_Success</a> )</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">if</span>( m_Tracks &lt;= 0 )</div>
<div class="line">                    movieStatus = <a name="a81"></a><a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5a1c929a653b48e397b01a6e78cda0903c">movie::Status_TrackNotFound</a>;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">        *extractor = movieExtractor.release();</div>
<div class="line">        *clientReader = movieClientReader;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">return</span> movieStatus;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5">movie::Status</a> MovieDecoderPlayer::CreateDecoder(<a name="_a82"></a><a class="code" href="classmovie_1_1_decoder.html">movie::Decoder</a>** decoder, <a class="code" href="namespacemovie.html#a13e52fd4ee5ac91b6966c5afb314373c">movie::DecoderType</a> decoderType, <a class="code" href="namespacemovie.html#a3d945ea69005414e3972a5a6693ed37e">movie::DecoderMode</a> decoderMode, <a class="code" href="namespacemovie.html#ac02fee064f0db5847a949db9245d1723">movie::DecoderOutputFormat</a> decoderOutputFormat)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">if</span>( decoder == NULL )</div>
<div class="line">        <span class="keywordflow">return</span> <a name="a83"></a><a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5a6e3c56816bf1f3f692a28461f418c58a">movie::Status_ErrorBadValue</a>;</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">if</span>( <span class="keyword">true</span> == IsAudioDecoder(decoderType) )</div>
<div class="line">        {</div>
<div class="line">            m_AudioDecoderMode = decoderMode;</div>
<div class="line">            m_AudioDecoderOutputFormat = decoderOutputFormat;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span>( <span class="keyword">true</span> == IsVideoDecoder(decoderType) )</div>
<div class="line">        {</div>
<div class="line">            m_VideoDecoderMode = decoderMode;</div>
<div class="line">            m_VideoDecoderOutputFormat = decoderOutputFormat;</div>
<div class="line">        }</div>
<div class="line">        <a class="code" href="classmovie_1_1_decoder.html">movie::Decoder</a>* movieDecoder = <span class="keyword">new</span> <a class="code" href="classmovie_1_1_decoder.html">movie::Decoder</a>(decoderType, decoderOutputFormat, decoderMode);</div>
<div class="line">        <span class="keywordflow">if</span>( movieDecoder == NULL )</div>
<div class="line">        {</div>
<div class="line">            *decoder = NULL;</div>
<div class="line">            <span class="keywordflow">return</span> <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5a6de6894a9e777a43a2bebebd1b76667c">movie::Status_OutOfMemory</a>;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">        {</div>
<div class="line">            *decoder = movieDecoder;</div>
<div class="line">            <span class="keywordflow">return</span> <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5a578dbc51cacf7873a3e40667603e58be">movie::Status_Success</a>;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5">movie::Status</a> MovieDecoderPlayer::ConfigureDecoder(<a class="code" href="classmovie_1_1_decoder.html">movie::Decoder</a>* decoder, <a name="_a84"></a><a class="code" href="structmovie_1_1_decoder_events.html">movie::DecoderEvents</a>* decoderEvents, <a class="code" href="classmovie_1_1_media_data.html">movie::MediaData</a>* configuration)</div>
<div class="line">{</div>
<div class="line">    <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5">movie::Status</a> movieStatus = <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5a819d55a4ad4bd1ac42bc65771cdc6792">movie::Status_UnknownError</a>;</div>
<div class="line">    <span class="keywordflow">if</span>( decoder == NULL )</div>
<div class="line">        <span class="keywordflow">return</span> <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5a6e3c56816bf1f3f692a28461f418c58a">movie::Status_ErrorBadValue</a>;</div>
<div class="line">    movieStatus = decoder-&gt;<a name="a85"></a><a class="code" href="classmovie_1_1_decoder.html#a47a49a43086eb80e558d4ba171a74c00">RegisterClientEvents</a>(decoderEvents);</div>
<div class="line">    <span class="keywordflow">if</span>( movieStatus == <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5a578dbc51cacf7873a3e40667603e58be">movie::Status_Success</a> )</div>
<div class="line">        movieStatus = decoder-&gt;<a name="a86"></a><a class="code" href="classmovie_1_1_decoder.html#a944ade387d0de8b7fb358981520271ac">Configure</a>(configuration);</div>
<div class="line">    <span class="keywordflow">return</span> movieStatus;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5">movie::Status</a> MovieDecoderPlayer::StartDecoder(<a class="code" href="classmovie_1_1_decoder.html">movie::Decoder</a>* decoder)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">if</span>( decoder == NULL )</div>
<div class="line">        <span class="keywordflow">return</span> <a name="a87"></a><a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5acf2611bc7af8725ad0a8c2e396325f7d">movie::Status_NullDecoder</a>;</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">        <span class="keywordflow">return</span> decoder-&gt;<a name="a88"></a><a class="code" href="classmovie_1_1_decoder.html#a8ccd0573d0c1564ca61ded0a3b5c7d70">Start</a>();</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5">movie::Status</a> MovieDecoderPlayer::StopDecoder(<a class="code" href="classmovie_1_1_decoder.html">movie::Decoder</a>* decoder)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">if</span>( decoder == NULL )</div>
<div class="line">        <span class="keywordflow">return</span> <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5acf2611bc7af8725ad0a8c2e396325f7d">movie::Status_NullDecoder</a>;</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">        <span class="keywordflow">return</span> decoder-&gt;<a name="a89"></a><a class="code" href="classmovie_1_1_decoder.html#a577023b841484fd29ce2321748082b00">Stop</a>();</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5">movie::Status</a> MovieDecoderPlayer::FlushDecoder(<a class="code" href="classmovie_1_1_decoder.html">movie::Decoder</a>* decoder)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">if</span>( decoder == NULL )</div>
<div class="line">        <span class="keywordflow">return</span> <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5acf2611bc7af8725ad0a8c2e396325f7d">movie::Status_NullDecoder</a>;</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">        <span class="keywordflow">return</span> decoder-&gt;<a name="a90"></a><a class="code" href="classmovie_1_1_decoder.html#affb6f4d8d34c744c93730fb90f2214ee">Flush</a>();</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> MovieDecoderPlayer::DestroyDecoder(<a class="code" href="classmovie_1_1_decoder.html">movie::Decoder</a>* decoder)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">if</span>( decoder != NULL )</div>
<div class="line">        <span class="keyword">delete</span> decoder;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5">movie::Status</a> MovieDecoderPlayer::CreateDecoders(<a class="code" href="classmovie_1_1_extractor.html">movie::Extractor</a>*  extractor,</div>
<div class="line">    <a class="code" href="namespacemovie.html#a3d945ea69005414e3972a5a6693ed37e">movie::DecoderMode</a> audioDecoderMode,</div>
<div class="line">    <a class="code" href="namespacemovie.html#ac02fee064f0db5847a949db9245d1723">movie::DecoderOutputFormat</a> audioDecoderOutputFormat,</div>
<div class="line">    <a class="code" href="namespacemovie.html#a3d945ea69005414e3972a5a6693ed37e">movie::DecoderMode</a> videoDecoderMode,</div>
<div class="line">    <a class="code" href="namespacemovie.html#ac02fee064f0db5847a949db9245d1723">movie::DecoderOutputFormat</a> videoDecoderOutputFormat)</div>
<div class="line">{</div>
<div class="line">    <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5">movie::Status</a> movieStatus = <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5a578dbc51cacf7873a3e40667603e58be">movie::Status_Success</a>;</div>
<div class="line">    <a class="code" href="classmovie_1_1_media_data.html">movie::MediaData</a> trackFormat;</div>
<div class="line">    <span class="keywordflow">if</span>( extractor == NULL )</div>
<div class="line">        movieStatus = <a name="a91"></a><a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5a58298d28726396655a2c3353e3619466">movie::Status_NullExtractor</a>;</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">for</span>( <span class="keywordtype">int</span> i = 0; i &lt; m_Tracks; i ++ )</div>
<div class="line">        {</div>
<div class="line">            <a class="code" href="namespacemovie.html#a13e52fd4ee5ac91b6966c5afb314373c">movie::DecoderType</a> decoderType = movie::DecoderType::DecoderType_Unknown;</div>
<div class="line">            extractor-&gt;<a name="a92"></a><a class="code" href="classmovie_1_1_extractor.html#ae1185be7850eeffad8858742e4731cc2">GetTrackConfiguration</a>(i, &amp;trackFormat);</div>
<div class="line">            <span class="keyword">const</span> <span class="keywordtype">char</span> *mime;</div>
<div class="line">            <span class="keywordflow">if</span>( trackFormat.<a name="a93"></a><a class="code" href="classmovie_1_1_media_data.html#afbe5d7d4037c346b252a58b1a82a7204">FindString</a>(<span class="stringliteral">&quot;mime&quot;</span>, &amp;mime) )</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">if</span>( ( !strncasecmp(<span class="stringliteral">&quot;video/&quot;</span>, mime, 6) ) &amp;&amp; ( m_VideoDecoder == NULL) )</div>
<div class="line">                {</div>
<div class="line">                    <span class="keywordflow">if</span>( !strncasecmp(<span class="stringliteral">&quot;video/avc&quot;</span>, mime, 9) )</div>
<div class="line">                        decoderType = <a class="code" href="namespacemovie.html#a13e52fd4ee5ac91b6966c5afb314373cab217d89283577ce5f43ca1a91a6218fa">movie::DecoderType_VideoAvc</a>;</div>
<div class="line">                    <span class="keywordflow">else</span> <span class="keywordflow">if</span>( !strncasecmp(<span class="stringliteral">&quot;video/x-vnd.on2.vp8&quot;</span>, mime, 19) )</div>
<div class="line">                        decoderType = <a class="code" href="namespacemovie.html#a13e52fd4ee5ac91b6966c5afb314373ca1313bb0e49ad71e6828ec8ade6003d4e">movie::DecoderType_VideoVp8</a>;</div>
<div class="line">                    <span class="keywordflow">else</span> <span class="keywordflow">if</span>( !strncasecmp(<span class="stringliteral">&quot;video/x-vnd.on2.vp9&quot;</span>, mime, 19) )</div>
<div class="line">                        decoderType = <a class="code" href="namespacemovie.html#a13e52fd4ee5ac91b6966c5afb314373ca3596c2d49a5a2c15cd3165b45055accd">movie::DecoderType_VideoVp9</a>;</div>
<div class="line">                    movieStatus = CreateDecoder(&amp;m_VideoDecoder, decoderType, videoDecoderMode, videoDecoderOutputFormat);</div>
<div class="line">                    <span class="keywordflow">if</span>( movieStatus == <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5a578dbc51cacf7873a3e40667603e58be">movie::Status_Success</a> )</div>
<div class="line">                    {</div>
<div class="line">                        movieStatus = ConfigureDecoder(m_VideoDecoder, &amp;m_VideoDecoderEvents, &amp;trackFormat);</div>
<div class="line">                        <span class="keywordflow">if</span>( movieStatus == <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5a578dbc51cacf7873a3e40667603e58be">movie::Status_Success</a> )</div>
<div class="line">                        {</div>
<div class="line">                            m_VideoTrackIndex = i;</div>
<div class="line">                            int32_t width = 0;</div>
<div class="line">                            int32_t height = 0;</div>
<div class="line">                            trackFormat.<a name="a94"></a><a class="code" href="classmovie_1_1_media_data.html#a411b32acf9d22f3e6921563401c377fc">FindInt32</a>(<span class="stringliteral">&quot;width&quot;</span>, &amp;width);</div>
<div class="line">                            m_Width = width;</div>
<div class="line">                            trackFormat.<a class="code" href="classmovie_1_1_media_data.html#a411b32acf9d22f3e6921563401c377fc">FindInt32</a>(<span class="stringliteral">&quot;height&quot;</span>, &amp;height);</div>
<div class="line">                            m_Height = height;</div>
<div class="line">                            int32_t outSize = 0;</div>
<div class="line">                            int32_t outalign = 0;</div>
<div class="line">                            int32_t videoFrameRate = 0;</div>
<div class="line">                            trackFormat.<a class="code" href="classmovie_1_1_media_data.html#a411b32acf9d22f3e6921563401c377fc">FindInt32</a>(<span class="stringliteral">&quot;frame-rate&quot;</span>, &amp;videoFrameRate);</div>
<div class="line">                            <span class="keywordflow">if</span>( videoFrameRate &gt; 0 )</div>
<div class="line">                                m_VideoFrameRate = videoFrameRate;</div>
<div class="line">                            <span class="keywordflow">else</span></div>
<div class="line">                                m_VideoFrameRate = 60;</div>
<div class="line">                            m_VideoDecoder-&gt;GetOutputBufferSize(&amp;outSize, &amp;outalign);</div>
<div class="line">                            movieStatus = extractor-&gt;<a name="a95"></a><a class="code" href="classmovie_1_1_extractor.html#ae316072526a3e2b6c314ba60f9ac4a5d">SelectTrack</a>(i);</div>
<div class="line">                            m_VideoDecoderCreated = <span class="keyword">true</span>;</div>
<div class="line">                            m_VideoDecoderType = decoderType;</div>
<div class="line">                            ResetVideoDecodeComplete();</div>
<div class="line">                            NN_SDK_LOG( <span class="stringliteral">&quot;\n Video decoder created \n&quot;</span> );</div>
<div class="line">                        }</div>
<div class="line">                        <span class="keywordflow">else</span></div>
<div class="line">                        {</div>
<div class="line">                            <span class="keyword">delete</span> m_VideoDecoder;</div>
<div class="line">                            m_VideoDecoder = NULL;</div>
<div class="line">                        }</div>
<div class="line">                    }</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">if</span>( ( !strncasecmp(<span class="stringliteral">&quot;audio/&quot;</span>, mime, 6) ) &amp;&amp; ( m_AudioDecoder == NULL) )</div>
<div class="line">                {</div>
<div class="line">                    <span class="keywordflow">if</span>( !strncasecmp(<span class="stringliteral">&quot;audio/mp4a-latm&quot;</span>, mime, 15) )</div>
<div class="line">                        decoderType = <a name="a96"></a><a class="code" href="namespacemovie.html#a13e52fd4ee5ac91b6966c5afb314373ca949b76f8cf9e591b7abeb365d7776eae">movie::DecoderType_AudioAac</a>;</div>
<div class="line">                    <span class="keywordflow">else</span> <span class="keywordflow">if</span>( !strncasecmp(<span class="stringliteral">&quot;audio/vorbis&quot;</span>, mime, 12) )</div>
<div class="line">                        decoderType = <a name="a97"></a><a class="code" href="namespacemovie.html#a13e52fd4ee5ac91b6966c5afb314373caf7aa15d900e0dced6523112f0dec9cd7">movie::DecoderType_AudioVorbis</a>;</div>
<div class="line">                    int32_t sampleRate = 0;</div>
<div class="line">                    trackFormat.<a class="code" href="classmovie_1_1_media_data.html#a411b32acf9d22f3e6921563401c377fc">FindInt32</a>(<span class="stringliteral">&quot;sample-rate&quot;</span>, &amp;sampleRate);</div>
<div class="line">                    m_SampleRate = sampleRate;</div>
<div class="line">                    int32_t numChannels = 0;</div>
<div class="line">                    trackFormat.<a class="code" href="classmovie_1_1_media_data.html#a411b32acf9d22f3e6921563401c377fc">FindInt32</a>(<span class="stringliteral">&quot;channel-count&quot;</span>, &amp;numChannels);</div>
<div class="line">                    m_NumChannels = numChannels;</div>
<div class="line">                    <span class="keywordflow">if</span>( ( sampleRate &gt;= 16000 ) &amp;&amp; ( numChannels &lt;= 6) )</div>
<div class="line">                    {</div>
<div class="line">                        movieStatus = CreateDecoder(&amp;m_AudioDecoder, decoderType, audioDecoderMode, audioDecoderOutputFormat);</div>
<div class="line">                        <span class="keywordflow">if</span>( movieStatus == <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5a578dbc51cacf7873a3e40667603e58be">movie::Status_Success</a> )</div>
<div class="line">                        {</div>
<div class="line">                            movieStatus = ConfigureDecoder(m_AudioDecoder, &amp;m_AudioDecoderEvents, &amp;trackFormat);</div>
<div class="line">                            <span class="keywordflow">if</span>( movieStatus == <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5a578dbc51cacf7873a3e40667603e58be">movie::Status_Success</a> )</div>
<div class="line">                            {</div>
<div class="line">                                m_AudioTrackIndex = i;</div>
<div class="line">                                int32_t outSize = 0;</div>
<div class="line">                                int32_t outalign = 0;</div>
<div class="line">                                m_AudioDecoder-&gt;GetOutputBufferSize(&amp;outSize, &amp;outalign);</div>
<div class="line">                                movieStatus = extractor-&gt;<a class="code" href="classmovie_1_1_extractor.html#ae316072526a3e2b6c314ba60f9ac4a5d">SelectTrack</a>(i);</div>
<div class="line">                                m_AudioDecoderCreated = <span class="keyword">true</span>;</div>
<div class="line">                                m_AudioDecoderType = decoderType;</div>
<div class="line">                                ResetAudioDecodeComplete();</div>
<div class="line">                                NN_SDK_LOG(<span class="stringliteral">&quot;\n Audio decoder created \n&quot;</span>);</div>
<div class="line">                            }</div>
<div class="line">                        }</div>
<div class="line">                    }</div>
<div class="line">                    <span class="keywordflow">else</span></div>
<div class="line">                    {</div>
<div class="line">                        <span class="keywordflow">if</span>( numChannels &gt; 6 )</div>
<div class="line">                        {</div>
<div class="line">                            NN_SDK_LOG(<span class="stringliteral">&quot;\n This media file has audio track with %d channels, &quot;</span>, numChannels);</div>
<div class="line">                            NN_SDK_LOG(<span class="stringliteral">&quot; MovieDecodePlayer Sample supports up to 5.1 (6) channels for audio playback \n&quot;</span>);</div>
<div class="line">                        }</div>
<div class="line">                        <span class="keywordflow">if</span>( sampleRate &lt; 16000 )</div>
<div class="line">                        {</div>
<div class="line">                            NN_SDK_LOG(<span class="stringliteral">&quot;\n This media file has audio track with %d Hz Sample rate, &quot;</span>, sampleRate);</div>
<div class="line">                            NN_SDK_LOG(<span class="stringliteral">&quot; MovieDecodePlayer Sample does not supports sample rate lower than 16 KHz for audio playback \n&quot;</span>);</div>
<div class="line">                        }</div>
<div class="line">                        movieStatus = <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5a819d55a4ad4bd1ac42bc65771cdc6792">movie::Status_UnknownError</a>;</div>
<div class="line">                    }</div>
<div class="line">                    <span class="keywordflow">if</span>( movieStatus != <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5a578dbc51cacf7873a3e40667603e58be">movie::Status_Success</a> )</div>
<div class="line">                    {</div>
<div class="line">                        m_AudioDecoderType = movie::DecoderType::DecoderType_Unknown;</div>
<div class="line">                        m_AudioDecoderCreated = <span class="keyword">false</span>;</div>
<div class="line">                        <span class="keyword">delete</span> m_AudioDecoder;</div>
<div class="line">                        m_AudioDecoder = NULL;</div>
<div class="line">                    }</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">            m_TrackFormat.push_back(trackFormat);</div>
<div class="line">            trackFormat.<a name="a98"></a><a class="code" href="classmovie_1_1_media_data.html#a196c88834858be094dba17270e7a3249">Clear</a>();</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">if</span>( ( m_AudioDecoder == NULL ) &amp;&amp; ( m_VideoDecoder == NULL ) )</div>
<div class="line">        movieStatus = <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5a819d55a4ad4bd1ac42bc65771cdc6792">movie::Status_UnknownError</a>;</div>
<div class="line">    <span class="keywordflow">return</span> movieStatus;</div>
<div class="line">}<span class="comment">//NOLINT(impl/function_size)</span></div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> MovieDecoderPlayer::DestroyExtractor(<a class="code" href="classmovie_1_1_extractor.html">movie::Extractor</a>* extractor )</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">if</span>( extractor != NULL )</div>
<div class="line">        <span class="keyword">delete</span> extractor;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5">movie::Status</a> MovieDecoderPlayer::AddBufferToAudioIndexList(int32_t bufferIndex)</div>
<div class="line">{</div>
<div class="line">    <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5">movie::Status</a> movieStatus = <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5a578dbc51cacf7873a3e40667603e58be">movie::Status_Success</a>;</div>
<div class="line">    <a name="a99"></a><a class="code" href="namespacenn_1_1os.html#a8d4678856d87c3faea21f47ced342bb6">nn::os::LockMutex</a>( &amp;m_AudioListMutex );</div>
<div class="line">    m_AudioBufferIndexList.push_back(bufferIndex);</div>
<div class="line">    <a name="a100"></a><a class="code" href="namespacenn_1_1os.html#aa661a7036a18c378a694ad67941cd75e">nn::os::UnlockMutex</a>( &amp;m_AudioListMutex );</div>
<div class="line">    <span class="keywordflow">return</span> movieStatus;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5">movie::Status</a> MovieDecoderPlayer::RemoveBufferFromAudioIndexList(int32_t* bufferIndex)</div>
<div class="line">{</div>
<div class="line">    <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5">movie::Status</a> movieStatus = <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5a578dbc51cacf7873a3e40667603e58be">movie::Status_Success</a>;</div>
<div class="line">    <a class="code" href="namespacenn_1_1os.html#a8d4678856d87c3faea21f47ced342bb6">nn::os::LockMutex</a>( &amp;m_AudioListMutex );</div>
<div class="line">    int32_t index = -1;</div>
<div class="line">    <span class="keywordflow">if</span>( m_AudioBufferIndexList.size() &gt; 0 )</div>
<div class="line">    {</div>
<div class="line">        index = m_AudioBufferIndexList.front();</div>
<div class="line">        m_AudioBufferIndexList.erase(m_AudioBufferIndexList.begin());</div>
<div class="line">    }</div>
<div class="line">    *bufferIndex = index;</div>
<div class="line">    <a class="code" href="namespacenn_1_1os.html#aa661a7036a18c378a694ad67941cd75e">nn::os::UnlockMutex</a>( &amp;m_AudioListMutex );</div>
<div class="line">    <span class="keywordflow">return</span> movieStatus;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5">movie::Status</a> MovieDecoderPlayer::GetAudioIndexListSize(int32_t* indexListSize)</div>
<div class="line">{</div>
<div class="line">    <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5">movie::Status</a> movieStatus = <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5a578dbc51cacf7873a3e40667603e58be">movie::Status_Success</a>;</div>
<div class="line">    <a class="code" href="namespacenn_1_1os.html#a8d4678856d87c3faea21f47ced342bb6">nn::os::LockMutex</a>(&amp;m_AudioListMutex);</div>
<div class="line">    *indexListSize = m_AudioBufferIndexList.size();</div>
<div class="line">    <a class="code" href="namespacenn_1_1os.html#aa661a7036a18c378a694ad67941cd75e">nn::os::UnlockMutex</a>(&amp;m_AudioListMutex);</div>
<div class="line">    <span class="keywordflow">return</span> movieStatus;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5">movie::Status</a> MovieDecoderPlayer::GetVideoIndexListSize(int32_t* indexListSize)</div>
<div class="line">{</div>
<div class="line">    <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5">movie::Status</a> movieStatus = <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5a578dbc51cacf7873a3e40667603e58be">movie::Status_Success</a>;</div>
<div class="line">    <a class="code" href="namespacenn_1_1os.html#a8d4678856d87c3faea21f47ced342bb6">nn::os::LockMutex</a>(&amp;m_VideoListMutex);</div>
<div class="line">    *indexListSize = m_VideoBufferIndexList.size();</div>
<div class="line">    <a class="code" href="namespacenn_1_1os.html#aa661a7036a18c378a694ad67941cd75e">nn::os::UnlockMutex</a>(&amp;m_VideoListMutex);</div>
<div class="line">    <span class="keywordflow">return</span> movieStatus;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5">movie::Status</a> MovieDecoderPlayer::AddBufferToVideoIndexList(int32_t bufferIndex)</div>
<div class="line">{</div>
<div class="line">    <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5">movie::Status</a> movieStatus = <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5a578dbc51cacf7873a3e40667603e58be">movie::Status_Success</a>;</div>
<div class="line">    <a class="code" href="namespacenn_1_1os.html#a8d4678856d87c3faea21f47ced342bb6">nn::os::LockMutex</a>( &amp;m_VideoListMutex );</div>
<div class="line">    m_VideoBufferIndexList.push_back(bufferIndex);</div>
<div class="line">    <a class="code" href="namespacenn_1_1os.html#aa661a7036a18c378a694ad67941cd75e">nn::os::UnlockMutex</a>( &amp;m_VideoListMutex );</div>
<div class="line">    <span class="keywordflow">return</span> movieStatus;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5">movie::Status</a> MovieDecoderPlayer::RemoveBufferFromVideoIndexList(int32_t* bufferIndex)</div>
<div class="line">{</div>
<div class="line">    <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5">movie::Status</a> movieStatus = <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5a578dbc51cacf7873a3e40667603e58be">movie::Status_Success</a>;</div>
<div class="line">    <a class="code" href="namespacenn_1_1os.html#a8d4678856d87c3faea21f47ced342bb6">nn::os::LockMutex</a>( &amp;m_VideoListMutex );</div>
<div class="line">    int32_t index = -1;</div>
<div class="line">    <span class="keywordflow">if</span>( m_VideoBufferIndexList.size() &gt; 0 )</div>
<div class="line">    {</div>
<div class="line">        index = m_VideoBufferIndexList.front();</div>
<div class="line">        m_VideoBufferIndexList.erase(m_VideoBufferIndexList.begin());</div>
<div class="line">    }</div>
<div class="line">    *bufferIndex = index;</div>
<div class="line">    <a class="code" href="namespacenn_1_1os.html#aa661a7036a18c378a694ad67941cd75e">nn::os::UnlockMutex</a>( &amp;m_VideoListMutex );</div>
<div class="line">    <span class="keywordflow">return</span> movieStatus;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5">movie::Status</a> MovieDecoderPlayer::ReadInputDataFromExtractorSendTodecoder(ByteStreamReader* byteStreamReader, <span class="keywordtype">int</span> index, <a class="code" href="classmovie_1_1_decoder.html">movie::Decoder</a>* decoder)</div>
<div class="line">{</div>
<div class="line">    <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5">movie::Status</a> movieStatus = <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5a578dbc51cacf7873a3e40667603e58be">movie::Status_Success</a>;</div>
<div class="line">    <a name="_a101"></a><a class="code" href="classmovie_1_1_buffer.html">movie::Buffer</a> buffer;</div>
<div class="line">    uint32_t flags = <a name="a102"></a><a class="code" href="namespacemovie.html#ab01293acfd248b32f8a2b5d310635eaca14b5b0581b8cf6975aa9ac42bd9317fe">movie::BufferFlags_None</a>;</div>
<div class="line">    int64_t presentationTimeUs = 0;</div>
<div class="line">    decoder-&gt;<a name="a103"></a><a class="code" href="classmovie_1_1_decoder.html#ae711ed8a0f2814aaaa4e4c11fcdd7c0e">GetInputBuffer</a>(index, &amp;buffer);</div>
<div class="line">    int32_t frameDataSize = 0;</div>
<div class="line"></div>
<div class="line">    movieStatus = byteStreamReader-&gt;ReadNextFrame((<span class="keywordtype">char</span>*)buffer.<a name="a104"></a><a class="code" href="classmovie_1_1_buffer.html#ad3416b750611c829f5f7ed27a8a497fa">Base</a>(), buffer.<a name="a105"></a><a class="code" href="classmovie_1_1_buffer.html#aab5e70c2ddb941a1b687a8dc29221dc7">Capacity</a>(), &amp;frameDataSize, &amp;presentationTimeUs);</div>
<div class="line">    <span class="keywordflow">if</span>( movieStatus == <a name="a106"></a><a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5a7e5d9e91d2e94737185fe49c47a607a7">movie::Status_EndOfStream</a> )</div>
<div class="line">    {</div>
<div class="line">        flags = <a name="a107"></a><a class="code" href="namespacemovie.html#ab01293acfd248b32f8a2b5d310635eacae08b6e862c5dab202cfa3bfb5609a9dc">movie::BufferFlags_EndOfStream</a>;</div>
<div class="line">        <span class="comment">// End of stream reached</span></div>
<div class="line">        movieStatus = <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5a7e5d9e91d2e94737185fe49c47a607a7">movie::Status_EndOfStream</a>;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span>( movieStatus == <a name="a108"></a><a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5a1590a774f8d50075fc3101a24fb1f73e">movie::Status_NotEnoughData</a> )</div>
<div class="line">    {</div>
<div class="line">        int32_t retryReadCount = 16;</div>
<div class="line">        <span class="keywordflow">while</span>( retryReadCount -- )</div>
<div class="line">        {</div>
<div class="line">            movieStatus = byteStreamReader-&gt;ReadNextFrame(( <span class="keywordtype">char</span>* ) buffer.<a class="code" href="classmovie_1_1_buffer.html#ad3416b750611c829f5f7ed27a8a497fa">Base</a>(), buffer.<a class="code" href="classmovie_1_1_buffer.html#aab5e70c2ddb941a1b687a8dc29221dc7">Capacity</a>(), &amp;frameDataSize, &amp;presentationTimeUs);</div>
<div class="line">            <span class="keywordflow">if</span>( movieStatus == <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5a578dbc51cacf7873a3e40667603e58be">movie::Status_Success</a> )</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            <span class="keywordflow">else</span> <span class="keywordflow">if</span>( movieStatus == <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5a1590a774f8d50075fc3101a24fb1f73e">movie::Status_NotEnoughData</a> )</div>
<div class="line">                <span class="keywordflow">continue</span>;</div>
<div class="line">            <span class="keywordflow">else</span></div>
<div class="line">            {</div>
<div class="line">                flags = <a class="code" href="namespacemovie.html#ab01293acfd248b32f8a2b5d310635eacae08b6e862c5dab202cfa3bfb5609a9dc">movie::BufferFlags_EndOfStream</a>;</div>
<div class="line">                movieStatus = <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5a7e5d9e91d2e94737185fe49c47a607a7">movie::Status_EndOfStream</a>;</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">    decoder-&gt;<a name="a109"></a><a class="code" href="classmovie_1_1_decoder.html#af8cf50e9cc39c5e57f6a0c291ac85f17">SendInputBufferForDecode</a>(index, 0, frameDataSize, presentationTimeUs, flags);</div>
<div class="line">    <span class="keywordflow">return</span> movieStatus;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5">movie::Status</a> MovieDecoderPlayer::ReadInputDataFromExtractorSendTodecoder(<span class="keywordtype">int</span> index, <a class="code" href="classmovie_1_1_decoder.html">movie::Decoder</a>* decoder)</div>
<div class="line">{</div>
<div class="line">    <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5">movie::Status</a> movieStatus = <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5a578dbc51cacf7873a3e40667603e58be">movie::Status_Success</a>;</div>
<div class="line">    <a class="code" href="classmovie_1_1_buffer.html">movie::Buffer</a> buffer;</div>
<div class="line">    uint32_t flags = <a class="code" href="namespacemovie.html#ab01293acfd248b32f8a2b5d310635eaca14b5b0581b8cf6975aa9ac42bd9317fe">movie::BufferFlags_None</a>;</div>
<div class="line">    int64_t presentationTimeUs = 0;</div>
<div class="line">    movieStatus = decoder-&gt;<a class="code" href="classmovie_1_1_decoder.html#ae711ed8a0f2814aaaa4e4c11fcdd7c0e">GetInputBuffer</a>(index, &amp;buffer);</div>
<div class="line">    <span class="keywordflow">if</span>( movieStatus == <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5a578dbc51cacf7873a3e40667603e58be">movie::Status_Success</a> )</div>
<div class="line">    {</div>
<div class="line">        movieStatus = m_Extractor-&gt;Read(&amp;buffer);</div>
<div class="line">        <span class="keywordflow">if</span>( ( movieStatus != <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5a578dbc51cacf7873a3e40667603e58be">movie::Status_Success</a> ) || ( buffer.<a name="a110"></a><a class="code" href="classmovie_1_1_buffer.html#a77c3147edfda457b89c89776d80e6e4b">Size</a>() &lt;= 0 ) || ( movieStatus == <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5a7e5d9e91d2e94737185fe49c47a607a7">movie::Status_EndOfStream</a> ) )</div>
<div class="line">            flags = <a class="code" href="namespacemovie.html#ab01293acfd248b32f8a2b5d310635eacae08b6e862c5dab202cfa3bfb5609a9dc">movie::BufferFlags_EndOfStream</a>;</div>
<div class="line">        m_Extractor-&gt;GetSampleTime(&amp;presentationTimeUs);</div>
<div class="line">        decoder-&gt;<a class="code" href="classmovie_1_1_decoder.html#af8cf50e9cc39c5e57f6a0c291ac85f17">SendInputBufferForDecode</a>(index, buffer.<a name="a111"></a><a class="code" href="classmovie_1_1_buffer.html#a4257222918ab69d2c3d340394edd83e4">Offset</a>(), buffer.<a class="code" href="classmovie_1_1_buffer.html#a77c3147edfda457b89c89776d80e6e4b">Size</a>(), presentationTimeUs, flags);</div>
<div class="line">        m_Extractor-&gt;Advance();</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">return</span> movieStatus;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5">movie::Status</a> MovieDecoderPlayer::SendEosToDecoder()</div>
<div class="line">{</div>
<div class="line">    <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5">movie::Status</a> movieStatus = <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5a819d55a4ad4bd1ac42bc65771cdc6792">movie::Status_UnknownError</a>;</div>
<div class="line">    <a class="code" href="classmovie_1_1_buffer.html">movie::Buffer</a> buffer;</div>
<div class="line">    <span class="keywordtype">bool</span> audioEosSent = <span class="keyword">true</span>;</div>
<div class="line">    <span class="keywordtype">bool</span> videoEosSent = <span class="keyword">true</span>;</div>
<div class="line">    uint32_t flags = <a class="code" href="namespacemovie.html#ab01293acfd248b32f8a2b5d310635eacae08b6e862c5dab202cfa3bfb5609a9dc">movie::BufferFlags_EndOfStream</a>;</div>
<div class="line">    <span class="keywordflow">if</span>( <span class="keyword">true</span> == IsAudioDecoderCreated() )</div>
<div class="line">    {</div>
<div class="line">        <a class="code" href="namespacenn_1_1os.html#a8d4678856d87c3faea21f47ced342bb6">nn::os::LockMutex</a>(&amp;m_AudioListMutex);</div>
<div class="line">        <span class="keywordtype">int</span> audioInputListSize = m_AudioBufferIndexList.size();</div>
<div class="line">        <a class="code" href="namespacenn_1_1os.html#aa661a7036a18c378a694ad67941cd75e">nn::os::UnlockMutex</a>(&amp;m_AudioListMutex);</div>
<div class="line">        audioEosSent = <span class="keyword">false</span>;</div>
<div class="line">        <span class="keywordflow">for</span>( <span class="keywordtype">int</span> i = 0; i &lt; audioInputListSize; i++ )</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordtype">int</span> index = -1;</div>
<div class="line">            RemoveBufferFromAudioIndexList(&amp;index);</div>
<div class="line">            <span class="keywordflow">if</span>( index != -1 )</div>
<div class="line">            {</div>
<div class="line">                m_AudioDecoder-&gt;GetInputBuffer(index, &amp;buffer);</div>
<div class="line">                m_AudioDecoder-&gt;SendInputBufferForDecode(index, 0, 0, 0, flags);</div>
<div class="line">                audioEosSent = <span class="keyword">true</span>;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">if</span>( <span class="keyword">true</span> == IsVideoDecoderCreated() )</div>
<div class="line">    {</div>
<div class="line">        videoEosSent = <span class="keyword">false</span>;</div>
<div class="line">        <a class="code" href="namespacenn_1_1os.html#a8d4678856d87c3faea21f47ced342bb6">nn::os::LockMutex</a>(&amp;m_VideoListMutex);</div>
<div class="line">        <span class="keywordtype">int</span> videoInputListSize = m_VideoBufferIndexList.size();</div>
<div class="line">        <a class="code" href="namespacenn_1_1os.html#aa661a7036a18c378a694ad67941cd75e">nn::os::UnlockMutex</a>(&amp;m_VideoListMutex);</div>
<div class="line">        <span class="keywordflow">for</span>( <span class="keywordtype">int</span> i = 0; i &lt; videoInputListSize; i++ )</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordtype">int</span> index = -1;</div>
<div class="line">            RemoveBufferFromVideoIndexList(&amp;index);</div>
<div class="line">            <span class="keywordflow">if</span>( index != -1 )</div>
<div class="line">            {</div>
<div class="line">                m_VideoDecoder-&gt;GetInputBuffer(index, &amp;buffer);</div>
<div class="line">                m_VideoDecoder-&gt;SendInputBufferForDecode(index, 0, 0, 0, flags);</div>
<div class="line">                videoEosSent = <span class="keyword">true</span>;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">if</span>( ( audioEosSent == <span class="keyword">true</span> ) &amp;&amp; ( videoEosSent == <span class="keyword">true</span> ) )</div>
<div class="line">        movieStatus = <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5a578dbc51cacf7873a3e40667603e58be">movie::Status_Success</a>;</div>
<div class="line">    <span class="keywordflow">return</span> movieStatus;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5">movie::Status</a> MovieDecoderPlayer::CheckForInputBuffersAndReadVideoInputData()</div>
<div class="line">{</div>
<div class="line">    <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5">movie::Status</a> movieStatus = <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5a578dbc51cacf7873a3e40667603e58be">movie::Status_Success</a>;</div>
<div class="line">    <span class="keywordtype">size_t</span> currentTrackIndex = -1;</div>
<div class="line">    <span class="keywordtype">int</span> index = -1;</div>
<div class="line">    <span class="comment">// For byte stream there is only one track [only raw video streams (h264, vp8, vp9) are supported]</span></div>
<div class="line">    <span class="keywordflow">if</span>( m_ByteStreamReader == NULL )</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">if</span>( m_Extractor != NULL )</div>
<div class="line">        {</div>
<div class="line">            movieStatus = m_Extractor-&gt;GetTrackIndexForAvailableData(&amp;currentTrackIndex);</div>
<div class="line">            <span class="keywordflow">if</span>( ( movieStatus != <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5a578dbc51cacf7873a3e40667603e58be">movie::Status_Success</a> ) || ( movieStatus == <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5a7e5d9e91d2e94737185fe49c47a607a7">movie::Status_EndOfStream</a> ) )</div>
<div class="line">            {</div>
<div class="line">                SendEosToDecoder();</div>
<div class="line">                <span class="keywordflow">return</span> movieStatus;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">if</span>( ( m_VideoDecoderType    == <a class="code" href="namespacemovie.html#a13e52fd4ee5ac91b6966c5afb314373ca1313bb0e49ad71e6828ec8ade6003d4e">movie::DecoderType_VideoVp8</a> )</div>
<div class="line">            || ( m_VideoDecoderType == <a class="code" href="namespacemovie.html#a13e52fd4ee5ac91b6966c5afb314373ca3596c2d49a5a2c15cd3165b45055accd">movie::DecoderType_VideoVp9</a> )</div>
<div class="line">            || ( m_VideoDecoderType == <a class="code" href="namespacemovie.html#a13e52fd4ee5ac91b6966c5afb314373cab217d89283577ce5f43ca1a91a6218fa">movie::DecoderType_VideoAvc</a> ) )</div>
<div class="line">        {</div>
<div class="line">            currentTrackIndex = m_VideoTrackIndex;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordtype">int</span> videoIndexListSize = 0;</div>
<div class="line">    <span class="keywordflow">if</span>( currentTrackIndex == m_VideoTrackIndex )</div>
<div class="line">    {</div>
<div class="line">        RemoveBufferFromVideoIndexList(&amp;index);</div>
<div class="line">        <span class="keywordflow">if</span>( index != -1 )</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">if</span>( m_ByteStreamReader != NULL )</div>
<div class="line">                ReadInputDataFromExtractorSendTodecoder(m_ByteStreamReader, index, m_VideoDecoder);</div>
<div class="line">            <span class="keywordflow">else</span></div>
<div class="line">                ReadInputDataFromExtractorSendTodecoder(index, m_VideoDecoder);</div>
<div class="line">        }</div>
<div class="line">        currentTrackIndex = -1;</div>
<div class="line">        <span class="keywordflow">if</span>( m_Extractor != NULL )</div>
<div class="line">        {</div>
<div class="line">            movieStatus = m_Extractor-&gt;GetTrackIndexForAvailableData(&amp;currentTrackIndex);</div>
<div class="line">            <span class="keywordflow">if</span>( movieStatus == <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5a578dbc51cacf7873a3e40667603e58be">movie::Status_Success</a> )</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">if</span>( currentTrackIndex == m_VideoTrackIndex )</div>
<div class="line">                {</div>
<div class="line">                    GetVideoIndexListSize(&amp;videoIndexListSize);</div>
<div class="line">                    <span class="keywordflow">if</span>( videoIndexListSize &gt; 0 )</div>
<div class="line">                        SignalVideoInputBufferAvailable();</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">    {</div>
<div class="line">        <span class="comment">// Try to read audio data from Extractor</span></div>
<div class="line">        <span class="keywordtype">int</span> audioIndexListSize = 0;</div>
<div class="line">        GetAudioIndexListSize(&amp;audioIndexListSize);</div>
<div class="line">        <span class="keywordflow">if</span>( audioIndexListSize &gt; 0 )</div>
<div class="line">            SignalAudioInputBufferAvailable();</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">return</span> movieStatus;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5">movie::Status</a> MovieDecoderPlayer::CheckForInputBuffersAndReadAudioInputData()</div>
<div class="line">{</div>
<div class="line">    <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5">movie::Status</a> movieStatus = <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5a578dbc51cacf7873a3e40667603e58be">movie::Status_Success</a>;</div>
<div class="line">    <span class="keywordtype">size_t</span> currentTrackIndex = -1;</div>
<div class="line">    <span class="keywordtype">int</span> index = -1;</div>
<div class="line">    <span class="keywordtype">int</span> audioIndexListSize = 0;</div>
<div class="line">    <span class="keywordtype">int</span> videoIndexListSize = 0;</div>
<div class="line">    <span class="comment">// For byte stream there is only one track [only raw video streams (h264, vp8, vp9) are supported]</span></div>
<div class="line">    <span class="keywordflow">if</span>( m_ByteStreamReader == NULL )</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">if</span>( m_Extractor != NULL )</div>
<div class="line">        {</div>
<div class="line">            currentTrackIndex = -1;</div>
<div class="line">            movieStatus = m_Extractor-&gt;GetTrackIndexForAvailableData(&amp;currentTrackIndex);</div>
<div class="line">            <span class="keywordflow">if</span>( ( movieStatus != <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5a578dbc51cacf7873a3e40667603e58be">movie::Status_Success</a> ) || ( movieStatus == <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5a7e5d9e91d2e94737185fe49c47a607a7">movie::Status_EndOfStream</a> ) )</div>
<div class="line">            {</div>
<div class="line">                SendEosToDecoder();</div>
<div class="line">                <span class="keywordflow">return</span> movieStatus;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">if</span>( ( m_VideoDecoderType == <a class="code" href="namespacemovie.html#a13e52fd4ee5ac91b6966c5afb314373ca1313bb0e49ad71e6828ec8ade6003d4e">movie::DecoderType_VideoVp8</a> )</div>
<div class="line">                || ( m_VideoDecoderType == <a class="code" href="namespacemovie.html#a13e52fd4ee5ac91b6966c5afb314373ca3596c2d49a5a2c15cd3165b45055accd">movie::DecoderType_VideoVp9</a> )</div>
<div class="line">                || ( m_VideoDecoderType == <a class="code" href="namespacemovie.html#a13e52fd4ee5ac91b6966c5afb314373cab217d89283577ce5f43ca1a91a6218fa">movie::DecoderType_VideoAvc</a> ) )</div>
<div class="line">            {</div>
<div class="line">                currentTrackIndex = m_VideoTrackIndex;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span>( currentTrackIndex == m_AudioTrackIndex )</div>
<div class="line">        {</div>
<div class="line">            GetAudioIndexListSize(&amp;audioIndexListSize);</div>
<div class="line">            <span class="keywordflow">if</span>( audioIndexListSize &gt; 0 )</div>
<div class="line">            {</div>
<div class="line">                RemoveBufferFromAudioIndexList(&amp;index);</div>
<div class="line">                <span class="keywordflow">if</span>( index != -1 )</div>
<div class="line">                {</div>
<div class="line">                    <span class="keywordflow">if</span>( m_ByteStreamReader != NULL )</div>
<div class="line">                        ReadInputDataFromExtractorSendTodecoder(m_ByteStreamReader, index, m_AudioDecoder);</div>
<div class="line">                    <span class="keywordflow">else</span></div>
<div class="line">                        ReadInputDataFromExtractorSendTodecoder(index, m_AudioDecoder);</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">if</span>( m_Extractor != NULL )</div>
<div class="line">            {</div>
<div class="line">                currentTrackIndex = -1;</div>
<div class="line">                movieStatus = m_Extractor-&gt;GetTrackIndexForAvailableData(&amp;currentTrackIndex);</div>
<div class="line">                <span class="keywordflow">if</span>( movieStatus == <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5a578dbc51cacf7873a3e40667603e58be">movie::Status_Success</a> )</div>
<div class="line">                {</div>
<div class="line">                    <span class="keywordflow">if</span>( currentTrackIndex == m_AudioTrackIndex )</div>
<div class="line">                    {</div>
<div class="line">                        audioIndexListSize = 0;</div>
<div class="line">                        GetAudioIndexListSize(&amp;audioIndexListSize);</div>
<div class="line">                        <span class="keywordflow">if</span>( audioIndexListSize &gt; 0 )</div>
<div class="line">                            SignalAudioInputBufferAvailable();</div>
<div class="line">                    }</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">        {</div>
<div class="line">            videoIndexListSize = 0;</div>
<div class="line">            GetVideoIndexListSize(&amp;videoIndexListSize);</div>
<div class="line">            <span class="keywordflow">if</span>( videoIndexListSize &gt; 0 )</div>
<div class="line">                SignalVideoInputBufferAvailable();</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">return</span> movieStatus;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5">movie::Status</a> MovieDecoderPlayer::SignalVideoInputBufferAvailable()</div>
<div class="line">{</div>
<div class="line">    <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5">movie::Status</a> movieStatus = <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5a578dbc51cacf7873a3e40667603e58be">movie::Status_Success</a>;</div>
<div class="line">    <a name="a112"></a><a class="code" href="namespacenn_1_1os.html#afec9c0c3cacf43c7aa82f323da656af5">nn::os::SendMessageQueue</a>( &amp;m_VideoInputMessageQueue, MovieDecoderPlayer::MoviePlayerMessage_VideoInputAvailable);</div>
<div class="line">    <span class="keywordflow">return</span> movieStatus;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5">movie::Status</a> MovieDecoderPlayer::SignalAudioInputBufferAvailable()</div>
<div class="line">{</div>
<div class="line">    <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5">movie::Status</a> movieStatus = <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5a578dbc51cacf7873a3e40667603e58be">movie::Status_Success</a>;</div>
<div class="line">    <a class="code" href="namespacenn_1_1os.html#afec9c0c3cacf43c7aa82f323da656af5">nn::os::SendMessageQueue</a>(&amp;m_AudioInputMessageQueue, MovieDecoderPlayer::MoviePlayerMessage_AudioInputAvailable);</div>
<div class="line">    <span class="keywordflow">return</span> movieStatus;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5">movie::Status</a> MovieDecoderPlayer::SignalAudioInputReadThreadExit()</div>
<div class="line">{</div>
<div class="line">    <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5">movie::Status</a> movieStatus = <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5a578dbc51cacf7873a3e40667603e58be">movie::Status_Success</a>;</div>
<div class="line">    <a class="code" href="namespacenn_1_1os.html#afec9c0c3cacf43c7aa82f323da656af5">nn::os::SendMessageQueue</a>(&amp;m_AudioInputMessageQueue, MovieDecoderPlayer::MoviePlayerMessage_AudioInputThreadExit);</div>
<div class="line">    <span class="keywordflow">return</span> movieStatus;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5">movie::Status</a> MovieDecoderPlayer::SignalVideoInputReadThreadExit()</div>
<div class="line">{</div>
<div class="line">    <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5">movie::Status</a> movieStatus = <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5a578dbc51cacf7873a3e40667603e58be">movie::Status_Success</a>;</div>
<div class="line">    <a class="code" href="namespacenn_1_1os.html#afec9c0c3cacf43c7aa82f323da656af5">nn::os::SendMessageQueue</a>( &amp;m_VideoInputMessageQueue, MovieDecoderPlayer::MoviePlayerMessage_VideoInputThreadExit);</div>
<div class="line">    <span class="keywordflow">return</span> movieStatus;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5">movie::Status</a> MovieDecoderPlayer::SignalAudioVideoWorkerThreadExit()</div>
<div class="line">{</div>
<div class="line">    <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5">movie::Status</a> movieStatus = <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5a578dbc51cacf7873a3e40667603e58be">movie::Status_Success</a>;</div>
<div class="line">    <a name="a113"></a><a class="code" href="namespacenn_1_1os.html#a9b959a51c1d28b76894597695fd3d081">nn::os::SignalEvent</a>(&amp;m_AudioVideoWorkerThreadExitEvent );</div>
<div class="line">    <span class="keywordflow">return</span> movieStatus;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> VideoInputReadThreadFunction(<span class="keywordtype">void</span> *arg)</div>
<div class="line">{</div>
<div class="line">    MovieDecoderPlayer *movieDecoderPlayer = (MovieDecoderPlayer*) arg;</div>
<div class="line">    <span class="keywordflow">for</span> (;;)</div>
<div class="line">    {</div>
<div class="line">        uintptr_t data;</div>
<div class="line">        <a name="a114"></a><a class="code" href="namespacenn_1_1os.html#ace7ad0de1da8fdeeeb01e7de7494dc87">nn::os::ReceiveMessageQueue</a>( &amp;data, &amp;movieDecoderPlayer-&gt;m_VideoInputMessageQueue );</div>
<div class="line">        <span class="keywordflow">if</span>( data == MovieDecoderPlayer::MoviePlayerMessage_VideoInputAvailable )</div>
<div class="line">            movieDecoderPlayer-&gt;CheckForInputBuffersAndReadVideoInputData();</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span>( data == MovieDecoderPlayer::MoviePlayerMessage_VideoInputThreadExit )</div>
<div class="line">        {</div>
<div class="line">            movieDecoderPlayer-&gt;m_VideoInputReadThreadDone = <span class="keyword">true</span>;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> AudioInputReadThreadFunction(<span class="keywordtype">void</span> *arg)</div>
<div class="line">{</div>
<div class="line">    MovieDecoderPlayer *movieDecoderPlayer = ( MovieDecoderPlayer* ) arg;</div>
<div class="line">    <span class="keywordflow">for</span>( ;;)</div>
<div class="line">    {</div>
<div class="line">        uintptr_t data;</div>
<div class="line">        <a class="code" href="namespacenn_1_1os.html#ace7ad0de1da8fdeeeb01e7de7494dc87">nn::os::ReceiveMessageQueue</a>(&amp;data, &amp;movieDecoderPlayer-&gt;m_AudioInputMessageQueue);</div>
<div class="line">        <span class="keywordflow">if</span>( data == MovieDecoderPlayer::MoviePlayerMessage_AudioInputAvailable )</div>
<div class="line">            movieDecoderPlayer-&gt;CheckForInputBuffersAndReadAudioInputData();</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span>( data == MovieDecoderPlayer::MoviePlayerMessage_AudioInputThreadExit )</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5">movie::Status</a> MovieDecoderPlayer::VideoInputBufferAvailableEvent()</div>
<div class="line">{</div>
<div class="line">    <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5">movie::Status</a> movieStatus = <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5a578dbc51cacf7873a3e40667603e58be">movie::Status_Success</a>;</div>
<div class="line">    int32_t index = -1;</div>
<div class="line">    <a class="code" href="classmovie_1_1_buffer.html">movie::Buffer</a> buffer;</div>
<div class="line">    int32_t numberOfBuffersAvailable = 0;;</div>
<div class="line">    movieStatus = m_VideoDecoder-&gt;AcquireInputBufferIndex(&amp;index, &amp;numberOfBuffersAvailable);</div>
<div class="line">    <span class="keywordflow">if</span>( movieStatus == <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5a578dbc51cacf7873a3e40667603e58be">movie::Status_Success</a> )</div>
<div class="line">    {</div>
<div class="line">        AddBufferToVideoIndexList(index);</div>
<div class="line">        SignalVideoInputBufferAvailable();</div>
<div class="line">        <span class="keywordflow">for</span>( int32_t i = 0; i &lt; numberOfBuffersAvailable; i ++)</div>
<div class="line">        {</div>
<div class="line">            int32_t remainingBuffers = 0;</div>
<div class="line">            movieStatus = m_VideoDecoder-&gt;AcquireInputBufferIndex(&amp;index, &amp;remainingBuffers);</div>
<div class="line">            <span class="keywordflow">if</span>( movieStatus == <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5a578dbc51cacf7873a3e40667603e58be">movie::Status_Success</a> )</div>
<div class="line">            {</div>
<div class="line">                 AddBufferToVideoIndexList(index);</div>
<div class="line">                 SignalVideoInputBufferAvailable();</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">return</span> movieStatus;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5">movie::Status</a> MovieDecoderPlayer::VideoOutputBufferAvailableEvent()</div>
<div class="line">{</div>
<div class="line">    <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5">movie::Status</a> movieStatus = <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5a578dbc51cacf7873a3e40667603e58be">movie::Status_Success</a>;</div>
<div class="line">    int32_t index = -1;</div>
<div class="line">    int64_t presentationTimeUs = 0ll;</div>
<div class="line">    uint32_t flags = 0;</div>
<div class="line">    int32_t numberOfBuffersAvailable = 0;</div>
<div class="line"></div>
<div class="line">    <a class="code" href="classmovie_1_1_buffer.html">movie::Buffer</a> buffer;</div>
<div class="line"></div>
<div class="line">    movieStatus = m_VideoDecoder-&gt;AcquireOutputBufferIndex(&amp;index, &amp;presentationTimeUs, &amp;flags, &amp;numberOfBuffersAvailable);</div>
<div class="line">    <span class="keywordflow">if</span>( movieStatus == <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5a578dbc51cacf7873a3e40667603e58be">movie::Status_Success</a> )</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">if</span>( m_ByteStreamReader != NULL )</div>
<div class="line">            presentationTimeUs = m_VideoPresentationTimeUs;</div>
<div class="line">        m_MovieVideoOutputHandler-&gt;OnOutputAvailable(index, presentationTimeUs, flags);</div>
<div class="line">        m_VideoOutputBufferReceived ++;</div>
<div class="line">        <span class="keywordflow">if</span>( m_ByteStreamReader != NULL )</div>
<div class="line">            m_VideoPresentationTimeUs += m_ByteStreamReader-&gt;GetPresentationTimeIncrementInUs();</div>
<div class="line">        <span class="keywordflow">if</span>( flags == <a class="code" href="namespacemovie.html#ab01293acfd248b32f8a2b5d310635eacae08b6e862c5dab202cfa3bfb5609a9dc">movie::BufferFlags_EndOfStream</a> )</div>
<div class="line">            SetVideoDecodeComplete();</div>
<div class="line">        <span class="keywordflow">for</span>( int32_t i = 0; i &lt; numberOfBuffersAvailable; i ++)</div>
<div class="line">        {</div>
<div class="line">            int32_t remainingBuffers = 0;</div>
<div class="line">            movieStatus = m_VideoDecoder-&gt;AcquireOutputBufferIndex(&amp;index, &amp;presentationTimeUs, &amp;flags, &amp;remainingBuffers);</div>
<div class="line">            <span class="keywordflow">if</span>( movieStatus == <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5a578dbc51cacf7873a3e40667603e58be">movie::Status_Success</a> )</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">if</span>( flags == <a class="code" href="namespacemovie.html#ab01293acfd248b32f8a2b5d310635eacae08b6e862c5dab202cfa3bfb5609a9dc">movie::BufferFlags_EndOfStream</a> )</div>
<div class="line">                     SetVideoDecodeComplete();</div>
<div class="line">                <span class="keywordflow">if</span>( m_ByteStreamReader != NULL )</div>
<div class="line">                    presentationTimeUs = m_VideoPresentationTimeUs;</div>
<div class="line">                m_MovieVideoOutputHandler-&gt;OnOutputAvailable(index, presentationTimeUs, flags);</div>
<div class="line">                m_VideoOutputBufferReceived ++;</div>
<div class="line">                <span class="keywordflow">if</span>( m_ByteStreamReader != NULL )</div>
<div class="line">                    m_VideoPresentationTimeUs += m_ByteStreamReader-&gt;GetPresentationTimeIncrementInUs();</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">return</span> movieStatus;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5">movie::Status</a> MovieDecoderPlayer::VideoFormatChangedEvent()</div>
<div class="line">{</div>
<div class="line">    NN_SDK_LOG( <span class="stringliteral">&quot;\n VideoFormatChangedEvent \n&quot;</span> );</div>
<div class="line">    <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5">movie::Status</a> movieStatus = <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5a578dbc51cacf7873a3e40667603e58be">movie::Status_Success</a>;</div>
<div class="line">    <a class="code" href="classmovie_1_1_media_data.html">movie::MediaData</a> format;</div>
<div class="line">    movieStatus = m_VideoDecoder-&gt;GetOutputFormat(&amp;format);</div>
<div class="line">    <span class="keywordflow">if</span>( movieStatus == <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5a578dbc51cacf7873a3e40667603e58be">movie::Status_Success</a> )</div>
<div class="line">    {</div>
<div class="line">        int32_t width = 0;</div>
<div class="line">        int32_t height = 0;</div>
<div class="line">        format.<a class="code" href="classmovie_1_1_media_data.html#a411b32acf9d22f3e6921563401c377fc">FindInt32</a>(<span class="stringliteral">&quot;width&quot;</span>, &amp;width);</div>
<div class="line">        m_Width = width;</div>
<div class="line">        format.<a class="code" href="classmovie_1_1_media_data.html#a411b32acf9d22f3e6921563401c377fc">FindInt32</a>(<span class="stringliteral">&quot;height&quot;</span>, &amp;height);</div>
<div class="line">        m_Height = height;</div>
<div class="line">        NN_SDK_LOG(<span class="stringliteral">&quot;VideoFormatChangedEvent Width %d, Height %d\n&quot;</span>, width, height);</div>
<div class="line">    }</div>
<div class="line">    format.<a class="code" href="classmovie_1_1_media_data.html#a196c88834858be094dba17270e7a3249">Clear</a>();</div>
<div class="line">    m_VideoFormatChangeEventReceived = <span class="keyword">true</span>;</div>
<div class="line">    CheckAndSignalFormatChangeWaiter();</div>
<div class="line">    <span class="keywordflow">return</span> movieStatus;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5">movie::Status</a> MovieDecoderPlayer::AudioInputBufferAvailableEvent()</div>
<div class="line">{</div>
<div class="line">    <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5">movie::Status</a> movieStatus = <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5a578dbc51cacf7873a3e40667603e58be">movie::Status_Success</a>;</div>
<div class="line">    int32_t index = -1;</div>
<div class="line">    <a class="code" href="classmovie_1_1_buffer.html">movie::Buffer</a> buffer;</div>
<div class="line">    int32_t numberOfBuffersAvailable = 0;;</div>
<div class="line">    movieStatus = m_AudioDecoder-&gt;AcquireInputBufferIndex(&amp;index, &amp;numberOfBuffersAvailable);</div>
<div class="line">    <span class="keywordflow">if</span>( movieStatus == <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5a578dbc51cacf7873a3e40667603e58be">movie::Status_Success</a> )</div>
<div class="line">    {</div>
<div class="line">        AddBufferToAudioIndexList(index);</div>
<div class="line">        SignalAudioInputBufferAvailable();</div>
<div class="line">        <span class="keywordflow">for</span>( int32_t i = 0; i &lt; numberOfBuffersAvailable; i ++)</div>
<div class="line">        {</div>
<div class="line">            int32_t remainingBuffers = 0;</div>
<div class="line">            movieStatus = m_AudioDecoder-&gt;AcquireInputBufferIndex(&amp;index, &amp;remainingBuffers);</div>
<div class="line">            <span class="keywordflow">if</span>( movieStatus == <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5a578dbc51cacf7873a3e40667603e58be">movie::Status_Success</a> )</div>
<div class="line">            {</div>
<div class="line">                 AddBufferToAudioIndexList(index);</div>
<div class="line">                 SignalAudioInputBufferAvailable();</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">return</span> movieStatus;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5">movie::Status</a> MovieDecoderPlayer::AudioOutputBufferAvailableEvent()</div>
<div class="line">{</div>
<div class="line">    <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5">movie::Status</a> movieStatus = <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5a578dbc51cacf7873a3e40667603e58be">movie::Status_Success</a>;</div>
<div class="line">    int32_t index = -1;</div>
<div class="line">    int64_t presentationTimeUs= 0ll;</div>
<div class="line">    uint32_t flags = 0;</div>
<div class="line">    int32_t numberOfBuffersAvailable = 0;</div>
<div class="line">    movieStatus = m_AudioDecoder-&gt;AcquireOutputBufferIndex(&amp;index, &amp;presentationTimeUs, &amp;flags, &amp;numberOfBuffersAvailable);</div>
<div class="line">    <span class="keywordflow">if</span>( movieStatus == <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5a578dbc51cacf7873a3e40667603e58be">movie::Status_Success</a> )</div>
<div class="line">    {</div>
<div class="line">        m_MovieAudioOutputHandler-&gt;OnOutputAvailable(index, presentationTimeUs, flags);</div>
<div class="line">        m_AudioOutputBufferReceived ++;</div>
<div class="line">        <span class="keywordflow">if</span>( flags == <a class="code" href="namespacemovie.html#ab01293acfd248b32f8a2b5d310635eacae08b6e862c5dab202cfa3bfb5609a9dc">movie::BufferFlags_EndOfStream</a> )</div>
<div class="line">            SetAudioDecodeComplete();</div>
<div class="line">        <span class="keywordflow">for</span>( int32_t i = 0; i &lt; numberOfBuffersAvailable; i ++)</div>
<div class="line">        {</div>
<div class="line">            int32_t remainingBuffers = 0;</div>
<div class="line">            movieStatus = m_AudioDecoder-&gt;AcquireOutputBufferIndex(&amp;index, &amp;presentationTimeUs, &amp;flags, &amp;remainingBuffers);</div>
<div class="line">            <span class="keywordflow">if</span>( movieStatus == <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5a578dbc51cacf7873a3e40667603e58be">movie::Status_Success</a> )</div>
<div class="line">            {</div>
<div class="line">                m_AudioOutputBufferReceived ++;</div>
<div class="line">                m_MovieAudioOutputHandler-&gt;OnOutputAvailable(index, presentationTimeUs, flags);</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">if</span>( flags == <a class="code" href="namespacemovie.html#ab01293acfd248b32f8a2b5d310635eacae08b6e862c5dab202cfa3bfb5609a9dc">movie::BufferFlags_EndOfStream</a> )</div>
<div class="line">                 SetAudioDecodeComplete();</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">return</span> movieStatus;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5">movie::Status</a> MovieDecoderPlayer::AudioFormatChangedEvent()</div>
<div class="line">{</div>
<div class="line">    <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5">movie::Status</a> movieStatus = <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5a578dbc51cacf7873a3e40667603e58be">movie::Status_Success</a>;</div>
<div class="line">    <a class="code" href="classmovie_1_1_media_data.html">movie::MediaData</a> audioFormat;</div>
<div class="line">    movieStatus = m_AudioDecoder-&gt;GetOutputFormat(&amp;audioFormat);</div>
<div class="line">    <span class="keywordflow">if</span>( movieStatus == <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5a578dbc51cacf7873a3e40667603e58be">movie::Status_Success</a> )</div>
<div class="line">    {</div>
<div class="line">        int32_t numChannels = 0;</div>
<div class="line">        int32_t sampleRate = 0;</div>
<div class="line">        audioFormat.<a class="code" href="classmovie_1_1_media_data.html#a411b32acf9d22f3e6921563401c377fc">FindInt32</a>(<span class="stringliteral">&quot;channel-count&quot;</span>, &amp;numChannels);</div>
<div class="line">        audioFormat.<a class="code" href="classmovie_1_1_media_data.html#a411b32acf9d22f3e6921563401c377fc">FindInt32</a>(<span class="stringliteral">&quot;sample-rate&quot;</span>, &amp;sampleRate);</div>
<div class="line">        <span class="keywordflow">if</span>( numChannels &gt; 0 )</div>
<div class="line">            m_NumChannels = numChannels;</div>
<div class="line">        <span class="keywordflow">if</span>( sampleRate &gt; 0 )</div>
<div class="line">            m_SampleRate = sampleRate;</div>
<div class="line">    }</div>
<div class="line">    audioFormat.<a class="code" href="classmovie_1_1_media_data.html#a196c88834858be094dba17270e7a3249">Clear</a>();</div>
<div class="line">    NN_SDK_LOG( <span class="stringliteral">&quot;\n AudioFormatChangedEvent \n&quot;</span> );</div>
<div class="line">    m_AudioFormatChangeEventReceived = <span class="keyword">true</span>;</div>
<div class="line">    CheckAndSignalFormatChangeWaiter();</div>
<div class="line">    <span class="keywordflow">return</span> movieStatus;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> AudioVideoWorkerThreadFunction(<span class="keywordtype">void</span> *arg)</div>
<div class="line">{</div>
<div class="line">    MovieDecoderPlayer *movieDecoderPlayer = (MovieDecoderPlayer*) arg;</div>
<div class="line">    <span class="comment">// Thread is starting, link all MultiWait holders</span></div>
<div class="line">    <a name="a115"></a><a class="code" href="namespacenn_1_1os.html#a7cd9b25e14bee063959eb9e7f62a4aa8">nn::os::LinkMultiWaitHolder</a>( &amp;movieDecoderPlayer-&gt;m_AudioVideoWorkerMultiWait, &amp;movieDecoderPlayer-&gt;m_AudioVideoWorkerThreadExitEventHolder );</div>
<div class="line">    <a class="code" href="namespacenn_1_1os.html#a7cd9b25e14bee063959eb9e7f62a4aa8">nn::os::LinkMultiWaitHolder</a>(&amp;movieDecoderPlayer-&gt;m_AudioVideoWorkerMultiWait, &amp;movieDecoderPlayer-&gt;m_AudioDecoderMultiWaitHolderTypes.errorEventHolder);</div>
<div class="line">    <a class="code" href="namespacenn_1_1os.html#a7cd9b25e14bee063959eb9e7f62a4aa8">nn::os::LinkMultiWaitHolder</a>(&amp;movieDecoderPlayer-&gt;m_AudioVideoWorkerMultiWait, &amp;movieDecoderPlayer-&gt;m_AudioDecoderMultiWaitHolderTypes.formatChangedEventHolder);</div>
<div class="line">    <a class="code" href="namespacenn_1_1os.html#a7cd9b25e14bee063959eb9e7f62a4aa8">nn::os::LinkMultiWaitHolder</a>(&amp;movieDecoderPlayer-&gt;m_AudioVideoWorkerMultiWait, &amp;movieDecoderPlayer-&gt;m_AudioDecoderMultiWaitHolderTypes.inputBufferAvailableEventHolder);</div>
<div class="line">    <a class="code" href="namespacenn_1_1os.html#a7cd9b25e14bee063959eb9e7f62a4aa8">nn::os::LinkMultiWaitHolder</a>(&amp;movieDecoderPlayer-&gt;m_AudioVideoWorkerMultiWait, &amp;movieDecoderPlayer-&gt;m_AudioDecoderMultiWaitHolderTypes.outputBufferAvailableEventHolder);</div>
<div class="line">    <a class="code" href="namespacenn_1_1os.html#a7cd9b25e14bee063959eb9e7f62a4aa8">nn::os::LinkMultiWaitHolder</a>(&amp;movieDecoderPlayer-&gt;m_AudioVideoWorkerMultiWait, &amp;movieDecoderPlayer-&gt;m_VideoDecoderMultiWaitHolderTypes.errorEventHolder);</div>
<div class="line">    <a class="code" href="namespacenn_1_1os.html#a7cd9b25e14bee063959eb9e7f62a4aa8">nn::os::LinkMultiWaitHolder</a>(&amp;movieDecoderPlayer-&gt;m_AudioVideoWorkerMultiWait, &amp;movieDecoderPlayer-&gt;m_VideoDecoderMultiWaitHolderTypes.formatChangedEventHolder);</div>
<div class="line">    <a class="code" href="namespacenn_1_1os.html#a7cd9b25e14bee063959eb9e7f62a4aa8">nn::os::LinkMultiWaitHolder</a>(&amp;movieDecoderPlayer-&gt;m_AudioVideoWorkerMultiWait, &amp;movieDecoderPlayer-&gt;m_VideoDecoderMultiWaitHolderTypes.inputBufferAvailableEventHolder);</div>
<div class="line">    <a class="code" href="namespacenn_1_1os.html#a7cd9b25e14bee063959eb9e7f62a4aa8">nn::os::LinkMultiWaitHolder</a>(&amp;movieDecoderPlayer-&gt;m_AudioVideoWorkerMultiWait, &amp;movieDecoderPlayer-&gt;m_VideoDecoderMultiWaitHolderTypes.outputBufferAvailableEventHolder);</div>
<div class="line">    <span class="comment">// Wait for events and process them.</span></div>
<div class="line">    <span class="keywordflow">for</span> (;;)</div>
<div class="line">    {</div>
<div class="line">        <a name="_a116"></a><a class="code" href="structnn_1_1os_1_1_multi_wait_holder_type.html">nn::os::MultiWaitHolderType</a>* holder = <a name="a117"></a><a class="code" href="namespacenn_1_1os.html#ab9b837eb53fa2c8a9610cec2b69666fd">nn::os::WaitAny</a>( &amp;movieDecoderPlayer-&gt;m_AudioVideoWorkerMultiWait );</div>
<div class="line">        <span class="keywordflow">if</span>( holder == &amp;movieDecoderPlayer-&gt;m_VideoDecoderMultiWaitHolderTypes.inputBufferAvailableEventHolder )</div>
<div class="line">        {</div>
<div class="line">            <a name="a118"></a><a class="code" href="namespacenn_1_1os.html#a46abbb4e59711874cfec72fe97b58e36">nn::os::ClearEvent</a>(movieDecoderPlayer-&gt;m_VideoDecoderEvents.inputBufferAvailableEvent);</div>
<div class="line">            movieDecoderPlayer-&gt;VideoInputBufferAvailableEvent();</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( holder == &amp;movieDecoderPlayer-&gt;m_VideoDecoderMultiWaitHolderTypes.outputBufferAvailableEventHolder )</div>
<div class="line">        {</div>
<div class="line">            <a class="code" href="namespacenn_1_1os.html#a46abbb4e59711874cfec72fe97b58e36">nn::os::ClearEvent</a>(movieDecoderPlayer-&gt;m_VideoDecoderEvents.outputBufferAvailableEvent);</div>
<div class="line">            movieDecoderPlayer-&gt;VideoOutputBufferAvailableEvent();</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( holder == &amp;movieDecoderPlayer-&gt;m_VideoDecoderMultiWaitHolderTypes.formatChangedEventHolder )</div>
<div class="line">        {</div>
<div class="line">            <a class="code" href="namespacenn_1_1os.html#a46abbb4e59711874cfec72fe97b58e36">nn::os::ClearEvent</a>(movieDecoderPlayer-&gt;m_VideoDecoderEvents.formatChangedEvent);</div>
<div class="line">            movieDecoderPlayer-&gt;VideoFormatChangedEvent();</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span>( holder == &amp;movieDecoderPlayer-&gt;m_VideoDecoderMultiWaitHolderTypes.errorEventHolder )</div>
<div class="line">        {</div>
<div class="line">            <a class="code" href="namespacenn_1_1os.html#a46abbb4e59711874cfec72fe97b58e36">nn::os::ClearEvent</a>(movieDecoderPlayer-&gt;m_VideoDecoderEvents.errorEvent);</div>
<div class="line">            <a class="code" href="nn___log_8h.html#aa8c0b58247a2078e37f2fe0974b98a61">NN_LOG</a>(<span class="stringliteral">&quot;\n Error event received from Video Decoder \n&quot;</span>);</div>
<div class="line">            <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5">movie::Status</a> movieError = movieDecoderPlayer-&gt;m_VideoDecoder-&gt;GetLastError();</div>
<div class="line">            <span class="keywordflow">if</span>( movieError != <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5a578dbc51cacf7873a3e40667603e58be">movie::Status_Success</a> )</div>
<div class="line">            {</div>
<div class="line">                <a class="code" href="nn___log_8h.html#aa8c0b58247a2078e37f2fe0974b98a61">NN_LOG</a>(<span class="stringliteral">&quot;\n Error = 0x%x \&quot;%s\&quot; \n&quot;</span>, movieError, <a name="a119"></a><a class="code" href="namespacemovie.html#a08b220331b0805bcf13890e9a0d0dcf8">movie::StatusToString</a>(movieError));</div>
<div class="line">                <a class="code" href="nn___log_8h.html#aa8c0b58247a2078e37f2fe0974b98a61">NN_LOG</a>(<span class="stringliteral">&quot;\n Terminate Playback \n&quot;</span>);</div>
<div class="line">                movieDecoderPlayer-&gt;SetPlaybackComplete();</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span>( holder == &amp;movieDecoderPlayer-&gt;m_AudioDecoderMultiWaitHolderTypes.inputBufferAvailableEventHolder )</div>
<div class="line">        {</div>
<div class="line">            <a class="code" href="namespacenn_1_1os.html#a46abbb4e59711874cfec72fe97b58e36">nn::os::ClearEvent</a>(movieDecoderPlayer-&gt;m_AudioDecoderEvents.inputBufferAvailableEvent);</div>
<div class="line">            movieDecoderPlayer-&gt;AudioInputBufferAvailableEvent();</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( holder == &amp;movieDecoderPlayer-&gt;m_AudioDecoderMultiWaitHolderTypes.outputBufferAvailableEventHolder )</div>
<div class="line">        {</div>
<div class="line">            <a class="code" href="namespacenn_1_1os.html#a46abbb4e59711874cfec72fe97b58e36">nn::os::ClearEvent</a>( movieDecoderPlayer-&gt;m_AudioDecoderEvents.outputBufferAvailableEvent);</div>
<div class="line">            movieDecoderPlayer-&gt;AudioOutputBufferAvailableEvent();</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( holder == &amp;movieDecoderPlayer-&gt;m_AudioDecoderMultiWaitHolderTypes.formatChangedEventHolder )</div>
<div class="line">        {</div>
<div class="line">            <a class="code" href="namespacenn_1_1os.html#a46abbb4e59711874cfec72fe97b58e36">nn::os::ClearEvent</a>( movieDecoderPlayer-&gt;m_AudioDecoderEvents.formatChangedEvent);</div>
<div class="line">            movieDecoderPlayer-&gt;AudioFormatChangedEvent();</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span>( holder == &amp;movieDecoderPlayer-&gt;m_AudioDecoderMultiWaitHolderTypes.errorEventHolder )</div>
<div class="line">        {</div>
<div class="line">            <a class="code" href="namespacenn_1_1os.html#a46abbb4e59711874cfec72fe97b58e36">nn::os::ClearEvent</a>(movieDecoderPlayer-&gt;m_AudioDecoderEvents.errorEvent);</div>
<div class="line">            <a class="code" href="nn___log_8h.html#aa8c0b58247a2078e37f2fe0974b98a61">NN_LOG</a>(<span class="stringliteral">&quot;\n Error event received from Audio Decoder \n&quot;</span>);</div>
<div class="line">            <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5">movie::Status</a> movieError = movieDecoderPlayer-&gt;m_AudioDecoder-&gt;GetLastError();</div>
<div class="line">            <span class="keywordflow">if</span>( movieError != <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5a578dbc51cacf7873a3e40667603e58be">movie::Status_Success</a> )</div>
<div class="line">            {</div>
<div class="line">                <a class="code" href="nn___log_8h.html#aa8c0b58247a2078e37f2fe0974b98a61">NN_LOG</a>(<span class="stringliteral">&quot;\n Error = 0x%x \&quot;%s\&quot; \n&quot;</span>, movieError, <a class="code" href="namespacemovie.html#a08b220331b0805bcf13890e9a0d0dcf8">movie::StatusToString</a>(movieError));</div>
<div class="line">                <a class="code" href="nn___log_8h.html#aa8c0b58247a2078e37f2fe0974b98a61">NN_LOG</a>(<span class="stringliteral">&quot;\n Terminate Playback \n&quot;</span>);</div>
<div class="line">                movieDecoderPlayer-&gt;SetPlaybackComplete();</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( holder == &amp;movieDecoderPlayer-&gt;m_AudioVideoWorkerThreadExitEventHolder )</div>
<div class="line">        {</div>
<div class="line">            <a class="code" href="namespacenn_1_1os.html#a46abbb4e59711874cfec72fe97b58e36">nn::os::ClearEvent</a>( &amp;movieDecoderPlayer-&gt;m_AudioVideoWorkerThreadExitEvent );</div>
<div class="line">            <span class="comment">// Thread is exiting, unlink VideoDecoder MultiWait holders</span></div>
<div class="line">            <a name="a120"></a><a class="code" href="namespacenn_1_1os.html#a07c9c7bbc51249b69dc2361957fd650b">nn::os::UnlinkMultiWaitHolder</a>(&amp;movieDecoderPlayer-&gt;m_VideoDecoderMultiWaitHolderTypes.errorEventHolder);</div>
<div class="line">            <a class="code" href="namespacenn_1_1os.html#a07c9c7bbc51249b69dc2361957fd650b">nn::os::UnlinkMultiWaitHolder</a>(&amp;movieDecoderPlayer-&gt;m_VideoDecoderMultiWaitHolderTypes.formatChangedEventHolder);</div>
<div class="line">            <a class="code" href="namespacenn_1_1os.html#a07c9c7bbc51249b69dc2361957fd650b">nn::os::UnlinkMultiWaitHolder</a>(&amp;movieDecoderPlayer-&gt;m_VideoDecoderMultiWaitHolderTypes.inputBufferAvailableEventHolder);</div>
<div class="line">            <a class="code" href="namespacenn_1_1os.html#a07c9c7bbc51249b69dc2361957fd650b">nn::os::UnlinkMultiWaitHolder</a>(&amp;movieDecoderPlayer-&gt;m_VideoDecoderMultiWaitHolderTypes.outputBufferAvailableEventHolder);</div>
<div class="line">            <span class="comment">// Thread is exiting, unlink AudioDecoder MultiWait holders</span></div>
<div class="line">            <a class="code" href="namespacenn_1_1os.html#a07c9c7bbc51249b69dc2361957fd650b">nn::os::UnlinkMultiWaitHolder</a>(&amp;movieDecoderPlayer-&gt;m_AudioDecoderMultiWaitHolderTypes.errorEventHolder);</div>
<div class="line">            <a class="code" href="namespacenn_1_1os.html#a07c9c7bbc51249b69dc2361957fd650b">nn::os::UnlinkMultiWaitHolder</a>(&amp;movieDecoderPlayer-&gt;m_AudioDecoderMultiWaitHolderTypes.formatChangedEventHolder);</div>
<div class="line">            <a class="code" href="namespacenn_1_1os.html#a07c9c7bbc51249b69dc2361957fd650b">nn::os::UnlinkMultiWaitHolder</a>(&amp;movieDecoderPlayer-&gt;m_AudioDecoderMultiWaitHolderTypes.inputBufferAvailableEventHolder);</div>
<div class="line">            <a class="code" href="namespacenn_1_1os.html#a07c9c7bbc51249b69dc2361957fd650b">nn::os::UnlinkMultiWaitHolder</a>(&amp;movieDecoderPlayer-&gt;m_AudioDecoderMultiWaitHolderTypes.outputBufferAvailableEventHolder);</div>
<div class="line">            <span class="comment">// Thread is exiting, unlink AudioVideoWorker MultiWait holder</span></div>
<div class="line">            <a class="code" href="namespacenn_1_1os.html#a07c9c7bbc51249b69dc2361957fd650b">nn::os::UnlinkMultiWaitHolder</a>( &amp;movieDecoderPlayer-&gt;m_AudioVideoWorkerThreadExitEventHolder );</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">}<span class="comment">//NOLINT(impl/function_size)</span></div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> MovieDecoderPlayer::Reset()</div>
<div class="line">{</div>
<div class="line">    <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5">movie::Status</a> movieStatus = <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5a578dbc51cacf7873a3e40667603e58be">movie::Status_Success</a>;</div>
<div class="line">    <span class="keywordflow">if</span>( m_AudioDecoder != NULL )</div>
<div class="line">    {</div>
<div class="line">        m_AudioDecoder-&gt;Reset();</div>
<div class="line">        <a class="code" href="namespacenn_1_1os.html#a8d4678856d87c3faea21f47ced342bb6">nn::os::LockMutex</a>(&amp;m_AudioListMutex);</div>
<div class="line">        m_AudioBufferIndexList.clear();</div>
<div class="line">        m_MovieAudioOutputHandler-&gt;Stop();</div>
<div class="line">        <a class="code" href="namespacenn_1_1os.html#aa661a7036a18c378a694ad67941cd75e">nn::os::UnlockMutex</a>(&amp;m_AudioListMutex);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">if</span>( m_VideoDecoder != NULL )</div>
<div class="line">    {</div>
<div class="line">        m_VideoDecoder-&gt;Reset();</div>
<div class="line">        <a class="code" href="namespacenn_1_1os.html#a8d4678856d87c3faea21f47ced342bb6">nn::os::LockMutex</a>(&amp;m_VideoListMutex);</div>
<div class="line">        m_VideoBufferIndexList.clear();</div>
<div class="line">        m_MovieVideoOutputHandler-&gt;Stop();</div>
<div class="line">        <a class="code" href="namespacenn_1_1os.html#aa661a7036a18c378a694ad67941cd75e">nn::os::UnlockMutex</a>(&amp;m_VideoListMutex);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">if</span>(m_VideoTrackIndex &gt;= 0)</div>
<div class="line">    {</div>
<div class="line">        movieStatus = ConfigureDecoder(m_VideoDecoder, &amp;m_VideoDecoderEvents, &amp;m_TrackFormat[m_VideoTrackIndex]);</div>
<div class="line">        <span class="keywordflow">if</span>( movieStatus == <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5a578dbc51cacf7873a3e40667603e58be">movie::Status_Success</a> )</div>
<div class="line">        {</div>
<div class="line">            StartDecoder(m_VideoDecoder);</div>
<div class="line">            NN_SDK_LOG( <span class="stringliteral">&quot;\n Failed to reconfigure video decoder \n&quot;</span> );</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">if</span>(m_AudioTrackIndex &gt;= 0)</div>
<div class="line">    {</div>
<div class="line">        movieStatus = ConfigureDecoder(m_AudioDecoder, &amp;m_AudioDecoderEvents, &amp;m_TrackFormat[m_AudioTrackIndex]);</div>
<div class="line">        <span class="keywordflow">if</span>( movieStatus == <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5a578dbc51cacf7873a3e40667603e58be">movie::Status_Success</a> )</div>
<div class="line">        {</div>
<div class="line">            StartDecoder(m_AudioDecoder);</div>
<div class="line">            NN_SDK_LOG(<span class="stringliteral">&quot;\n Failed to reconfigure audio decoder \n&quot;</span>);</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5">movie::Status</a> MovieDecoderPlayer::HandleLoopBack()</div>
<div class="line">{</div>
<div class="line">    <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5">movie::Status</a> movieStatus = <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5a819d55a4ad4bd1ac42bc65771cdc6792">movie::Status_UnknownError</a>;</div>
<div class="line">    ResetPlaybackComplete();</div>
<div class="line">    <a class="code" href="namespacenn_1_1os.html#a8d4678856d87c3faea21f47ced342bb6">nn::os::LockMutex</a>(&amp;m_AudioListMutex);</div>
<div class="line">    m_AudioBufferIndexList.clear();</div>
<div class="line">    <a class="code" href="namespacenn_1_1os.html#aa661a7036a18c378a694ad67941cd75e">nn::os::UnlockMutex</a>(&amp;m_AudioListMutex);</div>
<div class="line">    <a class="code" href="namespacenn_1_1os.html#a8d4678856d87c3faea21f47ced342bb6">nn::os::LockMutex</a>(&amp;m_VideoListMutex);</div>
<div class="line">    m_VideoBufferIndexList.clear();</div>
<div class="line">    <a class="code" href="namespacenn_1_1os.html#aa661a7036a18c378a694ad67941cd75e">nn::os::UnlockMutex</a>(&amp;m_VideoListMutex);</div>
<div class="line">    <span class="keywordflow">if</span>( m_MovieVideoOutputHandler != <span class="keyword">nullptr</span> )</div>
<div class="line">    {</div>
<div class="line">        m_MovieVideoOutputHandler-&gt;Pause();</div>
<div class="line">        m_MovieVideoOutputHandler-&gt;Stop();</div>
<div class="line">        m_MovieVideoOutputHandler-&gt;Finalize();</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">if</span>( m_MovieAudioOutputHandler != <span class="keyword">nullptr</span> )</div>
<div class="line">    {</div>
<div class="line">        m_MovieAudioOutputHandler-&gt;Pause();</div>
<div class="line">        m_MovieAudioOutputHandler-&gt;Stop();</div>
<div class="line">        m_MovieAudioOutputHandler-&gt;Close();</div>
<div class="line">        m_MovieAudioOutputHandler-&gt;Finalize();</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">if</span>( m_VideoDecoder != <span class="keyword">nullptr</span> )</div>
<div class="line">        m_VideoDecoder-&gt;Flush();</div>
<div class="line">    <span class="keywordflow">if</span>( m_AudioDecoder != <span class="keyword">nullptr</span> )</div>
<div class="line">        m_AudioDecoder-&gt;Flush();</div>
<div class="line">    <span class="keywordflow">if</span>( m_Extractor != <span class="keyword">nullptr</span> )</div>
<div class="line">        m_Extractor-&gt;SeekTo(0);</div>
<div class="line">    <span class="keywordflow">if</span>( m_ByteStreamReader != NULL )</div>
<div class="line">    {</div>
<div class="line">        movieStatus = m_ByteStreamReader-&gt;PrepareForLooping();</div>
<div class="line">        <span class="keywordflow">if</span>( movieStatus != <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5a578dbc51cacf7873a3e40667603e58be">movie::Status_Success</a> )</div>
<div class="line">            <span class="keywordflow">return</span> movieStatus;</div>
<div class="line">    }</div>
<div class="line">    m_MediaClock-&gt;ClearAnchorTime();</div>
<div class="line">    <span class="keywordflow">if</span>( m_MovieVideoOutputHandler != <span class="keyword">nullptr</span> )</div>
<div class="line">    {</div>
<div class="line">        m_MovieVideoOutputHandler-&gt;Initialize(m_MediaClock, <span class="keyword">nullptr</span>);</div>
<div class="line">        m_MovieVideoOutputHandler-&gt;Start(m_Width, m_Height);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">if</span>( m_MovieAudioOutputHandler != <span class="keyword">nullptr</span> )</div>
<div class="line">    {</div>
<div class="line">        m_MovieAudioOutputHandler-&gt;Initialize(m_MediaClock);</div>
<div class="line">        m_MovieAudioOutputHandler-&gt;Open(m_AudioDecoder, m_SampleRate, m_NumChannels, m_VariableSizeAudioFrames);</div>
<div class="line">        m_MovieAudioOutputHandler-&gt;Start();</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">if</span>( m_VideoDecoder != <span class="keyword">nullptr</span> )</div>
<div class="line">        m_VideoDecoder-&gt;Start();</div>
<div class="line">    <span class="keywordflow">if</span>( m_AudioDecoder != <span class="keyword">nullptr</span> )</div>
<div class="line">        m_AudioDecoder-&gt;Start();</div>
<div class="line">    m_LoopCount++;</div>
<div class="line">    NN_SDK_LOG(<span class="stringliteral">&quot;\n Loop Count : %d\n&quot;</span>, m_LoopCount);</div>
<div class="line">    <span class="keywordflow">return</span> <a class="code" href="namespacemovie.html#aae52268c80d5ad84f5ca8eda8eaad4c5a578dbc51cacf7873a3e40667603e58be">movie::Status_Success</a>;</div>
<div class="line">}<span class="comment">//NOLINT(impl/function_size)</span></div>
<div class="line"></div>
<div class="line"><span class="keywordtype">bool</span> MovieDecoderPlayer::IsAudioDecoder(<a class="code" href="namespacemovie.html#a13e52fd4ee5ac91b6966c5afb314373c">movie::DecoderType</a> decoderType)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">if</span>( ( decoderType == <a class="code" href="namespacemovie.html#a13e52fd4ee5ac91b6966c5afb314373ca949b76f8cf9e591b7abeb365d7776eae">movie::DecoderType_AudioAac</a> ) ||</div>
<div class="line">        ( decoderType == <a class="code" href="namespacemovie.html#a13e52fd4ee5ac91b6966c5afb314373caf7aa15d900e0dced6523112f0dec9cd7">movie::DecoderType_AudioVorbis</a> ) )</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">bool</span> MovieDecoderPlayer::IsVideoDecoder(<a class="code" href="namespacemovie.html#a13e52fd4ee5ac91b6966c5afb314373c">movie::DecoderType</a> decoderType)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">if</span>( ( decoderType == <a class="code" href="namespacemovie.html#a13e52fd4ee5ac91b6966c5afb314373cab217d89283577ce5f43ca1a91a6218fa">movie::DecoderType_VideoAvc</a> ) ||</div>
<div class="line">        ( decoderType == <a class="code" href="namespacemovie.html#a13e52fd4ee5ac91b6966c5afb314373ca1313bb0e49ad71e6828ec8ade6003d4e">movie::DecoderType_VideoVp8</a> ) ||</div>
<div class="line">        ( decoderType == <a class="code" href="namespacemovie.html#a13e52fd4ee5ac91b6966c5afb314373ca3596c2d49a5a2c15cd3165b45055accd">movie::DecoderType_VideoVp9</a> ) )</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> MovieDecoderPlayer::CheckAndSignalFormatChangeWaiter()</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">if</span>( ( m_AudioFormatChangeEventReceived == <span class="keyword">true</span> ) &amp;&amp; ( m_VideoFormatChangeEventReceived == <span class="keyword">true</span> ) )</div>
<div class="line">    {</div>
<div class="line">        <a class="code" href="namespacenn_1_1os.html#a9b959a51c1d28b76894597695fd3d081">nn::os::SignalEvent</a>(&amp;m_FormatChangedPlayerEvent);</div>
<div class="line">        m_AudioFormatChangeEventReceived = <span class="keyword">false</span>;</div>
<div class="line">        m_VideoFormatChangeEventReceived = <span class="keyword">false</span>;</div>
<div class="line">        <span class="keywordflow">if</span>( m_AudioDecoder == <span class="keyword">nullptr</span> )</div>
<div class="line">            m_AudioFormatChangeEventReceived = <span class="keyword">true</span>;</div>
<div class="line">        <span class="keywordflow">if</span>( m_VideoDecoder == <span class="keyword">nullptr</span> )</div>
<div class="line">            m_VideoFormatChangeEventReceived = <span class="keyword">true</span>;</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> MovieDecoderPlayer::WaitForFormatChange()</div>
<div class="line">{</div>
<div class="line">    <a name="a121"></a><a class="code" href="namespacenn_1_1os.html#a9fba39baba3e475cae08127a632cab07">nn::os::TimedWaitEvent</a>(&amp;m_FormatChangedPlayerEvent, <a class="code" href="classnn_1_1_time_span.html#a1b8582b5180ce7992fc82a148c7f8c90">nn::TimeSpan::FromMilliSeconds</a>(5000));</div>
<div class="line">    <a class="code" href="namespacenn_1_1os.html#a46abbb4e59711874cfec72fe97b58e36">nn::os::ClearEvent</a>(&amp;m_FormatChangedPlayerEvent);</div>
<div class="line">}</div>
</div><!-- fragment --> </div><!-- contents -->
<!-- HTML footer for doxygen 1.8.8-->
<!-- start footer part -->
</body>
</html>
