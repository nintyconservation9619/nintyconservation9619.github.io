<!-- HTML header for doxygen 1.8.8-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.10"/>
<title>NintendoSDK API Reference: AssetFileDataHolder.cpp</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="openclose.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="stylesheet.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">NintendoSDK API Reference
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- 構築: Doxygen 1.8.10 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'検索');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>総合概要</span></a></li>
      <li><a href="pages.html"><span>諸情報</span></a></li>
      <li><a href="modules.html"><span>モジュール</span></a></li>
      <li><a href="namespaces.html"><span>名前空間</span></a></li>
      <li><a href="annotated.html"><span>クラス</span></a></li>
      <li><a href="files.html"><span>ファイル</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="検索" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">AssetFileDataHolder.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<p>ソースコードの説明は、<a class="el" href="_page_sample_nvn_tutorial_library.html">NVN Tutorial Library</a> および <a class="el" href="_asset_file_data_holder_8cpp.html" title="This files defines some structures that hold the data provided by an asset file created by Tutorial02...">AssetFileDataHolder.cpp</a> を参照してください。</p>
<div class="fragment"><div class="line"><span class="comment">/*--------------------------------------------------------------------------------*</span></div>
<div class="line"><span class="comment">  Copyright (C)Nintendo All rights reserved.</span></div>
<div class="line"><span class="comment"></span></div>
<div class="line"><span class="comment">  These coded instructions, statements, and computer programs contain proprietary</span></div>
<div class="line"><span class="comment">  information of Nintendo and/or its licensed developers and are protected by</span></div>
<div class="line"><span class="comment">  national and international copyright laws. They may not be disclosed to third</span></div>
<div class="line"><span class="comment">  parties or copied or duplicated in any form, in whole or in part, without the</span></div>
<div class="line"><span class="comment">  prior written consent of Nintendo.</span></div>
<div class="line"><span class="comment"></span></div>
<div class="line"><span class="comment">  The content herein is highly confidential and should be handled accordingly.</span></div>
<div class="line"><span class="comment"> *--------------------------------------------------------------------------------*/</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#include &lt;vector&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="nn___assert_8h.html">nn/nn_Assert.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="_asset_file_data_holder_8h.html">nvntutorial/AssetFileDataHolder.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="_texture_i_d_manager_8h.html">nvntutorial/TextureIDManager.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="_memory_pool_8h.html">nvntutorial/MemoryPool.h</a>&gt;</span></div>
<div class="line"></div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * NVNProgramData::Initialize</span></div>
<div class="line"><span class="comment"> * --------------------------</span></div>
<div class="line"><span class="comment"> * Sets up some default values for the structure.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keywordtype">void</span> <a name="a0"></a><a class="code" href="namespacenn_1_1htcs.html#a7eab72b8843a2a9ff763f52b78da680e">NVNProgramData::Initialize</a>()</div>
<div class="line">{</div>
<div class="line">    m_pProgramName = NULL;</div>
<div class="line">    m_ShaderStages = 0;</div>
<div class="line">    m_ShaderType = ShaderTypes::ShaderType_Num;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * NVNProgramData::SetName</span></div>
<div class="line"><span class="comment"> * --------------------------</span></div>
<div class="line"><span class="comment"> * Sets the name of the shader program.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keywordtype">void</span> NVNProgramData::SetName(<span class="keyword">const</span> <span class="keywordtype">char</span>* pName, <span class="keywordtype">int</span> length)</div>
<div class="line">{</div>
<div class="line">    m_pProgramName = <span class="keyword">new</span> <span class="keywordtype">char</span>[length + 1];</div>
<div class="line">    memset(m_pProgramName, 0, length + 1);</div>
<div class="line">    memcpy(m_pProgramName, pName, length);</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * NVNProgramData::Finalize</span></div>
<div class="line"><span class="comment"> * ------------------------</span></div>
<div class="line"><span class="comment"> * Cleans up the memory allocated for the object</span></div>
<div class="line"><span class="comment"> * and any NVN objects associated with it.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keywordtype">void</span> <a name="a1"></a><a class="code" href="namespacenn_1_1htcs.html#abf5eb36f3563222450920fad56fdaf61">NVNProgramData::Finalize</a>()</div>
<div class="line">{</div>
<div class="line">    <a name="a2"></a><a class="code" href="group__nvn__c__functions.html#ga24bd32154585c557cea6e061aecb6000">nvnProgramFinalize</a>(&amp;m_Program);</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (m_pProgramName)</div>
<div class="line">    {</div>
<div class="line">        <span class="keyword">delete</span>[] m_pProgramName;</div>
<div class="line">        m_pProgramName = NULL;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; m_ShaderBuffers.size(); ++i)</div>
<div class="line">    {</div>
<div class="line">        <a name="a3"></a><a class="code" href="group__nvn__c__functions.html#ga3e56941d8153c1e1b2ba861189ea993d">nvnBufferFinalize</a>(m_ShaderBuffers[i]);</div>
<div class="line">        <span class="keyword">delete</span> m_ShaderBuffers[i];</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    m_ShaderBuffers.clear();</div>
<div class="line">    m_ShaderStages = 0;</div>
<div class="line"></div>
<div class="line">    m_ShaderMemoryPool.Shutdown();</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * NVNModelData::Initialize</span></div>
<div class="line"><span class="comment"> * ------------------------</span></div>
<div class="line"><span class="comment"> * Sets up some default values for the structure.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keywordtype">void</span> <a class="code" href="namespacenn_1_1htcs.html#a7eab72b8843a2a9ff763f52b78da680e">NVNModelData::Initialize</a>()</div>
<div class="line">{</div>
<div class="line">    m_pModelName = NULL;</div>
<div class="line">    m_VertexBufferSize = 0;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * NVNModelData::SetName</span></div>
<div class="line"><span class="comment"> * ---------------------</span></div>
<div class="line"><span class="comment"> * Sets the model&#39;s name.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keywordtype">void</span> NVNModelData::SetName(<span class="keyword">const</span> <span class="keywordtype">char</span>* pName, <span class="keywordtype">int</span> length)</div>
<div class="line">{</div>
<div class="line">    m_pModelName = <span class="keyword">new</span> <span class="keywordtype">char</span>[length + 1];</div>
<div class="line">    memset(m_pModelName, 0, length + 1);</div>
<div class="line">    memcpy(m_pModelName, pName, length);</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * NVNModelData::Finalize</span></div>
<div class="line"><span class="comment"> * ----------------------</span></div>
<div class="line"><span class="comment"> * Cleans up the memory allocated for the object</span></div>
<div class="line"><span class="comment"> * and any NVN objects associated with it.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keywordtype">void</span> <a class="code" href="namespacenn_1_1htcs.html#abf5eb36f3563222450920fad56fdaf61">NVNModelData::Finalize</a>()</div>
<div class="line">{</div>
<div class="line">    <a class="code" href="group__nvn__c__functions.html#ga3e56941d8153c1e1b2ba861189ea993d">nvnBufferFinalize</a>(&amp;m_VertexBuffer);</div>
<div class="line"></div>
<div class="line">    <a class="code" href="group__nvn__c__functions.html#ga3e56941d8153c1e1b2ba861189ea993d">nvnBufferFinalize</a>(&amp;m_IndexBuffer);</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span>(m_pModelName)</div>
<div class="line">    {</div>
<div class="line">        <span class="keyword">delete</span>[] m_pModelName;</div>
<div class="line">        m_pModelName = NULL;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    m_BufferMemoryPool.Shutdown();</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; m_Model.m_VertexAttributes.size(); ++i)</div>
<div class="line">    {</div>
<div class="line">        VertexAttribute&amp; attr = m_Model.m_VertexAttributes[i];</div>
<div class="line">        <span class="keywordflow">if</span>(attr.m_pData)</div>
<div class="line">        {</div>
<div class="line">            <span class="keyword">delete</span> <span class="keyword">reinterpret_cast&lt;</span><span class="keywordtype">char</span>*<span class="keyword">&gt;</span>(attr.m_pData);</div>
<div class="line">            attr.m_pData = NULL;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (m_Model.m_IndexData.m_pData)</div>
<div class="line">    {</div>
<div class="line">        <span class="keyword">delete</span> <span class="keyword">reinterpret_cast&lt;</span><span class="keywordtype">char</span>*<span class="keyword">&gt;</span>(m_Model.m_IndexData.m_pData);</div>
<div class="line">        m_Model.m_IndexData.m_pData = NULL;</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * NVNModelData::AddVertexAttribute</span></div>
<div class="line"><span class="comment"> * --------------------------------</span></div>
<div class="line"><span class="comment"> * Copies the given vertex attribute data into</span></div>
<div class="line"><span class="comment"> * the model data structure.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keywordtype">void</span> NVNModelData::AddVertexAttribute(<span class="keyword">const</span> VertexAttributeHeader&amp; header)</div>
<div class="line">{</div>
<div class="line">    VertexAttribute attribute;</div>
<div class="line">    attribute.m_Name = std::string(header.m_pAttributeName, header.m_AttributeNameLength);</div>
<div class="line">    attribute.m_DataSize = header.m_AttributeDataSize;</div>
<div class="line">    attribute.m_ElementSize = header.m_AttributeDataSize / header.m_AttributeStride;</div>
<div class="line">    attribute.m_Stride = header.m_AttributeStride;</div>
<div class="line">    attribute.m_NvnFormat = header.m_NvnFormat;</div>
<div class="line">    attribute.m_Location = <span class="keyword">static_cast&lt;</span>uint32_t<span class="keyword">&gt;</span>(-1);</div>
<div class="line">    attribute.m_pData = <span class="keyword">new</span> <span class="keywordtype">char</span>[header.m_AttributeDataSize];</div>
<div class="line"></div>
<div class="line">    memcpy(attribute.m_pData, header.m_AttributeData, header.m_AttributeDataSize);</div>
<div class="line">    m_Model.m_VertexAttributes.push_back(attribute);</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * NVNModelData::SetupAttributeStatesNVN</span></div>
<div class="line"><span class="comment"> * -------------------------------------</span></div>
<div class="line"><span class="comment"> * Sets up NVNvertexAttibState and NVNvertexStream state</span></div>
<div class="line"><span class="comment"> * classes for each of the loaded vertex attributes.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keywordtype">void</span> NVNModelData::SetupAttributeStatesNVN(int32_t (*GetLocation)(<span class="keyword">const</span> std::string&amp;))</div>
<div class="line">{</div>
<div class="line">    m_VertexAttributeStates.resize(m_Model.m_NumVertexAttributes);</div>
<div class="line">    m_VertexStreamStates.resize(m_Model.m_NumVertexAttributes);</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">for</span> (uint32_t i = 0; i &lt; m_Model.m_NumVertexAttributes; ++i)</div>
<div class="line">    {</div>
<div class="line">        VertexAttribute&amp; attribute = m_Model.m_VertexAttributes[i];</div>
<div class="line">        uint32_t location = <span class="keyword">static_cast&lt;</span>uint32_t<span class="keyword">&gt;</span>(GetLocation(attribute.m_Name));</div>
<div class="line"></div>
<div class="line">        attribute.m_Location = location;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (location &gt;= m_Model.m_NumVertexAttributes)</div>
<div class="line">            <a name="a4"></a><a class="code" href="nn___assert_8h.html#ade59d1d911907a16c0241f8fe3b31542">NN_ASSERT</a>(0, <span class="stringliteral">&quot;location outside of vector range.&quot;</span>);</div>
<div class="line"></div>
<div class="line">            <span class="comment">/*</span></div>
<div class="line"><span class="comment">             * NVN Vertex Attribute and Stream States</span></div>
<div class="line"><span class="comment">             * --------------------------------------</span></div>
<div class="line"><span class="comment">             * The NVNvertexAttributeState object is used to</span></div>
<div class="line"><span class="comment">             * define the format of a given vertex attribute. It</span></div>
<div class="line"><span class="comment">             * is also associated with an NVNvertexStreamState</span></div>
<div class="line"><span class="comment">             * object. The stream state controls the stride and</span></div>
<div class="line"><span class="comment">             * the divisor of the attribute. The attribute state</span></div>
<div class="line"><span class="comment">             * and stream state objects are bound to a command</span></div>
<div class="line"><span class="comment">             * buffer in arrays. The index into the attribute</span></div>
<div class="line"><span class="comment">             * state array of a given attribute determines it&#39;s</span></div>
<div class="line"><span class="comment">             * binding location in the shader. The stream index</span></div>
<div class="line"><span class="comment">             * held by the attribute state is an index into the</span></div>
<div class="line"><span class="comment">             * bound stream state array.</span></div>
<div class="line"><span class="comment">             */</span></div>
<div class="line">        <a name="_a5"></a><a class="code" href="struct_n_v_nvertex_attrib_state.html">NVNvertexAttribState</a>* pAttributeState = &amp;m_VertexAttributeStates[location];</div>
<div class="line"></div>
<div class="line">        <a name="a6"></a><a class="code" href="group__nvn__c__functions.html#ga8e71254f0f8cd7eb8fa2aa8e8909779f">nvnVertexAttribStateSetDefaults</a>(pAttributeState);</div>
<div class="line">        <a name="a7"></a><a class="code" href="group__nvn__c__functions.html#gab96f74226c1d22d01c186d908eff14ab">nvnVertexAttribStateSetStreamIndex</a>(pAttributeState, location);</div>
<div class="line">        <a name="a8"></a><a class="code" href="group__nvn__c__functions.html#ga447b6bbe81e21c3bff3dbf10bc15d80e">nvnVertexAttribStateSetFormat</a>(pAttributeState, static_cast&lt;NVNformat&gt;(attribute.m_NvnFormat), 0);</div>
<div class="line"></div>
<div class="line">        <a name="_a9"></a><a class="code" href="struct_n_v_nvertex_stream_state.html">NVNvertexStreamState</a>* pStreamState = &amp;m_VertexStreamStates[location];</div>
<div class="line">        <a name="a10"></a><a class="code" href="group__nvn__c__functions.html#ga9dca0133939bd660957dd5de2a56d240">nvnVertexStreamStateSetDefaults</a>(pStreamState);</div>
<div class="line">        <a name="a11"></a><a class="code" href="group__nvn__c__functions.html#ga9a72c7499ec4a36d8cc38d0b5d575c90">nvnVertexStreamStateSetStride</a>(pStreamState, attribute.m_Stride);</div>
<div class="line"></div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * NVNTextureData::Initialize</span></div>
<div class="line"><span class="comment"> * --------------------------</span></div>
<div class="line"><span class="comment"> * Sets up some default values for the structure.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keywordtype">void</span> <a class="code" href="namespacenn_1_1htcs.html#a7eab72b8843a2a9ff763f52b78da680e">NVNTextureData::Initialize</a>()</div>
<div class="line">{</div>
<div class="line">    m_TextureID = 0;</div>
<div class="line">    m_SamplerID = 0;</div>
<div class="line">    m_TextureInitialized = <span class="keyword">false</span>;</div>
<div class="line">    m_SamplerInitialized = <span class="keyword">false</span>;</div>
<div class="line">    m_TextureHandle = NULL;</div>
<div class="line">    m_pTextureName = NULL;</div>
<div class="line">    m_TextureDataSize = 0;</div>
<div class="line">    m_GpuVersion = 0;</div>
<div class="line">    m_Alignment = 0;</div>
<div class="line">    m_Width = 0;</div>
<div class="line">    m_Height = 0;</div>
<div class="line">    m_Depth = 0;</div>
<div class="line">    m_NvnTextureTarget = <a name="a12"></a><a class="code" href="group__nvn__c__enum.html#gga7f247010f53480c7dd1f3b2ad638c431a856184892b54a04cd16ec7848108ec53">NVN_TEXTURE_TARGET_2D</a>;</div>
<div class="line">    m_NvnFormat = <a name="a13"></a><a class="code" href="group__nvn__c__enum.html#gga99463f5b9af6151e604b01dfdd5fecaba7c782a722996d27efbfc6f9128f32d73">NVN_FORMAT_NONE</a>;</div>
<div class="line">    m_MipLevels = 0;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * NVNTextureData::SetName</span></div>
<div class="line"><span class="comment"> * -----------------------</span></div>
<div class="line"><span class="comment"> * Sets the name of the texture.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keywordtype">void</span> NVNTextureData::SetName(<span class="keyword">const</span> <span class="keywordtype">char</span>* pName, <span class="keywordtype">int</span> length)</div>
<div class="line">{</div>
<div class="line">    m_pTextureName = <span class="keyword">new</span> <span class="keywordtype">char</span>[length + 1];</div>
<div class="line">    memset(m_pTextureName, 0, length + 1);</div>
<div class="line">    memcpy(m_pTextureName, pName, length);</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * NVNTextureData::Finalize</span></div>
<div class="line"><span class="comment"> * ------------------------</span></div>
<div class="line"><span class="comment"> * Cleans up the memory allocated for the object</span></div>
<div class="line"><span class="comment"> * and any NVN objects associated with it.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keywordtype">void</span> <a class="code" href="namespacenn_1_1htcs.html#abf5eb36f3563222450920fad56fdaf61">NVNTextureData::Finalize</a>()</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">if</span> (m_TextureInitialized)</div>
<div class="line">    {</div>
<div class="line">        <a name="a14"></a><a class="code" href="group__nvn__c__functions.html#gaa5741253f7ab5c9075a6821a68cfa351">nvnTextureFinalize</a>(&amp;m_Texture);</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (m_SamplerInitialized)</div>
<div class="line">    {</div>
<div class="line">        <a name="a15"></a><a class="code" href="group__nvn__c__functions.html#ga82945a36dea04505dcd29e03442ed5a6">nvnSamplerFinalize</a>(&amp;m_Sampler);</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    m_TextureMemoryPool.Shutdown();</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (m_pTextureName)</div>
<div class="line">    {</div>
<div class="line">        <span class="keyword">delete</span>[] m_pTextureName;</div>
<div class="line">        m_pTextureName = NULL;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    m_TextureHandle = NULL;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * AssetFileDataHolder Constructor</span></div>
<div class="line"><span class="comment"> * -------------------------------</span></div>
<div class="line"><span class="comment"> * Empty default constuctor.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line">AssetFileDataHolder::AssetFileDataHolder()</div>
<div class="line">{</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * AssetFileDataHolder Destructor</span></div>
<div class="line"><span class="comment"> * ------------------------------</span></div>
<div class="line"><span class="comment"> * Calls the Finalize funcion to clean up if needed.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line">AssetFileDataHolder::~AssetFileDataHolder()</div>
<div class="line">{</div>
<div class="line">    <a class="code" href="namespacenn_1_1htcs.html#abf5eb36f3563222450920fad56fdaf61">Finalize</a>();</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * AssetFileDataHolder::Finalize</span></div>
<div class="line"><span class="comment"> * -----------------------------</span></div>
<div class="line"><span class="comment"> * Cleans up the memory allocated for the objects.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keywordtype">void</span> <a class="code" href="namespacenn_1_1htcs.html#abf5eb36f3563222450920fad56fdaf61">AssetFileDataHolder::Finalize</a>()</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; m_ProgramData.size(); ++i)</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">if</span> (m_ProgramData[i])</div>
<div class="line">        {</div>
<div class="line">            m_ProgramData[i]-&gt;Finalize();</div>
<div class="line">            <span class="keyword">delete</span> m_ProgramData[i];</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; m_ModelData.size(); ++i)</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">if</span> (m_ModelData[i])</div>
<div class="line">        {</div>
<div class="line">            m_ModelData[i]-&gt;Finalize();</div>
<div class="line">            <span class="keyword">delete</span> m_ModelData[i];</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; m_TextureData.size(); ++i)</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">if</span> (m_TextureData[i])</div>
<div class="line">        {</div>
<div class="line">            m_TextureData[i]-&gt;Finalize();</div>
<div class="line">            <span class="keyword">delete</span> m_TextureData[i];</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * AssetFileDataHolder::AddProgramData</span></div>
<div class="line"><span class="comment"> * -----------------------------------</span></div>
<div class="line"><span class="comment"> * Adds a shader program data structure to the data holder.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keywordtype">void</span> AssetFileDataHolder::AddProgramData(NVNProgramData* pProgramData)</div>
<div class="line">{</div>
<div class="line">    m_ProgramData.push_back(pProgramData);</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * AssetFileDataHolder::AddModelData</span></div>
<div class="line"><span class="comment"> * ---------------------------------</span></div>
<div class="line"><span class="comment"> * Adds a model data structure to the data holder.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keywordtype">void</span> AssetFileDataHolder::AddModelData(NVNModelData* pModelData)</div>
<div class="line">{</div>
<div class="line">    m_ModelData.push_back(pModelData);</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * AssetFileDataHolder::AddTextureData</span></div>
<div class="line"><span class="comment"> * -----------------------------------</span></div>
<div class="line"><span class="comment"> * Adds a texture data structure to the data holder.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keywordtype">void</span> AssetFileDataHolder::AddTextureData(NVNTextureData* pTextureData)</div>
<div class="line">{</div>
<div class="line">    m_TextureData.push_back(pTextureData);</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * AssetFileDataHolder::GetProgramData</span></div>
<div class="line"><span class="comment"> * -----------------------------------</span></div>
<div class="line"><span class="comment"> * Get the list of shader program data structures.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line">std::vector&lt;NVNProgramData*&gt;&amp; AssetFileDataHolder::GetProgramData()</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">return</span> m_ProgramData;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * AssetFileDataHolder::GetModelData</span></div>
<div class="line"><span class="comment"> * ---------------------------------</span></div>
<div class="line"><span class="comment"> * Get the list of model data structures.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line">std::vector&lt;NVNModelData*&gt;&amp; AssetFileDataHolder::GetModelData()</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">return</span> m_ModelData;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * AssetFileDataHolder::GetTextureData</span></div>
<div class="line"><span class="comment"> * -----------------------------------</span></div>
<div class="line"><span class="comment"> * Get the list of texture data structures.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line">std::vector&lt;NVNTextureData*&gt;&amp; AssetFileDataHolder::GetTextureData()</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">return</span> m_TextureData;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * AssetFileDataHolder::SetupAttributeStatesNVN</span></div>
<div class="line"><span class="comment"> * --------------------------------------------</span></div>
<div class="line"><span class="comment"> * Sets up the vertex attribute states and vertex stream</span></div>
<div class="line"><span class="comment"> * states for each model.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keywordtype">void</span> AssetFileDataHolder::SetupAttributeStatesNVN(int32_t(*GetLocation)(<span class="keyword">const</span> std::string&amp;))</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; m_ModelData.size(); ++i)</div>
<div class="line">    {</div>
<div class="line">        m_ModelData[i]-&gt;SetupAttributeStatesNVN(GetLocation);</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * AssetFileDataHolder::SetupTextureSamplerHandle</span></div>
<div class="line"><span class="comment"> * ----------------------------------------------</span></div>
<div class="line"><span class="comment"> * Builds a sampler using the passed in NVNsamplerBuilder,</span></div>
<div class="line"><span class="comment"> * registers the sampler for each texture, and creates</span></div>
<div class="line"><span class="comment"> * the texture handle.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keywordtype">void</span> AssetFileDataHolder::SetupTextureSamplerHandle(<a name="_a16"></a><a class="code" href="struct_n_v_ndevice.html">NVNdevice</a>* pDevice, TextureIDManager* pTextureIDManager, <a name="_a17"></a><a class="code" href="struct_n_v_nsampler_builder.html">NVNsamplerBuilder</a>* pSamplerBuilder)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; m_TextureData.size(); ++i)</div>
<div class="line">    {</div>
<div class="line">            <span class="comment">/* Initialize the sampler used for the texture and register it with the pool. */</span></div>
<div class="line">        NVNboolean samplerSuccess = <a name="a18"></a><a class="code" href="group__nvn__c__functions.html#ga5f3728966dc1ce72231c88bd3bca94ad">nvnSamplerInitialize</a>(&amp;m_TextureData[i]-&gt;m_Sampler, pSamplerBuilder);</div>
<div class="line">        <a class="code" href="nn___assert_8h.html#ade59d1d911907a16c0241f8fe3b31542">NN_ASSERT</a>(samplerSuccess, <span class="stringliteral">&quot;Failed to initialize sampler\n&quot;</span>);</div>
<div class="line">        m_TextureData[i]-&gt;m_SamplerInitialized = <span class="keyword">true</span>;</div>
<div class="line">        m_TextureData[i]-&gt;m_SamplerID = pTextureIDManager-&gt;RegisterSampler(&amp;m_TextureData[i]-&gt;m_Sampler);</div>
<div class="line"></div>
<div class="line">            <span class="comment">/* Combine the texture ID and the sampler ID to make a 64-bit texture handle. */</span></div>
<div class="line">        m_TextureData[i]-&gt;m_TextureHandle = <a name="a19"></a><a class="code" href="group__nvn__c__functions.html#ga0ca6fe7fc102170723f5eccb14a25046">nvnDeviceGetTextureHandle</a>(pDevice, m_TextureData[i]-&gt;m_TextureID, m_TextureData[i]-&gt;m_SamplerID);</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"></div>
</div><!-- fragment --> </div><!-- contents -->
<!-- HTML footer for doxygen 1.8.8-->
<!-- start footer part -->
</body>
</html>
