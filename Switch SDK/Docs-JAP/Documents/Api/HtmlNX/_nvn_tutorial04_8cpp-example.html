<!-- HTML header for doxygen 1.8.8-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.10"/>
<title>NintendoSDK API Reference: NvnTutorial04.cpp</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="openclose.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="stylesheet.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">NintendoSDK API Reference
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- 構築: Doxygen 1.8.10 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'検索');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>総合概要</span></a></li>
      <li><a href="pages.html"><span>諸情報</span></a></li>
      <li><a href="modules.html"><span>モジュール</span></a></li>
      <li><a href="namespaces.html"><span>名前空間</span></a></li>
      <li><a href="annotated.html"><span>クラス</span></a></li>
      <li><a href="files.html"><span>ファイル</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="検索" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">NvnTutorial04.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<p>ソースコードの説明は、<a class="el" href="_page_sample_nvn_tutorial04.html">NVN Tutorial 04: Multithreaded Asset File Loading, Cube Maps, and Mipmaps</a> および <a class="el" href="_nvn_tutorial04_8cpp.html" title="This tutorial builds off of Tutorial03 and introduces asset file loading in parallel on multiple thre...">NvnTutorial04.cpp</a> を参照してください。</p>
<div class="fragment"><div class="line"><span class="comment">/*--------------------------------------------------------------------------------*</span></div>
<div class="line"><span class="comment">  Copyright (C)Nintendo All rights reserved.</span></div>
<div class="line"><span class="comment"></span></div>
<div class="line"><span class="comment">  These coded instructions, statements, and computer programs contain proprietary</span></div>
<div class="line"><span class="comment">  information of Nintendo and/or its licensed developers and are protected by</span></div>
<div class="line"><span class="comment">  national and international copyright laws. They may not be disclosed to third</span></div>
<div class="line"><span class="comment">  parties or copied or duplicated in any form, in whole or in part, without the</span></div>
<div class="line"><span class="comment">  prior written consent of Nintendo.</span></div>
<div class="line"><span class="comment"></span></div>
<div class="line"><span class="comment">  The content herein is highly confidential and should be handled accordingly.</span></div>
<div class="line"><span class="comment"> *--------------------------------------------------------------------------------*/</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#include &lt;cstdio&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;cmath&gt;</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#include &lt;nn/nn_SdkAssert.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="nn___log_8h.html">nn/nn_Log.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;nn/os.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="os___thread_8h.html">nn/os/os_Thread.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="os___mutex_8h.html">nn/os/os_Mutex.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="fs_8h.html">nn/fs.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="util___matrix_8h.html">nn/util/util_Matrix.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="util___vector_8h.html">nn/util/util_Vector.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="nvn___func_ptr_inline_8h.html">nvn/nvn_FuncPtrInline.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="nvn___func_ptr_impl_8h.html">nvn/nvn_FuncPtrImpl.h</a>&gt;</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="_tutorial_base_class_8h.html">nvntutorial/TutorialBaseClass.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="_multi_threaded_asset_file_loading_helper_8h.html">nvntutorial/MultiThreadedAssetFileLoadingHelper.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="_texture_i_d_manager_8h.html">nvntutorial/TextureIDManager.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="_tutorial_util_8h.html">nvntutorial/TutorialUtil.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="_uniform_buffer_8h.html">nvntutorial/UniformBuffer.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="_memory_pool_8h.html">nvntutorial/MemoryPool.h</a>&gt;</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#ifdef _WIN32</span></div>
<div class="line"><span class="preprocessor">    #ifndef WIN32_LEAN_AND_MEAN</span></div>
<div class="line"><span class="preprocessor">    #define WIN32_LEAN_AND_MEAN</span></div>
<div class="line"><span class="preprocessor">    #endif</span></div>
<div class="line"><span class="preprocessor">    #ifndef NOMINMAX</span></div>
<div class="line"><span class="preprocessor">    #define NOMINMAX</span></div>
<div class="line"><span class="preprocessor">    #endif</span></div>
<div class="line"><span class="preprocessor">    #include &lt;<a class="code" href="nn___windows_8h.html">nn/nn_Windows.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"></div>
<div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span>    g_CubesToRender = 3;</div>
<div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">float</span>  g_Pi = 3.14159f;</div>
<div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">size_t</span> g_CommandMemorySize = 2 * 1024;</div>
<div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">size_t</span> g_ControlMemorySize = 2 * 1024;</div>
<div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">size_t</span> g_NumColorBuffers = 2;</div>
<div class="line"></div>
<div class="line"><span class="keyword">class </span>MultiThreadedAssetFileLoading : <span class="keyword">public</span> TutorialBaseClass</div>
<div class="line">{</div>
<div class="line">    <a name="a0"></a><a class="code" href="nn___macro_8h.html#a82564079f8f8c6547726002a9b168bdb">NN_DISALLOW_COPY</a>(MultiThreadedAssetFileLoading);</div>
<div class="line"></div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    MultiThreadedAssetFileLoading();</div>
<div class="line">    <span class="keyword">virtual</span> ~MultiThreadedAssetFileLoading();</div>
<div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">void</span> Init(<a name="a1"></a><a class="code" href="group__nvn__c__funcptrs.html#ga06bf27d9bd46e20d791f91f6ef085835">PFNNVNBOOTSTRAPLOADERPROC</a> pLoader, <a class="code" href="group__nvn__c__api__typedefs.html#ga05b6b3dd5b965bd81efe2d03cee0bbbd">NVNnativeWindow</a> nativeWindow);</div>
<div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a name="a2"></a><a class="code" href="namespacenn_1_1htcs.html#af2da72858626203b882be6742eeb5993">Shutdown</a>();</div>
<div class="line"></div>
<div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">void</span> Draw(uint64_t millisec);</div>
<div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">void</span> Resize(<span class="keywordtype">int</span> width, <span class="keywordtype">int</span> height);</div>
<div class="line"></div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">    <span class="keyword">static</span> <span class="keywordtype">void</span> NVNAPIENTRY DebugLayerCallback(</div>
<div class="line">        <a class="code" href="group__nvn__c__enum.html#ga70a49f98019e4832818240297bee7eb3">NVNdebugCallbackSource</a> source,</div>
<div class="line">        <a class="code" href="group__nvn__c__enum.html#ga661d03f0e1c886c81d5ccc67935df182">NVNdebugCallbackType</a> type,</div>
<div class="line">        <span class="keywordtype">int</span> <span class="keywordtype">id</span>,</div>
<div class="line">        <a class="code" href="group__nvn__c__enum.html#ga6d72003c068d7795201e77d27bf8c7ac">NVNdebugCallbackSeverity</a> severity,</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">char</span>* message,</div>
<div class="line">        <span class="keywordtype">void</span>* pUser</div>
<div class="line">        );</div>
<div class="line"></div>
<div class="line">    <span class="keywordtype">void</span> SetupUniformBlock();</div>
<div class="line">    <span class="keywordtype">void</span> UpdateSimpleTexturedModelUniformBlock(UniformBuffer* pVertUniformBuffer, UniformBuffer* pFragUniformBuffer, <a name="_a3"></a><a class="code" href="structnn_1_1util_1_1_matrix_row_major4x4f_type.html">nn::util::Matrix4x4fType</a>&amp; modelMat, <a class="code" href="structnn_1_1util_1_1_matrix_row_major4x4f_type.html">nn::util::Matrix4x4fType</a>&amp; projMat, <a class="code" href="group__nvn__c__handle.html#gaa1a1fc7a9e690ce93870bcd71ea6b446">NVNtextureHandle</a> handle);</div>
<div class="line">    <span class="keywordtype">void</span> UpdateCubeMappedModelUniformBlock(UniformBuffer* pVertUniformBuffer, UniformBuffer* pFragUniformBuffer, <a class="code" href="structnn_1_1util_1_1_matrix_row_major4x4f_type.html">nn::util::Matrix4x4fType</a>&amp; modelMat, <a class="code" href="structnn_1_1util_1_1_matrix_row_major4x4f_type.html">nn::util::Matrix4x4fType</a>&amp; projMat, <a class="code" href="group__nvn__c__handle.html#gaa1a1fc7a9e690ce93870bcd71ea6b446">NVNtextureHandle</a> handle);</div>
<div class="line">    <span class="keywordtype">void</span> MultiThreadedLoad();</div>
<div class="line"></div>
<div class="line">    <span class="keywordtype">int</span> UpdateRenderTargets();</div>
<div class="line"></div>
<div class="line">    <a name="_a4"></a><a class="code" href="struct_n_v_ndevice.html">NVNdevice</a>                         m_Device;</div>
<div class="line">    <a name="_a5"></a><a class="code" href="struct_n_v_nqueue.html">NVNqueue</a>                          m_Queue;</div>
<div class="line">    <span class="keywordtype">void</span>*                             m_pQueueMemory;</div>
<div class="line"></div>
<div class="line">    <a name="a6"></a><a class="code" href="namespacenn_1_1gfx.html#ad620d8208dd309eb7c4dd5973a6aeee5">MemoryPool</a>*                       m_pCommandMemoryPool;</div>
<div class="line"></div>
<div class="line">    ptrdiff_t                         m_CommandPoolOffset;</div>
<div class="line">    <span class="keywordtype">void</span>*                             m_pControlPool;</div>
<div class="line">    <a name="_a7"></a><a class="code" href="struct_n_v_ncommand_buffer.html">NVNcommandBuffer</a>                  m_CommandBuffer;</div>
<div class="line">    <a class="code" href="group__nvn__c__handle.html#gab7f10945ffe1f6161c87238c75ae411d">NVNcommandHandle</a>                  m_CommandHandle;</div>
<div class="line"></div>
<div class="line">    <a name="_a8"></a><a class="code" href="struct_n_v_ntexture_builder.html">NVNtextureBuilder</a>                 m_RenderTargetBuilder;</div>
<div class="line">    <a name="_a9"></a><a class="code" href="struct_n_v_ntexture.html">NVNtexture</a>*                       m_pRenderTargets[g_NumColorBuffers];</div>
<div class="line">    <a class="code" href="struct_n_v_ntexture.html">NVNtexture</a>*                       m_pDepthBuffer;</div>
<div class="line">    <a name="_a10"></a><a class="code" href="struct_n_v_nsampler_builder.html">NVNsamplerBuilder</a>                 m_SamplerBuilder;</div>
<div class="line">    <a name="_a11"></a><a class="code" href="struct_n_v_nbuffer_builder.html">NVNbufferBuilder</a>                  m_BufferBuilder;</div>
<div class="line"></div>
<div class="line">    <a name="_a12"></a><a class="code" href="struct_n_v_nsync.html">NVNsync</a>                           m_RenderTargetPresentSync;</div>
<div class="line">    <a class="code" href="struct_n_v_nsync.html">NVNsync</a>                           m_CommandBufferSync;</div>
<div class="line">    <a class="code" href="struct_n_v_nsync.html">NVNsync</a>                           m_UniformBlockUpdateSync;</div>
<div class="line">    std::vector&lt;AssetFileDataHolder*&gt; m_DataHolders;</div>
<div class="line"></div>
<div class="line">    <a name="_a13"></a><a class="code" href="struct_n_v_nblend_state.html">NVNblendState</a>                     m_BlendState;</div>
<div class="line">    <a name="_a14"></a><a class="code" href="struct_n_v_nchannel_mask_state.html">NVNchannelMaskState</a>               m_ChannelMaskState;</div>
<div class="line">    <a name="_a15"></a><a class="code" href="struct_n_v_ncolor_state.html">NVNcolorState</a>                     m_ColorState;</div>
<div class="line">    <a name="_a16"></a><a class="code" href="struct_n_v_ndepth_stencil_state.html">NVNdepthStencilState</a>              m_DepthStencilState;</div>
<div class="line">    <a name="_a17"></a><a class="code" href="struct_n_v_nmultisample_state.html">NVNmultisampleState</a>               m_MultiSampleState;</div>
<div class="line">    <a name="_a18"></a><a class="code" href="struct_n_v_npolygon_state.html">NVNpolygonState</a>                   m_PolygonState;</div>
<div class="line"></div>
<div class="line">    <a class="code" href="namespacenn_1_1gfx.html#ad620d8208dd309eb7c4dd5973a6aeee5">MemoryPool</a>*                       m_pUniformBufferMemoryPool;</div>
<div class="line"></div>
<div class="line">    UniformBuffer                     m_BasicCubeUniformVertexBuffer;</div>
<div class="line">    UniformBuffer                     m_BasicCubeUniformFragmentBuffer;</div>
<div class="line"></div>
<div class="line">    UniformBuffer                     m_MipmapCubeUniformVertexBuffer;</div>
<div class="line">    UniformBuffer                     m_MipmapCubeUniformFragmentBuffer;</div>
<div class="line"></div>
<div class="line">    UniformBuffer                     m_CubeMapUniformVertexBuffer;</div>
<div class="line">    UniformBuffer                     m_CubeMapUniformFragmentBuffer;</div>
<div class="line"></div>
<div class="line">    TextureIDManager*                 m_pTextureIDManager;</div>
<div class="line"></div>
<div class="line">    <a class="code" href="namespacenn_1_1gfx.html#ad620d8208dd309eb7c4dd5973a6aeee5">MemoryPool</a>*                       m_pRenderTargetMemoryPool;</div>
<div class="line"></div>
<div class="line">    ptrdiff_t                         m_RenderTargetCommandPoolOffset;</div>
<div class="line">    <span class="keywordtype">void</span>*                             m_pRenderTargetControlPool;</div>
<div class="line">    <a class="code" href="struct_n_v_ncommand_buffer.html">NVNcommandBuffer</a>                  m_RenderTargetCommandBuffer;</div>
<div class="line">    <a class="code" href="group__nvn__c__handle.html#gab7f10945ffe1f6161c87238c75ae411d">NVNcommandHandle</a>                  m_RenderTargetCommandHandle;</div>
<div class="line"></div>
<div class="line">    <a name="_a19"></a><a class="code" href="struct_n_v_nwindow.html">NVNwindow</a>*                        m_pWindow;</div>
<div class="line">    <a name="_a20"></a><a class="code" href="struct_n_v_nwindow_builder.html">NVNwindowBuilder</a>                  m_WindowBuilder;</div>
<div class="line">    <span class="keywordtype">int</span>                               m_CurrentWindowIndex;</div>
<div class="line">    <a class="code" href="struct_n_v_nsync.html">NVNsync</a>                           m_WindowSync;</div>
<div class="line"></div>
<div class="line">    <span class="keywordtype">int</span>                               m_ScreenWidth;</div>
<div class="line">    <span class="keywordtype">int</span>                               m_ScreenHeight;</div>
<div class="line"></div>
<div class="line">    <span class="keywordtype">float</span>                             m_RotY;</div>
<div class="line">    <span class="keywordtype">float</span>                             m_Oscillate;</div>
<div class="line"></div>
<div class="line">    <span class="keywordtype">int</span>                               m_CommandMemoryUsed;</div>
<div class="line">    <span class="keywordtype">int</span>                               m_ControlMemoryUsed;</div>
<div class="line"></div>
<div class="line">    <span class="keywordtype">size_t</span>                            m_ColorTargetSize;</div>
<div class="line">    <span class="keywordtype">size_t</span>                            m_DepthTargetSize;</div>
<div class="line">};</div>
<div class="line"></div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * MultiThreadedAssetFileLoading Constructor</span></div>
<div class="line"><span class="comment"> * -----------------------------------------</span></div>
<div class="line"><span class="comment"> * Setup default member values.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line">MultiThreadedAssetFileLoading::MultiThreadedAssetFileLoading() :</div>
<div class="line">    m_pQueueMemory(NULL),</div>
<div class="line">    m_pCommandMemoryPool(NULL),</div>
<div class="line">    m_pControlPool(NULL),</div>
<div class="line">    m_CommandHandle(NULL),</div>
<div class="line">    m_pDepthBuffer(NULL),</div>
<div class="line">    m_pUniformBufferMemoryPool(NULL),</div>
<div class="line">    m_pTextureIDManager(NULL),</div>
<div class="line">    m_pRenderTargetMemoryPool(NULL),</div>
<div class="line">    m_pRenderTargetControlPool(NULL),</div>
<div class="line">    m_RenderTargetCommandHandle(NULL),</div>
<div class="line">    m_pWindow(NULL),</div>
<div class="line">    m_CurrentWindowIndex(-1),</div>
<div class="line">    m_ScreenWidth(0),</div>
<div class="line">    m_ScreenHeight(0),</div>
<div class="line">    m_RotY(45.0f),</div>
<div class="line">    m_Oscillate(g_Pi),</div>
<div class="line">    m_CommandMemoryUsed(0),</div>
<div class="line">    m_ControlMemoryUsed(0),</div>
<div class="line">    m_ColorTargetSize(0),</div>
<div class="line">    m_DepthTargetSize(0)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; g_NumColorBuffers; ++i)</div>
<div class="line">    {</div>
<div class="line">        m_pRenderTargets[i] = NULL;</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * MultiThreadedAssetFileLoading::SetupUniformBlock</span></div>
<div class="line"><span class="comment"> * ------------------------------------------------</span></div>
<div class="line"><span class="comment"> * Initialize the uniform blocks for each model to render.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keywordtype">void</span> MultiThreadedAssetFileLoading::SetupUniformBlock()</div>
<div class="line">{</div>
<div class="line">        <span class="comment">/* Setup the memory pool for the uniform blocks. */</span></div>
<div class="line">    m_pUniformBufferMemoryPool = <span class="keyword">new</span> <a class="code" href="namespacenn_1_1gfx.html#ad620d8208dd309eb7c4dd5973a6aeee5">MemoryPool</a>();</div>
<div class="line"></div>
<div class="line">    <span class="keywordtype">int</span> bufferAlignment = 0;</div>
<div class="line">    <a name="a21"></a><a class="code" href="group__nvn__c__functions.html#ga6f739de39c3818a65b190be3a82cf891">nvnDeviceGetInteger</a>(&amp;m_Device, <a name="a22"></a><a class="code" href="group__nvn__c__enum.html#ggac887e20e2474bb76b87943b0f0be7a50ac5b90148e47e9a26cd38b367123ff374">NVN_DEVICE_INFO_UNIFORM_BUFFER_ALIGNMENT</a>, &amp;bufferAlignment);</div>
<div class="line">    m_pUniformBufferMemoryPool-&gt;Init(NULL,</div>
<div class="line">                                     2 * Align(<span class="keyword">sizeof</span>(SimpleTexturedModel::BlockVSUniformBlockData), bufferAlignment) +</div>
<div class="line">                                     2 * Align(<span class="keyword">sizeof</span>(SimpleTexturedModel::BlockFSUniformBlockData), bufferAlignment) +</div>
<div class="line">                                     Align(<span class="keyword">sizeof</span>(CubeMap::BlockVSUniformBlockData), bufferAlignment) +</div>
<div class="line">                                     Align(<span class="keyword">sizeof</span>(CubeMap::BlockFSUniformBlockData), bufferAlignment),</div>
<div class="line">                                     <a name="a23"></a><a class="code" href="group__nvn__c__enum.html#ggaa7df4970255609d7a317631bcb37d654a93f5342f52f301cfdca9901586b9b8e1">NVN_MEMORY_POOL_FLAGS_CPU_UNCACHED_BIT</a> | <a name="a24"></a><a class="code" href="group__nvn__c__enum.html#ggaa7df4970255609d7a317631bcb37d654a81b40bf9e82d33f8c546a95fc5ce5f7e">NVN_MEMORY_POOL_FLAGS_GPU_CACHED_BIT</a>,</div>
<div class="line">                                     &amp;m_Device);</div>
<div class="line"></div>
<div class="line">    m_BasicCubeUniformVertexBuffer.Init(&amp;m_Device, <span class="keyword">sizeof</span>(SimpleTexturedModel::BlockVSUniformBlockData), m_pUniformBufferMemoryPool);</div>
<div class="line">    m_BasicCubeUniformFragmentBuffer.Init(&amp;m_Device, <span class="keyword">sizeof</span>(SimpleTexturedModel::BlockFSUniformBlockData), m_pUniformBufferMemoryPool);</div>
<div class="line"></div>
<div class="line">    m_MipmapCubeUniformVertexBuffer.Init(&amp;m_Device, <span class="keyword">sizeof</span>(SimpleTexturedModel::BlockVSUniformBlockData), m_pUniformBufferMemoryPool);</div>
<div class="line">    m_MipmapCubeUniformFragmentBuffer.Init(&amp;m_Device, <span class="keyword">sizeof</span>(SimpleTexturedModel::BlockFSUniformBlockData), m_pUniformBufferMemoryPool);</div>
<div class="line"></div>
<div class="line">    m_CubeMapUniformVertexBuffer.Init(&amp;m_Device, <span class="keyword">sizeof</span>(CubeMap::BlockVSUniformBlockData), m_pUniformBufferMemoryPool);</div>
<div class="line">    m_CubeMapUniformFragmentBuffer.Init(&amp;m_Device, <span class="keyword">sizeof</span>(CubeMap::BlockFSUniformBlockData), m_pUniformBufferMemoryPool);</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * MultiThreadedAssetFileLoading::UpdateSimpleTexturedModelUniformBlock</span></div>
<div class="line"><span class="comment"> * --------------------------------------------------------------------</span></div>
<div class="line"><span class="comment"> * Update the uniforms for the simple/mipmapped cubes.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keywordtype">void</span> MultiThreadedAssetFileLoading::UpdateSimpleTexturedModelUniformBlock(UniformBuffer* pVertUniformBuffer, UniformBuffer* pFragUniformBuffer, <a class="code" href="structnn_1_1util_1_1_matrix_row_major4x4f_type.html">nn::util::Matrix4x4fType</a>&amp; modelMat, <a class="code" href="structnn_1_1util_1_1_matrix_row_major4x4f_type.html">nn::util::Matrix4x4fType</a>&amp; projMat, <a class="code" href="group__nvn__c__handle.html#gaa1a1fc7a9e690ce93870bcd71ea6b446">NVNtextureHandle</a> handle)</div>
<div class="line">{</div>
<div class="line">    SimpleTexturedModel::BlockVSUniformBlockData vsData;</div>
<div class="line"></div>
<div class="line">    <a name="_a25"></a><a class="code" href="structnn_1_1util_1_1_float_row_major4x4.html">nn::util::Float4x4</a> temp;</div>
<div class="line">    nn::util::MatrixStore(&amp;temp, modelMat);</div>
<div class="line">    vsData.SetUniform_u_modelMtx(*<span class="keyword">reinterpret_cast&lt;</span><span class="keywordtype">float</span>(*)[16]<span class="keyword">&gt;</span>(&amp;temp));</div>
<div class="line"></div>
<div class="line">    <a class="code" href="structnn_1_1util_1_1_matrix_row_major4x4f_type.html">nn::util::Matrix4x4fType</a> cameraMat;</div>
<div class="line">    nn::util::MatrixIdentity(&amp;cameraMat);</div>
<div class="line">    nn::util::MatrixStore(&amp;temp, cameraMat);</div>
<div class="line">    vsData.SetUniform_u_viewMtx(*<span class="keyword">reinterpret_cast&lt;</span><span class="keywordtype">float</span>(*)[16]<span class="keyword">&gt;</span>(&amp;temp));</div>
<div class="line"></div>
<div class="line">    nn::util::MatrixStore(&amp;temp, projMat);</div>
<div class="line">    vsData.SetUniform_u_projMtx(*<span class="keyword">reinterpret_cast&lt;</span><span class="keywordtype">float</span>(*)[16]<span class="keyword">&gt;</span>(&amp;temp));</div>
<div class="line"></div>
<div class="line">    pVertUniformBuffer-&gt;SetData(&amp;vsData, <span class="keyword">sizeof</span>(vsData));</div>
<div class="line"></div>
<div class="line">    SimpleTexturedModel::BlockFSUniformBlockData fsData;</div>
<div class="line">    fsData.SetUniform_u_bindlessTex(handle);</div>
<div class="line">    pFragUniformBuffer-&gt;SetData(&amp;fsData, <span class="keyword">sizeof</span>(fsData));</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * MultiThreadedAssetFileLoading::UpdateCubeMappedModelUniformBlock</span></div>
<div class="line"><span class="comment"> * ----------------------------------------------------------------</span></div>
<div class="line"><span class="comment"> * Update the uniforms for the cube mapped cube.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keywordtype">void</span> MultiThreadedAssetFileLoading::UpdateCubeMappedModelUniformBlock(UniformBuffer* pVertUniformBuffer, UniformBuffer* pFragUniformBuffer, <a class="code" href="structnn_1_1util_1_1_matrix_row_major4x4f_type.html">nn::util::Matrix4x4fType</a>&amp; modelMat, <a class="code" href="structnn_1_1util_1_1_matrix_row_major4x4f_type.html">nn::util::Matrix4x4fType</a>&amp; projMat, <a class="code" href="group__nvn__c__handle.html#gaa1a1fc7a9e690ce93870bcd71ea6b446">NVNtextureHandle</a> handle)</div>
<div class="line">{</div>
<div class="line">    CubeMap::BlockVSUniformBlockData vsData;</div>
<div class="line"></div>
<div class="line">    <a class="code" href="structnn_1_1util_1_1_float_row_major4x4.html">nn::util::Float4x4</a> temp;</div>
<div class="line">    nn::util::MatrixStore(&amp;temp, modelMat);</div>
<div class="line">    vsData.SetUniform_u_modelMtx(*<span class="keyword">reinterpret_cast&lt;</span><span class="keywordtype">float</span>(*)[16]<span class="keyword">&gt;</span>(&amp;temp));</div>
<div class="line"></div>
<div class="line">    <a class="code" href="structnn_1_1util_1_1_matrix_row_major4x4f_type.html">nn::util::Matrix4x4fType</a> cameraMat;</div>
<div class="line">    nn::util::MatrixIdentity(&amp;cameraMat);</div>
<div class="line">    nn::util::MatrixStore(&amp;temp, cameraMat);</div>
<div class="line">    vsData.SetUniform_u_viewMtx(*<span class="keyword">reinterpret_cast&lt;</span><span class="keywordtype">float</span>(*)[16]<span class="keyword">&gt;</span>(&amp;temp));</div>
<div class="line"></div>
<div class="line">    nn::util::MatrixStore(&amp;temp, projMat);</div>
<div class="line">    vsData.SetUniform_u_projMtx(*<span class="keyword">reinterpret_cast&lt;</span><span class="keywordtype">float</span>(*)[16]<span class="keyword">&gt;</span>(&amp;temp));</div>
<div class="line"></div>
<div class="line">    pVertUniformBuffer-&gt;SetData(&amp;vsData, <span class="keyword">sizeof</span>(vsData));</div>
<div class="line"></div>
<div class="line">    CubeMap::BlockFSUniformBlockData fsData;</div>
<div class="line">    fsData.SetUniform_u_bindlessTex(handle);</div>
<div class="line">    pFragUniformBuffer-&gt;SetData(&amp;fsData, <span class="keyword">sizeof</span>(fsData));</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * MultiThreadedAssetFileLoading Destructor</span></div>
<div class="line"><span class="comment"> * ----------------------------------------</span></div>
<div class="line"><span class="comment"> * Empty destructor.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line">MultiThreadedAssetFileLoading::~MultiThreadedAssetFileLoading()</div>
<div class="line">{</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * MultiThreadedAssetFileLoading::Init</span></div>
<div class="line"><span class="comment"> * -----------------------------------</span></div>
<div class="line"><span class="comment"> * Initialize NVN, load asset files, and create objects needed for the</span></div>
<div class="line"><span class="comment"> * application to run.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keywordtype">void</span> MultiThreadedAssetFileLoading::Init(<a class="code" href="group__nvn__c__funcptrs.html#ga06bf27d9bd46e20d791f91f6ef085835">PFNNVNBOOTSTRAPLOADERPROC</a> pLoader, <a class="code" href="group__nvn__c__api__typedefs.html#ga05b6b3dd5b965bd81efe2d03cee0bbbd">NVNnativeWindow</a> nativeWindow)</div>
<div class="line">{</div>
<div class="line">    <a name="a26"></a><a class="code" href="nn___assert_8h.html#ade59d1d911907a16c0241f8fe3b31542">NN_ASSERT</a>(pLoader != NULL);</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Load the function pointer to get other nvn function pointers. */</span></div>
<div class="line">    pfnc_nvnDeviceGetProcAddress = (<a name="a27"></a><a class="code" href="group__nvn__c__entryfuncptrs.html#ga74380034a2bce7023361a7bf92b7c69a">PFNNVNDEVICEGETPROCADDRESSPROC</a>) (*pLoader)(<span class="stringliteral">&quot;nvnDeviceGetProcAddress&quot;</span>);</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (pfnc_nvnDeviceGetProcAddress == NULL)</div>
<div class="line">    {</div>
<div class="line">            <span class="comment">/* This can happen if an NVN driver is not installed on a Windows PC. */</span></div>
<div class="line">        <a class="code" href="nn___assert_8h.html#ade59d1d911907a16c0241f8fe3b31542">NN_ASSERT</a>(0, <span class="stringliteral">&quot;BootstrapLoader failed to find nvnDeviceGetProcAddress&quot;</span>);</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">        <span class="comment">/*</span></div>
<div class="line"><span class="comment">         * Load function pointers for creating nvn device</span></div>
<div class="line"><span class="comment">         */</span></div>
<div class="line">    nvnLoadCProcs( NULL, pfnc_nvnDeviceGetProcAddress );</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Check the API version. */</span></div>
<div class="line">    <span class="keywordtype">int</span> majorVersion, minorVersion;</div>
<div class="line">    <a class="code" href="group__nvn__c__functions.html#ga6f739de39c3818a65b190be3a82cf891">nvnDeviceGetInteger</a>( NULL, <a name="a28"></a><a class="code" href="group__nvn__c__enum.html#ggac887e20e2474bb76b87943b0f0be7a50a0a28757032ed570b5999474a3e9b4d2b">NVN_DEVICE_INFO_API_MAJOR_VERSION</a>, &amp;majorVersion );</div>
<div class="line">    <a class="code" href="group__nvn__c__functions.html#ga6f739de39c3818a65b190be3a82cf891">nvnDeviceGetInteger</a>( NULL, <a name="a29"></a><a class="code" href="group__nvn__c__enum.html#ggac887e20e2474bb76b87943b0f0be7a50ad6ff7d57f34e67a3d63ab8b5989a2c6a">NVN_DEVICE_INFO_API_MINOR_VERSION</a>, &amp;minorVersion );</div>
<div class="line">    <span class="keywordflow">if</span>( majorVersion != <a name="a30"></a><a class="code" href="group__nvn__c__defines.html#ga4eb83fe713146d844b1ac7f8e9c3dada">NVN_API_MAJOR_VERSION</a> || minorVersion &lt; <a name="a31"></a><a class="code" href="group__nvn__c__defines.html#gaa8b4a49a0c4f852b73be3b50bb3f270e">NVN_API_MINOR_VERSION</a> )</div>
<div class="line">    {</div>
<div class="line">        <a class="code" href="nn___assert_8h.html#ade59d1d911907a16c0241f8fe3b31542">NN_ASSERT</a>( 0, <span class="stringliteral">&quot;NVN SDK not supported by current driver.&quot;</span> );</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* If debug or develop is enabled, turn on NVN&#39;s debug layer. */</span></div>
<div class="line">    <span class="keywordtype">int</span> deviceFlags = 0;</div>
<div class="line"><span class="preprocessor">#if defined(NN_SDK_BUILD_DEBUG) || defined(NN_SDK_BUILD_DEVELOP)</span></div>
<div class="line">    deviceFlags = <a name="a32"></a><a class="code" href="group__nvn__c__enum.html#gga9c68350bf64f2e7a90a23290c26872d3ac002cdaba27241c296213d4722dad0a6">NVN_DEVICE_FLAG_DEBUG_ENABLE_LEVEL_2_BIT</a>;</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"></div>
<div class="line">    <a name="_a33"></a><a class="code" href="struct_n_v_ndevice_builder.html">NVNdeviceBuilder</a> deviceBuilder;</div>
<div class="line">    <a name="a34"></a><a class="code" href="group__nvn__c__functions.html#gaa042629cf4bc5ef1fab4bc7bf37b6f4f">nvnDeviceBuilderSetDefaults</a>(&amp;deviceBuilder);</div>
<div class="line">    <a name="a35"></a><a class="code" href="group__nvn__c__functions.html#ga918d154a1d1f156eb61e6a3e402cbf1c">nvnDeviceBuilderSetFlags</a>(&amp;deviceBuilder, deviceFlags);</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (<a name="a36"></a><a class="code" href="group__nvn__c__functions.html#gac05386acab686b7614d353c9a4ea4d96">nvnDeviceInitialize</a>(&amp;m_Device, &amp;deviceBuilder) == <span class="keyword">false</span>)</div>
<div class="line">    {</div>
<div class="line">            <span class="comment">/*</span></div>
<div class="line"><span class="comment">             * This can fail for a few reasons; the most likely on Horizon is</span></div>
<div class="line"><span class="comment">             * insufficent device memory.</span></div>
<div class="line"><span class="comment">             */</span></div>
<div class="line">        <a class="code" href="nn___assert_8h.html#ade59d1d911907a16c0241f8fe3b31542">NN_ASSERT</a>(0, <span class="stringliteral">&quot;nvnDeviceInitialize&quot;</span>);</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">        <span class="comment">/*</span></div>
<div class="line"><span class="comment">         * Ensure function pointers are all loaded properly</span></div>
<div class="line"><span class="comment">         */</span></div>
<div class="line">    nvnLoadCProcs(&amp;m_Device, pfnc_nvnDeviceGetProcAddress );</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Setup the debug callback for the debug layer. */</span></div>
<div class="line">    <span class="keywordflow">if</span> (deviceFlags &amp; <a class="code" href="group__nvn__c__enum.html#gga9c68350bf64f2e7a90a23290c26872d3ac002cdaba27241c296213d4722dad0a6">NVN_DEVICE_FLAG_DEBUG_ENABLE_LEVEL_2_BIT</a>)</div>
<div class="line">    {</div>
<div class="line">        <a name="a37"></a><a class="code" href="group__nvn__c__functions.html#gab73dcc0df1012caf66620aa7c56b2592">nvnDeviceInstallDebugCallback</a>(</div>
<div class="line">            &amp;m_Device,</div>
<div class="line">            reinterpret_cast&lt;PFNNVNDEBUGCALLBACKPROC&gt;(&amp;DebugLayerCallback),</div>
<div class="line">            NULL, <span class="comment">// For testing purposes; any pointer is OK here.</span></div>
<div class="line">            <a name="a38"></a><a class="code" href="group__nvn__c__defines.html#ga48151b7e768a13685d77d1a4c464a33b">NVN_TRUE</a> <span class="comment">// NVN_TRUE = Enable the callback.</span></div>
<div class="line">            );</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Initialize the queue. */</span></div>
<div class="line">    <a name="_a39"></a><a class="code" href="struct_n_v_nqueue_builder.html">NVNqueueBuilder</a> queueBuilder;</div>
<div class="line">    <a name="a40"></a><a class="code" href="group__nvn__c__functions.html#ga7fdbe1fc82e21cf370aa7f1fa0a6141a">nvnQueueBuilderSetDevice</a>(&amp;queueBuilder, &amp;m_Device);</div>
<div class="line">    <a name="a41"></a><a class="code" href="group__nvn__c__functions.html#ga20bc093a367e06cd1f1f273289354b75">nvnQueueBuilderSetDefaults</a>(&amp;queueBuilder);</div>
<div class="line">    <a name="a42"></a><a class="code" href="group__nvn__c__functions.html#ga161b2d39535ffac2829d972058391bb6">nvnQueueBuilderSetComputeMemorySize</a>(&amp;queueBuilder, 0);</div>
<div class="line"></div>
<div class="line">    <span class="keywordtype">int</span> minQueueCommandMemorySize = 0;</div>
<div class="line">    <a class="code" href="group__nvn__c__functions.html#ga6f739de39c3818a65b190be3a82cf891">nvnDeviceGetInteger</a>(&amp;m_Device, <a name="a43"></a><a class="code" href="group__nvn__c__enum.html#ggac887e20e2474bb76b87943b0f0be7a50af620633087a96a544b6c2ff6741a7697">NVN_DEVICE_INFO_QUEUE_COMMAND_MEMORY_MIN_SIZE</a>, &amp;minQueueCommandMemorySize);</div>
<div class="line">    <a name="a44"></a><a class="code" href="group__nvn__c__functions.html#ga4291be788552aa888e9551d0e1084bfb">nvnQueueBuilderSetCommandMemorySize</a>(&amp;queueBuilder, minQueueCommandMemorySize);</div>
<div class="line">    <a name="a45"></a><a class="code" href="group__nvn__c__functions.html#ga4de1469ce962b138ca454c034f6e649b">nvnQueueBuilderSetCommandFlushThreshold</a>(&amp;queueBuilder, minQueueCommandMemorySize);</div>
<div class="line"></div>
<div class="line">    <span class="keywordtype">size_t</span> neededQueueMemorySize = <a name="a46"></a><a class="code" href="group__nvn__c__functions.html#ga2903b2910d9471307595962237d3c578">nvnQueueBuilderGetQueueMemorySize</a>(&amp;queueBuilder);</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> ((neededQueueMemorySize % <a name="a47"></a><a class="code" href="group__nvn__c__defines.html#gadfd69601d2d9f953c55808127ba60853">NVN_MEMORY_POOL_STORAGE_GRANULARITY</a>) != 0)</div>
<div class="line">    {</div>
<div class="line">        <a class="code" href="nn___assert_8h.html#ade59d1d911907a16c0241f8fe3b31542">NN_ASSERT</a>(0, <span class="stringliteral">&quot;Memory size reported for queue is not the proper granularity&quot;</span>);</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#if defined( NN_BUILD_TARGET_PLATFORM_OS_WIN )</span></div>
<div class="line">    m_pQueueMemory = NULL;</div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line">    m_pQueueMemory = AlignedAllocate(neededQueueMemorySize, <a name="a48"></a><a class="code" href="group__nvn__c__defines.html#gace820e752b400cf7aa36e9684a7f45cb">NVN_MEMORY_POOL_STORAGE_ALIGNMENT</a>);</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"></div>
<div class="line">    <a name="a49"></a><a class="code" href="group__nvn__c__functions.html#ga0403d233aff80ce9cc6548b5dbe24ca2">nvnQueueBuilderSetQueueMemory</a>(&amp;queueBuilder, m_pQueueMemory, neededQueueMemorySize);</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (<a name="a50"></a><a class="code" href="group__nvn__c__functions.html#ga512027cc783d925feb7261915130e2ca">nvnQueueInitialize</a>(&amp;m_Queue, &amp;queueBuilder) == <span class="keyword">false</span>)</div>
<div class="line">    {</div>
<div class="line">        <a class="code" href="nn___assert_8h.html#ade59d1d911907a16c0241f8fe3b31542">NN_ASSERT</a>(0, <span class="stringliteral">&quot;nvnQueueInitialize failed&quot;</span>);</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Initialize the rendering command buffer. */</span></div>
<div class="line">    <span class="keywordflow">if</span> (!<a name="a51"></a><a class="code" href="group__nvn__c__functions.html#gab146b70a699dfee69d0724e430d5694e">nvnCommandBufferInitialize</a>(&amp;m_CommandBuffer, &amp;m_Device))</div>
<div class="line">    {</div>
<div class="line">        <a class="code" href="nn___assert_8h.html#ade59d1d911907a16c0241f8fe3b31542">NN_ASSERT</a>(0, <span class="stringliteral">&quot;Failed to initialize command buffer&quot;</span>);</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">        <span class="comment">/*</span></div>
<div class="line"><span class="comment">         * Queries the device for the proper control and command</span></div>
<div class="line"><span class="comment">         * memory alignment for a command buffer.</span></div>
<div class="line"><span class="comment">         */</span></div>
<div class="line">    <span class="keywordtype">int</span> commandBufferCommandAlignment = 0;</div>
<div class="line">    <span class="keywordtype">int</span> commandBufferControlAlignment = 0;</div>
<div class="line">    <a class="code" href="group__nvn__c__functions.html#ga6f739de39c3818a65b190be3a82cf891">nvnDeviceGetInteger</a>(&amp;m_Device, <a name="a52"></a><a class="code" href="group__nvn__c__enum.html#ggac887e20e2474bb76b87943b0f0be7a50ada72f2b5ef4df11606b61aaa86f6f22c">NVN_DEVICE_INFO_COMMAND_BUFFER_COMMAND_ALIGNMENT</a>, &amp;commandBufferCommandAlignment);</div>
<div class="line">    <a class="code" href="group__nvn__c__functions.html#ga6f739de39c3818a65b190be3a82cf891">nvnDeviceGetInteger</a>(&amp;m_Device, <a name="a53"></a><a class="code" href="group__nvn__c__enum.html#ggac887e20e2474bb76b87943b0f0be7a50a743ea42e337a76b9d8ed34181a0d802e">NVN_DEVICE_INFO_COMMAND_BUFFER_CONTROL_ALIGNMENT</a>, &amp;commandBufferControlAlignment);</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Setup the command buffer memory pool. */</span></div>
<div class="line">    m_pCommandMemoryPool = <span class="keyword">new</span> <a class="code" href="namespacenn_1_1gfx.html#ad620d8208dd309eb7c4dd5973a6aeee5">MemoryPool</a>();</div>
<div class="line">    m_pCommandMemoryPool-&gt;Init(NULL,</div>
<div class="line">                               Align(g_CommandMemorySize, commandBufferCommandAlignment) * 2,</div>
<div class="line">                               <a class="code" href="group__nvn__c__enum.html#ggaa7df4970255609d7a317631bcb37d654a93f5342f52f301cfdca9901586b9b8e1">NVN_MEMORY_POOL_FLAGS_CPU_UNCACHED_BIT</a> | <a class="code" href="group__nvn__c__enum.html#ggaa7df4970255609d7a317631bcb37d654a81b40bf9e82d33f8c546a95fc5ce5f7e">NVN_MEMORY_POOL_FLAGS_GPU_CACHED_BIT</a>,</div>
<div class="line">                               &amp;m_Device);</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Grab the offset from the memory pool. */</span></div>
<div class="line">    m_CommandPoolOffset = m_pCommandMemoryPool-&gt;GetNewMemoryChunkOffset(g_CommandMemorySize, commandBufferCommandAlignment);</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Setup the control memory with the proper alignment. */</span></div>
<div class="line">    m_pControlPool = AlignedAllocate(g_ControlMemorySize, commandBufferControlAlignment);</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Add the memory to the command buffer. */</span></div>
<div class="line">    <a name="a54"></a><a class="code" href="group__nvn__c__functions.html#ga2c0d758cfa73c25f2a34486353f46d92">nvnCommandBufferAddCommandMemory</a>(&amp;m_CommandBuffer, m_pCommandMemoryPool-&gt;GetMemoryPool(), m_CommandPoolOffset, g_CommandMemorySize);</div>
<div class="line">    <a name="a55"></a><a class="code" href="group__nvn__c__functions.html#ga8de6ce290ee0180d9bcd700c1d08d0bf">nvnCommandBufferAddControlMemory</a>(&amp;m_CommandBuffer, m_pControlPool, g_ControlMemorySize);</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Render Target Setting Command Buffer. */</span></div>
<div class="line">    <span class="keywordflow">if</span> (!<a class="code" href="group__nvn__c__functions.html#gab146b70a699dfee69d0724e430d5694e">nvnCommandBufferInitialize</a>(&amp;m_RenderTargetCommandBuffer, &amp;m_Device))</div>
<div class="line">    {</div>
<div class="line">        <a class="code" href="nn___assert_8h.html#ade59d1d911907a16c0241f8fe3b31542">NN_ASSERT</a>(0, <span class="stringliteral">&quot;Failed to initialize render target command buffer&quot;</span>);</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Grab the offset from the memory pool. */</span></div>
<div class="line">    m_RenderTargetCommandPoolOffset = m_pCommandMemoryPool-&gt;GetNewMemoryChunkOffset(g_CommandMemorySize, commandBufferCommandAlignment);</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Setup the control memory with the proper alignment. */</span></div>
<div class="line">    m_pRenderTargetControlPool = AlignedAllocate(g_ControlMemorySize, commandBufferControlAlignment);</div>
<div class="line"></div>
<div class="line">    <a class="code" href="group__nvn__c__functions.html#ga2c0d758cfa73c25f2a34486353f46d92">nvnCommandBufferAddCommandMemory</a>(&amp;m_RenderTargetCommandBuffer, m_pCommandMemoryPool-&gt;GetMemoryPool(), m_RenderTargetCommandPoolOffset, g_CommandMemorySize);</div>
<div class="line">    <a class="code" href="group__nvn__c__functions.html#ga8de6ce290ee0180d9bcd700c1d08d0bf">nvnCommandBufferAddControlMemory</a>(&amp;m_RenderTargetCommandBuffer, m_pRenderTargetControlPool, g_ControlMemorySize);</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Initialize the render target sync. */</span></div>
<div class="line">    <span class="keywordflow">if</span> (!<a name="a56"></a><a class="code" href="group__nvn__c__functions.html#gad8eeff0f19eaa7bb9b57ea8134411baa">nvnSyncInitialize</a>(&amp;m_RenderTargetPresentSync, &amp;m_Device))</div>
<div class="line">    {</div>
<div class="line">        <a class="code" href="nn___assert_8h.html#ade59d1d911907a16c0241f8fe3b31542">NN_ASSERT</a>(0, <span class="stringliteral">&quot;Failed to initialize render target present sync&quot;</span>);</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Initialize the rendering command buffer sync. */</span></div>
<div class="line">    <span class="keywordflow">if</span> (!<a class="code" href="group__nvn__c__functions.html#gad8eeff0f19eaa7bb9b57ea8134411baa">nvnSyncInitialize</a>(&amp;m_CommandBufferSync, &amp;m_Device))</div>
<div class="line">    {</div>
<div class="line">        <a class="code" href="nn___assert_8h.html#ade59d1d911907a16c0241f8fe3b31542">NN_ASSERT</a>(0, <span class="stringliteral">&quot;Failed to initialize command buffer sync&quot;</span>);</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Initialize the uniform buffer update sync. */</span></div>
<div class="line">    <span class="keywordflow">if</span> (!<a class="code" href="group__nvn__c__functions.html#gad8eeff0f19eaa7bb9b57ea8134411baa">nvnSyncInitialize</a>(&amp;m_UniformBlockUpdateSync, &amp;m_Device))</div>
<div class="line">    {</div>
<div class="line">        <a class="code" href="nn___assert_8h.html#ade59d1d911907a16c0241f8fe3b31542">NN_ASSERT</a>(0, <span class="stringliteral">&quot;Failed to initialize uniform block update sync&quot;</span>);</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (!<a class="code" href="group__nvn__c__functions.html#gad8eeff0f19eaa7bb9b57ea8134411baa">nvnSyncInitialize</a>(&amp;m_WindowSync, &amp;m_Device))</div>
<div class="line">    {</div>
<div class="line">        <a class="code" href="nn___assert_8h.html#ade59d1d911907a16c0241f8fe3b31542">NN_ASSERT</a>(0, <span class="stringliteral">&quot;Failed to initialize window sync&quot;</span>);</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Blend State */</span></div>
<div class="line">    <a name="a57"></a><a class="code" href="group__nvn__c__functions.html#gad0c043334f5f7eb94883fc0465f18e4f">nvnBlendStateSetDefaults</a>(&amp;m_BlendState);</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Channel Mask State */</span></div>
<div class="line">    <a name="a58"></a><a class="code" href="group__nvn__c__functions.html#gafc110d97cce3482f715d26e83413adfc">nvnChannelMaskStateSetDefaults</a>(&amp;m_ChannelMaskState);</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Color State */</span></div>
<div class="line">    <a name="a59"></a><a class="code" href="group__nvn__c__functions.html#ga1b5549b5bc5384456dda61010d85b5c2">nvnColorStateSetDefaults</a>(&amp;m_ColorState);</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Depth Stencil State */</span></div>
<div class="line">    <a name="a60"></a><a class="code" href="group__nvn__c__functions.html#ga2f659011ea2a0c713e64022959b865e2">nvnDepthStencilStateSetDefaults</a>(&amp;m_DepthStencilState);</div>
<div class="line"></div>
<div class="line">    <a name="a61"></a><a class="code" href="group__nvn__c__functions.html#ga8a0a2454a1b00a8889d1d34fd8a7da69">nvnDepthStencilStateSetDepthTestEnable</a>(&amp;m_DepthStencilState, <a class="code" href="group__nvn__c__defines.html#ga48151b7e768a13685d77d1a4c464a33b">NVN_TRUE</a>);</div>
<div class="line">    <a name="a62"></a><a class="code" href="group__nvn__c__functions.html#ga363282d1d17b72e5553651d7b2c367cf">nvnDepthStencilStateSetDepthWriteEnable</a>(&amp;m_DepthStencilState, <a class="code" href="group__nvn__c__defines.html#ga48151b7e768a13685d77d1a4c464a33b">NVN_TRUE</a>);</div>
<div class="line">    <a name="a63"></a><a class="code" href="group__nvn__c__functions.html#gafdbe8e6bc4bfb62a304d831a919d9890">nvnDepthStencilStateSetDepthFunc</a>(&amp;m_DepthStencilState, <a name="a64"></a><a class="code" href="group__nvn__c__enum.html#gga14f57c18bdbcc7517a24b723743e61e6a3381414ebe69b3db3da052248ba47bda">NVNdepthFunc::NVN_DEPTH_FUNC_LESS</a>);</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Multisample state */</span></div>
<div class="line">    <a name="a65"></a><a class="code" href="group__nvn__c__functions.html#ga0d649ca21de18dd8b544c8006d6612d8">nvnMultisampleStateSetDefaults</a>(&amp;m_MultiSampleState);</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Polygon state */</span></div>
<div class="line">    <a name="a66"></a><a class="code" href="group__nvn__c__functions.html#ga47c2200da77cbb2c0d7279ecb9311525">nvnPolygonStateSetDefaults</a>(&amp;m_PolygonState);</div>
<div class="line">    <a name="a67"></a><a class="code" href="group__nvn__c__functions.html#ga0de647048323e5c7b6fe8d93a0875cca">nvnPolygonStateSetFrontFace</a>(&amp;m_PolygonState, <a name="a68"></a><a class="code" href="group__nvn__c__enum.html#gga77dcac47ffba6330842afbc0c57db3c3a171a73f1463236c1cc74be65247e2eb1">NVNfrontFace::NVN_FRONT_FACE_CCW</a>);</div>
<div class="line">    <a name="a69"></a><a class="code" href="group__nvn__c__functions.html#ga3520bbbee9b5089521912dacdbdbb4b6">nvnPolygonStateSetCullFace</a>(&amp;m_PolygonState, <a name="a70"></a><a class="code" href="group__nvn__c__enum.html#gga258b4f915ce6b9b20d57763d617278dfaa92cb133043cad098d2b5295662cab52">NVNface::NVN_FACE_BACK</a>);</div>
<div class="line">    <a name="a71"></a><a class="code" href="group__nvn__c__functions.html#gae5d89993b3e9b7adcee98d5846052cb5">nvnPolygonStateSetPolygonMode</a>(&amp;m_PolygonState, <a name="a72"></a><a class="code" href="group__nvn__c__enum.html#ggae34b6e4f02d0dae7198337f940340ec6afa5ffe77479c77c1d43668353cf58e91">NVNpolygonMode::NVN_POLYGON_MODE_FILL</a>);</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Builders */</span></div>
<div class="line">    <a name="a73"></a><a class="code" href="group__nvn__c__functions.html#ga7504233cce44b1f5a7223f322b76a84d">nvnSamplerBuilderSetDevice</a>(&amp;m_SamplerBuilder, &amp;m_Device);</div>
<div class="line">    <a name="a74"></a><a class="code" href="group__nvn__c__functions.html#ga889b306858059648c66e88a226391acc">nvnSamplerBuilderSetDefaults</a>(&amp;m_SamplerBuilder);</div>
<div class="line"></div>
<div class="line">    <a name="a75"></a><a class="code" href="group__nvn__c__functions.html#ga7f1e5a40cc9b049892a527b95ac9b9fc">nvnBufferBuilderSetDevice</a>(&amp;m_BufferBuilder, &amp;m_Device);</div>
<div class="line">    <a name="a76"></a><a class="code" href="group__nvn__c__functions.html#ga17550ab21d8136e4f5c48c91c21716f2">nvnBufferBuilderSetDefaults</a>(&amp;m_BufferBuilder);</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Set up the texture builder for the render target. */</span></div>
<div class="line">    <a name="a77"></a><a class="code" href="group__nvn__c__functions.html#ga3125b10128cdf01e0c489ebf9644cc36">nvnTextureBuilderSetDevice</a>(&amp;m_RenderTargetBuilder, &amp;m_Device);</div>
<div class="line">    <a name="a78"></a><a class="code" href="group__nvn__c__functions.html#ga6287f82327692478ee9040e4fe73dd36">nvnTextureBuilderSetDefaults</a>(&amp;m_RenderTargetBuilder);</div>
<div class="line">    <a name="a79"></a><a class="code" href="group__nvn__c__functions.html#ga249280b0e8c57ead0fa7a82a8ebc56f9">nvnTextureBuilderSetFlags</a>(&amp;m_RenderTargetBuilder, <a name="a80"></a><a class="code" href="group__nvn__c__enum.html#gga57ab2536473c8e62f621554a2618121bad47e8f3aafe9ec5eb90d9309d591604f">NVN_TEXTURE_FLAGS_DISPLAY_BIT</a> | <a name="a81"></a><a class="code" href="group__nvn__c__enum.html#gga57ab2536473c8e62f621554a2618121ba0d4ba29569c01183e9a92cb3359da7d1">NVN_TEXTURE_FLAGS_COMPRESSIBLE_BIT</a>);</div>
<div class="line">    <a name="a82"></a><a class="code" href="group__nvn__c__functions.html#ga1eb945f455f851adf9b738be38cfb0bc">nvnTextureBuilderSetSize2D</a>(&amp;m_RenderTargetBuilder, 1920, 1080);</div>
<div class="line">    <a name="a83"></a><a class="code" href="group__nvn__c__functions.html#gaa7e80e3d31c6cffc51d255cbe86694b3">nvnTextureBuilderSetTarget</a>(&amp;m_RenderTargetBuilder, <a name="a84"></a><a class="code" href="group__nvn__c__enum.html#gga7f247010f53480c7dd1f3b2ad638c431a856184892b54a04cd16ec7848108ec53">NVN_TEXTURE_TARGET_2D</a>);</div>
<div class="line">    <a name="a85"></a><a class="code" href="group__nvn__c__functions.html#gad83f59e208a24b5843543e1d0c7aec8a">nvnTextureBuilderSetFormat</a>(&amp;m_RenderTargetBuilder, <a name="a86"></a><a class="code" href="group__nvn__c__enum.html#gga99463f5b9af6151e604b01dfdd5fecaba81514f73c168617e9819e91131e87426">NVN_FORMAT_RGBA8</a>);</div>
<div class="line">    m_ColorTargetSize = <a name="a87"></a><a class="code" href="group__nvn__c__functions.html#ga1ba9cfd0600643dbb909eaa9c36abe26">nvnTextureBuilderGetStorageSize</a>(&amp;m_RenderTargetBuilder);</div>
<div class="line"></div>
<div class="line">    <a class="code" href="group__nvn__c__functions.html#ga6287f82327692478ee9040e4fe73dd36">nvnTextureBuilderSetDefaults</a>(&amp;m_RenderTargetBuilder);</div>
<div class="line">    <a class="code" href="group__nvn__c__functions.html#ga249280b0e8c57ead0fa7a82a8ebc56f9">nvnTextureBuilderSetFlags</a>(&amp;m_RenderTargetBuilder, <a class="code" href="group__nvn__c__enum.html#gga57ab2536473c8e62f621554a2618121ba0d4ba29569c01183e9a92cb3359da7d1">NVN_TEXTURE_FLAGS_COMPRESSIBLE_BIT</a>);</div>
<div class="line">    <a class="code" href="group__nvn__c__functions.html#ga1eb945f455f851adf9b738be38cfb0bc">nvnTextureBuilderSetSize2D</a>(&amp;m_RenderTargetBuilder, 1920, 1080);</div>
<div class="line">    <a class="code" href="group__nvn__c__functions.html#gaa7e80e3d31c6cffc51d255cbe86694b3">nvnTextureBuilderSetTarget</a>(&amp;m_RenderTargetBuilder, <a class="code" href="group__nvn__c__enum.html#gga7f247010f53480c7dd1f3b2ad638c431a856184892b54a04cd16ec7848108ec53">NVN_TEXTURE_TARGET_2D</a>);</div>
<div class="line">    <a class="code" href="group__nvn__c__functions.html#gad83f59e208a24b5843543e1d0c7aec8a">nvnTextureBuilderSetFormat</a>(&amp;m_RenderTargetBuilder, <a name="a88"></a><a class="code" href="group__nvn__c__enum.html#gga99463f5b9af6151e604b01dfdd5fecabafb1417ff7fa8ad938ebbf64da47af845">NVN_FORMAT_DEPTH32F</a>);</div>
<div class="line">    m_DepthTargetSize = <a class="code" href="group__nvn__c__functions.html#ga1ba9cfd0600643dbb909eaa9c36abe26">nvnTextureBuilderGetStorageSize</a>(&amp;m_RenderTargetBuilder);</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Set up the render target memory pool. */</span></div>
<div class="line">    m_pRenderTargetMemoryPool = <span class="keyword">new</span> <a class="code" href="namespacenn_1_1gfx.html#ad620d8208dd309eb7c4dd5973a6aeee5">MemoryPool</a>();</div>
<div class="line">    m_pRenderTargetMemoryPool-&gt;Init(</div>
<div class="line">        NULL,</div>
<div class="line">        m_ColorTargetSize * g_NumColorBuffers + m_DepthTargetSize,</div>
<div class="line">        <a name="a89"></a><a class="code" href="group__nvn__c__enum.html#ggaa7df4970255609d7a317631bcb37d654ae90d91fe770d2eb3e1476c404c003369">NVN_MEMORY_POOL_FLAGS_CPU_NO_ACCESS_BIT</a> | <a class="code" href="group__nvn__c__enum.html#ggaa7df4970255609d7a317631bcb37d654a81b40bf9e82d33f8c546a95fc5ce5f7e">NVN_MEMORY_POOL_FLAGS_GPU_CACHED_BIT</a> | <a name="a90"></a><a class="code" href="group__nvn__c__enum.html#ggaa7df4970255609d7a317631bcb37d654a85f45881362092d4c5f745395818cb09">NVN_MEMORY_POOL_FLAGS_COMPRESSIBLE_BIT</a>,</div>
<div class="line">        &amp;m_Device);</div>
<div class="line"></div>
<div class="line">    m_pTextureIDManager = <span class="keyword">new</span> TextureIDManager(&amp;m_Device);</div>
<div class="line"></div>
<div class="line">    <a name="a91"></a><a class="code" href="group__nvn__c__functions.html#ga3924f2d40fa227e1b405df3755ad46e7">nvnWindowBuilderSetDefaults</a>(&amp;m_WindowBuilder);</div>
<div class="line">    <a name="a92"></a><a class="code" href="group__nvn__c__functions.html#gaf93ec4cee4147e9cc004b7b16c802621">nvnWindowBuilderSetDevice</a>(&amp;m_WindowBuilder, &amp;m_Device);</div>
<div class="line">    <a name="a93"></a><a class="code" href="group__nvn__c__functions.html#gac518ddbead9eac057d3578c6195166b2">nvnWindowBuilderSetNativeWindow</a>(&amp;m_WindowBuilder, nativeWindow);</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Setup the uniform blocks for the models. */</span></div>
<div class="line">    SetupUniformBlock();</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Load the asset files in parallel. */</span></div>
<div class="line">    MultiThreadedLoad();</div>
<div class="line">}<span class="comment">//NOLINT(impl/function_size)</span></div>
<div class="line"></div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * LoadAssetFiles</span></div>
<div class="line"><span class="comment"> * --------------</span></div>
<div class="line"><span class="comment"> * Function called by the asset loading worker threads.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keywordtype">void</span> LoadAssetFiles(<span class="keywordtype">void</span>* pParam )</div>
<div class="line">{</div>
<div class="line">    MultiThreadedAssetFileLoadingHelper* loader = (MultiThreadedAssetFileLoadingHelper*)pParam;</div>
<div class="line">    loader-&gt;LoadAssetFile();</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * MultiThreadedAssetFileLoading::MultiThreadedLoad</span></div>
<div class="line"><span class="comment"> * ------------------------------------------------</span></div>
<div class="line"><span class="comment"> * This function sets up multiple worker threads to</span></div>
<div class="line"><span class="comment"> * load asset files in parallel. Each thread handles</span></div>
<div class="line"><span class="comment"> * loading in the data from the binary file and setiing</span></div>
<div class="line"><span class="comment"> * up the NVN objects for each section of the file.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keywordtype">void</span> MultiThreadedAssetFileLoading::MultiThreadedLoad()</div>
<div class="line">{</div>
<div class="line">    AssetLoaderArg* pArgs[3];</div>
<div class="line">    <a name="_a94"></a><a class="code" href="structnn_1_1os_1_1_mutex_type.html">nn::os::MutexType</a> poolMutex;</div>
<div class="line">    <a name="a95"></a><a class="code" href="namespacenn_1_1os.html#a8d0a550df15490a884932a062dc26533">nn::os::InitializeMutex</a>(&amp;poolMutex, <span class="keyword">false</span>, 0);</div>
<div class="line"></div>
<div class="line">    pArgs[0] = <span class="keyword">new</span> AssetLoaderArg(&amp;m_Device, <span class="stringliteral">&quot;multiThreadedAssetFile0.out&quot;</span>, &amp;poolMutex, m_pTextureIDManager, <span class="keyword">false</span>, <span class="keyword">false</span>);</div>
<div class="line">    pArgs[1] = <span class="keyword">new</span> AssetLoaderArg(&amp;m_Device, <span class="stringliteral">&quot;multiThreadedAssetFile1.out&quot;</span>, &amp;poolMutex, m_pTextureIDManager, <span class="keyword">true</span>, <span class="keyword">false</span>);</div>
<div class="line">    pArgs[2] = <span class="keyword">new</span> AssetLoaderArg(&amp;m_Device, <span class="stringliteral">&quot;multiThreadedAssetFile2.out&quot;</span>, &amp;poolMutex, m_pTextureIDManager, <span class="keyword">false</span>, <span class="keyword">true</span>);</div>
<div class="line"></div>
<div class="line">    MultiThreadedAssetFileLoadingHelper* pLoaders[3];</div>
<div class="line">    pLoaders[0] = <span class="keyword">new</span> MultiThreadedAssetFileLoadingHelper(pArgs[0]);</div>
<div class="line">    pLoaders[1] = <span class="keyword">new</span> MultiThreadedAssetFileLoadingHelper(pArgs[1]);</div>
<div class="line">    pLoaders[2] = <span class="keyword">new</span> MultiThreadedAssetFileLoadingHelper(pArgs[2]);</div>
<div class="line"></div>
<div class="line">    <a name="_a96"></a><a class="code" href="structnn_1_1os_1_1_thread_type.html">nn::os::ThreadType</a> hThreadArray[3];</div>
<div class="line"></div>
<div class="line">    <span class="keywordtype">size_t</span> cacheSize = 0;</div>
<div class="line">    <a name="_a97"></a><a class="code" href="classnn_1_1_result.html">nn::Result</a> result = <a name="a98"></a><a class="code" href="namespacenn_1_1fs.html#a5df6e3385c795a5bd046790ef7f17f2d">nn::fs::QueryMountRomCacheSize</a>(&amp;cacheSize);</div>
<div class="line">    <a class="code" href="nn___assert_8h.html#ade59d1d911907a16c0241f8fe3b31542">NN_ASSERT</a>( result.<a name="a99"></a><a class="code" href="classnn_1_1_result.html#a80792d8ec8b6b9e9b34025100baa67ec">IsSuccess</a>() );</div>
<div class="line"></div>
<div class="line">    <span class="keywordtype">char</span>* mountRomCacheBuffer = <span class="keyword">new</span>(std::nothrow) <span class="keywordtype">char</span>[cacheSize];</div>
<div class="line">    <a name="a100"></a><a class="code" href="nn___assert_8h.html#a0473ebccccc250efd6100a9bbfec406b">NN_ASSERT_NOT_NULL</a>(mountRomCacheBuffer);</div>
<div class="line"></div>
<div class="line">    result = <a name="a101"></a><a class="code" href="namespacenn_1_1fs.html#a2e453fe1fbf8f818dc45bbd2897105cd">nn::fs::MountRom</a>(<span class="stringliteral">&quot;rom&quot;</span>, mountRomCacheBuffer, cacheSize);</div>
<div class="line">    <a name="a102"></a><a class="code" href="nn___abort_8h.html#a1e657a678a588533a020c2e947df7772">NN_ABORT_UNLESS_RESULT_SUCCESS</a>(result);</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#ifdef _WIN32</span></div>
<div class="line">    <span class="keywordtype">size_t</span> threadStackSize = 8 * 1024;</div>
<div class="line">    <span class="keywordtype">char</span>* threadStack = (<span class="keywordtype">char</span>*)AlignedAllocate(g_CubesToRender * threadStackSize, 4096);</div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line">    <span class="keywordtype">size_t</span> threadStackSize = 1024 * 1024;</div>
<div class="line">    <span class="keywordtype">char</span>* threadStack = (<span class="keywordtype">char</span>*)AlignedAllocate(g_CubesToRender * threadStackSize, 4096);</div>
<div class="line">    <a class="code" href="nn___assert_8h.html#ade59d1d911907a16c0241f8fe3b31542">NN_ASSERT</a>(threadStack);</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"></div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; g_CubesToRender; ++i)</div>
<div class="line">        {</div>
<div class="line">            result = <a name="a103"></a><a class="code" href="namespacenn_1_1os.html#a75f43e1d3c194c0d2173ef5d95785933">nn::os::CreateThread</a>(</div>
<div class="line">                &amp;hThreadArray[i],                   <span class="comment">// Address of ThreadType</span></div>
<div class="line">                LoadAssetFiles,                     <span class="comment">// Function pointer to call</span></div>
<div class="line">                pLoaders[i],                        <span class="comment">// Data to pass</span></div>
<div class="line">                threadStack + i * threadStackSize,  <span class="comment">// Stack memory for thread to use</span></div>
<div class="line">                threadStackSize,                    <span class="comment">// Size of stack</span></div>
<div class="line">                <a name="a104"></a><a class="code" href="namespacenn_1_1os.html#a5985811d04e64c0823ed758fd420591d">nn::os::DefaultThreadPriority</a>);     <span class="comment">// Priority</span></div>
<div class="line"></div>
<div class="line">            <a class="code" href="nn___assert_8h.html#ade59d1d911907a16c0241f8fe3b31542">NN_ASSERT</a>(result.<a class="code" href="classnn_1_1_result.html#a80792d8ec8b6b9e9b34025100baa67ec">IsSuccess</a>());</div>
<div class="line">            <a name="a105"></a><a class="code" href="namespacenn_1_1os.html#a18eec7c4c4c298f7abaa9ef41d6de76b">nn::os::StartThread</a>(&amp;hThreadArray[i]);</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <a class="code" href="group__nvn__c__functions.html#ga2c0d758cfa73c25f2a34486353f46d92">nvnCommandBufferAddCommandMemory</a>(&amp;m_CommandBuffer, m_pCommandMemoryPool-&gt;GetMemoryPool(), m_CommandPoolOffset, g_CommandMemorySize);</div>
<div class="line">    <a class="code" href="group__nvn__c__functions.html#ga8de6ce290ee0180d9bcd700c1d08d0bf">nvnCommandBufferAddControlMemory</a>(&amp;m_CommandBuffer, m_pControlPool, g_ControlMemorySize);</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Wait for the threads to be done. */</span></div>
<div class="line">    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; g_CubesToRender; ++i)</div>
<div class="line">    {</div>
<div class="line">        <a name="a106"></a><a class="code" href="namespacenn_1_1os.html#a8070c91be85c5ccb36b56e9ff3a75b26">nn::os::WaitThread</a>(&amp;hThreadArray[i]);</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Grab the data holders for each file and do some setup. */</span></div>
<div class="line">    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; g_CubesToRender; ++i)</div>
<div class="line">    {</div>
<div class="line">        AssetFileDataHolder* pDataHolder = pLoaders[i]-&gt;GetAssetFileDataHolder();</div>
<div class="line">        m_DataHolders.push_back(pDataHolder);</div>
<div class="line"></div>
<div class="line">        std::vector&lt;NVNProgramData*&gt;&amp; programData = m_DataHolders[i]-&gt;GetProgramData();</div>
<div class="line">        ShaderTypes::ShaderType shaderType = programData[0]-&gt;m_ShaderType;</div>
<div class="line"></div>
<div class="line">        m_DataHolders[i]-&gt;SetupAttributeStatesNVN(ShaderTypes::Attributes_GetAttributeLocationFunction(shaderType));</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <a name="a107"></a><a class="code" href="namespacenn_1_1os.html#a8ce43d38754bf3049ab8d60b9d9e0046">nn::os::FinalizeMutex</a>(&amp;poolMutex);</div>
<div class="line">    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; g_CubesToRender; ++i)</div>
<div class="line">    {</div>
<div class="line">        <span class="keyword">delete</span> pArgs[i];</div>
<div class="line">        pArgs[i] = NULL;</div>
<div class="line">        <span class="keyword">delete</span> pLoaders[i];</div>
<div class="line">        pLoaders[i] = NULL;</div>
<div class="line"></div>
<div class="line">        <a name="a108"></a><a class="code" href="namespacenn_1_1os.html#a9dbfcfb82583a9e34431e8c11d2411dd">nn::os::DestroyThread</a>(&amp;hThreadArray[i]);</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    AlignedDeallocate(threadStack);</div>
<div class="line">    <a name="a109"></a><a class="code" href="namespacenn_1_1fs.html#ac8a95249afd4a87a55d319dfecb0466c">nn::fs::Unmount</a>(<span class="stringliteral">&quot;rom&quot;</span>);</div>
<div class="line">    <span class="keyword">delete</span>[] mountRomCacheBuffer;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * MultiThreadedAssetFileLoading::Shutdown</span></div>
<div class="line"><span class="comment"> * ---------------------------------------</span></div>
<div class="line"><span class="comment"> * This method cleans up all nvn objects and dynamically allocated memory.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keywordtype">void</span> <a class="code" href="namespacenn_1_1htcs.html#af2da72858626203b882be6742eeb5993">MultiThreadedAssetFileLoading::Shutdown</a>()</div>
<div class="line">{</div>
<div class="line">    <a name="a110"></a><a class="code" href="group__nvn__c__functions.html#gaab3c15f657cefdff33dab453795ff38f">nvnQueueFinish</a>(&amp;m_Queue);</div>
<div class="line">    <a name="a111"></a><a class="code" href="group__nvn__c__functions.html#ga918f1f02b17ba89d048372ead736a929">nvnSyncFinalize</a>(&amp;m_RenderTargetPresentSync);</div>
<div class="line">    <a class="code" href="group__nvn__c__functions.html#ga918f1f02b17ba89d048372ead736a929">nvnSyncFinalize</a>(&amp;m_CommandBufferSync);</div>
<div class="line">    <a class="code" href="group__nvn__c__functions.html#ga918f1f02b17ba89d048372ead736a929">nvnSyncFinalize</a>(&amp;m_UniformBlockUpdateSync);</div>
<div class="line">    <a class="code" href="group__nvn__c__functions.html#ga918f1f02b17ba89d048372ead736a929">nvnSyncFinalize</a>(&amp;m_WindowSync);</div>
<div class="line"></div>
<div class="line">    <a name="a112"></a><a class="code" href="group__nvn__c__functions.html#ga014c41d2335d4d9ff6c776c99bc70bfb">nvnCommandBufferFinalize</a>(&amp;m_RenderTargetCommandBuffer);</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span>(m_pRenderTargetControlPool)</div>
<div class="line">    {</div>
<div class="line">        AlignedDeallocate(m_pRenderTargetControlPool);</div>
<div class="line">        m_pRenderTargetControlPool = NULL;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <a class="code" href="group__nvn__c__functions.html#ga014c41d2335d4d9ff6c776c99bc70bfb">nvnCommandBufferFinalize</a>(&amp;m_CommandBuffer);</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span>(m_pCommandMemoryPool)</div>
<div class="line">    {</div>
<div class="line">        m_pCommandMemoryPool-&gt;Shutdown();</div>
<div class="line">        <span class="keyword">delete</span> m_pCommandMemoryPool;</div>
<div class="line">        m_pCommandMemoryPool = NULL;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span>(m_pControlPool)</div>
<div class="line">    {</div>
<div class="line">        AlignedDeallocate(m_pControlPool);</div>
<div class="line">        m_pControlPool = NULL;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span>(m_pWindow)</div>
<div class="line">    {</div>
<div class="line">        <a name="a113"></a><a class="code" href="group__nvn__c__functions.html#ga53660a4abfffea411f62415c79a65cdf">nvnWindowFinalize</a>(m_pWindow);</div>
<div class="line">        <span class="keyword">delete</span> m_pWindow;</div>
<div class="line">        m_pWindow = NULL;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; g_NumColorBuffers; ++i)</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">if</span>(m_pRenderTargets[i])</div>
<div class="line">        {</div>
<div class="line">            <a name="a114"></a><a class="code" href="group__nvn__c__functions.html#gaa5741253f7ab5c9075a6821a68cfa351">nvnTextureFinalize</a>(m_pRenderTargets[i]);</div>
<div class="line">            <span class="keyword">delete</span> m_pRenderTargets[i];</div>
<div class="line">            m_pRenderTargets[i] = NULL;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span>(m_pDepthBuffer)</div>
<div class="line">    {</div>
<div class="line">        <a class="code" href="group__nvn__c__functions.html#gaa5741253f7ab5c9075a6821a68cfa351">nvnTextureFinalize</a>(m_pDepthBuffer);</div>
<div class="line">        <span class="keyword">delete</span> m_pDepthBuffer;</div>
<div class="line">        m_pDepthBuffer = NULL;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; m_DataHolders.size(); ++i)</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">if</span>(m_DataHolders[i])</div>
<div class="line">        {</div>
<div class="line">            <span class="keyword">delete</span> m_DataHolders[i];</div>
<div class="line">            m_DataHolders[i] = NULL;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    m_BasicCubeUniformVertexBuffer.Finalize();</div>
<div class="line">    m_BasicCubeUniformFragmentBuffer.Finalize();</div>
<div class="line"></div>
<div class="line">    m_MipmapCubeUniformVertexBuffer.Finalize();</div>
<div class="line">    m_MipmapCubeUniformFragmentBuffer.Finalize();</div>
<div class="line"></div>
<div class="line">    m_CubeMapUniformVertexBuffer.Finalize();</div>
<div class="line">    m_CubeMapUniformFragmentBuffer.Finalize();</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span>(m_pUniformBufferMemoryPool)</div>
<div class="line">    {</div>
<div class="line">        m_pUniformBufferMemoryPool-&gt;Shutdown();</div>
<div class="line">        <span class="keyword">delete</span> m_pUniformBufferMemoryPool;</div>
<div class="line">        m_pUniformBufferMemoryPool = NULL;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span>(m_pRenderTargetMemoryPool)</div>
<div class="line">    {</div>
<div class="line">        m_pRenderTargetMemoryPool-&gt;Shutdown();</div>
<div class="line">        <span class="keyword">delete</span> m_pRenderTargetMemoryPool;</div>
<div class="line">        m_pRenderTargetMemoryPool = NULL;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span>(m_pTextureIDManager)</div>
<div class="line">    {</div>
<div class="line">        <span class="keyword">delete</span> m_pTextureIDManager;</div>
<div class="line">        m_pTextureIDManager = NULL;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <a name="a115"></a><a class="code" href="group__nvn__c__functions.html#ga54ac57de39c708eb9758bae7770d5ccc">nvnQueueFinalize</a>(&amp;m_Queue);</div>
<div class="line">    <span class="keywordflow">if</span> (m_pQueueMemory)</div>
<div class="line">    {</div>
<div class="line">        AlignedDeallocate(m_pQueueMemory);</div>
<div class="line">        m_pQueueMemory = NULL;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <a name="a116"></a><a class="code" href="group__nvn__c__functions.html#ga5fccd6ba67cd2d269900832d3b7e82ff">nvnDeviceFinalize</a>(&amp;m_Device);</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * MultiThreadedAssetFileLoading::Draw</span></div>
<div class="line"><span class="comment"> * -----------------------------------</span></div>
<div class="line"><span class="comment"> * This method updates uniform data and submits the commands</span></div>
<div class="line"><span class="comment"> * recorded in the command buffer to the queue and presents</span></div>
<div class="line"><span class="comment"> * the render target to the screen.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keywordtype">void</span> MultiThreadedAssetFileLoading::Draw(uint64_t <span class="comment">/*millisec*/</span>)</div>
<div class="line">{</div>
<div class="line">        <span class="comment">/* Get the current render target and setup/submit a command buffer to set it. */</span></div>
<div class="line">    <span class="keywordtype">int</span> index = UpdateRenderTargets();</div>
<div class="line"></div>
<div class="line">    <a name="a117"></a><a class="code" href="group__nvn__c__functions.html#ga095fabdb4c81459bbe496ba45528211b">nvnQueueSubmitCommands</a>(&amp;m_Queue, 1, &amp;m_RenderTargetCommandHandle);</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Wait to update uniform data safely. */</span></div>
<div class="line">    <a name="a118"></a><a class="code" href="group__nvn__c__functions.html#gae646129720b27503c239a22db9653fa0">nvnQueueFenceSync</a>(&amp;m_Queue, &amp;m_UniformBlockUpdateSync, <a name="a119"></a><a class="code" href="group__nvn__c__enum.html#gga6ab26a343b68da722799167ea97ec69da81ae43677cd72903d494e5c37e061294">NVN_SYNC_CONDITION_ALL_GPU_COMMANDS_COMPLETE</a>, 0);</div>
<div class="line">    <a name="a120"></a><a class="code" href="group__nvn__c__functions.html#ga98feac9fc906eb1a9a5eb19ef4381b46">nvnQueueFlush</a>(&amp;m_Queue);</div>
<div class="line">    <a name="a121"></a><a class="code" href="group__nvn__c__functions.html#ga2e9deb5d068866fe0c32929a3f82baf3">nvnSyncWait</a>(&amp;m_UniformBlockUpdateSync, <a name="a122"></a><a class="code" href="group__nvn__c__defines.html#ga6c3444e501307a094f1d57abf1059aed">NVN_WAIT_TIMEOUT_MAXIMUM</a>);</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Update the uniform values for the basic cube. */</span></div>
<div class="line">    <a name="_a123"></a><a class="code" href="structnn_1_1util_1_1_matrix_row_major4x3f_type.html">nn::util::Matrix4x3fType</a> simpleTranslateMat;</div>
<div class="line">    nn::util::MatrixIdentity(&amp;simpleTranslateMat);</div>
<div class="line">    <a name="_a124"></a><a class="code" href="structnn_1_1util_1_1_vector3f_type.html">nn::util::Vector3fType</a> simpleTranslateVector;</div>
<div class="line">    nn::util::VectorSet(&amp;simpleTranslateVector, -1.5f, 0.0f, -3.0f);</div>
<div class="line">    nn::util::MatrixSetTranslate(&amp;simpleTranslateMat, simpleTranslateVector);</div>
<div class="line"></div>
<div class="line">    <a class="code" href="structnn_1_1util_1_1_matrix_row_major4x3f_type.html">nn::util::Matrix4x3fType</a> simpleRotateXMat;</div>
<div class="line">    nn::util::MatrixIdentity(&amp;simpleRotateXMat);</div>
<div class="line">    <a class="code" href="structnn_1_1util_1_1_vector3f_type.html">nn::util::Vector3fType</a> simpleRotateXVector;</div>
<div class="line">    nn::util::VectorSet(&amp;simpleRotateXVector, 30.0f * 3.1459f / 180.0f, 0.0f, 0.0f);</div>
<div class="line">    nn::util::MatrixSetRotateXyz(&amp;simpleRotateXMat, simpleRotateXVector);</div>
<div class="line"></div>
<div class="line">    <a class="code" href="structnn_1_1util_1_1_matrix_row_major4x3f_type.html">nn::util::Matrix4x3fType</a> simpleRotateYMat;</div>
<div class="line">    nn::util::MatrixIdentity(&amp;simpleRotateYMat);</div>
<div class="line">    <a class="code" href="structnn_1_1util_1_1_vector3f_type.html">nn::util::Vector3fType</a> simpleRotateYVector;</div>
<div class="line">    nn::util::VectorSet(&amp;simpleRotateYVector, 0.0f, m_RotY * 3.14159f / 180.0f, 0.0f);</div>
<div class="line">    nn::util::MatrixSetRotateXyz(&amp;simpleRotateYMat, simpleRotateYVector);</div>
<div class="line"></div>
<div class="line">    <a class="code" href="structnn_1_1util_1_1_matrix_row_major4x3f_type.html">nn::util::Matrix4x3fType</a> simpleScaleMat;</div>
<div class="line">    nn::util::MatrixIdentity(&amp;simpleScaleMat);</div>
<div class="line">    <a class="code" href="structnn_1_1util_1_1_vector3f_type.html">nn::util::Vector3fType</a> simpleScaleVector;</div>
<div class="line">    nn::util::VectorSet(&amp;simpleScaleVector, 0.75f, 0.75f, 0.75f);</div>
<div class="line">    nn::util::MatrixSetScale(&amp;simpleScaleMat, simpleScaleVector);</div>
<div class="line"></div>
<div class="line">    <a class="code" href="structnn_1_1util_1_1_matrix_row_major4x3f_type.html">nn::util::Matrix4x3fType</a> simpleModelMat;</div>
<div class="line">    <a class="code" href="structnn_1_1util_1_1_matrix_row_major4x3f_type.html">nn::util::Matrix4x3fType</a> tempMat1;</div>
<div class="line">    <a class="code" href="structnn_1_1util_1_1_matrix_row_major4x3f_type.html">nn::util::Matrix4x3fType</a> tempMat2;</div>
<div class="line">    nn::util::MatrixMultiply(&amp;tempMat1, simpleScaleMat, simpleRotateYMat);</div>
<div class="line">    nn::util::MatrixMultiply(&amp;tempMat2, tempMat1, simpleRotateXMat);</div>
<div class="line">    nn::util::MatrixMultiply(&amp;simpleModelMat, tempMat2, simpleTranslateMat);</div>
<div class="line"></div>
<div class="line">    <a class="code" href="structnn_1_1util_1_1_matrix_row_major4x4f_type.html">nn::util::Matrix4x4fType</a> projMat44;</div>
<div class="line">    nn::util::MatrixPerspectiveFieldOfViewRightHanded(&amp;projMat44, 60.0f * 3.14159f / 180.0f, static_cast&lt;float&gt;(m_ScreenWidth) / static_cast&lt;float&gt;(m_ScreenHeight), 1.0f, 1000.0f);</div>
<div class="line"></div>
<div class="line">    std::vector&lt;NVNTextureData*&gt;&amp; textureDataSimple = m_DataHolders[0]-&gt;GetTextureData();</div>
<div class="line"></div>
<div class="line">    <a class="code" href="structnn_1_1util_1_1_matrix_row_major4x4f_type.html">nn::util::Matrix4x4fType</a> simpleModelMat44;</div>
<div class="line">    nn::util::MatrixConvert(&amp;simpleModelMat44, simpleModelMat);</div>
<div class="line"></div>
<div class="line">    UpdateSimpleTexturedModelUniformBlock(&amp;m_BasicCubeUniformVertexBuffer, &amp;m_BasicCubeUniformFragmentBuffer, simpleModelMat44, projMat44, textureDataSimple[0]-&gt;m_TextureHandle);</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Update the uniform values for the mipmapped cube. */</span></div>
<div class="line">    <a class="code" href="structnn_1_1util_1_1_matrix_row_major4x3f_type.html">nn::util::Matrix4x3fType</a> mipmapTranslateMat;</div>
<div class="line">    nn::util::MatrixIdentity(&amp;mipmapTranslateMat);</div>
<div class="line">    <a class="code" href="structnn_1_1util_1_1_vector3f_type.html">nn::util::Vector3fType</a> mipmapTranslateVector;</div>
<div class="line">    nn::util::VectorSet(&amp;mipmapTranslateVector, 0.0f, 0.0f, -52.0f - 50.0f * cos(m_Oscillate));</div>
<div class="line">    nn::util::MatrixSetTranslate(&amp;mipmapTranslateMat, mipmapTranslateVector);</div>
<div class="line"></div>
<div class="line">    <a class="code" href="structnn_1_1util_1_1_matrix_row_major4x3f_type.html">nn::util::Matrix4x3fType</a> mipmapRotateXMat;</div>
<div class="line">    nn::util::MatrixIdentity(&amp;mipmapRotateXMat);</div>
<div class="line">    <a class="code" href="structnn_1_1util_1_1_vector3f_type.html">nn::util::Vector3fType</a> mipmapRotateXVector;</div>
<div class="line">    nn::util::VectorSet(&amp;mipmapRotateXVector, 35.0f * 3.1459f / 180.0f, 0.0f, 0.0f);</div>
<div class="line">    nn::util::MatrixSetRotateXyz(&amp;mipmapRotateXMat, mipmapRotateXVector);</div>
<div class="line"></div>
<div class="line">    <a class="code" href="structnn_1_1util_1_1_matrix_row_major4x3f_type.html">nn::util::Matrix4x3fType</a> mipmapRotateYMat;</div>
<div class="line">    nn::util::MatrixIdentity(&amp;mipmapRotateYMat);</div>
<div class="line">    <a class="code" href="structnn_1_1util_1_1_vector3f_type.html">nn::util::Vector3fType</a> mipmapRotateYVector;</div>
<div class="line">    nn::util::VectorSet(&amp;mipmapRotateYVector, 0.0f, 45.0f * 3.14159f / 180.0f, 0.0f);</div>
<div class="line">    nn::util::MatrixSetRotateXyz(&amp;mipmapRotateYMat, mipmapRotateYVector);</div>
<div class="line"></div>
<div class="line">    <a class="code" href="structnn_1_1util_1_1_matrix_row_major4x3f_type.html">nn::util::Matrix4x3fType</a> mipmapScaleMat;</div>
<div class="line">    nn::util::MatrixIdentity(&amp;mipmapScaleMat);</div>
<div class="line">    <a class="code" href="structnn_1_1util_1_1_vector3f_type.html">nn::util::Vector3fType</a> mipmapScaleVector;</div>
<div class="line">    nn::util::VectorSet(&amp;mipmapScaleVector, 1.0f, 1.0f, 1.0f);</div>
<div class="line">    nn::util::MatrixSetScale(&amp;mipmapScaleMat, simpleScaleVector);</div>
<div class="line"></div>
<div class="line">    <a class="code" href="structnn_1_1util_1_1_matrix_row_major4x3f_type.html">nn::util::Matrix4x3fType</a> mipmapModelMat;</div>
<div class="line">    nn::util::MatrixMultiply(&amp;tempMat1, mipmapScaleMat, mipmapRotateYMat);</div>
<div class="line">    nn::util::MatrixMultiply(&amp;tempMat2, tempMat1, mipmapRotateXMat);</div>
<div class="line">    nn::util::MatrixMultiply(&amp;mipmapModelMat, tempMat2, mipmapTranslateMat);</div>
<div class="line"></div>
<div class="line">    std::vector&lt;NVNTextureData*&gt;&amp; textureDataMipmap = m_DataHolders[1]-&gt;GetTextureData();</div>
<div class="line"></div>
<div class="line">    <a class="code" href="structnn_1_1util_1_1_matrix_row_major4x4f_type.html">nn::util::Matrix4x4fType</a> mipmapModelMat44;</div>
<div class="line">    nn::util::MatrixConvert(&amp;mipmapModelMat44, mipmapModelMat);</div>
<div class="line"></div>
<div class="line">    UpdateSimpleTexturedModelUniformBlock(&amp;m_MipmapCubeUniformVertexBuffer, &amp;m_MipmapCubeUniformFragmentBuffer, mipmapModelMat44, projMat44, textureDataMipmap[0]-&gt;m_TextureHandle);</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Update the uniforms for the cube mapped cube. */</span></div>
<div class="line">    <a class="code" href="structnn_1_1util_1_1_matrix_row_major4x3f_type.html">nn::util::Matrix4x3fType</a> cubeMapTranslateMat;</div>
<div class="line">    nn::util::MatrixIdentity(&amp;cubeMapTranslateMat);</div>
<div class="line">    <a class="code" href="structnn_1_1util_1_1_vector3f_type.html">nn::util::Vector3fType</a> cubeMapTranslateVector;</div>
<div class="line">    nn::util::VectorSet(&amp;cubeMapTranslateVector, 1.5f, 0.0f, -3.0f);</div>
<div class="line">    nn::util::MatrixSetTranslate(&amp;cubeMapTranslateMat, cubeMapTranslateVector);</div>
<div class="line"></div>
<div class="line">    <a class="code" href="structnn_1_1util_1_1_matrix_row_major4x3f_type.html">nn::util::Matrix4x3fType</a> cubeMapRotateXMat;</div>
<div class="line">    nn::util::MatrixIdentity(&amp;cubeMapRotateXMat);</div>
<div class="line">    <a class="code" href="structnn_1_1util_1_1_vector3f_type.html">nn::util::Vector3fType</a> cubeMapRotateXVector;</div>
<div class="line">    nn::util::VectorSet(&amp;cubeMapRotateXVector, sin(m_Oscillate) * 30.0f * 3.1459f / 180.0f, 0.0f, 0.0f);</div>
<div class="line">    nn::util::MatrixSetRotateXyz(&amp;cubeMapRotateXMat, cubeMapRotateXVector);</div>
<div class="line"></div>
<div class="line">    <a class="code" href="structnn_1_1util_1_1_matrix_row_major4x3f_type.html">nn::util::Matrix4x3fType</a> cubeMapRotateYMat;</div>
<div class="line">    nn::util::MatrixIdentity(&amp;cubeMapRotateYMat);</div>
<div class="line">    <a class="code" href="structnn_1_1util_1_1_vector3f_type.html">nn::util::Vector3fType</a> cubeMapRotateYVector;</div>
<div class="line">    nn::util::VectorSet(&amp;cubeMapRotateYVector, 0.0f, m_RotY * 3.14159f / 180.0f, 0.0f);</div>
<div class="line">    nn::util::MatrixSetRotateXyz(&amp;cubeMapRotateYMat, cubeMapRotateYVector);</div>
<div class="line"></div>
<div class="line">    <a class="code" href="structnn_1_1util_1_1_matrix_row_major4x3f_type.html">nn::util::Matrix4x3fType</a> cubeMapScaleMat;</div>
<div class="line">    nn::util::MatrixIdentity(&amp;cubeMapScaleMat);</div>
<div class="line">    <a class="code" href="structnn_1_1util_1_1_vector3f_type.html">nn::util::Vector3fType</a> cubeMapScaleVector;</div>
<div class="line">    nn::util::VectorSet(&amp;cubeMapScaleVector, 0.75f, 0.75f, 0.75f);</div>
<div class="line">    nn::util::MatrixSetScale(&amp;cubeMapScaleMat, cubeMapScaleVector);</div>
<div class="line"></div>
<div class="line">    <a class="code" href="structnn_1_1util_1_1_matrix_row_major4x3f_type.html">nn::util::Matrix4x3fType</a> cubeMapModelMat;</div>
<div class="line">    nn::util::MatrixMultiply(&amp;tempMat1, cubeMapScaleMat, cubeMapRotateYMat);</div>
<div class="line">    nn::util::MatrixMultiply(&amp;tempMat2, tempMat1, cubeMapRotateXMat);</div>
<div class="line">    nn::util::MatrixMultiply(&amp;cubeMapModelMat, tempMat2, cubeMapTranslateMat);</div>
<div class="line"></div>
<div class="line">    std::vector&lt;NVNTextureData*&gt;&amp; textureDatacubeMap = m_DataHolders[2]-&gt;GetTextureData();</div>
<div class="line"></div>
<div class="line">    <a class="code" href="structnn_1_1util_1_1_matrix_row_major4x4f_type.html">nn::util::Matrix4x4fType</a> cubeMapModelMat44;</div>
<div class="line">    nn::util::MatrixConvert(&amp;cubeMapModelMat44, cubeMapModelMat);</div>
<div class="line"></div>
<div class="line">    UpdateCubeMappedModelUniformBlock(&amp;m_CubeMapUniformVertexBuffer, &amp;m_CubeMapUniformFragmentBuffer, cubeMapModelMat44, projMat44, textureDatacubeMap[0]-&gt;m_TextureHandle);</div>
<div class="line"></div>
<div class="line">    m_RotY += 0.15f;</div>
<div class="line">    m_Oscillate += (g_Pi / 360.0f);</div>
<div class="line"></div>
<div class="line">    <a class="code" href="group__nvn__c__functions.html#ga2e9deb5d068866fe0c32929a3f82baf3">nvnSyncWait</a>(&amp;m_WindowSync, <a class="code" href="group__nvn__c__defines.html#ga6c3444e501307a094f1d57abf1059aed">NVN_WAIT_TIMEOUT_MAXIMUM</a>);</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Submit the command buffer to render the cube. */</span></div>
<div class="line">    <a class="code" href="group__nvn__c__functions.html#ga095fabdb4c81459bbe496ba45528211b">nvnQueueSubmitCommands</a>(&amp;m_Queue, 1, &amp;m_CommandHandle);</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Present the target to the screen. */</span></div>
<div class="line">    <a name="a125"></a><a class="code" href="group__nvn__c__functions.html#gad317e78382b7f51a7a6f0504193d90c7">nvnQueuePresentTexture</a>(&amp;m_Queue, m_pWindow, index);</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * MultiThreadedAssetFileLoading::UpdateRenderTargets</span></div>
<div class="line"><span class="comment"> * --------------------------------------------------</span></div>
<div class="line"><span class="comment"> * Gets the index of the current render target from the NVNwindow</span></div>
<div class="line"><span class="comment"> * and records a command buffer that sets it up to be rendered to.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keywordtype">int</span> MultiThreadedAssetFileLoading::UpdateRenderTargets()</div>
<div class="line">{</div>
<div class="line">        <span class="comment">/* Get the next target index. */</span></div>
<div class="line">    <a class="code" href="group__nvn__c__enum.html#ga58e9b155d7f2272b95044eed1f40415e">NVNwindowAcquireTextureResult</a> result = <a name="a126"></a><a class="code" href="group__nvn__c__functions.html#ga7fa0b45affa2e04d77e3c1ad11a03c32">nvnWindowAcquireTexture</a>(m_pWindow, &amp;m_WindowSync, &amp;m_CurrentWindowIndex);</div>
<div class="line"></div>
<div class="line">    <a class="code" href="nn___assert_8h.html#ade59d1d911907a16c0241f8fe3b31542">NN_ASSERT</a>(result == <a name="a127"></a><a class="code" href="group__nvn__c__enum.html#gga58e9b155d7f2272b95044eed1f40415eac9962a2f8bbcd4c01bb04d1e4111aba5">NVN_WINDOW_ACQUIRE_TEXTURE_RESULT_SUCCESS</a>);</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Wait for the previous fram to finish before rewriting the command buffer. */</span></div>
<div class="line">    <a class="code" href="group__nvn__c__functions.html#gae646129720b27503c239a22db9653fa0">nvnQueueFenceSync</a>(&amp;m_Queue, &amp;m_CommandBufferSync, <a class="code" href="group__nvn__c__enum.html#gga6ab26a343b68da722799167ea97ec69da81ae43677cd72903d494e5c37e061294">NVN_SYNC_CONDITION_ALL_GPU_COMMANDS_COMPLETE</a>, 0);</div>
<div class="line">    <a class="code" href="group__nvn__c__functions.html#ga98feac9fc906eb1a9a5eb19ef4381b46">nvnQueueFlush</a>(&amp;m_Queue);</div>
<div class="line">    <a class="code" href="group__nvn__c__functions.html#ga2e9deb5d068866fe0c32929a3f82baf3">nvnSyncWait</a>(&amp;m_CommandBufferSync, <a class="code" href="group__nvn__c__defines.html#ga6c3444e501307a094f1d57abf1059aed">NVN_WAIT_TIMEOUT_MAXIMUM</a>);</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Reset the command buffer memory. */</span></div>
<div class="line">    <a class="code" href="group__nvn__c__functions.html#ga2c0d758cfa73c25f2a34486353f46d92">nvnCommandBufferAddCommandMemory</a>(&amp;m_RenderTargetCommandBuffer, m_pCommandMemoryPool-&gt;GetMemoryPool(), m_RenderTargetCommandPoolOffset, g_CommandMemorySize);</div>
<div class="line">    <a class="code" href="group__nvn__c__functions.html#ga8de6ce290ee0180d9bcd700c1d08d0bf">nvnCommandBufferAddControlMemory</a>(&amp;m_RenderTargetCommandBuffer, m_pRenderTargetControlPool, g_ControlMemorySize);</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Record the command buffer to set the target. */</span></div>
<div class="line">    <a name="a128"></a><a class="code" href="group__nvn__c__functions.html#gaeb763d2bdad2c058c75802190fef4748">nvnCommandBufferBeginRecording</a>(&amp;m_RenderTargetCommandBuffer);</div>
<div class="line">    <a name="a129"></a><a class="code" href="group__nvn__c__functions.html#gae3e9cdfa2eaad5ed0f5363598fa0ce7c">nvnCommandBufferSetRenderTargets</a>(&amp;m_RenderTargetCommandBuffer, 1, &amp;m_pRenderTargets[m_CurrentWindowIndex], NULL, m_pDepthBuffer, NULL);</div>
<div class="line">    m_RenderTargetCommandHandle = <a name="a130"></a><a class="code" href="group__nvn__c__functions.html#ga7d97d4cbf72259b6e867f3080f223b95">nvnCommandBufferEndRecording</a>(&amp;m_RenderTargetCommandBuffer);</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Return the index. */</span></div>
<div class="line">    <span class="keywordflow">return</span> m_CurrentWindowIndex;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * MultiThreadedAssetFileLoading::Resize</span></div>
<div class="line"><span class="comment"> * -------------------------------------</span></div>
<div class="line"><span class="comment"> * This method is called everytime the window is resized and is passed</span></div>
<div class="line"><span class="comment"> * the new size of the window. It frees the old render target and creates a new</span></div>
<div class="line"><span class="comment"> * render target with the new screen size. A new set of commands for the command buffer</span></div>
<div class="line"><span class="comment"> * is recorded.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keywordtype">void</span> MultiThreadedAssetFileLoading::Resize(<span class="keywordtype">int</span> width, <span class="keywordtype">int</span> height)</div>
<div class="line">{</div>
<div class="line">        <span class="comment">/* Check for the window being minimized or having no visible surface. */</span></div>
<div class="line">    <span class="keywordflow">if</span>(width == 0 || height == 0)</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Save the current height and width of the screen. */</span></div>
<div class="line">    m_ScreenHeight = height;</div>
<div class="line">    m_ScreenWidth = width;</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Sync to safely rewrite the command buffer. */</span></div>
<div class="line">    <a class="code" href="group__nvn__c__functions.html#gae646129720b27503c239a22db9653fa0">nvnQueueFenceSync</a>(&amp;m_Queue, &amp;m_CommandBufferSync, <a class="code" href="group__nvn__c__enum.html#gga6ab26a343b68da722799167ea97ec69da81ae43677cd72903d494e5c37e061294">NVN_SYNC_CONDITION_ALL_GPU_COMMANDS_COMPLETE</a>, 0);</div>
<div class="line">    <a class="code" href="group__nvn__c__functions.html#ga98feac9fc906eb1a9a5eb19ef4381b46">nvnQueueFlush</a>(&amp;m_Queue);</div>
<div class="line">    <a class="code" href="group__nvn__c__functions.html#ga2e9deb5d068866fe0c32929a3f82baf3">nvnSyncWait</a>(&amp;m_CommandBufferSync, <a class="code" href="group__nvn__c__defines.html#ga6c3444e501307a094f1d57abf1059aed">NVN_WAIT_TIMEOUT_MAXIMUM</a>);</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* If it&#39;s the first time Resize is called, allocate the NVNwindow. */</span></div>
<div class="line">    <span class="keywordflow">if</span> (m_pWindow == NULL)</div>
<div class="line">    {</div>
<div class="line">        m_pWindow = <span class="keyword">new</span> <a class="code" href="struct_n_v_nwindow.html">NVNwindow</a>;</div>
<div class="line">    }</div>
<div class="line">        <span class="comment">/*</span></div>
<div class="line"><span class="comment">         * Otherwise finalize (free) the NVNwindow used for the previous window size.</span></div>
<div class="line"><span class="comment">         * The NVNWindow must be finalized before a render target it owns is finalized.</span></div>
<div class="line"><span class="comment">         */</span></div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">    {</div>
<div class="line">        <a class="code" href="group__nvn__c__functions.html#ga53660a4abfffea411f62415c79a65cdf">nvnWindowFinalize</a>(m_pWindow);</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Set up the builder for the render target. */</span></div>
<div class="line">    <a class="code" href="group__nvn__c__functions.html#ga6287f82327692478ee9040e4fe73dd36">nvnTextureBuilderSetDefaults</a>(&amp;m_RenderTargetBuilder);</div>
<div class="line">    <a class="code" href="group__nvn__c__functions.html#ga249280b0e8c57ead0fa7a82a8ebc56f9">nvnTextureBuilderSetFlags</a>(&amp;m_RenderTargetBuilder, <a class="code" href="group__nvn__c__enum.html#gga57ab2536473c8e62f621554a2618121bad47e8f3aafe9ec5eb90d9309d591604f">NVN_TEXTURE_FLAGS_DISPLAY_BIT</a> | <a class="code" href="group__nvn__c__enum.html#gga57ab2536473c8e62f621554a2618121ba0d4ba29569c01183e9a92cb3359da7d1">NVN_TEXTURE_FLAGS_COMPRESSIBLE_BIT</a>);</div>
<div class="line">    <a class="code" href="group__nvn__c__functions.html#ga1eb945f455f851adf9b738be38cfb0bc">nvnTextureBuilderSetSize2D</a>(&amp;m_RenderTargetBuilder, m_ScreenWidth, m_ScreenHeight);</div>
<div class="line">    <a class="code" href="group__nvn__c__functions.html#gaa7e80e3d31c6cffc51d255cbe86694b3">nvnTextureBuilderSetTarget</a>(&amp;m_RenderTargetBuilder, <a class="code" href="group__nvn__c__enum.html#gga7f247010f53480c7dd1f3b2ad638c431a856184892b54a04cd16ec7848108ec53">NVN_TEXTURE_TARGET_2D</a>);</div>
<div class="line">    <a class="code" href="group__nvn__c__functions.html#gad83f59e208a24b5843543e1d0c7aec8a">nvnTextureBuilderSetFormat</a>(&amp;m_RenderTargetBuilder, <a class="code" href="group__nvn__c__enum.html#gga99463f5b9af6151e604b01dfdd5fecaba81514f73c168617e9819e91131e87426">NVN_FORMAT_RGBA8</a>);</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; g_NumColorBuffers; ++i)</div>
<div class="line">    {</div>
<div class="line">            <span class="comment">/* If it&#39;s the first time Resize is called, allocate the render target. */</span></div>
<div class="line">        <span class="keywordflow">if</span> (m_pRenderTargets[i] == NULL)</div>
<div class="line">        {</div>
<div class="line">            m_pRenderTargets[i] = <span class="keyword">new</span> <a class="code" href="struct_n_v_ntexture.html">NVNtexture</a>;</div>
<div class="line">        }</div>
<div class="line">            <span class="comment">/* Otherwise finalize (free) the render target used for the previous window size. */</span></div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">        {</div>
<div class="line">            <a class="code" href="group__nvn__c__functions.html#gaa5741253f7ab5c9075a6821a68cfa351">nvnTextureFinalize</a>(m_pRenderTargets[i]);</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <a name="a131"></a><a class="code" href="group__nvn__c__functions.html#gaf6530c01a016b836ad82434f6a793cd8">nvnTextureBuilderSetStorage</a>(&amp;m_RenderTargetBuilder, m_pRenderTargetMemoryPool-&gt;GetMemoryPool(), m_ColorTargetSize * i);</div>
<div class="line"></div>
<div class="line">            <span class="comment">/* Create the texture using the current state of the texture builder. */</span></div>
<div class="line">        <span class="keywordflow">if</span> (!<a name="a132"></a><a class="code" href="group__nvn__c__functions.html#gad8c5cbaa3292721f1de9d521a66aac3e">nvnTextureInitialize</a>(m_pRenderTargets[i], &amp;m_RenderTargetBuilder))</div>
<div class="line">        {</div>
<div class="line">            <a class="code" href="nn___assert_8h.html#ade59d1d911907a16c0241f8fe3b31542">NN_ASSERT</a>(0, <span class="stringliteral">&quot;Failed to initialize render target&quot;</span>);</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* If it&#39;s the first time Resize is called, allocate the depth buffer. */</span></div>
<div class="line">    <span class="keywordflow">if</span> (m_pDepthBuffer == NULL)</div>
<div class="line">    {</div>
<div class="line">        m_pDepthBuffer = <span class="keyword">new</span> <a class="code" href="struct_n_v_ntexture.html">NVNtexture</a>;</div>
<div class="line">    }</div>
<div class="line">        <span class="comment">/* Otherwise finalize (free) the depth buffer used for the previous window size. */</span></div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">    {</div>
<div class="line">        <a class="code" href="group__nvn__c__functions.html#gaa5741253f7ab5c9075a6821a68cfa351">nvnTextureFinalize</a>(m_pDepthBuffer);</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Initialize depth buffer for render target. */</span></div>
<div class="line">    <a class="code" href="group__nvn__c__functions.html#ga6287f82327692478ee9040e4fe73dd36">nvnTextureBuilderSetDefaults</a>(&amp;m_RenderTargetBuilder);</div>
<div class="line">    <a class="code" href="group__nvn__c__functions.html#ga249280b0e8c57ead0fa7a82a8ebc56f9">nvnTextureBuilderSetFlags</a>(&amp;m_RenderTargetBuilder, <a class="code" href="group__nvn__c__enum.html#gga57ab2536473c8e62f621554a2618121ba0d4ba29569c01183e9a92cb3359da7d1">NVN_TEXTURE_FLAGS_COMPRESSIBLE_BIT</a>);</div>
<div class="line">    <a class="code" href="group__nvn__c__functions.html#ga1eb945f455f851adf9b738be38cfb0bc">nvnTextureBuilderSetSize2D</a>(&amp;m_RenderTargetBuilder, m_ScreenWidth, m_ScreenHeight);</div>
<div class="line">    <a class="code" href="group__nvn__c__functions.html#gaa7e80e3d31c6cffc51d255cbe86694b3">nvnTextureBuilderSetTarget</a>(&amp;m_RenderTargetBuilder, <a class="code" href="group__nvn__c__enum.html#gga7f247010f53480c7dd1f3b2ad638c431a856184892b54a04cd16ec7848108ec53">NVN_TEXTURE_TARGET_2D</a>);</div>
<div class="line">    <a class="code" href="group__nvn__c__functions.html#gad83f59e208a24b5843543e1d0c7aec8a">nvnTextureBuilderSetFormat</a>(&amp;m_RenderTargetBuilder, <a class="code" href="group__nvn__c__enum.html#gga99463f5b9af6151e604b01dfdd5fecabafb1417ff7fa8ad938ebbf64da47af845">NVN_FORMAT_DEPTH32F</a>);</div>
<div class="line">    <a class="code" href="group__nvn__c__functions.html#gaf6530c01a016b836ad82434f6a793cd8">nvnTextureBuilderSetStorage</a>(&amp;m_RenderTargetBuilder, m_pRenderTargetMemoryPool-&gt;GetMemoryPool(), m_ColorTargetSize * g_NumColorBuffers);</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (!<a class="code" href="group__nvn__c__functions.html#gad8c5cbaa3292721f1de9d521a66aac3e">nvnTextureInitialize</a>(m_pDepthBuffer, &amp;m_RenderTargetBuilder))</div>
<div class="line">    {</div>
<div class="line">        <a class="code" href="nn___assert_8h.html#ade59d1d911907a16c0241f8fe3b31542">NN_ASSERT</a>(0, <span class="stringliteral">&quot;Failed to initialize depth target&quot;</span>);</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Pass off the render targets to the window. */</span></div>
<div class="line">    <a name="a133"></a><a class="code" href="group__nvn__c__functions.html#ga610c7f233b7bb1e02f4926fe554df5db">nvnWindowBuilderSetTextures</a>(&amp;m_WindowBuilder, g_NumColorBuffers, m_pRenderTargets);</div>
<div class="line">    <a name="a134"></a><a class="code" href="group__nvn__c__functions.html#gac5c388ac1ed70cb34ea4d71d23af9a73">nvnWindowInitialize</a>(m_pWindow, &amp;m_WindowBuilder);</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Reset the command buffer memory. */</span></div>
<div class="line">    <a class="code" href="group__nvn__c__functions.html#ga2c0d758cfa73c25f2a34486353f46d92">nvnCommandBufferAddCommandMemory</a>(&amp;m_CommandBuffer, m_pCommandMemoryPool-&gt;GetMemoryPool(), m_CommandPoolOffset, g_CommandMemorySize);</div>
<div class="line">    <a class="code" href="group__nvn__c__functions.html#ga8de6ce290ee0180d9bcd700c1d08d0bf">nvnCommandBufferAddControlMemory</a>(&amp;m_CommandBuffer, m_pControlPool, g_ControlMemorySize);</div>
<div class="line"></div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Starts the recording of a new set of commands for the given command buffer. */</span></div>
<div class="line">    <a class="code" href="group__nvn__c__functions.html#gaeb763d2bdad2c058c75802190fef4748">nvnCommandBufferBeginRecording</a>(&amp;m_CommandBuffer);</div>
<div class="line">    {</div>
<div class="line">            <span class="comment">/* Bind the texture and sampler descriptor pools. */</span></div>
<div class="line">        m_pTextureIDManager-&gt;SetSamplerPool(&amp;m_CommandBuffer);</div>
<div class="line">        m_pTextureIDManager-&gt;SetTexturePool(&amp;m_CommandBuffer);</div>
<div class="line"></div>
<div class="line">            <span class="comment">/* Sets the scissor rectangle and viewport to the full screen */</span></div>
<div class="line">        <a name="a135"></a><a class="code" href="group__nvn__c__functions.html#gac6c38cac9330ae402f2f911d1e1aa757">nvnCommandBufferSetScissor</a>(&amp;m_CommandBuffer, 0, 0, m_ScreenWidth, m_ScreenHeight);</div>
<div class="line">        <a name="a136"></a><a class="code" href="group__nvn__c__functions.html#gac4cadef7ff012bc4d218bfd9e510a888">nvnCommandBufferSetViewport</a>(&amp;m_CommandBuffer, 0, 0, m_ScreenWidth, m_ScreenHeight);</div>
<div class="line"></div>
<div class="line">            <span class="comment">/* Clears the currently set render target at a given index. */</span></div>
<div class="line">        <span class="keywordtype">float</span> clearColor[4] = { 0.4f, 0.55f, 0.6f, 1.0f };</div>
<div class="line">        <a name="a137"></a><a class="code" href="group__nvn__c__functions.html#gab857894818dcd7f7a58d0358a9e44100">nvnCommandBufferClearColor</a>(&amp;m_CommandBuffer, 0, clearColor, <a name="a138"></a><a class="code" href="group__nvn__c__enum.html#ggac703c5549157a2c6efb057f8047bde0fad16b7a15db3173484f7cd5496edb727f">NVN_CLEAR_COLOR_MASK_RGBA</a>);</div>
<div class="line">        <a name="a139"></a><a class="code" href="group__nvn__c__functions.html#gae5f7adad6751d801a89cd1101253fa85">nvnCommandBufferClearDepthStencil</a>(&amp;m_CommandBuffer, 1.0, <a class="code" href="group__nvn__c__defines.html#ga48151b7e768a13685d77d1a4c464a33b">NVN_TRUE</a>, 0, 0);</div>
<div class="line"></div>
<div class="line">            <span class="comment">/* Bind the render state objects. */</span></div>
<div class="line">        <a name="a140"></a><a class="code" href="group__nvn__c__functions.html#ga7c3895b442dc5055a3ba72b149389a90">nvnCommandBufferBindBlendState</a>(&amp;m_CommandBuffer, &amp;m_BlendState);</div>
<div class="line">        <a name="a141"></a><a class="code" href="group__nvn__c__functions.html#gac468cb3593c0a9653515830e19800536">nvnCommandBufferBindChannelMaskState</a>(&amp;m_CommandBuffer, &amp;m_ChannelMaskState);</div>
<div class="line">        <a name="a142"></a><a class="code" href="group__nvn__c__functions.html#ga6b957807821fbeac2c91ddfc34e9e941">nvnCommandBufferBindColorState</a>(&amp;m_CommandBuffer, &amp;m_ColorState);</div>
<div class="line">        <a name="a143"></a><a class="code" href="group__nvn__c__functions.html#gae829ea8fc2209e876f64e9eaa7b21992">nvnCommandBufferBindDepthStencilState</a>(&amp;m_CommandBuffer, &amp;m_DepthStencilState);</div>
<div class="line">        <a name="a144"></a><a class="code" href="group__nvn__c__functions.html#ga463e501c3151aab9e9cb737e6cbaba5d">nvnCommandBufferBindMultisampleState</a>(&amp;m_CommandBuffer, &amp;m_MultiSampleState);</div>
<div class="line">        <a name="a145"></a><a class="code" href="group__nvn__c__functions.html#gab5bee99214e32842654cbc22dd5f17bd">nvnCommandBufferBindPolygonState</a>(&amp;m_CommandBuffer, &amp;m_PolygonState);</div>
<div class="line">        <a name="a146"></a><a class="code" href="group__nvn__c__functions.html#gadcba5a3b987a3f421ca0566a48dbf62e">nvnCommandBufferSetSampleMask</a>(&amp;m_CommandBuffer, static_cast&lt;uint32_t&gt;(~0));</div>
<div class="line"></div>
<div class="line">        <a class="code" href="group__nvn__c__handle.html#ga067da3a838f115226c89fad655278f80">NVNbufferAddress</a> vertBufferAddresses[3] = {m_BasicCubeUniformVertexBuffer.GetBufferAddress(),</div>
<div class="line">                                                   m_MipmapCubeUniformVertexBuffer.GetBufferAddress(),</div>
<div class="line">                                                   m_CubeMapUniformVertexBuffer.GetBufferAddress()};</div>
<div class="line">        <a class="code" href="group__nvn__c__handle.html#ga067da3a838f115226c89fad655278f80">NVNbufferAddress</a> fragBufferAddresses[3] = {m_BasicCubeUniformFragmentBuffer.GetBufferAddress(),</div>
<div class="line">                                                   m_MipmapCubeUniformFragmentBuffer.GetBufferAddress(),</div>
<div class="line">                                                   m_CubeMapUniformFragmentBuffer.GetBufferAddress()};</div>
<div class="line"></div>
<div class="line">            <span class="comment">/* Render each object in a loop. */</span></div>
<div class="line">        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; g_CubesToRender; ++i)</div>
<div class="line">        {</div>
<div class="line">            std::vector&lt;NVNModelData*&gt;&amp; modelData = m_DataHolders[i]-&gt;GetModelData();</div>
<div class="line">            Model* pModel = &amp;modelData[0]-&gt;m_Model;</div>
<div class="line"></div>
<div class="line">                <span class="comment">/* Bind the vertex buffer(s). */</span></div>
<div class="line">            <a class="code" href="group__nvn__c__handle.html#ga067da3a838f115226c89fad655278f80">NVNbufferAddress</a> vboAddr = <a name="a147"></a><a class="code" href="group__nvn__c__functions.html#gac38c964075df642306d6490b8b50ace3">nvnBufferGetAddress</a>(&amp;modelData[0]-&gt;m_VertexBuffer);</div>
<div class="line">            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = 0; j &lt; pModel-&gt;m_VertexAttributes.size(); ++j)</div>
<div class="line">            {</div>
<div class="line">                VertexAttribute&amp; attr = pModel-&gt;m_VertexAttributes[j];</div>
<div class="line">                <a name="a148"></a><a class="code" href="group__nvn__c__functions.html#ga328bba22810a4467865b444d17bec8e9">nvnCommandBufferBindVertexBuffer</a>(&amp;m_CommandBuffer, attr.m_Location, vboAddr + modelData[0]-&gt;m_VertexAttributeBufferOffsets[j], attr.m_DataSize);</div>
<div class="line">            }</div>
<div class="line"></div>
<div class="line">                <span class="comment">/* Bind the vertex states. */</span></div>
<div class="line">            <a name="a149"></a><a class="code" href="group__nvn__c__functions.html#ga4f0e28ea8b574b0b7d3ee6bd2e94dcac">nvnCommandBufferBindVertexAttribState</a>(&amp;m_CommandBuffer, static_cast&lt;int&gt;(modelData[0]-&gt;m_VertexAttributeStates.size()), &amp;modelData[0]-&gt;m_VertexAttributeStates[0]);</div>
<div class="line">            <a name="a150"></a><a class="code" href="group__nvn__c__functions.html#ga8540a860937580eaa607cfa549667083">nvnCommandBufferBindVertexStreamState</a>(&amp;m_CommandBuffer, static_cast&lt;int&gt;(modelData[0]-&gt;m_VertexStreamStates.size()), &amp;modelData[0]-&gt;m_VertexStreamStates[0]);</div>
<div class="line"></div>
<div class="line">                <span class="comment">/* Bind the shader program and uniforms. */</span></div>
<div class="line">            std::vector&lt;NVNProgramData*&gt;&amp;   programData = m_DataHolders[i]-&gt;GetProgramData();</div>
<div class="line">            ShaderTypes::ShaderType shaderType = programData[0]-&gt;m_ShaderType;</div>
<div class="line">            uint32_t vertexUniformBlockBindingLocation = ShaderTypes::BlockVS_GetBinding(<a name="a151"></a><a class="code" href="group__nvn__c__enum.html#ggac99deb2b11df8b0358f73a92e2a2abdda5a6e5f69e0f338221cc5acf7882a21c7">NVN_SHADER_STAGE_VERTEX</a>, shaderType);</div>
<div class="line">            uint32_t vertexUniformBlockSize = ShaderTypes::BlockVS_GetUniformBlockSize(shaderType);</div>
<div class="line">            <a name="a152"></a><a class="code" href="group__nvn__c__functions.html#ga50631d9a85aca68db2ede52b0d13521e">nvnCommandBufferBindUniformBuffer</a>(&amp;m_CommandBuffer,</div>
<div class="line">                                              <a class="code" href="group__nvn__c__enum.html#ggac99deb2b11df8b0358f73a92e2a2abdda5a6e5f69e0f338221cc5acf7882a21c7">NVN_SHADER_STAGE_VERTEX</a>,</div>
<div class="line">                                              vertexUniformBlockBindingLocation,</div>
<div class="line">                                              vertBufferAddresses[i],</div>
<div class="line">                                              vertexUniformBlockSize);</div>
<div class="line"></div>
<div class="line">            uint32_t fragmentUniformBlockBindingLocation = ShaderTypes::BlockFS_GetBinding(<a name="a153"></a><a class="code" href="group__nvn__c__enum.html#ggac99deb2b11df8b0358f73a92e2a2abddaf979f751d1526164abb522c640c8eb06">NVN_SHADER_STAGE_FRAGMENT</a>, shaderType);</div>
<div class="line">            uint32_t fragmentUniformBlockSize = ShaderTypes::BlockFS_GetUniformBlockSize(shaderType);</div>
<div class="line">            <a class="code" href="group__nvn__c__functions.html#ga50631d9a85aca68db2ede52b0d13521e">nvnCommandBufferBindUniformBuffer</a>(&amp;m_CommandBuffer,</div>
<div class="line">                                              <a class="code" href="group__nvn__c__enum.html#ggac99deb2b11df8b0358f73a92e2a2abddaf979f751d1526164abb522c640c8eb06">NVN_SHADER_STAGE_FRAGMENT</a>,</div>
<div class="line">                                              fragmentUniformBlockBindingLocation,</div>
<div class="line">                                              fragBufferAddresses[i],</div>
<div class="line">                                              fragmentUniformBlockSize);</div>
<div class="line"></div>
<div class="line">            <a name="a154"></a><a class="code" href="group__nvn__c__functions.html#ga1f4b9d505338994b172c814ed32565c8">nvnCommandBufferBindProgram</a>(&amp;m_CommandBuffer, &amp;programData[0]-&gt;m_Program, programData[0]-&gt;m_ShaderStages);</div>
<div class="line"></div>
<div class="line">                <span class="comment">/* Draw the primitives. */</span></div>
<div class="line">            <a class="code" href="group__nvn__c__enum.html#gaaf90e0c2dbdc1e42db8192f0c0cb1522">NVNindexType</a> indexType = <span class="keyword">static_cast&lt;</span><a class="code" href="group__nvn__c__enum.html#gaaf90e0c2dbdc1e42db8192f0c0cb1522">NVNindexType</a><span class="keyword">&gt;</span>(pModel-&gt;m_IndexData.m_IndexType);</div>
<div class="line">            uint32_t numIndices = pModel-&gt;m_IndexData.m_DataSize / pModel-&gt;m_IndexData.m_Stride;</div>
<div class="line"></div>
<div class="line">            <a name="a155"></a><a class="code" href="group__nvn__c__functions.html#ga06f4d4765bf74d01809661766ac7df80">nvnCommandBufferDrawElements</a>(&amp;m_CommandBuffer,</div>
<div class="line">                                         static_cast&lt;NVNdrawPrimitive&gt;(pModel-&gt;m_NvnDrawPrimitiveType),</div>
<div class="line">                                         indexType,</div>
<div class="line">                                         numIndices,</div>
<div class="line">                                         <a class="code" href="group__nvn__c__functions.html#gac38c964075df642306d6490b8b50ace3">nvnBufferGetAddress</a>(&amp;modelData[0]-&gt;m_IndexBuffer));</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    m_CommandHandle = <a class="code" href="group__nvn__c__functions.html#ga7d97d4cbf72259b6e867f3080f223b95">nvnCommandBufferEndRecording</a>(&amp;m_CommandBuffer);</div>
<div class="line">}<span class="comment">//NOLINT(impl/function_size)</span></div>
<div class="line"></div>
<div class="line"><span class="comment">// static</span></div>
<div class="line"><span class="keywordtype">void</span> MultiThreadedAssetFileLoading::DebugLayerCallback(</div>
<div class="line">    <a class="code" href="group__nvn__c__enum.html#ga70a49f98019e4832818240297bee7eb3">NVNdebugCallbackSource</a> source,</div>
<div class="line">    <a class="code" href="group__nvn__c__enum.html#ga661d03f0e1c886c81d5ccc67935df182">NVNdebugCallbackType</a> type,</div>
<div class="line">    <span class="keywordtype">int</span> <span class="keywordtype">id</span>,</div>
<div class="line">    <a class="code" href="group__nvn__c__enum.html#ga6d72003c068d7795201e77d27bf8c7ac">NVNdebugCallbackSeverity</a> severity,</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">char</span>* message,</div>
<div class="line">    <span class="keywordtype">void</span>* pUser</div>
<div class="line">    )</div>
<div class="line">{</div>
<div class="line">    <a class="code" href="nn___assert_8h.html#ade59d1d911907a16c0241f8fe3b31542">NN_ASSERT</a>(pUser == NULL);</div>
<div class="line"></div>
<div class="line">    <a name="a156"></a><a class="code" href="nn___log_8h.html#aa8c0b58247a2078e37f2fe0974b98a61">NN_LOG</a>(<span class="stringliteral">&quot;NVN Debug Layer Callback:\n&quot;</span>);</div>
<div class="line">    <a class="code" href="nn___log_8h.html#aa8c0b58247a2078e37f2fe0974b98a61">NN_LOG</a>(<span class="stringliteral">&quot;  source:       0x%08x\n&quot;</span>, source);</div>
<div class="line">    <a class="code" href="nn___log_8h.html#aa8c0b58247a2078e37f2fe0974b98a61">NN_LOG</a>(<span class="stringliteral">&quot;  type:         0x%08x\n&quot;</span>, type);</div>
<div class="line">    <a class="code" href="nn___log_8h.html#aa8c0b58247a2078e37f2fe0974b98a61">NN_LOG</a>(<span class="stringliteral">&quot;  id:           0x%08x\n&quot;</span>, <span class="keywordtype">id</span>);</div>
<div class="line">    <a class="code" href="nn___log_8h.html#aa8c0b58247a2078e37f2fe0974b98a61">NN_LOG</a>(<span class="stringliteral">&quot;  severity:     0x%08x\n&quot;</span>, severity);</div>
<div class="line">    <a class="code" href="nn___log_8h.html#aa8c0b58247a2078e37f2fe0974b98a61">NN_LOG</a>(<span class="stringliteral">&quot;  message:      %s\n&quot;</span>,     message);</div>
<div class="line"></div>
<div class="line">    <a class="code" href="nn___assert_8h.html#ade59d1d911907a16c0241f8fe3b31542">NN_ASSERT</a>(0, <span class="stringliteral">&quot;Debug layer callback hit&quot;</span>);</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line">TutorialBaseClass* t()</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">static</span> MultiThreadedAssetFileLoading s_Tut;</div>
<div class="line">    <span class="keywordflow">return</span> (&amp;s_Tut);</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keyword">extern</span> <span class="stringliteral">&quot;C&quot;</span> <span class="keywordtype">void</span> <a name="a157"></a><a class="code" href="_socket_resolver_8cpp.html#ae79180f8ae90e05743b47a872f305a52">nnMain</a>()</div>
<div class="line">{</div>
<div class="line">    TutorialRun();</div>
<div class="line">}</div>
</div><!-- fragment --> </div><!-- contents -->
<!-- HTML footer for doxygen 1.8.8-->
<!-- start footer part -->
</body>
</html>
