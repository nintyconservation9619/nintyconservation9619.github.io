<!-- HTML header for doxygen 1.8.8-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.10"/>
<title>NintendoSDK API Reference: IrSensorMomentBasic.cpp</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="openclose.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="stylesheet.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">NintendoSDK API Reference
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- 構築: Doxygen 1.8.10 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'検索');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>総合概要</span></a></li>
      <li><a href="pages.html"><span>諸情報</span></a></li>
      <li><a href="modules.html"><span>モジュール</span></a></li>
      <li><a href="namespaces.html"><span>名前空間</span></a></li>
      <li><a href="annotated.html"><span>クラス</span></a></li>
      <li><a href="files.html"><span>ファイル</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="検索" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">IrSensorMomentBasic.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<p>ソースコードの説明は、<a class="el" href="_page_sample_ir_sensor_moment_basic.html">シンプルなモーションIRカメラのモーメントモードの制御</a> および <a class="el" href="_ir_sensor_moment_basic_8cpp.html" title="シンプルにモーションIRカメラのモーメントモードを使用するためのサンプルプログラム ">IrSensorMomentBasic.cpp</a> を参照してください。</p>
<div class="fragment"><div class="line"><span class="comment">/*--------------------------------------------------------------------------------*</span></div>
<div class="line"><span class="comment">  Copyright (C)Nintendo All rights reserved.</span></div>
<div class="line"><span class="comment"></span></div>
<div class="line"><span class="comment">  These coded instructions, statements, and computer programs contain proprietary</span></div>
<div class="line"><span class="comment">  information of Nintendo and/or its licensed developers and are protected by</span></div>
<div class="line"><span class="comment">  national and international copyright laws. They may not be disclosed to third</span></div>
<div class="line"><span class="comment">  parties or copied or duplicated in any form, in whole or in part, without the</span></div>
<div class="line"><span class="comment">  prior written consent of Nintendo.</span></div>
<div class="line"><span class="comment"></span></div>
<div class="line"><span class="comment">  The content herein is highly confidential and should be handled accordingly.</span></div>
<div class="line"><span class="comment"> *--------------------------------------------------------------------------------*/</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="nn___assert_8h.html">nn/nn_Assert.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="nn___log_8h.html">nn/nn_Log.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="nn___macro_8h.html">nn/nn_Macro.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;nn/hid.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="hid___npad_8h.html">nn/hid/hid_Npad.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="hid___npad_joy_8h.html">nn/hid/hid_NpadJoy.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="hid___controller_support_8h.html">nn/hid/hid_ControllerSupport.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="os___thread_8h.html">nn/os/os_Thread.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="os___system_event_8h.html">nn/os/os_SystemEvent.h</a>&gt;</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#include &lt;nn/irsensor.h&gt;</span></div>
<div class="line"></div>
<div class="line"><span class="keyword">namespace </span>{</div>
<div class="line"></div>
<div class="line">    <span class="keyword">struct </span>Npad</div>
<div class="line">    {</div>
<div class="line">        <span class="keyword">typedef</span> <a class="code" href="namespacenn_1_1hid.html#a5923008962b52bf501f91b30013aedd6">nn::hid::NpadIdType</a> Id;</div>
<div class="line">        <span class="keyword">typedef</span> <a name="_a0"></a><a class="code" href="structnn_1_1hid_1_1_npad_button.html">nn::hid::NpadButton</a> Button;</div>
<div class="line">    };</div>
<div class="line"></div>
<div class="line">    Npad::Id npadIds[] =</div>
<div class="line">    {</div>
<div class="line">        <a name="a1"></a><a class="code" href="structnn_1_1hid_1_1_npad_id.html#aa0b93745c1c6de72c1fd2174f35c8ed9">nn::hid::NpadId::No1</a>,</div>
<div class="line">        <a name="a2"></a><a class="code" href="structnn_1_1hid_1_1_npad_id.html#aa127a6d25de9fd544768ee18734f5b6f">nn::hid::NpadId::No2</a>,</div>
<div class="line">        <a name="a3"></a><a class="code" href="structnn_1_1hid_1_1_npad_id.html#ab910ee335a59d4354dab5a7f0b51b8a4">nn::hid::NpadId::No3</a>,</div>
<div class="line">        <a name="a4"></a><a class="code" href="structnn_1_1hid_1_1_npad_id.html#afc19a9a80ac740645b567fc7e1dc36cf">nn::hid::NpadId::Handheld</a>,</div>
<div class="line">    };</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">int</span> NpadIdCountMax = <span class="keyword">sizeof</span>(npadIds) / <span class="keyword">sizeof</span>(<a class="code" href="namespacenn_1_1hid.html#a5923008962b52bf501f91b30013aedd6">nn::hid::NpadIdType</a>);</div>
<div class="line"></div>
<div class="line">    <a name="_a5"></a><a class="code" href="structnn_1_1irsensor_1_1_ir_camera_handle.html">nn::irsensor::IrCameraHandle</a> irCameraHandles[NpadIdCountMax];</div>
<div class="line"></div>
<div class="line">    <span class="keywordtype">bool</span> isFinished = <span class="keyword">false</span>;</div>
<div class="line"></div>
<div class="line">    <span class="keywordtype">void</span> CheckFirmwareUpdate(<span class="keyword">const</span> <a class="code" href="structnn_1_1irsensor_1_1_ir_camera_handle.html">nn::irsensor::IrCameraHandle</a>&amp; irCameraHandle)</div>
<div class="line">    {</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">int</span> FirmwareCheckTrialCountMax = 300;</div>
<div class="line"></div>
<div class="line">        <span class="keywordtype">int</span> counter = 0;</div>
<div class="line">        <span class="keywordflow">while</span> (<a name="a6"></a><a class="code" href="nn___macro_8h.html#a71c0f58f6d49fe1392380eed4509ab9a">NN_STATIC_CONDITION</a>(<span class="keyword">true</span>))</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordtype">bool</span> isUpdateNeeded = <span class="keyword">false</span>;</div>
<div class="line">            <a name="_a7"></a><a class="code" href="classnn_1_1_result.html">nn::Result</a> result = <a name="a8"></a><a class="code" href="namespacenn_1_1irsensor.html#ae2d917a320b39f4bc1f29f87d2418819">nn::irsensor::CheckFirmwareUpdateNecessity</a>(&amp;isUpdateNeeded, irCameraHandle);</div>
<div class="line">            <span class="keywordflow">if</span> (result.<a name="a9"></a><a class="code" href="classnn_1_1_result.html#a80792d8ec8b6b9e9b34025100baa67ec">IsSuccess</a>())</div>
<div class="line">            {</div>
<div class="line">                <span class="comment">// 成功時は、ファームウェアの更新が必要かどうかのフラグが返ります。</span></div>
<div class="line">                <a name="a10"></a><a class="code" href="nn___log_8h.html#aa8c0b58247a2078e37f2fe0974b98a61">NN_LOG</a>(<span class="stringliteral">&quot;    Controller firmware update checking succeed.\n&quot;</span>);</div>
<div class="line">                <span class="keywordflow">if</span> (isUpdateNeeded)</div>
<div class="line">                {</div>
<div class="line">                    <span class="comment">// コントローラの更新が必要な場合は、更新アプレットを呼び出すことを推奨します。</span></div>
<div class="line">                    <span class="comment">// 更新アプレットはブロック処理で、接続された全てのコントローラのアップデートを行うため、呼び出しには注意が必要です。</span></div>
<div class="line"><span class="preprocessor">#if defined( NN_BUILD_CONFIG_OS_HORIZON )</span></div>
<div class="line">                    <span class="comment">// 選択 UI なしの強制アップデート版コンサポ呼び出し</span></div>
<div class="line">                    <span class="comment">// 成功しても失敗しても 1 回だけ呼び出し。</span></div>
<div class="line">                    <a name="_a11"></a><a class="code" href="structnn_1_1hid_1_1_controller_firmware_update_arg.html">nn::hid::ControllerFirmwareUpdateArg</a> arg;</div>
<div class="line">                    arg.<a name="a12"></a><a class="code" href="structnn_1_1hid_1_1_controller_firmware_update_arg.html#a2a57833010056601cc5f4e136242905e">enableForceUpdate</a> = <span class="keyword">false</span>;</div>
<div class="line">                    <a name="a13"></a><a class="code" href="namespacenn_1_1hid.html#a7533399b957c748b818b5a2114541ca8">nn::hid::ShowControllerFirmwareUpdate</a>(arg);</div>
<div class="line"><span class="preprocessor">#elif defined( NN_BUILD_CONFIG_OS_WIN )</span></div>
<div class="line">                    <a class="code" href="nn___log_8h.html#aa8c0b58247a2078e37f2fe0974b98a61">NN_LOG</a>(<span class="stringliteral">&quot;Invoke ControllerFirmwareUpdate is not suppported on Windows environment.\n&quot;</span>);</div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line"><span class="preprocessor">                    #error &quot;unsupported os&quot;</span></div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (::nn::irsensor::ResultIrsensorUnavailable::Includes(result))</div>
<div class="line">            {</div>
<div class="line">                <span class="comment">// コントローラが使用不可状態の場合は、スキップする。</span></div>
<div class="line">                <a class="code" href="nn___log_8h.html#aa8c0b58247a2078e37f2fe0974b98a61">NN_LOG</a>(<span class="stringliteral">&quot;    Controller is not available.\n&quot;</span>);</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (::nn::irsensor::ResultIrsensorFirmwareCheckIncompleted::Includes(result))</div>
<div class="line">            {</div>
<div class="line">                <span class="comment">// FirmwareUpdate のチェック中、もしくはアプレット呼び出し中なのでリトライする</span></div>
<div class="line">                counter++;</div>
<div class="line">                <span class="keywordflow">if</span> (counter &gt; FirmwareCheckTrialCountMax)</div>
<div class="line">                {</div>
<div class="line">                    <span class="comment">// チェック中の状態がしばらく続いた場合は、タイムアウトすることを推奨します。</span></div>
<div class="line">                    <a class="code" href="nn___log_8h.html#aa8c0b58247a2078e37f2fe0974b98a61">NN_LOG</a>(<span class="stringliteral">&quot;    Firmware update checking is timeout.\n&quot;</span>);</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">else</span></div>
<div class="line">                {</div>
<div class="line">                    <a class="code" href="nn___log_8h.html#aa8c0b58247a2078e37f2fe0974b98a61">NN_LOG</a>(<span class="stringliteral">&quot;    Firmware update checking is running.\n&quot;</span>);</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">else</span></div>
<div class="line">            {</div>
<div class="line">                <a name="a14"></a><a class="code" href="nn___abort_8h.html#a205eaac89c47d49cb982bf136e113de2">NN_ABORT</a>(<span class="stringliteral">&quot;    Firmware update checking unexpected error\n&quot;</span>);</div>
<div class="line">            }</div>
<div class="line">            <a name="a15"></a><a class="code" href="namespacenn_1_1os.html#a96b335e87af44c60a0d6dca75f11c9d2">::nn::os::SleepThread</a>(<a name="a16"></a><a class="code" href="classnn_1_1_time_span.html#a1b8582b5180ce7992fc82a148c7f8c90">nn::TimeSpan::FromMilliSeconds</a>(15));</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordtype">void</span> PrintStatus(<span class="keyword">const</span> <a class="code" href="structnn_1_1irsensor_1_1_ir_camera_handle.html">nn::irsensor::IrCameraHandle</a>&amp; irCameraHandle)</div>
<div class="line">    {</div>
<div class="line">        <span class="comment">//IR カメラの状態の取得</span></div>
<div class="line">        <a class="code" href="namespacenn_1_1irsensor.html#a0fb1b253296b92663904ac18e7416b60">nn::irsensor::IrCameraStatus</a> irCameraStatus = <a name="a17"></a><a class="code" href="namespacenn_1_1irsensor.html#acf66c625dc12cd1fb0d06e79eb1d32a5">nn::irsensor::GetIrCameraStatus</a>(irCameraHandle);</div>
<div class="line"></div>
<div class="line">        <span class="comment">//IR カメラが利用可能</span></div>
<div class="line">        <span class="keywordflow">if</span> (irCameraStatus == <a name="a18"></a><a class="code" href="namespacenn_1_1irsensor.html#a0fb1b253296b92663904ac18e7416b60abbb0ee81209053ee4ba83a445cd88c17">nn::irsensor::IrCameraStatus_Available</a>)</div>
<div class="line">        {</div>
<div class="line">            <a class="code" href="nn___log_8h.html#aa8c0b58247a2078e37f2fe0974b98a61">NN_LOG</a>(<span class="stringliteral">&quot;IR Camera Available\n&quot;</span>);</div>
<div class="line">        }</div>
<div class="line">        <span class="comment">//コントローラが未接続</span></div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (irCameraStatus == <a name="a19"></a><a class="code" href="namespacenn_1_1irsensor.html#a0fb1b253296b92663904ac18e7416b60a6cb3f3719cad5742b5a1a23b8eddb118">nn::irsensor::IrCameraStatus_Unconnected</a>)</div>
<div class="line">        {</div>
<div class="line">            <a class="code" href="nn___log_8h.html#aa8c0b58247a2078e37f2fe0974b98a61">NN_LOG</a>(<span class="stringliteral">&quot;IR Camera Unconnected\n&quot;</span>);</div>
<div class="line">        }</div>
<div class="line">        <span class="comment">//コントローラに IR カメラが非搭載</span></div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (irCameraStatus == <a name="a20"></a><a class="code" href="namespacenn_1_1irsensor.html#a0fb1b253296b92663904ac18e7416b60afa0b85228bb50e658b60831aec2766eb">nn::irsensor::IrCameraStatus_Unsupported</a>)</div>
<div class="line">        {</div>
<div class="line">            <a class="code" href="nn___log_8h.html#aa8c0b58247a2078e37f2fe0974b98a61">NN_LOG</a>(<span class="stringliteral">&quot;IR Camera Unsupported\n&quot;</span>);</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <a name="_a21"></a><a class="code" href="structnn_1_1irsensor_1_1_moment_processor_state.html">nn::irsensor::MomentProcessorState</a> state;</div>
<div class="line">        <span class="comment">//モーメントプロセッサの処理結果の取得</span></div>
<div class="line">        <a class="code" href="classnn_1_1_result.html">nn::Result</a> result = <a name="a22"></a><a class="code" href="namespacenn_1_1irsensor.html#a505a4e54e2b1931bd78c4a85f5b67276">nn::irsensor::GetMomentProcessorState</a>(&amp;state, irCameraHandle);</div>
<div class="line">        <span class="keywordflow">if</span> (nn::irsensor::ResultIrsensorNotReady::Includes(result))</div>
<div class="line">        {</div>
<div class="line">            <span class="comment">// NotReady のエラーが返る場合は、データの準備中ですので、正しいデータが来るまでリトライします。</span></div>
<div class="line">            <a class="code" href="nn___log_8h.html#aa8c0b58247a2078e37f2fe0974b98a61">NN_LOG</a>(<span class="stringliteral">&quot;Error: Data is not ready\n&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (nn::irsensor::ResultIrsensorUnsupported::Includes(result))</div>
<div class="line">        {</div>
<div class="line">            <span class="comment">// コントローラにモーションIRカメラが非搭載の場合は、</span></div>
<div class="line">            <span class="comment">// ユーザに適切なコントローラを接続するよう案内します。</span></div>
<div class="line">            <a class="code" href="nn___log_8h.html#aa8c0b58247a2078e37f2fe0974b98a61">NN_LOG</a>(<span class="stringliteral">&quot;Error: Controller is unsupported\n&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (nn::irsensor::ResultIrsensorUnconnected::Includes(result))</div>
<div class="line">        {</div>
<div class="line">            <span class="comment">// コントローラが非接続の場合は、ユーザに案内し、接続されるまでリトライすることを推奨します。</span></div>
<div class="line">            <a class="code" href="nn___log_8h.html#aa8c0b58247a2078e37f2fe0974b98a61">NN_LOG</a>(<span class="stringliteral">&quot;Error: Controller is unconnected\n&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (nn::irsensor::ResultIrsensorDeviceError::Includes(result))</div>
<div class="line">        {</div>
<div class="line">            <span class="comment">// DeviceError が発生した場合は、モーションIRカメラは使用できませんので、一度 プロセッサを停止します。</span></div>
<div class="line">            <span class="comment">// この場合、詳細なエラー内容を示したエラービューア、またはコントローラのアップデートが表示されるため、</span></div>
<div class="line">            <span class="comment">// ユーザは問題の解決を試みます。</span></div>
<div class="line">            <a class="code" href="nn___log_8h.html#aa8c0b58247a2078e37f2fe0974b98a61">NN_LOG</a>(<span class="stringliteral">&quot;Error: DeviceError occured\n&quot;</span>);</div>
<div class="line">            isFinished = <span class="keyword">true</span>;</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="comment">//サンプリング番号</span></div>
<div class="line">        <a class="code" href="nn___log_8h.html#aa8c0b58247a2078e37f2fe0974b98a61">NN_LOG</a>(<span class="stringliteral">&quot;SamplingNumber    : %lld\n&quot;</span>, state.<a name="a23"></a><a class="code" href="structnn_1_1irsensor_1_1_moment_processor_state.html#a40e64427e14d0d79b9d770cf8246fc16">samplingNumber</a>);</div>
<div class="line">        <span class="comment">//処理開始からの経過時間</span></div>
<div class="line">        <a class="code" href="nn___log_8h.html#aa8c0b58247a2078e37f2fe0974b98a61">NN_LOG</a>(<span class="stringliteral">&quot;timeStamp         : %lld us\n&quot;</span>, state.<a name="a24"></a><a class="code" href="structnn_1_1irsensor_1_1_moment_processor_state.html#af77696a3f52bcaff4d79dbcb6c0de445">timeStamp</a>.<a name="a25"></a><a class="code" href="structnn_1_1_time_span_type.html#a3cbd1615db31fa610feb7c6e6be3139b">GetMicroSeconds</a>());</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a name="a26"></a><a class="code" href="namespacenn_1_1irsensor.html#a6a72379158ea9356d7a6cda290fbe573">nn::irsensor::MomentProcessorBlockRowCount</a>; ++i)</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a name="a27"></a><a class="code" href="namespacenn_1_1irsensor.html#a1d1eb3129c3c4f712cc2d2abdad6764b">nn::irsensor::MomentProcessorBlockColumnCount</a>; ++j)</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordtype">int</span> index = i * nn::irsensor::MomentProcessorBlockColumnCount + j;</div>
<div class="line">                <span class="comment">//ブロックの平均輝度値</span></div>
<div class="line">                <span class="keywordtype">float</span> averageIntensity = state.<a name="a28"></a><a class="code" href="structnn_1_1irsensor_1_1_moment_processor_state.html#a13ea9f5fe1104f5963f94a9126ebad71">blocks</a>[index].<a name="a29"></a><a class="code" href="structnn_1_1irsensor_1_1_moment_statistic.html#abf11884c7e72155459472167ed530839">averageIntensity</a>;</div>
<div class="line">                <span class="comment">//ブロックの重心</span></div>
<div class="line">                <span class="keywordtype">float</span> centroidX = state.<a class="code" href="structnn_1_1irsensor_1_1_moment_processor_state.html#a13ea9f5fe1104f5963f94a9126ebad71">blocks</a>[index].<a name="a30"></a><a class="code" href="structnn_1_1irsensor_1_1_moment_statistic.html#a951268e414ca226f3d58e834424f1003">centroid</a>.<a name="a31"></a>x;</div>
<div class="line">                <span class="keywordtype">float</span> centroidY = state.<a class="code" href="structnn_1_1irsensor_1_1_moment_processor_state.html#a13ea9f5fe1104f5963f94a9126ebad71">blocks</a>[index].<a class="code" href="structnn_1_1irsensor_1_1_moment_statistic.html#a951268e414ca226f3d58e834424f1003">centroid</a>.<a name="a32"></a>y;</div>
<div class="line">                <a class="code" href="nn___log_8h.html#aa8c0b58247a2078e37f2fe0974b98a61">NN_LOG</a>(<span class="stringliteral">&quot;Block(%d,%d)\n&quot;</span>, j, i);</div>
<div class="line">                <a class="code" href="nn___log_8h.html#aa8c0b58247a2078e37f2fe0974b98a61">NN_LOG</a>(<span class="stringliteral">&quot;  AverageIntensity: %3.1f\n&quot;</span>, averageIntensity);</div>
<div class="line">                <a class="code" href="nn___log_8h.html#aa8c0b58247a2078e37f2fe0974b98a61">NN_LOG</a>(<span class="stringliteral">&quot;  Centroid        : (%3.1f, %3.1f)\n&quot;</span>, centroidX, centroidY);</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">        <a class="code" href="nn___log_8h.html#aa8c0b58247a2078e37f2fe0974b98a61">NN_LOG</a>(<span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordtype">void</span> Update()</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; NpadIdCountMax; i++)</div>
<div class="line">        {</div>
<div class="line">            <a name="_a33"></a><a class="code" href="structnn_1_1util_1_1_bit_flag_set.html">nn::hid::NpadStyleSet</a> style = <a name="a34"></a><a class="code" href="namespacenn_1_1hid.html#a50e56789aa106765d43935bb1838c797">nn::hid::GetNpadStyleSet</a>(npadIds[i]);</div>
<div class="line"></div>
<div class="line">            <span class="keywordflow">if</span> (style.<a name="a35"></a><a class="code" href="structnn_1_1util_1_1_bit_flag_set.html#a16d7fcb5bf4461b82f497a58d0fc2e1c">Test</a>&lt;<a name="_a36"></a><a class="code" href="structnn_1_1util_1_1_bit_flag_set_1_1_flag.html">nn::hid::NpadStyleJoyRight</a>&gt;())</div>
<div class="line">            {</div>
<div class="line">                <a name="_a37"></a><a class="code" href="structnn_1_1hid_1_1_npad_joy_right_state.html">nn::hid::NpadJoyRightState</a> stateJoyRight;</div>
<div class="line">                <a name="a38"></a><a class="code" href="namespacenn_1_1hid.html#a1ea1131389075ff5c5d5911dd6da9b8f">nn::hid::GetNpadState</a>(&amp;stateJoyRight, npadIds[i]);</div>
<div class="line"></div>
<div class="line">                <span class="comment">// ＋ ボタンが押されたら終了</span></div>
<div class="line">                <span class="keywordflow">if</span> (stateJoyRight.<a name="a39"></a><a class="code" href="structnn_1_1hid_1_1_npad_joy_right_state.html#a72130e581e9a657fc0f53b1dc4901d9d">buttons</a>.<a name="a40"></a><a class="code" href="structnn_1_1util_1_1_bit_flag_set.html#a16d7fcb5bf4461b82f497a58d0fc2e1c">Test</a>&lt;<a class="code" href="structnn_1_1util_1_1_bit_flag_set_1_1_flag.html">nn::hid::NpadButton::Plus</a>&gt;())</div>
<div class="line">                {</div>
<div class="line">                    isFinished = <span class="keyword">true</span>;</div>
<div class="line">                }</div>
<div class="line">                <span class="comment">//ボタンが押されていたら モーションIRカメラの状態と処理結果を取得して出力</span></div>
<div class="line">                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (stateJoyRight.<a class="code" href="structnn_1_1hid_1_1_npad_joy_right_state.html#a72130e581e9a657fc0f53b1dc4901d9d">buttons</a>.<a name="a41"></a><a class="code" href="structnn_1_1util_1_1_bit_flag_set.html#ae4e209a4994ffe17acedd0c657927e99">IsAnyOn</a>())</div>
<div class="line">                {</div>
<div class="line">                    <a class="code" href="nn___log_8h.html#aa8c0b58247a2078e37f2fe0974b98a61">NN_LOG</a>(<span class="stringliteral">&quot;Right Controller&#39;s buttons are Pressed\n&quot;</span>);</div>
<div class="line"></div>
<div class="line">                    PrintStatus(irCameraHandles[i]);</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line"></div>
<div class="line">            <span class="keywordflow">if</span> (style.<a class="code" href="structnn_1_1util_1_1_bit_flag_set.html#a16d7fcb5bf4461b82f497a58d0fc2e1c">Test</a>&lt;<a class="code" href="structnn_1_1util_1_1_bit_flag_set_1_1_flag.html">nn::hid::NpadStyleJoyLeft</a>&gt;())</div>
<div class="line">            {</div>
<div class="line">                <a name="_a42"></a><a class="code" href="structnn_1_1hid_1_1_npad_joy_left_state.html">nn::hid::NpadJoyLeftState</a> stateJoyLeft;</div>
<div class="line">                <a class="code" href="namespacenn_1_1hid.html#a1ea1131389075ff5c5d5911dd6da9b8f">nn::hid::GetNpadState</a>(&amp;stateJoyLeft, npadIds[i]);</div>
<div class="line"></div>
<div class="line">                <span class="comment">// - ボタンが押されたら終了</span></div>
<div class="line">                <span class="keywordflow">if</span> (stateJoyLeft.<a name="a43"></a><a class="code" href="structnn_1_1hid_1_1_npad_joy_left_state.html#a1122275526a7970666d8c21caef02677">buttons</a>.<a class="code" href="structnn_1_1util_1_1_bit_flag_set.html#a16d7fcb5bf4461b82f497a58d0fc2e1c">Test</a>&lt;<a class="code" href="structnn_1_1util_1_1_bit_flag_set_1_1_flag.html">nn::hid::NpadButton::Minus</a>&gt;())</div>
<div class="line">                {</div>
<div class="line">                    isFinished = <span class="keyword">true</span>;</div>
<div class="line">                }</div>
<div class="line">                <span class="comment">//ボタンが押されていたら モーションIRカメラの状態と処理結果を取得して出力</span></div>
<div class="line">                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (stateJoyLeft.<a class="code" href="structnn_1_1hid_1_1_npad_joy_left_state.html#a1122275526a7970666d8c21caef02677">buttons</a>.<a class="code" href="structnn_1_1util_1_1_bit_flag_set.html#ae4e209a4994ffe17acedd0c657927e99">IsAnyOn</a>())</div>
<div class="line">                {</div>
<div class="line">                    <a class="code" href="nn___log_8h.html#aa8c0b58247a2078e37f2fe0974b98a61">NN_LOG</a>(<span class="stringliteral">&quot;Left Controller&#39;s buttons are Pressed\n&quot;</span>);</div>
<div class="line"></div>
<div class="line">                    PrintStatus(irCameraHandles[i]);</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line"></div>
<div class="line">            <span class="keywordflow">if</span> (style.<a class="code" href="structnn_1_1util_1_1_bit_flag_set.html#a16d7fcb5bf4461b82f497a58d0fc2e1c">Test</a>&lt;<a class="code" href="structnn_1_1util_1_1_bit_flag_set_1_1_flag.html">nn::hid::NpadStyleHandheld</a>&gt;())</div>
<div class="line">            {</div>
<div class="line">                <a name="_a44"></a><a class="code" href="structnn_1_1hid_1_1_npad_handheld_state.html">nn::hid::NpadHandheldState</a> stateHandheld;</div>
<div class="line">                <a class="code" href="namespacenn_1_1hid.html#a1ea1131389075ff5c5d5911dd6da9b8f">nn::hid::GetNpadState</a>(&amp;stateHandheld, npadIds[i]);</div>
<div class="line"></div>
<div class="line">                <span class="comment">// ＋ ボタンが押されたら終了</span></div>
<div class="line">                <span class="keywordflow">if</span> (stateHandheld.<a name="a45"></a><a class="code" href="structnn_1_1hid_1_1_npad_handheld_state.html#a70f94ae42e5414c591583cb9a70877a3">buttons</a>.<a class="code" href="structnn_1_1util_1_1_bit_flag_set.html#a16d7fcb5bf4461b82f497a58d0fc2e1c">Test</a>&lt;<a class="code" href="structnn_1_1util_1_1_bit_flag_set_1_1_flag.html">nn::hid::NpadButton::Plus</a>&gt;())</div>
<div class="line">                {</div>
<div class="line">                    isFinished = <span class="keyword">true</span>;</div>
<div class="line">                }</div>
<div class="line">                <span class="comment">//ボタンが押されていたら モーションIRカメラの状態と処理結果を取得して出力</span></div>
<div class="line">                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (stateHandheld.<a class="code" href="structnn_1_1hid_1_1_npad_handheld_state.html#a70f94ae42e5414c591583cb9a70877a3">buttons</a>.<a class="code" href="structnn_1_1util_1_1_bit_flag_set.html#ae4e209a4994ffe17acedd0c657927e99">IsAnyOn</a>())</div>
<div class="line">                {</div>
<div class="line">                    <a class="code" href="nn___log_8h.html#aa8c0b58247a2078e37f2fe0974b98a61">NN_LOG</a>(<span class="stringliteral">&quot;Handheld Controller&#39;s buttons are Pressed\n&quot;</span>);</div>
<div class="line"></div>
<div class="line">                    PrintStatus(irCameraHandles[i]);</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line"></div>
<div class="line">            <span class="keywordflow">if</span> (style.<a class="code" href="structnn_1_1util_1_1_bit_flag_set.html#a16d7fcb5bf4461b82f497a58d0fc2e1c">Test</a>&lt;<a class="code" href="structnn_1_1util_1_1_bit_flag_set_1_1_flag.html">nn::hid::NpadStyleFullKey</a>&gt;())</div>
<div class="line">            {</div>
<div class="line">                <a name="_a46"></a><a class="code" href="structnn_1_1hid_1_1_npad_full_key_state.html">nn::hid::NpadFullKeyState</a> stateFullKey;</div>
<div class="line">                <a class="code" href="namespacenn_1_1hid.html#a1ea1131389075ff5c5d5911dd6da9b8f">nn::hid::GetNpadState</a>(&amp;stateFullKey, npadIds[i]);</div>
<div class="line"></div>
<div class="line">                <span class="comment">// ＋ ボタンが押されたら終了</span></div>
<div class="line">                <span class="keywordflow">if</span> (stateFullKey.<a name="a47"></a><a class="code" href="structnn_1_1hid_1_1_npad_full_key_state.html#ab47273cb70afeff22b5a21a62db2abab">buttons</a>.<a class="code" href="structnn_1_1util_1_1_bit_flag_set.html#a16d7fcb5bf4461b82f497a58d0fc2e1c">Test</a>&lt;<a class="code" href="structnn_1_1util_1_1_bit_flag_set_1_1_flag.html">nn::hid::NpadButton::Plus</a>&gt;())</div>
<div class="line">                {</div>
<div class="line">                    isFinished = <span class="keyword">true</span>;</div>
<div class="line">                }</div>
<div class="line">                <span class="comment">//ボタンが押されていたら モーションIRカメラの状態と処理結果を取得して出力</span></div>
<div class="line">                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (stateFullKey.<a class="code" href="structnn_1_1hid_1_1_npad_full_key_state.html#ab47273cb70afeff22b5a21a62db2abab">buttons</a>.<a class="code" href="structnn_1_1util_1_1_bit_flag_set.html#ae4e209a4994ffe17acedd0c657927e99">IsAnyOn</a>())</div>
<div class="line">                {</div>
<div class="line">                    <a class="code" href="nn___log_8h.html#aa8c0b58247a2078e37f2fe0974b98a61">NN_LOG</a>(<span class="stringliteral">&quot;FullKey Controller&#39;s buttons are Pressed\n&quot;</span>);</div>
<div class="line"></div>
<div class="line">                    PrintStatus(irCameraHandles[i]);</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">}<span class="comment">//namespace</span></div>
<div class="line"></div>
<div class="line"><span class="keyword">extern</span> <span class="stringliteral">&quot;C&quot;</span> <span class="keywordtype">void</span> <a name="a48"></a><a class="code" href="_socket_resolver_8cpp.html#ae79180f8ae90e05743b47a872f305a52">nnMain</a>()</div>
<div class="line">{</div>
<div class="line">    <a class="code" href="nn___log_8h.html#aa8c0b58247a2078e37f2fe0974b98a61">NN_LOG</a>(<span class="stringliteral">&quot;IR Sensor Moment Basic Sample(Npad) Start.\n&quot;</span>);</div>
<div class="line"></div>
<div class="line">    <a name="a49"></a><a class="code" href="namespacenn_1_1hid.html#a54ad6953b9cef17b4d79171e819b0048">nn::hid::InitializeNpad</a>();</div>
<div class="line"></div>
<div class="line">    <span class="comment">//Npadのスタイルを設定</span></div>
<div class="line">    <a name="a50"></a><a class="code" href="namespacenn_1_1hid.html#ac04a55a989058f9d69c5c3e4e29c4480">nn::hid::SetSupportedNpadStyleSet</a>(</div>
<div class="line">        ::nn::hid::NpadStyleJoyRight::Mask</div>
<div class="line">        | ::nn::hid::NpadStyleJoyLeft::Mask</div>
<div class="line">        | ::nn::hid::NpadStyleHandheld::Mask</div>
<div class="line">        | ::nn::hid::NpadStyleFullKey::Mask</div>
<div class="line">    );</div>
<div class="line"></div>
<div class="line">    <span class="comment">//使用するNpadId の設定</span></div>
<div class="line">    <a name="a51"></a><a class="code" href="namespacenn_1_1hid.html#a82326d8c0d5f888fce443798bb829e97">nn::hid::SetSupportedNpadIdType</a>(npadIds, <span class="keyword">sizeof</span>(npadIds) / <span class="keyword">sizeof</span>(npadIds[0]));</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; NpadIdCountMax; ++i)</div>
<div class="line">    {</div>
<div class="line">        <span class="comment">// 1本ずつ割り当て</span></div>
<div class="line">        <a name="a52"></a><a class="code" href="namespacenn_1_1hid.html#a617f872f844f16873b925fe0669a898a">nn::hid::SetNpadJoyAssignmentModeSingle</a>(npadIds[i]);</div>
<div class="line">        <span class="comment">//IR カメラのハンドルの取得</span></div>
<div class="line">        irCameraHandles[i] = <a name="a53"></a><a class="code" href="namespacenn_1_1irsensor.html#a4772960359a06fcd86d2b9ffe85059fc">nn::irsensor::GetIrCameraHandle</a>(npadIds[i]);</div>
<div class="line">        <span class="comment">//IR カメラの初期化</span></div>
<div class="line">        <a name="a54"></a><a class="code" href="namespacenn_1_1irsensor.html#a43c18eac7fe6430f1c9620e29169cf1a">nn::irsensor::Initialize</a>(irCameraHandles[i]);</div>
<div class="line">        <a class="code" href="nn___log_8h.html#aa8c0b58247a2078e37f2fe0974b98a61">NN_LOG</a>(<span class="stringliteral">&quot;NpadPlayerNumber(%d)\n&quot;</span>,npadIds[i]);</div>
<div class="line">        <span class="comment">// FirmwareUpdate のチェック</span></div>
<div class="line">        CheckFirmwareUpdate(irCameraHandles[i]);</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <a class="code" href="nn___log_8h.html#aa8c0b58247a2078e37f2fe0974b98a61">NN_LOG</a>(<span class="stringliteral">&quot;If you push any button, you can get IR sensor state.\n&quot;</span>);</div>
<div class="line">    <a class="code" href="nn___log_8h.html#aa8c0b58247a2078e37f2fe0974b98a61">NN_LOG</a>(<span class="stringliteral">&quot;Push (+) or (-) Button to shutdown this application.\n&quot;</span>);</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; NpadIdCountMax; ++i)</div>
<div class="line">    {</div>
<div class="line">        <a name="_a55"></a><a class="code" href="structnn_1_1irsensor_1_1_moment_processor_config.html">nn::irsensor::MomentProcessorConfig</a> config;</div>
<div class="line">        <span class="comment">//モーメントプロセッサのデフォルト設定の取得</span></div>
<div class="line">        <a name="a56"></a><a class="code" href="namespacenn_1_1irsensor.html#aacc1373caac7c89a734b57cae50b506c">nn::irsensor::GetMomentProcessorDefaultConfig</a>(&amp;config);</div>
<div class="line">        <span class="comment">//モーメントプロセッサの開始</span></div>
<div class="line">        <a name="a57"></a><a class="code" href="namespacenn_1_1irsensor.html#a0658b45f92e49e1612735574042920e9">nn::irsensor::RunMomentProcessor</a>(irCameraHandles[i], config);</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">while</span>(!isFinished)</div>
<div class="line">    {</div>
<div class="line">        Update();</div>
<div class="line">        <a class="code" href="namespacenn_1_1os.html#a96b335e87af44c60a0d6dca75f11c9d2">::nn::os::SleepThread</a>(<a class="code" href="classnn_1_1_time_span.html#a1b8582b5180ce7992fc82a148c7f8c90">nn::TimeSpan::FromMilliSeconds</a>(15));</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; NpadIdCountMax; ++i)</div>
<div class="line">    {</div>
<div class="line">        <span class="comment">//モーメントプロセッサの停止</span></div>
<div class="line">        <a name="a58"></a><a class="code" href="namespacenn_1_1irsensor.html#a3052171f2c63aafc0e4a164366ae22d7">nn::irsensor::StopImageProcessor</a>(irCameraHandles[i]);</div>
<div class="line">        <span class="comment">//IR カメラの終了処理</span></div>
<div class="line">        <a name="a59"></a><a class="code" href="namespacenn_1_1irsensor.html#a6265f5c6e6d6fc0e67fc6882a8945284">nn::irsensor::Finalize</a>(irCameraHandles[i]);</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <a class="code" href="nn___log_8h.html#aa8c0b58247a2078e37f2fe0974b98a61">NN_LOG</a>(<span class="stringliteral">&quot;IR Sensor Moment Basic Sample Done\n&quot;</span>);</div>
<div class="line">}</div>
</div><!-- fragment --> </div><!-- contents -->
<!-- HTML footer for doxygen 1.8.8-->
<!-- start footer part -->
</body>
</html>
