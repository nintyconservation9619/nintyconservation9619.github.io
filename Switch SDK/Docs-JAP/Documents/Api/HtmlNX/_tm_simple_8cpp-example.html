<!-- HTML header for doxygen 1.8.8-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.10"/>
<title>NintendoSDK API Reference: TmSimple.cpp</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="openclose.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="stylesheet.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">NintendoSDK API Reference
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- 構築: Doxygen 1.8.10 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'検索');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>総合概要</span></a></li>
      <li><a href="pages.html"><span>諸情報</span></a></li>
      <li><a href="modules.html"><span>モジュール</span></a></li>
      <li><a href="namespaces.html"><span>名前空間</span></a></li>
      <li><a href="annotated.html"><span>クラス</span></a></li>
      <li><a href="files.html"><span>ファイル</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="検索" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">TmSimple.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<p>ソースコードの説明は、<a class="el" href="_page_sample_tm_simple.html">TmSimple</a> および <a class="el" href="_tm_simple_8cpp.html" title="TM ライブラリサンプルプログラム ">TmSimple.cpp</a> を参照してください。</p>
<div class="fragment"><div class="line"><span class="comment">/*--------------------------------------------------------------------------------*</span></div>
<div class="line"><span class="comment">  Copyright (C)Nintendo All rights reserved.</span></div>
<div class="line"><span class="comment"></span></div>
<div class="line"><span class="comment">  These coded instructions, statements, and computer programs contain proprietary</span></div>
<div class="line"><span class="comment">  information of Nintendo and/or its licensed developers and are protected by</span></div>
<div class="line"><span class="comment">  national and international copyright laws. They may not be disclosed to third</span></div>
<div class="line"><span class="comment">  parties or copied or duplicated in any form, in whole or in part, without the</span></div>
<div class="line"><span class="comment">  prior written consent of Nintendo.</span></div>
<div class="line"><span class="comment"></span></div>
<div class="line"><span class="comment">  The content herein is highly confidential and should be handled accordingly.</span></div>
<div class="line"><span class="comment"> *--------------------------------------------------------------------------------*/</span></div>
<div class="line"><span class="preprocessor">#include &lt;memory&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;windows.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;string&gt;</span></div>
<div class="line"><span class="preprocessor">#include &quot;C:\Program Files\Nintendo\Oasis\include\tm.h&quot;</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#define RETURN_IF_FAILURE(operation) \</span></div>
<div class="line"><span class="preprocessor">do { \</span></div>
<div class="line"><span class="preprocessor">    nn::tm::Error MACRO_ERROR = operation; \</span></div>
<div class="line"><span class="preprocessor">    if (MACRO_ERROR != nn::tm::Error_Ok) \</span></div>
<div class="line"><span class="preprocessor">    { \</span></div>
<div class="line"><span class="preprocessor">        nn::tm::ErrorText MACRO_ERROR_STRING; \</span></div>
<div class="line"><span class="preprocessor">        nn::tm::GetErrorTextEn(&amp;MACRO_ERROR_STRING, MACRO_ERROR); \</span></div>
<div class="line"><span class="preprocessor">        printf(&quot;%s failed because %s(%d).\n&quot;, #operation, MACRO_ERROR_STRING.text, MACRO_ERROR); \</span></div>
<div class="line"><span class="preprocessor">        return; \</span></div>
<div class="line"><span class="preprocessor">    } \</span></div>
<div class="line"><span class="preprocessor">} while (0)</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#define PRINT_PARAMETER(error, print, param) \</span></div>
<div class="line"><span class="preprocessor">do { \</span></div>
<div class="line"><span class="preprocessor">    if (error != nn::tm::Error_Ok) \</span></div>
<div class="line"><span class="preprocessor">    { \</span></div>
<div class="line"><span class="preprocessor">        printf(print, &quot;Error&quot;); \</span></div>
<div class="line"><span class="preprocessor">    } \</span></div>
<div class="line"><span class="preprocessor">    else \</span></div>
<div class="line"><span class="preprocessor">    { \</span></div>
<div class="line"><span class="preprocessor">        printf(print, param); \</span></div>
<div class="line"><span class="preprocessor">    } \</span></div>
<div class="line"><span class="preprocessor">} while (0)</span></div>
<div class="line"></div>
<div class="line"><span class="keyword">const</span> <span class="keywordtype">char</span>* ConnectionTypeName[] =</div>
<div class="line">{</div>
<div class="line">    <span class="stringliteral">&quot;Unknown&quot;</span>,</div>
<div class="line">    <span class="stringliteral">&quot;Usb&quot;</span>,</div>
<div class="line">    <span class="stringliteral">&quot;Ethernet&quot;</span>,</div>
<div class="line">    <span class="stringliteral">&quot;Future&quot;</span>,</div>
<div class="line">};</div>
<div class="line"></div>
<div class="line"><span class="keyword">const</span> <span class="keywordtype">char</span>* HardwareTypeName[] =</div>
<div class="line">{</div>
<div class="line">    <span class="stringliteral">&quot;Unknown&quot;</span>,</div>
<div class="line">    <span class="stringliteral">&quot;Edev&quot;</span>,</div>
<div class="line">    <span class="stringliteral">&quot;Sdev&quot;</span>,</div>
<div class="line">    <span class="stringliteral">&quot;Sim&quot;</span>,</div>
<div class="line">    <span class="stringliteral">&quot;Future&quot;</span>,</div>
<div class="line">};</div>
<div class="line"></div>
<div class="line"><span class="keyword">const</span> <span class="keywordtype">char</span>* TargetStatusName[] =</div>
<div class="line">{</div>
<div class="line">    <span class="stringliteral">&quot;Unknown&quot;</span>,</div>
<div class="line">    <span class="stringliteral">&quot;Disconnected&quot;</span>,</div>
<div class="line">    <span class="stringliteral">&quot;Disconnecting&quot;</span>,</div>
<div class="line">    <span class="stringliteral">&quot;Connected&quot;</span>,</div>
<div class="line">    <span class="stringliteral">&quot;Connecting&quot;</span>,</div>
<div class="line">    <span class="stringliteral">&quot;Asleep&quot;</span>,</div>
<div class="line">    <span class="stringliteral">&quot;PoweringOn&quot;</span>,</div>
<div class="line">    <span class="stringliteral">&quot;PoweringOff&quot;</span>,</div>
<div class="line">};</div>
<div class="line"></div>
<div class="line"><span class="keyword">const</span> <span class="keywordtype">char</span>* ProgramStateName[] =</div>
<div class="line">{</div>
<div class="line">    <span class="stringliteral">&quot;NoProgram&quot;</span>,</div>
<div class="line">    <span class="stringliteral">&quot;Loading&quot;</span>,</div>
<div class="line">    <span class="stringliteral">&quot;Loaded&quot;</span>,</div>
<div class="line">    <span class="stringliteral">&quot;Running&quot;</span>,</div>
<div class="line">    <span class="stringliteral">&quot;Halted&quot;</span>,</div>
<div class="line">};</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> ShowRegisteredTargetsWithoutDetails(<a name="_a0"></a><a class="code" href="structnn_1_1tm_1_1_target_handle.html">nn::tm::TargetHandle</a> targetHandles[], <span class="keywordtype">int</span> targetCount)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">for</span> (int32_t iTarget = 0; iTarget &lt; targetCount; iTarget++)</div>
<div class="line">    {</div>
<div class="line">        <a class="code" href="namespacenn_1_1tm.html#af7ab04e057ae2bf176cfe7f5b5699034">nn::tm::Error</a> error;</div>
<div class="line">        printf(<span class="stringliteral">&quot;%d) &quot;</span>, iTarget);</div>
<div class="line"></div>
<div class="line">        <a name="_a1"></a><a class="code" href="structnn_1_1tm_1_1_target_name.html">nn::tm::TargetName</a> nameBuffer = { 0 };</div>
<div class="line">        error = <a name="a2"></a><a class="code" href="namespacenn_1_1tm.html#a800c61b734b55dc4092f4fb67a52ca91">nn::tm::GetTargetName</a>(&amp;nameBuffer, targetHandles[iTarget]);</div>
<div class="line">        PRINT_PARAMETER(error, <span class="stringliteral">&quot;\tName: %s&quot;</span>, nameBuffer.<a name="a3"></a>name);</div>
<div class="line"></div>
<div class="line">        <a name="_a4"></a><a class="code" href="structnn_1_1tm_1_1_target_ip_address.html">nn::tm::TargetIpAddress</a> ipAddress;</div>
<div class="line">        error = <a class="code" href="namespacenn_1_1tm.html#ad73941e8a33d7ce3b6389e2ece60b486">GetTargetIpAddress</a>(&amp;ipAddress, targetHandles[iTarget]);</div>
<div class="line">        PRINT_PARAMETER(error, <span class="stringliteral">&quot;\tIPAddress: %15s&quot;</span>, ipAddress.<a name="a5"></a>ipAddress);</div>
<div class="line"></div>
<div class="line">        <a name="_a6"></a><a class="code" href="structnn_1_1tm_1_1_target_serial_number.html">nn::tm::TargetSerialNumber</a> serialNumber;</div>
<div class="line">        error = <a name="a7"></a><a class="code" href="namespacenn_1_1tm.html#aebfc5817575397e282a0d2bcf0af3242">nn::tm::GetTargetSerialNumber</a>(&amp;serialNumber, targetHandles[iTarget]);</div>
<div class="line">        PRINT_PARAMETER(error, <span class="stringliteral">&quot;\tSerialNumber: %s\n&quot;</span>, serialNumber.<a name="a8"></a>serialNumber);</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">int</span> GetInputNumber()</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">int</span> ret;</div>
<div class="line">    <span class="keywordtype">char</span> buffer[128];</div>
<div class="line">    <span class="keywordtype">char</span>* check;</div>
<div class="line">    <span class="keywordflow">while</span> (<span class="keyword">true</span>)</div>
<div class="line">    {</div>
<div class="line">        fgets(buffer, <span class="keyword">sizeof</span>(buffer), stdin);</div>
<div class="line">        ret = strtol(buffer, &amp;check, 10);</div>
<div class="line">        <span class="keywordflow">if</span> (*check == <span class="charliteral">&#39;\n&#39;</span>)</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line">        printf(<span class="stringliteral">&quot;Please input number: &quot;</span>);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">return</span> ret;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> ShowDiscovoeredTargets()</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">int</span> WaitSec = 2;</div>
<div class="line">    RETURN_IF_FAILURE(<a name="a9"></a><a class="code" href="namespacenn_1_1tm.html#affc7631993d4d81734fd04ff6801ed1e">nn::tm::StartDiscovery</a>(WaitSec * 1000));</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; WaitSec; i++)</div>
<div class="line">    {</div>
<div class="line">        Sleep(1000);</div>
<div class="line">        printf(<span class="stringliteral">&quot;This is a list of currently found targets\n&quot;</span>);</div>
<div class="line"></div>
<div class="line">        {</div>
<div class="line">            int32_t targetCount;</div>
<div class="line">            RETURN_IF_FAILURE(<a name="a10"></a><a class="code" href="namespacenn_1_1tm.html#a3925fbf4c1069cdcbc537a96fb1f6746">nn::tm::GetDiscoveryTargetCount</a>(&amp;targetCount));</div>
<div class="line"></div>
<div class="line">            std::unique_ptr&lt;nn::tm::DiscoveryHandle[]&gt; pDiscoveryHandles(<span class="keyword">new</span> <a name="_a11"></a><a class="code" href="structnn_1_1tm_1_1_discovery_handle.html">nn::tm::DiscoveryHandle</a>[targetCount]);</div>
<div class="line">            RETURN_IF_FAILURE(<a name="a12"></a><a class="code" href="namespacenn_1_1tm.html#aa309bdadb5f56cde33525a5ce5dfedd5">nn::tm::GetDiscoveryTargets</a>(pDiscoveryHandles.get(), &amp;targetCount, targetCount));</div>
<div class="line"></div>
<div class="line">            <span class="keywordflow">for</span> (int32_t iTarget = 0; iTarget &lt; targetCount; iTarget++)</div>
<div class="line">            {</div>
<div class="line">                <a class="code" href="namespacenn_1_1tm.html#af7ab04e057ae2bf176cfe7f5b5699034">nn::tm::Error</a> error;</div>
<div class="line">                printf(<span class="stringliteral">&quot;%02d:\n&quot;</span>, iTarget);</div>
<div class="line"></div>
<div class="line">                <a class="code" href="structnn_1_1tm_1_1_target_name.html">nn::tm::TargetName</a> nameBuffer = { 0 };</div>
<div class="line">                error = <a name="a13"></a><a class="code" href="namespacenn_1_1tm.html#a4fc83f1ebddc0b361cbbaccc9fbdc058">nn::tm::GetDiscoveryTargetName</a>(&amp;nameBuffer, pDiscoveryHandles[iTarget]);</div>
<div class="line">                PRINT_PARAMETER(error, <span class="stringliteral">&quot;\tName: %s\n&quot;</span>, nameBuffer.name);</div>
<div class="line"></div>
<div class="line">                <a class="code" href="structnn_1_1tm_1_1_target_ip_address.html">nn::tm::TargetIpAddress</a> ipAddress;</div>
<div class="line">                error = <a name="a14"></a><a class="code" href="namespacenn_1_1tm.html#a1102c1e9497e0879b92c40abe6751132">nn::tm::GetDiscoveryTargetIpAddress</a>(&amp;ipAddress, pDiscoveryHandles[iTarget]);</div>
<div class="line">                PRINT_PARAMETER(error, <span class="stringliteral">&quot;\tIPAddress: %15s\n&quot;</span>, ipAddress.ipAddress);</div>
<div class="line"></div>
<div class="line">                <a class="code" href="structnn_1_1tm_1_1_target_serial_number.html">nn::tm::TargetSerialNumber</a> serialNumber;</div>
<div class="line">                error = <a name="a15"></a><a class="code" href="namespacenn_1_1tm.html#ab6c051987b95b741c68cb94aa5d025c6">nn::tm::GetDiscoveryTargetSerialNumber</a>(&amp;serialNumber, pDiscoveryHandles[iTarget]);</div>
<div class="line">                PRINT_PARAMETER(error, <span class="stringliteral">&quot;\tSerialNumber: %s\n&quot;</span>, serialNumber.serialNumber);</div>
<div class="line"></div>
<div class="line">                <a name="_a16"></a><a class="code" href="structnn_1_1tm_1_1_target_mac_address.html">nn::tm::TargetMacAddress</a> macAddress;</div>
<div class="line">                error = <a name="a17"></a><a class="code" href="namespacenn_1_1tm.html#af8d33f738ce669a3c0f08b4c84734840">nn::tm::GetDiscoveryTargetMacAddress</a>(&amp;macAddress, pDiscoveryHandles[iTarget]);</div>
<div class="line">                PRINT_PARAMETER(error, <span class="stringliteral">&quot;\tMAC Address: %s\n&quot;</span>, macAddress.<a name="a18"></a>macAddress);</div>
<div class="line"></div>
<div class="line">                <a class="code" href="namespacenn_1_1tm.html#aa59a34a84efb360bab2a0ffc81424f85">nn::tm::TargetConnectionType</a> connectionType;</div>
<div class="line">                error = <a class="code" href="namespacenn_1_1tm.html#a31ebc666c416974264c7677c4ecea001">GetDiscoveryTargetConnectionType</a>(&amp;connectionType, pDiscoveryHandles[iTarget]);</div>
<div class="line">                PRINT_PARAMETER(error, <span class="stringliteral">&quot;\tConnectionType: %s\n&quot;</span>, ConnectionTypeName[connectionType]);</div>
<div class="line"></div>
<div class="line">                <a class="code" href="namespacenn_1_1tm.html#a45342c02e85eb2eacb90f4b44f9cde6d">nn::tm::TargetHardwareType</a> hardwareType;</div>
<div class="line">                error = <a name="a19"></a><a class="code" href="namespacenn_1_1tm.html#a6758ab77b140308e0082326673fea42c">nn::tm::GetDiscoveryTargetHardwareType</a>(&amp;hardwareType, pDiscoveryHandles[iTarget]);</div>
<div class="line">                PRINT_PARAMETER(error, <span class="stringliteral">&quot;\tHardwareType: %s\n&quot;</span>, HardwareTypeName[hardwareType]);</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> ShowRegisteredTargets()</div>
<div class="line">{</div>
<div class="line">    int32_t targetCount;</div>
<div class="line">    RETURN_IF_FAILURE(<a name="a20"></a><a class="code" href="namespacenn_1_1tm.html#ab1bae8c19e9dcc5c5590e4a0a3fc2348">nn::tm::GetTargetCount</a>(&amp;targetCount));</div>
<div class="line"></div>
<div class="line">    std::unique_ptr&lt;nn::tm::TargetHandle[]&gt; pTargetHandles(<span class="keyword">new</span> <a class="code" href="structnn_1_1tm_1_1_target_handle.html">nn::tm::TargetHandle</a>[targetCount]);</div>
<div class="line">    RETURN_IF_FAILURE(<a name="a21"></a><a class="code" href="namespacenn_1_1tm.html#a50e6b98b7fd6773d8c896ffdd7dfe48e">nn::tm::GetTargets</a>(pTargetHandles.get(), &amp;targetCount, targetCount));</div>
<div class="line"></div>
<div class="line">    <a class="code" href="structnn_1_1tm_1_1_target_handle.html">nn::tm::TargetHandle</a> defaultTargetHandle;</div>
<div class="line">    RETURN_IF_FAILURE(<a name="a22"></a><a class="code" href="namespacenn_1_1tm.html#af16f8646436f34f1e13d98856ada479c">nn::tm::GetDefaultTarget</a>(&amp;defaultTargetHandle));</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">for</span> (int32_t iTarget = 0; iTarget &lt; targetCount; iTarget++)</div>
<div class="line">    {</div>
<div class="line">        <a class="code" href="namespacenn_1_1tm.html#af7ab04e057ae2bf176cfe7f5b5699034">nn::tm::Error</a> error;</div>
<div class="line">        printf(<span class="stringliteral">&quot;%02d:%s\n&quot;</span>, iTarget, (defaultTargetHandle.<a name="a23"></a>handle == pTargetHandles[iTarget].handle) ? <span class="stringliteral">&quot;(Default Target)&quot;</span> : <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"></div>
<div class="line">        <a class="code" href="structnn_1_1tm_1_1_target_name.html">nn::tm::TargetName</a> nameBuffer = { 0 };</div>
<div class="line">        error = <a class="code" href="namespacenn_1_1tm.html#a800c61b734b55dc4092f4fb67a52ca91">nn::tm::GetTargetName</a>(&amp;nameBuffer, pTargetHandles[iTarget]);</div>
<div class="line">        PRINT_PARAMETER(error, <span class="stringliteral">&quot;\tName: %s\n&quot;</span>, nameBuffer.name);</div>
<div class="line"></div>
<div class="line">        <a class="code" href="structnn_1_1tm_1_1_target_ip_address.html">nn::tm::TargetIpAddress</a> ipAddress;</div>
<div class="line">        error = <a name="a24"></a><a class="code" href="namespacenn_1_1tm.html#ad73941e8a33d7ce3b6389e2ece60b486">nn::tm::GetTargetIpAddress</a>(&amp;ipAddress, pTargetHandles[iTarget]);</div>
<div class="line">        PRINT_PARAMETER(error, <span class="stringliteral">&quot;\tIPAddress: %15s\n&quot;</span>, ipAddress.ipAddress);</div>
<div class="line"></div>
<div class="line">        <a class="code" href="structnn_1_1tm_1_1_target_serial_number.html">nn::tm::TargetSerialNumber</a> serialNumber;</div>
<div class="line">        error = <a class="code" href="namespacenn_1_1tm.html#aebfc5817575397e282a0d2bcf0af3242">nn::tm::GetTargetSerialNumber</a>(&amp;serialNumber, pTargetHandles[iTarget]);</div>
<div class="line">        PRINT_PARAMETER(error, <span class="stringliteral">&quot;\tSerialNumber: %s\n&quot;</span>, serialNumber.serialNumber);</div>
<div class="line"></div>
<div class="line">        <a class="code" href="structnn_1_1tm_1_1_target_mac_address.html">nn::tm::TargetMacAddress</a> macAddress;</div>
<div class="line">        error = <a name="a25"></a><a class="code" href="namespacenn_1_1tm.html#a9580b7cf83fd41575e9503d9cc99a248">nn::tm::GetTargetMacAddress</a>(&amp;macAddress, pTargetHandles[iTarget]);</div>
<div class="line">        PRINT_PARAMETER(error, <span class="stringliteral">&quot;\tMAC Address: %15s\n&quot;</span>, macAddress.macAddress);</div>
<div class="line"></div>
<div class="line">        <a class="code" href="namespacenn_1_1tm.html#a05f46629dc9dc5852868677b0f3b2448">nn::tm::TargetStatus</a> status;</div>
<div class="line">        error = <a name="a26"></a><a class="code" href="namespacenn_1_1tm.html#a5cf2dfc50667bdad60a5363e6f141e94">nn::tm::GetTargetStatus</a>(&amp;status, pTargetHandles[iTarget]);</div>
<div class="line">        PRINT_PARAMETER(error, <span class="stringliteral">&quot;\tStatus: %s\n&quot;</span>, TargetStatusName[status]);</div>
<div class="line"></div>
<div class="line">        <a class="code" href="namespacenn_1_1tm.html#aa59a34a84efb360bab2a0ffc81424f85">nn::tm::TargetConnectionType</a> connectionType;</div>
<div class="line">        error = <a name="a27"></a><a class="code" href="namespacenn_1_1tm.html#a52ee418d82ed14a94a6b659e78f8bdc1">nn::tm::GetTargetConnectionType</a>(&amp;connectionType, pTargetHandles[iTarget]);</div>
<div class="line">        PRINT_PARAMETER(error, <span class="stringliteral">&quot;\tConnectionType: %s\n&quot;</span>, ConnectionTypeName[connectionType]);</div>
<div class="line"></div>
<div class="line">        <a class="code" href="namespacenn_1_1tm.html#a45342c02e85eb2eacb90f4b44f9cde6d">nn::tm::TargetHardwareType</a> hardwareType;</div>
<div class="line">        error = <a name="a28"></a><a class="code" href="namespacenn_1_1tm.html#abd844cc492fa70b5d85d825542b1f131">nn::tm::GetTargetHardwareType</a>(&amp;hardwareType, pTargetHandles[iTarget]);</div>
<div class="line">        PRINT_PARAMETER(error, <span class="stringliteral">&quot;\tHardwareType: %s\n&quot;</span>, HardwareTypeName[hardwareType]);</div>
<div class="line"></div>
<div class="line">        <span class="keywordtype">bool</span> isSleeping;</div>
<div class="line">        error = <a name="a29"></a><a class="code" href="namespacenn_1_1tm.html#a665c0ff1359e1f48262aee05f7d94b7d">nn::tm::GetTargetIsSleeping</a>(&amp;isSleeping, pTargetHandles[iTarget]);</div>
<div class="line">        PRINT_PARAMETER(error, <span class="stringliteral">&quot;\tIsSleeping: %s\n&quot;</span>, (isSleeping) ? <span class="stringliteral">&quot;Yes&quot;</span> : <span class="stringliteral">&quot;No&quot;</span>);</div>
<div class="line"></div>
<div class="line">        <span class="keywordtype">bool</span> isConnected;</div>
<div class="line">        error = <a name="a30"></a><a class="code" href="namespacenn_1_1tm.html#a0eed937f7f18fcf145ec0631563b61ac">nn::tm::GetTargetIsConnected</a>(&amp;isConnected, pTargetHandles[iTarget]);</div>
<div class="line">        PRINT_PARAMETER(error, <span class="stringliteral">&quot;\tIsConnected: %s\n&quot;</span>, (isConnected) ? <span class="stringliteral">&quot;Yes&quot;</span> : <span class="stringliteral">&quot;No&quot;</span>);</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> AddTarget()</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// StartDiscovery should be called in ShowDiscovoeredTargets already so just call GetDiscoveryTargetCount and so on</span></div>
<div class="line">    int32_t targetCount;</div>
<div class="line">    RETURN_IF_FAILURE(<a class="code" href="namespacenn_1_1tm.html#a3925fbf4c1069cdcbc537a96fb1f6746">nn::tm::GetDiscoveryTargetCount</a>(&amp;targetCount));</div>
<div class="line">    <span class="keywordflow">if</span> (targetCount == 0)</div>
<div class="line">    {</div>
<div class="line">        printf(<span class="stringliteral">&quot;No target to add is found. Skip AddTarget\n&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line">    std::unique_ptr&lt;nn::tm::DiscoveryHandle[]&gt; pDiscoveryHandles(<span class="keyword">new</span> <a class="code" href="structnn_1_1tm_1_1_discovery_handle.html">nn::tm::DiscoveryHandle</a>[targetCount]);</div>
<div class="line">    RETURN_IF_FAILURE(<a class="code" href="namespacenn_1_1tm.html#aa309bdadb5f56cde33525a5ce5dfedd5">nn::tm::GetDiscoveryTargets</a>(pDiscoveryHandles.get(), &amp;targetCount, targetCount));</div>
<div class="line"></div>
<div class="line">    printf(<span class="stringliteral">&quot;Please input the option number to add:\n&quot;</span>);</div>
<div class="line">    <span class="keywordflow">for</span> (int32_t iTarget = 0; iTarget &lt; targetCount; iTarget++)</div>
<div class="line">    {</div>
<div class="line">        <a class="code" href="namespacenn_1_1tm.html#af7ab04e057ae2bf176cfe7f5b5699034">nn::tm::Error</a> error;</div>
<div class="line">        printf(<span class="stringliteral">&quot;%d):&quot;</span>, iTarget);</div>
<div class="line"></div>
<div class="line">        <a class="code" href="structnn_1_1tm_1_1_target_name.html">nn::tm::TargetName</a> nameBuffer = { 0 };</div>
<div class="line">        error = <a class="code" href="namespacenn_1_1tm.html#a4fc83f1ebddc0b361cbbaccc9fbdc058">nn::tm::GetDiscoveryTargetName</a>(&amp;nameBuffer, pDiscoveryHandles[iTarget]);</div>
<div class="line">        PRINT_PARAMETER(error, <span class="stringliteral">&quot;\tName: %s&quot;</span>, nameBuffer.name);</div>
<div class="line"></div>
<div class="line">        <a class="code" href="structnn_1_1tm_1_1_target_ip_address.html">nn::tm::TargetIpAddress</a> ipAddress;</div>
<div class="line">        error = <a class="code" href="namespacenn_1_1tm.html#a1102c1e9497e0879b92c40abe6751132">nn::tm::GetDiscoveryTargetIpAddress</a>(&amp;ipAddress, pDiscoveryHandles[iTarget]);</div>
<div class="line">        PRINT_PARAMETER(error, <span class="stringliteral">&quot;\tIPAddress: %s&quot;</span>, ipAddress.ipAddress);</div>
<div class="line"></div>
<div class="line">        <a class="code" href="structnn_1_1tm_1_1_target_serial_number.html">nn::tm::TargetSerialNumber</a> serialNumber;</div>
<div class="line">        error = <a class="code" href="namespacenn_1_1tm.html#ab6c051987b95b741c68cb94aa5d025c6">nn::tm::GetDiscoveryTargetSerialNumber</a>(&amp;serialNumber, pDiscoveryHandles[iTarget]);</div>
<div class="line">        PRINT_PARAMETER(error, <span class="stringliteral">&quot;\tSerialNumber: %s\n&quot;</span>, serialNumber.serialNumber);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordtype">int</span> selectedTarget = GetInputNumber();</div>
<div class="line">    <span class="keywordflow">if</span> (0 &lt;= selectedTarget &amp;&amp; selectedTarget &lt; targetCount)</div>
<div class="line">    {</div>
<div class="line">        <a class="code" href="structnn_1_1tm_1_1_target_handle.html">nn::tm::TargetHandle</a> targetHandle;</div>
<div class="line">        RETURN_IF_FAILURE(<a name="a31"></a><a class="code" href="namespacenn_1_1tm.html#a433ee979733abf98d33e410835c0b653">nn::tm::AddTarget</a>(&amp;targetHandle, pDiscoveryHandles[selectedTarget]));</div>
<div class="line">        printf(<span class="stringliteral">&quot;Added.\n&quot;</span>);</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keyword">const</span> std::string GetSampleNspPath()</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">char</span> buffer[512];</div>
<div class="line">    DWORD ret = GetEnvironmentVariableA(<span class="stringliteral">&quot;NINTENDO_SDK_ROOT&quot;</span>, buffer, <span class="keyword">sizeof</span>(buffer));</div>
<div class="line">    _ASSERT(ret &lt; <span class="keyword">sizeof</span>(buffer));</div>
<div class="line">    (void)ret;</div>
<div class="line">    <span class="keywordflow">return</span> std::string(buffer) + <span class="stringliteral">&quot;\\Resources\\Firmwares\\NX\\Sample\\Binaries\\GfxPrimitiveRenderer.nsp&quot;</span>;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> RunProgram()</div>
<div class="line">{</div>
<div class="line">    int32_t targetCount;</div>
<div class="line">    RETURN_IF_FAILURE(<a class="code" href="namespacenn_1_1tm.html#ab1bae8c19e9dcc5c5590e4a0a3fc2348">nn::tm::GetTargetCount</a>(&amp;targetCount));</div>
<div class="line">    <span class="keywordflow">if</span> (targetCount == 0)</div>
<div class="line">    {</div>
<div class="line">        printf(<span class="stringliteral">&quot;No target is found. Skip RunProgram\n&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    std::unique_ptr&lt;nn::tm::TargetHandle[]&gt; pTargetHandles(<span class="keyword">new</span> <a class="code" href="structnn_1_1tm_1_1_target_handle.html">nn::tm::TargetHandle</a>[targetCount]);</div>
<div class="line">    RETURN_IF_FAILURE(<a class="code" href="namespacenn_1_1tm.html#a50e6b98b7fd6773d8c896ffdd7dfe48e">nn::tm::GetTargets</a>(pTargetHandles.get(), &amp;targetCount, targetCount));</div>
<div class="line"></div>
<div class="line">    printf(<span class="stringliteral">&quot;Please input the option number of the target to run:\n&quot;</span>);</div>
<div class="line">    ShowRegisteredTargetsWithoutDetails(pTargetHandles.get(), targetCount);</div>
<div class="line">    <span class="keywordtype">int</span> selectedTarget = GetInputNumber();</div>
<div class="line">    <span class="keywordflow">if</span> (0 &lt;= selectedTarget &amp;&amp; selectedTarget &lt; targetCount)</div>
<div class="line">    {</div>
<div class="line">        <a class="code" href="structnn_1_1tm_1_1_target_handle.html">nn::tm::TargetHandle</a> target = pTargetHandles[selectedTarget];</div>
<div class="line">        <span class="comment">// Guarantee that the target is connected</span></div>
<div class="line">        RETURN_IF_FAILURE(<a name="a32"></a><a class="code" href="namespacenn_1_1tm.html#a85c3f9c3c4d21eae6e748898d2e89add">nn::tm::ConnectTarget</a>(target));</div>
<div class="line">        printf(<span class="stringliteral">&quot;Loading %s...\n&quot;</span>, GetSampleNspPath().c_str());</div>
<div class="line">        RETURN_IF_FAILURE(<a name="a33"></a><a class="code" href="namespacenn_1_1tm.html#ad8e5dfcc831c62dc7a5cf9af8c5aa721">nn::tm::LaunchTargetProgram</a>(target, GetSampleNspPath().c_str(), <span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;&quot;</span>));</div>
<div class="line"></div>
<div class="line">        <a name="_a34"></a><a class="code" href="structnn_1_1tm_1_1_target_program_name.html">nn::tm::TargetProgramName</a> programName;</div>
<div class="line">        <a class="code" href="namespacenn_1_1tm.html#af7ab04e057ae2bf176cfe7f5b5699034">nn::tm::Error</a> getNameError = <a name="a35"></a><a class="code" href="namespacenn_1_1tm.html#a67e416569975e489112f73827431e963">nn::tm::GetTargetProgramName</a>(&amp;programName, target);</div>
<div class="line">        <span class="keywordflow">if</span> (getNameError == <a name="a36"></a><a class="code" href="namespacenn_1_1tm.html#af7ab04e057ae2bf176cfe7f5b5699034ad61301c99dccde95d75d2cad197848d6">nn::tm::Error_Ok</a>)</div>
<div class="line">        {</div>
<div class="line">            printf(<span class="stringliteral">&quot;Running program is %s\n&quot;</span>, programName.<a name="a37"></a>name);</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">        {</div>
<div class="line">            <a name="_a38"></a><a class="code" href="structnn_1_1tm_1_1_error_text.html">nn::tm::ErrorText</a> errorText;</div>
<div class="line">            <a name="a39"></a><a class="code" href="namespacenn_1_1tm.html#a642828ac7ffde86bf9fc0ef626d309b0">nn::tm::GetErrorTextEn</a>(&amp;errorText, getNameError);</div>
<div class="line">            printf(<span class="stringliteral">&quot;GetTargetProgramName failed because %s(%d).\n&quot;</span>, errorText.<a name="a40"></a>text, getNameError);</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <a class="code" href="namespacenn_1_1tm.html#a65c4c275de00753bdcb270212e8d603c">nn::tm::TargetProgramState</a> programState;</div>
<div class="line">        <a class="code" href="namespacenn_1_1tm.html#af7ab04e057ae2bf176cfe7f5b5699034">nn::tm::Error</a> getStateError = <a name="a41"></a><a class="code" href="namespacenn_1_1tm.html#adbde8c1b5037ae73ba7708e85fe5724d">nn::tm::GetTargetProgramState</a>(&amp;programState, target);</div>
<div class="line">        <span class="keywordflow">if</span> (getStateError == <a class="code" href="namespacenn_1_1tm.html#af7ab04e057ae2bf176cfe7f5b5699034ad61301c99dccde95d75d2cad197848d6">nn::tm::Error_Ok</a>)</div>
<div class="line">        {</div>
<div class="line">            printf(<span class="stringliteral">&quot;Program state is %s\n&quot;</span>, ProgramStateName[programState + 1]);</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">        {</div>
<div class="line">            <a class="code" href="structnn_1_1tm_1_1_error_text.html">nn::tm::ErrorText</a> errorText;</div>
<div class="line">            <a class="code" href="namespacenn_1_1tm.html#a642828ac7ffde86bf9fc0ef626d309b0">nn::tm::GetErrorTextEn</a>(&amp;errorText, getStateError);</div>
<div class="line">            printf(<span class="stringliteral">&quot;GetTargetProgramName failed because %s(%d).\n&quot;</span>, errorText.text, getStateError);</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        printf(<span class="stringliteral">&quot;Terminating the application... &quot;</span>);</div>
<div class="line">        RETURN_IF_FAILURE(<a name="a42"></a><a class="code" href="namespacenn_1_1tm.html#a1f80d8a454f628089fe81343e4332874">nn::tm::KillTargetProgram</a>(target));</div>
<div class="line">        printf(<span class="stringliteral">&quot;Success\n&quot;</span>);</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">int</span> main()</div>
<div class="line">{</div>
<div class="line">    ShowDiscovoeredTargets();</div>
<div class="line">    ShowRegisteredTargets();</div>
<div class="line">    AddTarget();</div>
<div class="line">    RunProgram();</div>
<div class="line">    getchar();</div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"></div>
</div><!-- fragment --> </div><!-- contents -->
<!-- HTML footer for doxygen 1.8.8-->
<!-- start footer part -->
</body>
</html>
