<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<script type="text/javascript" src="../template/js/jquery/jquery.js"></script>
<script type="text/javascript" src="../template/js/common/manualLib.js"></script>
<script type="text/javascript" src="../tocData.js"></script>
<link rel="stylesheet" type="text/css" href="../template/css/template.css" />
<title>NintendoWare グラフィックス の変更点</title>
</head>
<body data-reassemble="autoindex=no,forceNoLabel=yes">
<div id="autoindex_content">
<div class="body_content">
<noscript>
<div style="border: 4px double black; margin: 4px; padding: 2px; font-weight: bold; background-color: #FFFFCC;">
<p>お使いのブラウザは JavaScript が使用できないため、本ドキュメントの一部機能が無効になっています。</p><p>JavaScript が無効の環境では目次を使用することができません。<br />JavaScriptの実行が許可された状態で閲覧してください。<br /><br /></p>
</div>
</noscript>
<div class="page_navigation_top">
<table class="page_navi_root">
<tr>
<td class="page_navi_left"></td>
<td class="page_navi_right"></td>
</tr>
</table>
</div>
<div class="breadcrumb"></div>

<!-- NintendoWare グラフィックス の変更点 -->
<div class="pagetitle" id="PageId_94757084">NintendoWare グラフィックス の変更点</div>
<div class="text_separate">
<p>NintendoSDK 0.7.0 で行われた NintendoWare グラフィックスの変更点について説明します。 <br />NintendoWare グラフィックスは、以下のモジュールのことを指します。</p>
<ul>
  <li>
    <span class="ApiLink_nn__g3d">nn::g3d</span>
  </li>
  <li>
    <span class="ApiLink_nn__ui2d">nn::ui2d</span>
  </li>
  <li>
    <span class="ApiLink_nn__font">nn::font</span>
  </li>
  <li>
    <span class="ApiLink_nn__vfx">nn::vfx</span>
  </li>
</ul>
<p>&nbsp;</p>
<div class="info_new">
  <div class="info_new_left">参考：</div>
  <div class="info_new_right">
    <p>NintendoSDK 0.8.0 にて ディスクリプタプールの扱い について仕様変更が行われました。本ページ上のコード例 は、NintendoSDK 0.8.0 の仕様に則したコードで変更しています。</p>
    <p>ディスクリプタプールの仕様変更の詳細は、<a href="../Pages/Page_99804825.html">NintendoWare グラフィックス の変更点 0.8.0</a> を参照ください。</p>
  </div>
</div>
<h2 id="Anchor_94757084_h2_1">目次</h2>
<p>
  <ul class="macro_toc">
    <li>
      <a href="#Anchor_94757084_h2_1">目次</a>
    </li>
    <li>
      <a href="#Anchor_94757084_h2_2">名前空間の移行</a>
    </li>
    <li>
      <a href="#Anchor_94757084_h2_3">低レイヤグラフィックスライブラリの変更</a>
    </li>
    <ul>
      <li>
        <a href="#Anchor_94757084_h3_1">グラフィックスデバイスについて</a>
      </li>
      <li>
        <a href="#Anchor_94757084_h3_2">グラフィックスコマンドについて</a>
      </li>
      <li>
        <a href="#Anchor_94757084_h3_3">ディスクリプタプールについて</a>
      </li>
      <li>
        <a href="#Anchor_94757084_h3_4">テクスチャ リソース について</a>
      </li>
      <li>
        <a href="#Anchor_94757084_h3_5">nn::gfx ライブラリを利用した実装について</a>
      </li>
    </ul>
    <li>
      <a href="#Anchor_94757084_h2_4">ツールについて</a>
    </li>
    <ul>
      <li>
        <a href="#Anchor_94757084_h3_6">3D Editor</a>
      </li>
      <li>
        <a href="#Anchor_94757084_h3_7">LayoutEditor</a>
      </li>
      <li>
        <a href="#Anchor_94757084_h3_8">EffectMaker</a>
      </li>
    </ul>
    <li>
      <a href="#Anchor_94757084_h2_5">ビューアについて</a>
    </li>
    <li>
      <a href="#Anchor_94757084_h2_6">API、メソッド名変更について</a>
    </li>
    <li>
      <a href="#Anchor_94757084_h2_7">各モジュールの変更点</a>
    </li>
    <ul>
      <li>
        <a href="#Anchor_94757084_h3_9">nn::g3d の変更点</a>
      </li>
      <li>
        <a href="#Anchor_94757084_h3_10">nn::vfx の変更点</a>
      </li>
      <li>
        <a href="#Anchor_94757084_h3_11">nn::ui2d、nn::font の変更点</a>
      </li>
    </ul>
  </ul>
</p>
<p>&nbsp;</p>
<h2 id="Anchor_94757084_h2_2">名前空間の移行</h2>
<p>NintendoSDK 0.7.0　にて 旧 NintendoWare グラフィックスモジュールは、 nw 名前空間から nn 名前空間 に移行しました。<br />名前空間の移行に伴い、名前空間の名称の見直しや統合も行いました。</p>
<table class="table">
  <tbody>
    <tr>
      <th class="highlight-blue">新グラフィックスモジュール</th>
      <th class="highlight-blue">旧グラフィックスモジュール</th>
      <th class="highlight-blue">&nbsp;</th>
    </tr>
    <tr>
      <td style="text-align: left;">nn::g3d</td>
      <td style="text-align: left;">nw::g3d</td>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td style="text-align: left;">nn::g3d::viewer</td>
      <td>nw::g3d::edit</td>
      <td>0.7.0 には含まれません。将来のバージョンで含まれる予定です。</td>
    </tr>
    <tr>
      <td style="text-align: left;">nn::ui2d</td>
      <td style="text-align: left;">nw::lyt / nw::ctrl</td>
      <td>nw::lyt / nw::ctrl は、nn::ui2d に統合されます。</td>
    </tr>
    <tr>
      <td style="text-align: left;">nn::ui2d::viewer</td>
      <td>nw::vwrlyt</td>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td style="text-align: left;">nn::font</td>
      <td>nw::sys::font / nw::scfont</td>
      <td>nw::sys::font / nw::scfont は、nn::font に統合されます。</td>
    </tr>
    <tr>
      <td style="text-align: left;">nn::fontll</td>
      <td>scffnd</td>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td style="text-align: left;">nn::vfx</td>
      <td style="text-align: left;">nw::eft</td>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td style="text-align: left;">nn::vfx::viewer</td>
      <td style="text-align: left;">nw::eftvw</td>
      <td>&nbsp;</td>
    </tr>
  </tbody>
</table>
<h2 id="Anchor_94757084_h2_3">低レイヤグラフィックスライブラリの変更</h2>
<p>NintendoWare グラフィックスモジュール(&nbsp;<span class="ApiLink_nn__g3d">nn::g3d</span> / <span class="ApiLink_nn__ui2d">nn::ui2d</span> / <span class="ApiLink_nn__vfx">nn::vfx</span> ) ではこれまで、OpenGL を低レイヤグラフィックスライブラリとして利用してきましたが、NintendoSDK 0.7.0 にて <span class="ApiLink_nn__gfx">nn::gfx</span> ライブラリ に変更しました。</p>
<p>変更後は以下のような構成になります。</p>
<p>
  <span class="embedded-file-wrapper ">
    <img src="../Attachments/Attach_94757084/94707133.png" width="500" class="embedded-image" />
  </span>
</p>
<p>この変更により、各モジュールの旧nw空間から移行するにあたって、ユーザー側でコード書き換えが発生する仕様変更が行われています。</p>
<p>&nbsp;</p>
<h3 id="Anchor_94757084_h3_1">グラフィックスデバイスについて</h3>
<p>
  <span class="ApiLink_nn__gfx">nn::gfx</span> ライブラリは、テクスチャやサンプラなどのグラフィックスオブジェクトの初期化に <span class="ApiLink_nn__gfx__Device">nn::gfx::Device</span> オブジェクトを要求します。よって、<span class="ApiLink_nn__g3d">nn::g3d</span> / <span class="ApiLink_nn__ui2d">nn::ui2d</span> / <span class="ApiLink_nn__vfx">nn::vfx</span> ランタイムでも、システムの初期化であったり、リソースの初期化メソッドにて <span class="ApiLink_nn__gfx__Device">nn::gfx::Device</span> オブジェクトを要求するような仕様変更が施されています。</p>
<p>&nbsp;</p>
<h3 id="Anchor_94757084_h3_2">グラフィックスコマンドについて</h3>
<p>
  <span class="ApiLink_nn__gfx">nn::gfx</span> ライブラリは、<span class="ApiLink_nn__gfx__Command">nn::gfx::Command</span> クラスにを介してグラフィックスコマンドを発行する仕様なので、各 <span class="ApiLink_nn__g3d">nn::g3d</span> / <span class="ApiLink_nn__ui2d">nn::ui2d</span> / <span class="ApiLink_nn__vfx">nn::vfx</span> の描画コマンド発行処理メソッドの引数に <span class="ApiLink_nn__gfx__Command">nn::gfx::Command</span> クラスを引数として受けるようなAPI変更が施されました。</p>
<table class="codeblock">
  <tbody>
    <tr>
      <td class="gutter">1<br />
2<br />
3<br />
4<br />
5<br />
6<br />
7<br />
8<br />
9<br />
10<br />
11<br />
12<br />
13<br />
14<br />
15<br />
16</td>
      <td class="code">
        <div class="codeblock"><pre><span class="c1">// コマンドバッファを初期化する
</span><span class="nn">nn::gfx::</span><span class="n">CommandBuffer</span> <span class="n">gfxCommandBuffer</span> <span class="p">;</span>
<span class="n">gfxCommandBuffer</span><span class="p">.</span><span class="n">Initialize</span><span class="p">(</span> <span class="p">...</span> <span class="p">);</span>

<span class="n">gfxCommandBuffer</span><span class="p">.</span><span class="n">Begin</span><span class="p">();</span>
<span class="p">{</span>
&nbsp;&nbsp;<span class="c1">// nn::vfx モジュールの描画コマンド発行処理
</span>&nbsp;&nbsp;<span class="n">vfxSystem</span><span class="o">-&gt;</span><span class="n">SwapBuffer</span><span class="p">();</span>
&nbsp;&nbsp;<span class="n">vfxSystem</span><span class="o">-&gt;</span><span class="n">SetViewParam</span><span class="p">(</span> <span class="o">&amp;</span><span class="n">view</span> <span class="p">);</span>
&nbsp;&nbsp;<span class="c1">// 描画コマンドを発行する nn::gfx::CommandBuffer オブジェクトを引数に渡す
</span>&nbsp;&nbsp;<span class="n">vfxSystem</span><span class="o">-&gt;</span><span class="n">Draw</span><span class="p">(</span> <span class="o">&amp;</span><span class="n">gfxCommandBuffer</span> <span class="p">);</span>
<span class="p">}</span>
<span class="n">gfxCommandBuffer</span><span class="p">.</span><span class="n">End</span><span class="p">();</span>

<span class="c1">// 書き込まれたグラフィックスコマンドを実行
</span><span class="n">gfxQueue</span><span class="p">.</span><span class="n">ExecuteCommand</span><span class="p">(</span> <span class="n">g_pCurrentCommandBuffer</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">g_Fence</span> <span class="p">);</span></pre></div>
      </td>
    </tr>
  </tbody>
</table>
<p>&nbsp;</p>
<h3 id="Anchor_94757084_h3_3">ディスクリプタプールについて</h3>
<p>テクスチャオブジェクトやサンプラオブジェクトは、ディスクリプタプールに登録しディスクリプタスロットを取得した上で利用されます。このディスクリプタプールは、アプリで１つしか用意されないので、font / ui2d / vfx&nbsp; ランタイム内部で生成されるオブジェクトはコールバック関数を通して、生成されたオブジェクトの情報をアプリ側に通知し、アプリ側でディスクリプタプールへの登録、ディスクリプタスロットの取得を行っていただく必要があります。</p>
<p>
  <span class="embedded-file-wrapper ">
    <img src="../Attachments/Attach_94757084/94709916.png" width="500" class="embedded-image" />
  </span>
</p>
<p>ディスクリプタプールを利用することで１つのオブジェクトのレンダリングに利用できるテクスチャやサンプラの数の上限が飛躍的に増加しますが、ディスクリプタプールに登録可能なグラフィックスオブジェクト数には制限がありますし、用意可能なディスクリプタプールは、NintendoWare、アプリケーション、OS で１つになります。</p>
<table class="table">
  <tbody>
    <tr>
      <td>テクスチャオブジェクト</td>
      <td>2^20個 (&nbsp;1048576 個 )</td>
    </tr>
    <tr>
      <td>サンプラオブジェクト</td>
      <td>2^12個 ( 4096 個 )</td>
    </tr>
  </tbody>
</table>
<table class="codeblock">
  <tbody>
    <tr>
      <td class="gutter">1<br />
2<br />
3<br />
4<br />
5<br />
6<br />
7<br />
8<br />
9<br />
10<br />
11<br />
12<br />
13<br />
14<br />
15<br />
16<br />
17<br />
18<br />
19<br />
20<br />
21<br />
22<br />
23<br />
24<br />
25<br />
26<br />
27<br />
28<br />
29<br />
30<br />
31<br />
32<br />
33<br />
34<br />
35<br />
36<br />
37<br />
38<br />
39<br />
40<br />
41<br />
42<br />
43<br />
44<br />
45<br />
46<br />
47<br />
48<br />
49<br />
50<br />
51<br />
52<br />
53<br />
54</td>
      <td class="code">
        <div class="codeblock"><pre><span class="c1">// テクスチャオブジェクトをディスクリプタプールへ登録するコールバック関数の記述例
</span><span class="kt">bool</span> <span class="nf">AllocateSlotForTexture</span><span class="p">(</span> <span class="nn">nn::gfx::</span><span class="n">DescriptorSlot</span><span class="o">*</span> <span class="n">dstSlot</span><span class="p">,</span> <span class="k">const</span> <span class="nn">nn::gfx::</span><span class="n">TextureView</span><span class="o">&amp;</span> <span class="n">textureView</span><span class="p">,</span> <span class="kt">void</span><span class="o">*</span> <span class="n">pUserData</span> <span class="p">)</span>
<span class="p">{</span>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="c1">// pUserData には、テクスチャディスクリプタプールへ登録するためのオブジェクトなどを渡せる
</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">TextrueDescriptorManger</span><span class="o">*</span> <span class="n">manger</span> <span class="o">=</span> <span class="k">reinterpret_cast</span><span class="o">&lt;</span> <span class="n">TextrueDescriptorManger</span><span class="o">*</span> <span class="o">&gt;</span><span class="p">(</span> <span class="n">pUserData</span> <span class="p">);</span>

&nbsp;&nbsp;&nbsp;&nbsp;<span class="c1">// 空いているディスクリプタインデックスを確保する
</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="kt">int</span> <span class="n">emptyTextureSlot</span> <span class="o">=</span> <span class="n">manger</span><span class="o">-&gt;</span><span class="n">GetEmptyTextureDescriptorSlot</span><span class="p">();</span>

&nbsp;&nbsp;&nbsp;&nbsp;<span class="nn">nn::gfx::</span><span class="n">DescriptorPool</span> <span class="n">textureDescriptorPool</span><span class="p">;</span>

&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">textureDescriptorPool</span><span class="p">.</span><span class="n">BeginUpdate</span><span class="p">();</span>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">{</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">textureDescriptorPool</span><span class="p">.</span><span class="n">SetTextureView</span><span class="p">(</span> <span class="n">emptyTextureSlot</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">textureView</span><span class="p">);</span>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">textureDescriptorPool</span><span class="p">.</span><span class="n">EndUpdate</span><span class="p">();</span>

&nbsp;&nbsp;&nbsp;&nbsp;<span class="c1">// ディスクリプタインデックスからディスクリプタスロットを取得する
</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">textureDescriptorPool</span><span class="p">.</span><span class="n">GetDescriptorSlot</span><span class="p">(</span> <span class="n">dstSlot</span><span class="p">,</span> <span class="n">emptyTextureSlot</span> <span class="p">);</span>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// サンプラオブジェクトをディスクリプタプールへ登録するコールバック関数の記述例
</span><span class="kt">bool</span> <span class="nf">AllocateSlotForSampler</span><span class="p">(</span><span class="nn">nn::gfx::</span><span class="n">DescriptorSlot</span><span class="o">*</span> <span class="n">dstSlot</span><span class="p">,</span> <span class="k">const</span> <span class="nn">nn::gfx::</span><span class="n">Sampler</span><span class="o">&amp;</span> <span class="n">sampler</span><span class="p">,</span> <span class="kt">void</span><span class="o">*</span> <span class="n">pUserData</span> <span class="p">)</span>
<span class="p">{</span>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="c1">// pUserData には、サンプラディスクリプタプールへ登録するためのオブジェクトなどを渡せる
</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">SamplerDescriptorManger</span><span class="o">*</span> <span class="n">manger</span> <span class="o">=</span> <span class="k">reinterpret_cast</span><span class="o">&lt;</span> <span class="n">SamplerDescriptorManger</span><span class="o">*</span> <span class="o">&gt;</span><span class="p">(</span> <span class="n">pUserData</span> <span class="p">);</span>

&nbsp;&nbsp;&nbsp;&nbsp;<span class="c1">// 空いているディスクリプタインデックスを確保する
</span>　&nbsp;&nbsp;<span class="kt">int</span> <span class="n">emptySamplerSlot</span> <span class="o">=</span> <span class="n">manger</span><span class="o">-&gt;</span><span class="n">GetEmptySamplerDescriptorSlot</span><span class="p">();</span>

&nbsp;&nbsp;&nbsp;&nbsp;<span class="nn">nn::gfx::</span><span class="n">DescriptorPool</span> <span class="n">samplerDescriptorPool</span><span class="p">;</span>

&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">samplerDescriptorPool</span><span class="p">.</span><span class="n">BeginUpdate</span><span class="p">();</span>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">{</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">g_samplerDescriptorPool</span><span class="p">.</span><span class="n">SetSampler</span><span class="p">(</span> <span class="n">emptySamplerSlot</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">sampler</span> <span class="p">);</span>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">samplerDescriptorPool</span><span class="p">.</span><span class="n">EndUpdate</span><span class="p">();</span>

&nbsp;&nbsp;&nbsp;&nbsp;<span class="c1">// ディスクリプタインデックスからディスクリプタスロットを取得する
</span>&nbsp;&nbsp;&nbsp; <span class="n">samplerDescriptorPool</span><span class="p">.</span><span class="n">GetDescriptorSlot</span><span class="p">(</span> <span class="n">dstSlot</span><span class="p">,</span> <span class="n">emptySamplerSlot</span> <span class="p">);</span>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// テクスチャ、サンプラ をコールバック経由でディスクリプタプールに登録する
</span>
<span class="c1">// nn::font の例
</span><span class="nn">nn::font::ResFontBase::</span><span class="n">RegisterTextureViewToDescriptorPool</span><span class="p">(</span> <span class="n">AllocateSlotForTexture</span><span class="p">,</span> <span class="n">textureDescriptorManger</span> <span class="p">);</span>
<span class="nn">nn::font::RectDrawer::</span><span class="n">RegisterSamplerToDescriptorPool</span><span class="p">(</span> <span class="n">AllocateSlotForSampler</span><span class="p">,</span> <span class="n">samplerDescriptorManger</span> <span class="p">);</span>

<span class="c1">// nn::vfx の例
</span><span class="nn">nn::vfx::System::</span><span class="n">RegisterTextureViewToDescriptorPool</span><span class="p">(</span> <span class="n">AllocateSlotForTexture</span><span class="p">,</span> <span class="n">textureDescriptorManger</span> <span class="p">);</span>
<span class="nn">nn::vfx::System::</span><span class="n">RegisterSamplerToDescriptorPool</span><span class="p">(</span> <span class="n">AllocateSlotForSampler</span><span class="p">,</span> <span class="n">samplerDescriptorManger</span> <span class="p">);</span>
<span class="nn">nn::vfx::Resource::</span><span class="n">RegisterTextureViewToDescriptorPool</span><span class="p">(</span> <span class="n">AllocateSlotForSampler</span><span class="p">,</span> <span class="n">samplerDescriptorManger</span> <span class="p">);</span></pre></div>
      </td>
    </tr>
  </tbody>
</table>
<p>&nbsp;</p>
<h3 id="Anchor_94757084_h3_4">テクスチャ リソース について</h3>
<p>g3d /&nbsp; vfx モジュールで利用するテクスチャファイルは、gfx テクスチャリソースを利用します。 gfxテクスチャリソースは、NW4Fテクスチャ形式と互換性があり、これまでに作成したテクスチャリソースはそのままご利用いただけます。ただし、vfxモジュールでは、NitendoSDK 0.6.0 まではタイリングテクスチャを利用可能でしたが、NitendoSDK 0.7.0 以降でWindowsプラットフォームで利用する場合、リニアテクスチャにコンバートする必要があります。<br />ui2d ではこれまで通り、TGAテクスチャを利用可能です。</p>
<p>&nbsp;</p>
<h3 id="Anchor_94757084_h3_5">nn::gfx ライブラリを利用した実装について</h3>
<p>現状、NitendoWare グラフィックス各モジュールの <span class="ApiLink_nn__gfx">nn::gfx</span> ライブラリ内機能 の対応状況は以下の通りです。</p>
<p>これらの対応状況は、今後サポートするプラットフォームに対して最適に動作するよう順次対応を行っていく予定です。</p>
<table class="table">
  <tbody>
    <tr>
      <th>機能</th>
      <th>利用状況</th>
    </tr>
    <tr>
      <td>メモリプール</td>
      <td>利用する</td>
    </tr>
    <tr>
      <td>テクスチャ ディスクリプタプール</td>
      <td>利用する</td>
    </tr>
    <tr>
      <td>サンプラ ディスクリプタプール</td>
      <td>利用する</td>
    </tr>
    <tr>
      <td>コンスタントバッファ ディスクリプタプール</td>
      <td>利用しない</td>
    </tr>
    <tr>
      <td>パイプラインモード</td>
      <td>利用しない</td>
    </tr>
    <tr>
      <td>ルートシグネチャモード</td>
      <td>利用しない</td>
    </tr>
  </tbody>
</table>
<p>&nbsp;</p>
<h2 id="Anchor_94757084_h2_4">ツールについて</h2>
<p>新NintendoWare グラフィックスでも旧来と同じく、3D Editor / Layout Editor / EffectMaker を利用してグラフィックスデータの作成、編集を行います。</p>
<h3 id="Anchor_94757084_h3_6">3D Editor</h3>
<p>基本的な使い方は、従来版と変わりません。</p>
<p>ただ、細かな部分で、プラットフォームによって、動作を切り替えるようになっています。</p>
<h3 id="Anchor_94757084_h3_7">LayoutEditor</h3>
<p>基本的な使い方は、従来版と変わりません。<br />ただ、細かな部分で、プラットフォームによって、動作を切り替えるようになっています。</p>
<h3 id="Anchor_94757084_h3_8">EffectMaker</h3>
<p>EffectMaker 上部の　プラットフォームコンボボックスから作成・編集するプラットフォームを選択できます。</p>
<table class="table">
  <tbody>
    <tr>
      <th>プラットフォーム名</th>
      <th>&nbsp;</th>
    </tr>
    <tr>
      <td>Windows</td>
      <td>
        <span class="ApiLink_nn__vfx">nn::vfx</span> 向けエフェクトデータの作成・編集を行う際に選択します。</td>
    </tr>
    <tr>
      <td>WindowsNw4f</td>
      <td>nw::eft2 向けエフェクトデータの 作成・編集を行う際に選択します。</td>
    </tr>
  </tbody>
</table>
<p>&nbsp;</p>
<h2 id="Anchor_94757084_h2_5">ビューアについて</h2>
<p>NintendoWare が提供している LayoutViewer や EffectViewer も <span class="ApiLink_nn__ui2d">nn::ui2d</span> ランタイム や <span class="ApiLink_nn__vfx">nn::vfx</span> ランタイム を利用した実装に置き換わりました。それに伴い、NintendoSDK 0.7.0 ではリリースされるビューアの実行ファイルが NintendoSDK 0.6.0 とは異なっています。</p>
<table class="table">
  <tbody>
    <tr>
      <th>実行ファイル名</th>
      <th>説明</th>
    </tr>
    <tr>
      <td>
        <strong>\Tools\Graphics\EffectViewer\Win32\EffectViewer.exe</strong>
      </td>
      <td>
        <span class="ApiLink_nn__vfx">nn::vfx</span> を利用して実装されたエフェクトメーカと通信してエフェクトデータを再生する32ビットビルド版ビューアです。</td>
    </tr>
    <tr>
      <td>
        <p>\Tools\Graphics\EffectViewer\Nw4f\EffectViewer.exe</p>
      </td>
      <td>nw::eft2 を利用して実装されたビューアです。</td>
    </tr>
    <tr>
      <td>
        <strong>Tools\Graphics\LayoutViewer\Win32\lytviewerGfx.exe</strong>
      </td>
      <td>nn::ui2d を利用して実装されたレイアウトエディタと通信してレイアウトデータを再生する32ビットビルド版ビューアです。</td>
    </tr>
    <tr>
      <td>Tools\Graphics\LayoutViewer-Nw4f\Win32\lytviewerGfx.exe</td>
      <td>nw::lyt を利用して実装されたビューアです。</td>
    </tr>
  </tbody>
</table>
<p>&nbsp;</p>
<p>また、NintendoSDK 0.7.0 では、エディタ と ビューア を連携させるために、TargetManagerを起動する必要があります。詳しくは、<a href="../Pages/Page_94763641.html">NintendoWare ニュース</a> を参照ください。</p>
<h2 id="Anchor_94757084_h2_6">API、メソッド名変更について</h2>
<p>NintendoSDK としての一貫性を高めるために、各種API 、メソッド名の変更も行いました。</p>
<p>&nbsp;</p>
<h2 id="Anchor_94757084_h2_7">各モジュールの変更点</h2>
<p>新NintendoWare グラフィックス 各モジュール固有の変更点をお知らせします。</p>
<h3 id="Anchor_94757084_h3_9">nn::g3d の変更点</h3>
<h4 id="Anchor_94757084_h4_1">レンダーステートについて</h4>
<p>nw::g3dではResRenderInfoクラスとResRenderStateクラスという似た機能を提供するクラスが存在していたため、クラスを整理し、ResRenderStateクラスを削除、ResRenderInfoクラスにその役割を引き継ぎました。この変更により、nw::g3dで使用していたモデルを<span class="ApiLink_nn__g3d">nn::g3d</span>向けにコンバートし直した場合、3dEditorで設定したレンダーステートの情報はそのままではモデルデータに含まれていません。レンダーステートとして必要な情報は、シェーダに描画情報のアノテーション(renderinfo)を記述し、3dEditorで適切に設定し、ResRenderInfoクラス経由で取得する必要があります。</p>
<p>過去の中間ファイルについて &lt;render_state&gt; を&nbsp;&lt;render_info&gt; に変換するには&nbsp;<a href="../Pages/Page_83955970.html">中間ファイルフィルター</a>&nbsp;を利用してください。</p>
<h4 id="Anchor_94757084_h4_2">アニメーションについて</h4>
<p>各アニメーションとランタイムにおいてそのアニメーションを扱うクラスの対応に変更が入りました。以下に対応を示します。</p>
<table class="table">
  <tbody>
    <tr>
      <th>アニメーション</th>
      <th>クラス</th>
    </tr>
    <tr>
      <td>スケルタルアニメーション</td>
      <td>
        <p>ResSkeletalAnim</p>
        <p>SkeletalAnimObj</p>
      </td>
    </tr>
    <tr>
      <td>シェイプアニメーション</td>
      <td>
        <p>ResShapeAnim</p>
        <p>ShapeAnimObj</p>
      </td>
    </tr>
    <tr>
      <td>
        <p>シェーダパラメータアニメーション</p>
        <p>カラーアニメーション</p>
        <p>テクスチャSRTアニメーション</p>
        <p>テクスチャパターンアニメーション</p>
        <p>マテリアルビジビリティアニメーション</p>
      </td>
      <td>
        <p>ResMaterialAnim</p>
        <p>MaterialAnimObj</p>
      </td>
    </tr>
    <tr>
      <td>ボーンビジビリティアニメーション</td>
      <td>
        <p>ResBoneVisibilityAnim</p>
        <p>BoneVisibilityAnimObj</p>
      </td>
    </tr>
    <tr>
      <td>シーンアニメーション</td>
      <td>
        <p>ResSceneAnim</p>
        <p>SceneAnimObj</p>
      </td>
    </tr>
  </tbody>
</table>
<p>この変更により、nw::g3dではシェーダパラメータアニメーション、カラーアニメーション、テクスチャSRTアニメーション、テクスチャパターンアニメーション、マテリアルビジビリティアニメーションにおいて同名のアニメーション名(=ファイル名)が許されていましたが、これが許されなくなります。nw::g3dで使用していたアニメーションデータを<span class="ApiLink_nn__g3d">nn::g3d</span>向けにコンバートし直す場合は、この点に注意して頂き、必要であればアニメーションのファイル名を変更して頂く必要があります。&nbsp;</p>
<h4 id="Anchor_94757084_h4_3">テクスチャについて</h4>
<p>モデルデータにテクスチャデータが含まれないようになりました。テクスチャデータはモデルデータとは別リソースとして扱い、BindTexture関数によりモデルと関連付ける必要があります。テクスチャデータの作成には 3D テクスチャーコンバーターを使用することが出来ます。</p>
<h4 id="Anchor_94757084_h4_4">エフェクトバイナリの出力オプションについて</h4>
<p>エフェクトメーカから nw::eft2 向け と&nbsp; <span class="ApiLink_nn__vfx">nn::vfx</span> 向けにバイナリ出力する際のコマンドラインオプションの指定方法に変更があります。<br />詳しくは、 <a href="../Pages/Page_83955581.html">バイナリコンバータ</a>　を参照ください。</p>
<p>&nbsp;</p>
<h3 id="Anchor_94757084_h3_10">nn::vfx の変更点</h3>
<p>nw::eft2 から <span class="ApiLink_nn__vfx">nn::vfx</span> への固有の変更点をお知らせします。<br /><a href="../Pages/Page_83955666.html">VFXランタイムを組み込む　~eftrd~</a>　も <span class="ApiLink_nn__vfx">nn::vfx</span> ベースに書き換えを行っていますので、そちらも参照ください。</p>
<h4 id="Anchor_94757084_h4_5">テクスチャリソースについて</h4>
<p>vfxモジュール向けに NW4Fテクスチャ形式を利用する場合、タイリングテクスチャ を リニアテクスチャ にコンバートする必要があります。</p>
<table class="codeblock">
  <tbody>
    <tr>
      <td class="gutter">1<br />
2</td>
      <td class="code">
        <div class="codeblock"><pre><span class="c1">// タイリングテクスチャ を リニアテクスチャ にコンバートする
</span><span class="n">NintendoSDK</span><span class="err">\</span><span class="n">Tools</span><span class="err">\</span><span class="n">Graphics</span><span class="err">\</span><span class="mi">3</span><span class="n">dTools</span><span class="err">\</span><span class="mi">3</span><span class="n">dTextureConverter</span><span class="p">.</span><span class="n">exe</span> <span class="n">texture_tiling</span><span class="p">.</span><span class="n">ftxb</span> <span class="o">-</span><span class="n">o</span> <span class="n">texture_linear</span><span class="p">.</span><span class="n">ftxb</span> <span class="o">--</span><span class="n">tile</span><span class="o">-</span><span class="n">mode</span> <span class="n">linear</span></pre></div>
      </td>
    </tr>
  </tbody>
</table>
<p>&nbsp;</p>
<h3 id="Anchor_94757084_h3_11">nn::ui2d、nn::font の変更点</h3>
<h4 id="Anchor_94757084_h4_6">
  <span class="with-breadcrumbs">リソース</span>
</h4>
<h5 id="Anchor_94757084_h5_1">
  <span class="with-breadcrumbs">フォント</span>
</h5>
<p>
  <span class="with-breadcrumbs">フォントのフォーマットが変わりましたので、フォントバイナリを作り直す必要があります。<br /></span>
</p>
<h4 id="Anchor_94757084_h4_7">
  <span class="with-breadcrumbs">ランタイムライブラリ</span>
</h4>
<h5 id="Anchor_94757084_h5_2">
  <span class="with-breadcrumbs">初期化</span>
</h5>
<p>
  <span class="with-breadcrumbs">シェーダリソースをランタイム内部に埋め込んだため、外部からロードして渡す処理が不要となりました。</span>
</p>
<p>
  <span class="with-breadcrumbs">サンプラーをアプリ側で用意してランタイムに渡す処理が必要となります。 詳しくは Ui2dSimple サンプルデモを参照してください。</span>
</p>
<h5 id="Anchor_94757084_h5_3">
  <span class="with-breadcrumbs">その他<br /></span>
</h5>
<p>
  <span class="with-breadcrumbs">アルファテストの機能が非対応になります。 将来的に対応するかどうかは未定です。</span>
</p>
<p>
  <span class="with-breadcrumbs">スケーラブルフォントファイルを使用する前に <span class="ApiLink_nn__fontll__ScalableFontEngineHelper__Decode">nn::fontll::ScalableFontEngineHelper::Decode</span> を呼び出す処理が必要になっています。</span>
</p>
<h4 id="Anchor_94757084_h4_8">
  <span class="with-breadcrumbs">コンバーター</span>
</h4>
<h5 id="Anchor_94757084_h5_4">LayoutConverter</h5>
<p>
  <span class="ApiLink_nn__ui2d">nn::ui2d</span> 向け（新フォーマット）と、 nw::lyt 向け（旧フォーマット）にバイナリを出力するすることができます。<br />下記のオプションの値を指定して下さい。</p>
<table class="table">
  <thead>
    <tr>
      <th>
        <div class="tablesorter-header-inner">コマンドラインオプション</div>
      </th>
      <th>
        <div class="tablesorter-header-inner">説明</div>
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>-p [platform]</td>
      <td>
        <ul>
          <li>
            <strong>
              <span class="ApiLink_nn__ui2d">nn::ui2d</span> </strong>向け には<strong>、win32ui2d</strong>　を指定します。</li>
          <li>&nbsp;<strong>nw::lyt</strong> 向けには <strong>win32</strong> を指定します。</li>
          <li>何も指定しないと、nw::lyt 向けに出力します。</li>
          <li>例： -p=win32ui2d</li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<h4 id="Anchor_94757084_h4_9">
  <span class="with-breadcrumbs">FontConvereterConsole</span>
</h4>
<p>
  <span class="ApiLink_nn__font">nn::font</span> 向け(新フォーマット)と、 nw::font 向け（旧フォーマット）にバイナリを出力するすることができます。<br />下記のオプションの値を指定して下さい。（GUI版 FontConverter は、<span class="ApiLink_nn__font">nn::font</span> 向けバイナリを出力します）</p>
<table class="table">
  <thead>
    <tr>
      <th>
        <div class="tablesorter-header-inner">コマンドラインオプション</div>
      </th>
      <th>
        <div class="tablesorter-header-inner">説明</div>
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        <p>-nobntx</p>
      </td>
      <td>
        <ul>
          <li>指定すると <strong>nw::font</strong> 向けにバイナリ を指定します。</li>
          <li>何も指定しないと、<strong><span class="ApiLink_nn__font">nn::font</span></strong> 向けに出力します。</li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<h4 id="Anchor_94757084_h4_10">
  <span class="with-breadcrumbs">ツール</span>
</h4>
<h5 id="Anchor_94757084_h5_5">
  <span class="with-breadcrumbs">LayoutEditor</span>
</h5>
<p>
  <span class="with-breadcrumbs">コマンドラインオプションの記述方法が変更になりました。</span>
</p>
<p>（入力ファイルパスの記述方法は変更ありません。）</p>
<div>
  <div class="syntaxhighlighter nogutter plain">
    <p>&nbsp;</p>
    <table class="table">
      <tbody>
        <tr>
          <td>
            <div class="container" title="Hint: double-click to select code">
              <div class="line number1 index0 alt2">
                <code class="plain plain">LayoutEditor.exe ...入力ファイルパス... [option]</code>
              </div>
            </div>
          </td>
        </tr>
      </tbody>
    </table>
    <p>
      <strong>オプション一覧</strong>
    </p>
  </div>
</div>
<table class="table">
  <thead>
    <tr>
      <th>
        <div class="tablesorter-header-inner">元のオプション</div>
      </th>
      <th>
        <div class="tablesorter-header-inner">新しいオプション</div>
      </th>
      <th>
        <div class="tablesorter-header-inner">処理内容</div>
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>-scf</td>
      <td>--current-frame</td>
      <td>カレントフレームの指定</td>
    </tr>
    <tr>
      <td>-ssc</td>
      <td>--save-screen-capture</td>
      <td>キャプチャを保存</td>
    </tr>
    <tr>
      <td>-scs</td>
      <td>--capture-size</td>
      <td>キャプチャサイズの指定</td>
    </tr>
    <tr>
      <td>&nbsp;</td>
      <td>--capture-file-path</td>
      <td>キャプチャファイルパスの指定</td>
    </tr>
    <tr>
      <td>-exp</td>
      <td>-o, --output</td>
      <td>中間ファイルの出力ファイルパスを指定</td>
    </tr>
    <tr>
      <td>-cil</td>
      <td>--close-if-loaded</td>
      <td>読み込み済みファイルを閉じる</td>
    </tr>
    <tr>
      <td>-spr</td>
      <td>--parts-root-path</td>
      <td>部品ルートパスの指定</td>
    </tr>
  </tbody>
</table>
<p>--sscは、キャプチャの保存フラグを立てるオプション (--save-screen-capture) とファイルパスを指定するオプション (--capture-file-path) に分かれました。</p>
<h4 id="Anchor_94757084_h4_11">
  <span class="with-breadcrumbs">サンプルデモ</span>
</h4>
<p>
  <span class="with-breadcrumbs">Ui2dSimple、Ui2dUserShader、FontSimple、FontWordWrapping、ScalableFontSimple のサンプルデモを追加しました。</span>
</p>
<p>&nbsp;</p>
</div>
<div class="breadcrumb_bottom"></div>
<div class="page_navigation">
<table class="page_navi_root">
<tr>
<td class="page_navi_left"></td>
<td class="page_navi_right"></td>
</tr>
<tr><td colspan="2" class="page_navi_bottom"></td></tr>
</table>
</div>
</div>
</div>
<!--AddLink-->
<script>
var NintendoSdkApiRefernce = {
    idMap: {},
    linkRewrite: function ()
    {
        var idMap = NintendoSdkApiRefernce.idMap;
        function rewrite(el)
        {
            var e = idMap[el.className];
            if (e === undefined)
            {
                return;
            }
            var html = '';
            html += '<a href=';
            html += e.url;
            html += ' target="_blank">';
            html += el.innerHTML;
            html += '</a>';
            el.innerHTML = html;
        }
        var apiLinkElems = document.querySelectorAll('span[class*="ApiLink_"]');
        for (var i = 0, n = apiLinkElems.length; i< n; ++i) {
            rewrite(apiLinkElems[i]);
        }
    }
};
function SetUrl( id, url )
{
    NintendoSdkApiRefernce.idMap[id] = { url: url };
}
SetUrl( 'ApiLink_nn__g3d', '../../../Api/HtmlNX/namespacenn_1_1g3d.html' )
SetUrl( 'ApiLink_nn__ui2d', '../../../Api/HtmlNX/namespacenn_1_1ui2d.html' )
SetUrl( 'ApiLink_nn__font', '../../../Api/HtmlNX/namespacenn_1_1font.html' )
SetUrl( 'ApiLink_nn__vfx', '../../../Api/HtmlNX/namespacenn_1_1vfx.html' )
SetUrl( 'ApiLink_nn__gfx', '../../../Api/HtmlNX/namespacenn_1_1gfx.html' )
SetUrl( 'ApiLink_nn__gfx__Device', '../../../Api/HtmlNX/classnn_1_1gfx_1_1_t_device.html' )
// ApiLink_nn__gfx__Command
SetUrl( 'ApiLink_nn__fontll__ScalableFontEngineHelper__Decode', '../../../Api/HtmlNX/classnn_1_1fontll_1_1_scalable_font_engine_helper.html#aec10ff3677f0074f9ef25f25396f1f89' )

NintendoSdkApiRefernce.linkRewrite();
</script>
<!--AddLink-->
</body>
</html>
