<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<script type="text/javascript" src="../template/js/jquery/jquery.js"></script>
<script type="text/javascript" src="../template/js/common/manualLib.js"></script>
<script type="text/javascript" src="../tocData.js"></script>
<link rel="stylesheet" type="text/css" href="../template/css/template.css" />
<title>テクスチャ</title>
</head>
<body data-reassemble="autoindex=no,forceNoLabel=yes">
<div id="autoindex_content">
<div class="body_content">
<noscript>
<div style="border: 4px double black; margin: 4px; padding: 2px; font-weight: bold; background-color: #FFFFCC;">
<p>お使いのブラウザは JavaScript が使用できないため、本ドキュメントの一部機能が無効になっています。</p><p>JavaScript が無効の環境では目次を使用することができません。<br />JavaScriptの実行が許可された状態で閲覧してください。<br /><br /></p>
</div>
</noscript>
<div class="page_navigation_top">
<table class="page_navi_root">
<tr>
<td class="page_navi_left"></td>
<td class="page_navi_right"></td>
</tr>
</table>
</div>
<div class="breadcrumb"></div>

<!-- テクスチャ -->
<div class="pagetitle" id="PageId_83956235">テクスチャ</div>
<div class="text_separate">
<h1 id="Anchor_83956235_h1_1">テクスチャ</h1>
<p>テクスチャを使用する際の下記項目について注意事項を説明します。</p>
<p>
  <ul class="macro_toc">
    <li>
      <a href="#Anchor_83956235_h2_1">テクスチャ名</a>
    </li>
    <li>
      <a href="#Anchor_83956235_h2_2">テクスチャの参照</a>
    </li>
    <li>
      <a href="#Anchor_83956235_h2_3">対応しているマップ</a>
    </li>
    <li>
      <a href="#Anchor_83956235_h2_4">テクスチャの重複</a>
    </li>
    <li>
      <a href="#Anchor_83956235_h2_5">マルチテクスチャ</a>
    </li>
    <li>
      <a href="#Anchor_83956235_h2_6">テクスチャファイルとフォーマット</a>
    </li>
    <li>
      <a href="#Anchor_83956235_h2_7">有効なアトリビュート</a>
    </li>
    <li>
      <a href="#Anchor_83956235_h2_8">マルチ UV</a>
    </li>
    <li>
      <a href="#Anchor_83956235_h2_9">法線マッピング</a>
    </li>
    <li>
      <a href="#Anchor_83956235_h2_10">関連リンク</a>
    </li>
  </ul>
</p>
<h2 id="Anchor_83956235_h2_1">テクスチャ名</h2>
<p>テクスチャのファイル名から拡張子を除いたものがテクスチャ名として出力されます。</p>
<h2 id="Anchor_83956235_h2_2">テクスチャの参照</h2>
<p>3ds Max 上でテクスチャを参照する際、絶対パス / 相対パス / ファイル名などで指定します。</p>
<p>エクスポートプラグインはテクスチャを参照する際、以下の優先順序に従ってテクスチャ情報を取得します。</p>
<div class="info_new">
  <div class="info_new_left">参考：</div>
  <div class="info_new_right">
    <p>※参照先候補となるフォルダに同名テクスチャがそれぞれ存在する場合、3ds Max のビューに表示されるテクスチャとエクスポートするテクスチャが一致しない場合があります。</p>
  </div>
</div>
<h3 id="Anchor_83956235_h3_1">エクスポートプラグインがテクスチャを参照するフォルダの優先順序</h3>
<ol>
  <li>絶対パスを参照します。</li>
  <li>プロジェクトフォルダの直下、もしくはプロジェクトフォルダを基準に相対パスで参照します。</li>
  <li>max ファイルと同じフォルダ内、もしくはそのフォルダを基準に相対パスで参照します。</li>
  <li>メニューの「カスタマイズ」-「ユーザ パスを設定」で開いたダイアログの「外部ファイル」で指定されたフォルダを参照します。</li>
</ol>
<h4 id="Anchor_83956235_h4_1">以下は参照するテクスチャ名が test.tga と仮定した時の具体例です。</h4>
<p>
  <strong>テクスチャが絶対パスで指定されている場合（例：　&quot;c:\data\texture\test.tga&quot;）</strong>
</p>
<ol>
  <li>絶対パスで指定された test.tga を参照します。</li>
  <li>上記フォルダにも test.tga が存在しなければ、プロジェクトフォルダ直下の test.tga を参照します。</li>
  <li>上記フォルダに test.tga が存在しなければ、max ファイルと同じフォルダ内の test.tga を参照します。</li>
  <li>上記フォルダに test.tga が存在しなければ、「ユーザ パスを設定」で指定されたフォルダを参照します。</li>
  <li>上記フォルダにも test.tga が存在しなければ、エラーとして処理します。</li>
</ol>
<p>
  <strong>テクスチャが相対パスで指定されている場合（例：　&quot;.\sceneassets\images\rgb.tga&quot;）</strong>
</p>
<ol>
  <li>プロジェクトフォルダを基準に相対パスで指定されたフォルダ内の test.tga を参照します。</li>
  <li>上記フォルダに test.tga が存在しなければ、maxファイルと同じフォルダを基準に相対パスで指定されたフォルダ内の test.tga を参照します。</li>
  <li>上記フォルダに test.tga が存在しなければ、maxファイルと同じフォルダ内の test.tga を参照します。</li>
  <li>上記フォルダに test.tga が存在しなければ、「ユーザ パスを設定」で指定されたフォルダを参照します。</li>
  <li>上記フォルダにも test.tga が存在しなければ、エラーとして処理します。</li>
</ol>
<p>
  <strong>テクスチャのパスが排除され、ファイル名で指定されている場合（例：　&quot;test.tga&quot;）</strong>
</p>
<ol>
  <li>プロジェクトフォルダ直下の test.tga を参照します。</li>
  <li>上記フォルダに test.tga が存在しなければ、max ファイルと同じフォルダ内の test.tga を参照します。</li>
  <li>上記フォルダに test.tga が存在しなければ、「ユーザ パスを設定」で指定されたフォルダを参照します。</li>
  <li>上記フォルダにも test.tga が存在しなければ、エラーとして処理します。</li>
</ol>
<h2 id="Anchor_83956235_h2_3">対応しているマップ</h2>
<p>マテリアルの全てのマップスロットに割り当てたマップが出力対象になります。</p>
<p>&quot;バンプ&quot;マップスロットは&quot;法線バンプ&quot;に対応しています。 <br />&quot;バンプ&quot;以外のマップスロットは&quot;ビットマップ&quot;もしくは&quot;合成&quot; に対応しています。 <br />それ以外のマップ（タイル、チェック、ノイズ等）には対応していません。</p>
<h2 id="Anchor_83956235_h2_4">テクスチャの重複</h2>
<p>マテリアル内で同じテクスチャが複数使われていた場合はそれぞれに出力されます。</p>
<p>ただし、不透明度に使用されたテクスチャと同じテクスチャが、他のマップスロットで使用されていた場合は出力されません。</p>
<h2 id="Anchor_83956235_h2_5">マルチテクスチャ</h2>
<p>&quot;合成&quot;マップを使用する場合、マルチテクスチャとして最大256枚まで設定できます。</p>
<p>中間ファイルには上のレイヤーから順に出力されます。</p>
<p>
  <a name="Anchor_83956235_tex_format"></a>
</p>
<h2 id="Anchor_83956235_h2_6">テクスチャファイルとフォーマット</h2>
<p>テクスチャファイルは TGA ファイルと DDS ファイルに対応しています。</p>
<p>DDS ファイルは、R8G8B8、A8R8G8B8、A16B16G16R16F、A32B32G32R32F フォーマットのみ対応しています。</p>
<p>テクスチャファイルのミップマップデータは反映されません。出力時に最上位レベルの画像を縮小してミップマップを作成します。</p>
<p>テクスチャ画像の幅と高さは 8192 以下にする必要があります。</p>
<p>テクスチャのフォーマットは次の規則で自動的に決定されます。このとき、テクスチャ画像のアルファ値（8 ビット）が 255 なら不透明、0 なら透明、1 ～ 254 なら半透明なテクセルとみなします。</p>
<ul>
  <li>すべてのテクセルで R = G = B の場合<ul><li>テクセルがすべて不透明 &rarr; unorm_bc4</li><li>透明または半透明なテクセルが存在 &rarr; unorm_bc5</li></ul></li>
  <li>R = G = B でないテクセルが存在する場合<ul><li>テクセルがすべて不透明 &rarr; unorm_bc1 または srgb_bc1</li><li>透明なテクセルが存在して半透明なテクセルが存在しない場合（抜きテクスチャ） &rarr; unorm_bc1 または srgb_bc1</li><li>半透明なテクセルが存在 &rarr; unorm_bc3 または srgb_bc3</li></ul></li>
</ul>
<div class="info_new">
  <div class="info_new_left">参考：</div>
  <div class="info_new_right">
    <p>法線マップ用テクスチャのフォーマットは常に snorm_bc5 となります。<br />テクスチャファイルが実数型の場合は常に float_16_16_16_16 となります。</p>
  </div>
</div>
<h2 id="Anchor_83956235_h2_7">有効なアトリビュート</h2>
<p>&quot;座標&quot;設定のうち、以下のパラメータについては、エクスポート時に中間ファイルに反映されます。</p>
<p>
  <span class="embedded-file-wrapper ">
    <img src="../Attachments/Attach_83956235/83080287.png" class="embedded-image" />
  </span>
</p>
<p>
  <strong>オフセットU,V</strong>、<strong>タイリングU,V</strong>、<strong>角度W</strong>の 設定は中間ファイル内のテクスチャ行列に反映することができます。<br /> &quot;UV, VW, WU&quot;は、&quot;UV&quot;を指定してください。&quot;VW, WU&quot;には対応していません。角度 U,V には対応していません。0.0を設定してください。</p>
<p>
  <strong>タイル</strong>の設定は中間ファイルに反映されます。</p>
<p>ブラ－、ブラ－オフセットには対応していません。</p>
<p>
  <a name="Anchor_83956235_multiple_uv"></a>
</p>
<h2 id="Anchor_83956235_h2_8">マルチ UV</h2>
<p>テクスチャが使用しているマップチャンネルと、「<strong>nw4f_uv</strong>」または「<strong>nw4f_fix</strong>」で始まる名前のマップチャンネルが、中間ファイルのテクスチャ座標として出力されます。 テクスチャ座標は 1 頂点あたり最大 8 セットまで出力できます。</p>
<p>中間ファイルの &lt;vtx_attrib&gt; には、マテリアルのマップスロットに割り当てられたテクスチャが使用しているマップチャンネルが、上から順に hint の uv0 から割り当てられます（複数のテクスチャが同じマップチャンネルを共有している場合は 1 つだけ出力されます）。<br /> ただし、「<strong>nw4f_fixN</strong>」をマップチャンネル名にすることで、 hint を明示的に設定することができます。</p>
<p>合成マップが使用されている場合、テクスチャが使用しているマップチャンネルが上からから順に割り当てられます。<br /> 使用されているマップチャンネルの後に、使用されていないマップチャンネルのうち「<strong>nw4f_uv</strong>」または「<strong>nw4f_fix_</strong>」で始まる名前のマップチャンネルがアルファベット順に割り当てられます。<br /> マップチャンネル名が「<strong>nw4f_fix_</strong>」で始まる場合、nw4f_fix_ の後の文字列が &lt;vtx_attrib&gt; の name に反映されます。</p>
<p>&lt;vtx_attrib&gt; は hint の昇順に出力されます。</p>
<p>たとえば、拡散反射光カラーで使用されているマップチャンネルが 1 、不透明度で使用されているマップチャンネルが 5 、使用されていないマップチャンネル 6 の名前が「nw4f_uv_a」、マップチャンネル 3 の名前が「nw4f_uv_b」が存在する場合、次のように割り当てられます。</p>
<table class="table">
  <tbody>
    <tr>
      <th colspan="3">3ds Max</th>
      <td rowspan="6">=&gt;</td>
      <th colspan="2">&lt;vtx_attrib&gt;</th>
    </tr>
    <tr>
      <th>マップチャンネル</th>
      <th>使用</th>
      <th>マップチャンネル名</th>
      <th>&nbsp;hint</th>
      <th>name</th>
    </tr>
    <tr>
      <td>1</td>
      <td>拡散反射光カラー</td>
      <td>&nbsp;</td>
      <td>uv0</td>
      <td>_u0</td>
    </tr>
    <tr>
      <td>3</td>
      <td>Ｘ</td>
      <td>nw4f_uv_b</td>
      <td>uv3</td>
      <td>_u3</td>
    </tr>
    <tr>
      <td>5</td>
      <td>不透明度</td>
      <td>&nbsp;</td>
      <td>uv1</td>
      <td>_u1</td>
    </tr>
    <tr>
      <td>6</td>
      <td>Ｘ</td>
      <td class="highlight-grey">nw4f_uv_a</td>
      <td>uv2</td>
      <td>_u2</td>
    </tr>
  </tbody>
</table>
<p>「<strong>nw4f_fixN</strong>（N は 0 以上 254 以下の整数）」で始まる名前の マップチャンネルを使用すると、&lt;vtx_attrib&gt; の hint の割り当てを直接指定できます。<br /> たとえばマップチャンネル名が「nw4f_fix3」なら hint は uv3 で出力されます。<br /> 「nw4f_fixN」で始まる名前のマップチャンネルを使用する場合、テクスチャが使用するマップチャンネル名はすべてのオブジェクトで共通にしてください。<br /> 「nw4f_fixN」で始まらない名前のマップチャンネルは、空いている hint に前から順番に割り当てられます。<br /> マップチャンネル名が「<strong>nw4f_fixN_</strong>」で始まる場合、nw4f_fixN_ の後の文字列が &lt;vtx_attrib&gt; の name に反映されます。</p>
<p>たとえば、拡散反射光カラーで使用されているマップチャンネルが 1 、使用されていないマップチャンネル 2 の名前が「nw4f_fix_decal」、マップチャンネル 3 の名前が「nw4f_fix0」、マップチャンネル 4 の名前が「nw4f_fix7_bake」が存在する場合、次のように割り当てられます。</p>
<table class="table">
  <tbody>
    <tr>
      <th colspan="3">3ds Max</th>
      <td rowspan="6">=&gt;</td>
      <th colspan="2">&lt;vtx_attrib&gt;</th>
    </tr>
    <tr>
      <th>マップチャンネル</th>
      <th>使用</th>
      <th>マップチャンネル名</th>
      <th>&nbsp;hint</th>
      <th>name</th>
    </tr>
    <tr>
      <td>1</td>
      <td>拡散反射光カラー</td>
      <td>&nbsp;</td>
      <td>uv1</td>
      <td>_u1</td>
    </tr>
    <tr>
      <td>2</td>
      <td>Ｘ</td>
      <td>nw4f_fix_decal</td>
      <td>uv2</td>
      <td>decal</td>
    </tr>
    <tr>
      <td>3</td>
      <td>Ｘ</td>
      <td>nw4f_fix0</td>
      <td>uv0</td>
      <td>_u0</td>
    </tr>
    <tr>
      <td>4</td>
      <td>Ｘ</td>
      <td>nw4f_fix7_bake</td>
      <td>uv7</td>
      <td>bake</td>
    </tr>
  </tbody>
</table>
<div class="info_new">
  <div class="info_new_left">参考：</div>
  <div class="info_new_right">
    <p>&lt;vtx_attrib&gt; の hint は以下の様な順番で設定されます。</p>
    <ul>
      <li>「<strong>nw4f_fixN</strong>」で始まる名前のマップチャンネル（hint は N 固定で設定）</li>
      <li>テクスチャが使用しているマップチャンネル（ここまでで使用されていない最小の hint から設定）</li>
      <li>「<strong>nw4f_fix_</strong>」で始まる名前のマップチャンネル（ここまでで使用されていない最小の hint から設定）</li>
      <li>「<strong>nw4f_uv</strong>」で始まる名前のマップチャンネル（ここまでで使用されていない最小の hint から設定）</li>
    </ul>
  </div>
</div>
<h2 id="Anchor_83956235_h2_9">法線マッピング</h2>
<p>3ds Max 上で NintendoWare 用の法線マッピングを設定する手順は、標準的な法線マッピングを設定する手順と同様です。</p>
<div class="info_new">
  <div class="info_new_left">参考：</div>
  <div class="info_new_right">
    <p>NintendoWare では接空間の法線マップ用テクスチャを使用します。</p>
  </div>
</div>
<p>法線マッピングを設定するには、マテリアルの <strong>バンプマップスロット</strong>に法線バンプを適用し法線マップ用テクスチャを指定します。</p>
<p>
  <span class="embedded-file-wrapper ">
    <img src="../Attachments/Attach_83956235/83080286.png" class="embedded-image" />
  </span>
</p>
<p>法線マッピングを設定すると、法線マップ用テクスチャのマップチャンネルに対応した接線と従法線を出力します。</p>
<h2 id="Anchor_83956235_h2_10">関連リンク</h2>
<p>
  <a href="../Pages/Page_83956248.html">モデリング</a>
</p>
</div>
<div class="breadcrumb_bottom"></div>
<div class="page_navigation">
<table class="page_navi_root">
<tr>
<td class="page_navi_left"></td>
<td class="page_navi_right"></td>
</tr>
<tr><td colspan="2" class="page_navi_bottom"></td></tr>
</table>
</div>
</div>
</div>
</body>
</html>
