<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<script type="text/javascript" src="../template/js/jquery/jquery.js"></script>
<script type="text/javascript" src="../template/js/common/manualLib.js"></script>
<script type="text/javascript" src="../tocData.js"></script>
<link rel="stylesheet" type="text/css" href="../template/css/template.css" />
<title>オーディオ出力</title>
</head>
<body data-reassemble="autoindex=no,forceNoLabel=yes">
<div id="autoindex_content">
<div class="body_content">
<noscript>
<div style="border: 4px double black; margin: 4px; padding: 2px; font-weight: bold; background-color: #FFFFCC;">
<p>お使いのブラウザは JavaScript が使用できないため、本ドキュメントの一部機能が無効になっています。</p><p>JavaScript が無効の環境では目次を使用することができません。<br />JavaScriptの実行が許可された状態で閲覧してください。<br /><br /></p>
</div>
</noscript>
<div class="page_navigation_top">
<table class="page_navi_root">
<tr>
<td class="page_navi_left"></td>
<td class="page_navi_right"></td>
</tr>
</table>
</div>
<div class="breadcrumb"></div>

<!-- オーディオ出力 -->
<div class="pagetitle" id="PageId_89991490">オーディオ出力</div>
<div class="text_separate">
<p>
  <ul class="macro_toc">
    <li>
      <a href="#Anchor_89991490_h1_1">オーディオ出力</a>
    </li>
    <ul>
      <li>
        <a href="#Anchor_89991490_h2_1">機能概要</a>
      </li>
      <ul>
        <li>
          <a href="#Anchor_89991490_h3_1">制御</a>
        </li>
        <li>
          <a href="#Anchor_89991490_h3_2">情報取得</a>
        </li>
        <li>
          <a href="#Anchor_89991490_h3_3">波形バッファ操作</a>
        </li>
        <ul>
          <li>
            <a href="#Anchor_89991490_h4_1">波形バッファの構成</a>
          </li>
          <ul>
            <li>
              <a href="#Anchor_89991490_h5_1">サンプルデータ中の各チャンネルデータの配置</a>
            </li>
            <li>
              <a href="#Anchor_89991490_h5_2">サンプル数の定義と取扱い</a>
            </li>
          </ul>
        </ul>
      </ul>
      <li>
        <a href="#Anchor_89991490_h2_2">使用例</a>
      </li>
      <li>
        <a href="#Anchor_89991490_h2_3">関数リファレンス</a>
      </li>
      <li>
        <a href="#Anchor_89991490_h2_4">注意点</a>
      </li>
      <ul>
        <li>
          <a href="#Anchor_89991490_h3_4">PC 開発環境と開発機環境の相違点について</a>
        </li>
      </ul>
    </ul>
  </ul>
</p>
<h1 id="Anchor_89991490_h1_1">オーディオ出力</h1>
<div class="info_new">
  <div class="info_new_left">参考：</div>
  <div class="info_new_right">
    <p>オーディオ出力の機能は、オーディオ信号の向きを除けば <a href="../Pages/Page_89991491.html">オーディオ入力</a> と同様のものとなっています。</p>
  </div>
</div>
<h2 id="Anchor_89991490_h2_1">機能概要</h2>
<p>オーディオ出力は、オーディオデータをデバイスから再生するための機能です。データの転送機能のみを提供するため、ボリュームのコントロールなどを行うことはできません。エフェクトやミキシングなどを含む、より複雑なオーディオ処理を行うには <a href="../Pages/Page_89991492.html">オーディオレンダラ</a> を利用する必要があります。</p>
<p>オーディオ出力は <a class="el" href="../../../Api/HtmlNX/structnn_1_1audio_1_1_audio_out.html">AudioOut</a> 構造体により管理されます。オーディオ出力に関する操作は、大きく分けて以下の 3 種類があります。</p>
<ul>
  <li>制御（初期化、再生開始、再生停止、終了）</li>
  <li>情報取得（サンプルレート、チャンネル数、etc.）</li>
  <li>波形バッファ操作</li>
</ul>
<h3 id="Anchor_89991490_h3_1">制御</h3>
<p>各オーディオ出力は名前を持ちます。システム上で利用可能なオーディオ出力の情報については&nbsp;<a class="el" href="../../../Api/HtmlNX/namespacenn_1_1audio.html#aa98ed1b90ede441c9ac1316247deea50">ListAudioOuts()</a> により取得可能です。</p>
<p>初期化は <a class="el" href="../../../Api/HtmlNX/namespacenn_1_1audio.html#ae9b3c4294b417adf1b15c31e69ab1017">OpenAudioOut()</a> または <a class="el" href="../../../Api/HtmlNX/namespacenn_1_1audio.html#acadf9d8fa3ac267bf09f6789a6bdbbb1">OpenDefaultAudioOut()</a> により行います。引数には名前（とサンプルレート）を指定します。再生を開始するには&nbsp;<a class="el" href="../../../Api/HtmlNX/namespacenn_1_1audio.html#a394c08e1517ef6e5be0c23e9d4c172c6">StartAudioOut()</a> を呼びます。再生停止、およびオーディオ出力の終了はそれぞれ <a class="el" href="../../../Api/HtmlNX/namespacenn_1_1audio.html#a79e886ce13f07e1411638e1410145fd2">StopAudioOut()</a>,&nbsp;<a class="el" href="../../../Api/HtmlNX/namespacenn_1_1audio.html#ab7e428eda5bf70d99245b5d4ddfc9a7d">CloseAudioOut()</a> により行います。</p>
<p>
  <span class="embedded-file-wrapper ">
    <img src="../Attachments/Attach_89991490/90147818.png" width="500" class="embedded-image" />
  </span>
</p>
<h3 id="Anchor_89991490_h3_2">情報取得</h3>
<p>以下の情報が取得可能です。</p>
<ul>
  <li>状態</li>
  <li>名前</li>
  <li>サンプルレート (Hz)</li>
  <li>チャンネル数</li>
  <li>サンプルフォーマット</li>
</ul>
<h3 id="Anchor_89991490_h3_3">波形バッファ操作</h3>
<p>再生するデータは <a class="el" href="../../../Api/HtmlNX/structnn_1_1audio_1_1_audio_out_buffer.html">AudioOutBuffer</a> 構造体（オーディオ出力バッファ）により管理します。データバッファやそのサイズを指定した後に&nbsp;<a class="el" href="../../../Api/HtmlNX/namespacenn_1_1audio.html#a3fe424df5fbd5ec6006dd36298f75f71">AppendAudioOutBuffer()</a> により <a class="el" href="../../../Api/HtmlNX/structnn_1_1audio_1_1_audio_out.html">AudioOut</a> 構造体に登録します。登録されたデータは、登録順に順次オーディオ出力より再生されます。データの再生の完了は&nbsp;<a class="el" href="../../../Api/HtmlNX/namespacenn_1_1audio.html#a609ca184b31d320c7c88079646551fa9">GetReleasedAudioOutBuffer()</a> により知ることができます。</p>
<h4 id="Anchor_89991490_h4_1">波形バッファの構成</h4>
<p>オーディオ出力バッファデータは、オーディオ出力の以下のパラメータに従った構成である必要があります。</p>
<ul>
  <li>サンプルレート (Hz)</li>
  <li>サンプルフォーマット</li>
  <li>チャンネル数 (ChannelCount)</li>
</ul>
<h5 id="Anchor_89991490_h5_1">サンプルデータ中の各チャンネルデータの配置</h5>
<p>例として、L, R 2 チャンネルの場合のオーディオ出力バッファの構成を以下に図示します。<br />オーディオ出力バッファに設定する「サイズ」は (<a class="el" href="../../../Api/HtmlNX/namespacenn_1_1audio.html#af2fbf2de8b43aabc18c8d4d688344334">GetSampleByteSize</a>(サンプルフォーマット) &times; ChannelCount) の倍数である必要があります。</p>
<p>
  <span class="embedded-file-wrapper ">
    <img src="../Attachments/Attach_89991490/186747817.png" class="embedded-image" />
  </span>
</p>
<p>&nbsp;</p>
<p>またオーディオ出力は 6 チャンネル出力もサポートしています。この場合のサンプルデータは <span class="ApiLink_nn__audio__ChannelMapping">nn::audio::ChannelMapping</span> で定義される順序でバッファに格納されている必要があります。FrontLeft(FL) / FrontRight(FR) / FrontCenter(FC) / LowFrequency(LFE) / RearLeft(FL) / RearRight(RR) それぞれのサンプルデータは、以下の配置で格納する必要があります。</p>
<p>
  <span class="embedded-file-wrapper ">
    <img src="../Attachments/Attach_89991490/186747844.png" class="embedded-image" />
  </span>
</p>
<h5 id="Anchor_89991490_h5_2">サンプル数の定義と取扱い</h5>
<p>サンプル数は各チャンネルごとに再生されるサンプルデータの個数として定義されます。</p>
<p>例えば上記 L, R 2 チャンネルの場合の出力バッファの構成図を例にとると、「L」「R」 のペアの個数がサンプル数となります。</p>
<p>
  <span class="embedded-file-wrapper ">
    <img src="../Attachments/Attach_89991490/186747820.png" class="embedded-image" />
  </span>
</p>
<p>オーディオ出力バッファに含まれる（チャンネル当たり）サンプル数は以下のように計算できます。</p>
<div style="border-width: 1px;" class="preformatted panel">
  <div class="preformattedContent panelContent">
    <pre>（オーディオ出力バッファの（チャンネルごとの）サンプル数）=（オーディオ出力バッファサイズ [bytes]）/（（チャンネル数）*（サンプルフォーマットから決まる 1 サンプルのデータサイズ））</pre>
  </div>
</div>
<p>「オーディオ出力バッファの（チャンネルごとの）サンプル数」と「サンプルレート」から、オーディオ出力バッファが取得可能となるタイミングの周期が以下のように計算できます。</p>
<div style="border-width: 1px;" class="preformatted panel">
  <div class="preformattedContent panelContent">
    <pre>（オーディオ出力バッファが取得可能となるタイミングの周期）=（オーディオ出力バッファの（チャンネルごとの）サンプル数）/（サンプルレート）</pre>
  </div>
</div>
<p>例えばサンプルレートが 48000 Hz で、オーディオ出力バッファが 480 サンプルである場合、周期は 480 / 48000 = 0.01（秒）= 10（ミリ秒）となります。</p>
<p>バッファが登録されていない、あるいは登録されたすべてのバッファの再生が完了すると、オーディオ出力は無音再生となります。オーディオ再生が途切れないようにするために、ライブラリ利用者は適切にオーディオ出力バッファの登録を行う必要があります。</p>
<h2 id="Anchor_89991490_h2_2">使用例</h2>
<p>
  <a class="external-link" href="../../../Api/HtmlNX/_page_sample_audio_audio_out.html" rel="nofollow">オーディオ再生のサンプル</a> を参照してください。</p>
<h2 id="Anchor_89991490_h2_3">関数リファレンス</h2>
<p>
  <a href="../../../Api/HtmlNX/namespacenn_1_1audio.html">nn::audio 名前空間</a> の「関数」内の「オーディオ出力」カテゴリを参照してください。</p>
<h2 id="Anchor_89991490_h2_4">注意点</h2>
<h3 id="Anchor_89991490_h3_4">PC 開発環境と開発機環境の相違点について</h3>
<p>PC 開発環境におけるオーディオの出力は Windows OS のサウンドドライバを利用しており、特にハードウェア割り込みのタイミングは環境に大きく依存します（<span style="color: rgb(51,51,51);">一般的には割り込みの間隔の揺らぎは開発機よりも大きくなります</span>）。このタイミングの違いにより、短いサンプル数の AudioOutBuffer を利用する場合に、環境によっては音途切れが発生する可能性があります。</p>
</div>
<div class="breadcrumb_bottom"></div>
<div class="page_navigation">
<table class="page_navi_root">
<tr>
<td class="page_navi_left"></td>
<td class="page_navi_right"></td>
</tr>
<tr><td colspan="2" class="page_navi_bottom"></td></tr>
</table>
</div>
</div>
</div>
<!--AddLink-->
<script>
var NintendoSdkApiRefernce = {
    idMap: {},
    linkRewrite: function ()
    {
        var idMap = NintendoSdkApiRefernce.idMap;
        function rewrite(el)
        {
            var e = idMap[el.className];
            if (e === undefined)
            {
                return;
            }
            var html = '';
            html += '<a href=';
            html += e.url;
            html += ' target="_blank">';
            html += el.innerHTML;
            html += '</a>';
            el.innerHTML = html;
        }
        var apiLinkElems = document.querySelectorAll('span[class*="ApiLink_"]');
        for (var i = 0, n = apiLinkElems.length; i< n; ++i) {
            rewrite(apiLinkElems[i]);
        }
    }
};
function SetUrl( id, url )
{
    NintendoSdkApiRefernce.idMap[id] = { url: url };
}
SetUrl( 'ApiLink_nn__audio__ChannelMapping', '../../../Api/HtmlNX/namespacenn_1_1audio.html#ae5febdb32531c0ab471ab02f6a0c2892' )

NintendoSdkApiRefernce.linkRewrite();
</script>
<!--AddLink-->
</body>
</html>
