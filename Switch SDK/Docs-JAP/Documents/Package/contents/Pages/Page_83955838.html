<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<script type="text/javascript" src="../template/js/jquery/jquery.js"></script>
<script type="text/javascript" src="../template/js/common/manualLib.js"></script>
<script type="text/javascript" src="../tocData.js"></script>
<link rel="stylesheet" type="text/css" href="../template/css/template.css" />
<title>テクスチャー</title>
</head>
<body data-reassemble="autoindex=no,forceNoLabel=yes">
<div id="autoindex_content">
<div class="body_content">
<noscript>
<div style="border: 4px double black; margin: 4px; padding: 2px; font-weight: bold; background-color: #FFFFCC;">
<p>お使いのブラウザは JavaScript が使用できないため、本ドキュメントの一部機能が無効になっています。</p><p>JavaScript が無効の環境では目次を使用することができません。<br />JavaScriptの実行が許可された状態で閲覧してください。<br /><br /></p>
</div>
</noscript>
<div class="page_navigation_top">
<table class="page_navi_root">
<tr>
<td class="page_navi_left"></td>
<td class="page_navi_right"></td>
</tr>
</table>
</div>
<div class="breadcrumb"></div>

<!-- テクスチャー -->
<div class="pagetitle" id="PageId_83955838">テクスチャー</div>
<div class="text_separate">
<p>テクスチャーを使用する際の下記項目について注意事項を説明します。</p>
<p>
  <ul class="macro_toc">
    <li>
      <a href="#Anchor_83955838_h1_1">テクスチャー名</a>
    </li>
    <li>
      <a href="#Anchor_83955838_h1_2">テクスチャーのノード</a>
    </li>
    <li>
      <a href="#Anchor_83955838_h1_3">テクスチャーファイルとフォーマット</a>
    </li>
    <li>
      <a href="#Anchor_83955838_h1_4">有効なアトリビュート</a>
    </li>
    <li>
      <a href="#Anchor_83955838_h1_5">マルチ UV</a>
    </li>
    <li>
      <a href="#Anchor_83955838_h1_6">法線マッピング</a>
    </li>
  </ul>
</p>
<p>
  <a name="Anchor_83955838_tex_name"></a>
</p>
<h1 id="Anchor_83955838_h1_1">テクスチャー名</h1>
<p>テクスチャーのファイル名から拡張子を除いたものがテクスチャー名として出力されます。</p>
<p>
  <a name="Anchor_83955838_tex_node"></a>
</p>
<h1 id="Anchor_83955838_h1_2">テクスチャーのノード</h1>
<p>下記のアトリビュートには、<strong>file ノード（シングルテクスチャー）</strong>または&nbsp;<strong>layeredTexture ノード（マルチテクスチャー）</strong>がテクスチャーとして使用できます。</p>
<ul>
  <li>マテリアルのカラー（Color）</li>
  <li>透明度（Transparency）</li>
  <li>白熱光（Incandescence）</li>
  <li>スペキュラカラー（Specular Color）</li>
</ul>
<div class="info_new">
  <div class="info_new_left">参考：</div>
  <div class="info_new_right">
    <p>カラーアトリビュートと透明度アトリビュートで同じテクスチャーファイルが使用されている場合、不透明度のサンプラーは出力しません。</p>
  </div>
</div>
<p>マテリアルの反射カラー（Reflected Color）アトリビュートには、<strong>file ノード</strong>、<strong>layeredTexture ノード</strong>、<strong>envBall ノード（環境ボール）</strong>、<strong>envCube ノード（環境立方体）</strong>がテクスチャーとして使用できます。</p>
<ul>
  <li>file ノード（envBall ノード）の場合、<a href="../Pages/Page_239574379.html#Anchor_239574379_horizontal_cross">水平十字または垂直十字キューブマップ</a>のファイルを指定できます（幅と高さがキューブマップでなければ 2D テクスチャーとして出力します）。</li>
  <li>envCube ノードの各面に file ノードが接続されている場合、<strong>前面</strong>に接続された file ノードのファイル名から拡張子を除いたものがテクスチャー名となります。</li>
  <li>envCube ノードの<strong>右面</strong>にのみ file ノードを接続して、その file ノードでキューブマップの DDS ファイルを使用することも可能です。</li>
</ul>
<div class="info_new">
  <div class="info_new_left">参考：</div>
  <div class="info_new_right">
    <p>layeredTexture ノードには file ノードまたは envCube ノードを接続してください。</p>
  </div>
</div>
<p>チェッカ（checker）、ランプ（ramp）などのプロシージャテクスチャーはそのままでは出力できないので、「ファイルテクスチャに変換（Convert to File Texture）」で file ノードに変換してから出力してください。<br />サブスタンスは、アトリビュートエディタの Export images to disk ボタンで file ノードに変換してから出力してください。</p>
<p>「レンダーノードの作成（Create Render Node）」ウィンドウのマッピングの手法は「通常（Normal）」にしてください（「投影（As projection）」や「ステンシル（As stencil）」には対応していません）。</p>
<div class="info_new">
  <div class="info_new_left">参考：</div>
  <div class="info_new_right">
    <p>PSD ファイルテクスチャー（psdFileTex ノード）は出力できません。</p>
  </div>
</div>
<p>中間ファイルの &lt;sampler_array&gt; には、次のアトリビュートに接続されたテクスチャーから順に出力されます。</p>
<ol>
  <li>カラー（Color）</li>
  <li>透明度（Transparency）</li>
  <li>白熱光（Incandescence）</li>
  <li>バンプマッピング（Bump Mapping）</li>
  <li>スペキュラカラー（Specular Color）</li>
  <li>反射カラー（Reflected Color）</li>
</ol>
<p>layeredTexture ノードが接続されている場合、上位（左側）のテクスチャーから順に出力されます。</p>
<p>中間ファイルのサンプラー（&lt;sampler&gt;）の名前とヒント情報は、デフォルトでは file ノードの接続先に応じて自動的に決定されます。<br /> サンプラーの名前とヒント情報を指定したい場合は、<a href="../Pages/Page_83956027.html">サンプラーアトリビュート設定プラグイン</a>を使用します。</p>
<p>envCube ノードを使用する場合、<strong>前面</strong>または<strong>右面</strong>に接続された file ノードに対してサンプラーのアトリビュートを設定します。<br /> <a href="../Pages/Page_83956027.html">サンプラーアトリビュート設定プラグイン</a>で設定することによって、マテリアルの半透明の深度（Translucence Depth）アトリビュートに接続されたテクスチャーを出力することもできます。</p>
<div class="info_new">
  <div class="info_new_left">参考：</div>
  <div class="info_new_right">
    <p>Maya 2015 で追加された UV タイリング機能には対応していません。</p>
  </div>
</div>
<p>
  <a name="Anchor_83955838_tex_format"></a>
</p>
<h1 id="Anchor_83955838_h1_3">テクスチャーファイルとフォーマット</h1>
<p>Maya から ftx ファイルを出力する場合、テクスチャーファイルは TGA ファイル、PNG ファイル、DDS ファイルのいずれかを使用してください。<br />16 bit/チャンネルの PNG ファイルは実数型として扱います。<br /> DDS ファイルは、R8G8B8、A8R8G8B8、A16B16G16R16F、A32B32G32R32F フォーマットのみ対応しています。</p>
<p>テクスチャーファイルのミップマップデータは反映されません。出力時に最上位レベルの画像を縮小してミップマップを作成します。</p>
<p>テクスチャーのフォーマットは次の規則で自動的に決定されます。<br />このとき、テクスチャー画像のアルファ値（8 ビット）が 255 なら不透明、0 なら透明、1 ～ 254 なら半透明なテクセルとみなします。</p>
<ul>
  <li>すべてのテクセルで R = G = B の場合<ul><li>テクセルがすべて不透明 &rarr; unorm_bc4</li><li>透明または半透明なテクセルが存在 &rarr; unorm_bc5</li></ul></li>
  <li>R = G = B でないテクセルが存在する場合<ul><li>テクセルがすべて不透明 &rarr; unorm_bc1 または srgb_bc1</li><li>透明なテクセルが存在して半透明なテクセルが存在しない場合（抜きテクスチャー） &rarr; unorm_bc1 または srgb_bc1</li><li>半透明なテクセルが存在 &rarr; unorm_bc3 または srgb_bc3</li></ul></li>
</ul>
<p>unorm_* と srgb_* のどちらを使用するかは<a href="../Pages/Page_83956186.html#Anchor_83956186_config_file">コンフィグファイル</a>で設定します。</p>
<p>法線マップ用テクスチャーのフォーマットはデフォルトでは snorm_bc5 ですが、<a href="../Pages/Page_83956186.html#Anchor_83956186_config_file">コンフィグファイル</a>で変更できます。<br /> テクスチャーファイルが実数型の場合は常に float_16_16_16_16 となります。</p>
<p>
  <a name="Anchor_83955838_valid_attribute"></a>
</p>
<h1 id="Anchor_83955838_h1_4">有効なアトリビュート</h1>
<p>place2dTexture ノードのアトリビュートで中間ファイルに反映されるのは<strong>フレームの移動（Translate Frame）</strong>、<strong>フレームの回転（Rotate Frame）</strong>、<strong>ミラー U（Mirror U）</strong>、<strong>ミラー V（Mirror V）</strong>、<strong>ラップ U（Wrap U）</strong>、<strong>ラップ V（Wrap V）</strong>、<strong>繰り返し UV（Repeat UV）</strong> です。<br />ただし、&nbsp;マテリアルの反射カラー（Reflected Color）アトリビュートに接続されたテクスチャーについては、place2dTexture ノードのアトリビュートは反映されません。</p>
<p>place2dTexture ノードの有効範囲（Coverage）アトリビュートは (1, 1)、オフセット（Offset）アトリビュートは (0, 0)、回転 UV（Rotate UV）アトリビュートは 0 にしておいてください。</p>
<p>layeredTexture ノードのアトリビュートは中間ファイルに反映されません。</p>
<p>
  <a name="Anchor_83955838_multiple_uv"></a>
</p>
<h1 id="Anchor_83955838_h1_5">マルチ UV</h1>
<p>テクスチャーが使用している UV セット、「<strong>nw4f_uv</strong>」または「<strong>nw4f_fix</strong>」で始まる名前の UV セットが、中間ファイルのテクスチャー座標として出力されます。テクスチャー座標は 1 頂点あたり最大 8 セットまで出力できます。<br />ただし、&nbsp;マテリアルの反射カラー（Reflected Color）アトリビュートに接続されたテクスチャーについては、テクスチャー座標が出力されません。</p>
<p>1 つのマテリアルを複数のオブジェクトに割り当てる場合、テクスチャーと UV セットの組み合わせはすべてのオブジェクトで共通にしてください。<br /> たとえば、あるオブジェクトで「Tex1」と「Tex2」が同じ UV セット「uvSet1」を使用している場合、他のオブジェクトでも「Tex1」と「Tex2」は同じ UV セット「uvSet1」を使用する必要があります。</p>
<div class="info_new">
  <div class="info_new_left">参考：</div>
  <div class="info_new_right">
    <p>同じ UV セットを使用するテクスチャーの組み合わせが一致していれば、UV セット名は異なっていても構いません。</p>
  </div>
</div>
<p>中間ファイルの &lt;vtx_attrib&gt; には、次のアトリビュートに接続されたテクスチャーが使用している UV セットから順に hint の uv0 から割り当てられます（複数のテクスチャーが同じ UV セットを共有している場合は 1 つだけ出力されます）。</p>
<ol>
  <li>カラー（Color）</li>
  <li>透明度（Transparency）</li>
  <li>白熱光（Incandescence）</li>
  <li>バンプマッピング（Bump Mapping）</li>
  <li>スペキュラカラー（Specular Color）</li>
</ol>
<p>なお、後述する方法（<strong>nw4f_fixN</strong> で始まる名前の UV セット）で、hint 割り当てを明示的に指定することもできます。</p>
<p>layeredTexture ノードが接続されている場合、上位（左側）のテクスチャーが使用している UV セットから順に割り当てられます。<br /> 使用されている UV セットの後に、使用されていない UV セットのうち「<strong>nw4f_uv</strong>」または「<strong>nw4f_fix_</strong>」で始まる名前の UV セットがアルファベット順に割り当てられます。<br /> UV セット名が「<strong>nw4f_fix_</strong>」で始まる場合、nw4f_fix_ の後の文字列が &lt;vtx_attrib&gt; の name に反映されます。</p>
<p>たとえば、カラーで使用されている UV セット「uvSet1」、透明度で使用されている UV セット「uvSet2」、使用されていない UV セット「nw4f_uv_a」、「nw4f_uv_b」が存在する場合、次のように割り当てられます。</p>
<div class="info_new">
  <div class="info_new_left">参考：</div>
  <div class="info_new_right">
    <p>uv0 : uvSet1 (name は _u0)<br />uv1 : uvSet2 (name は _u1)<br />uv2 : nw4f_uv_a (name は _u2)<br />uv3 : nw4f_uv_b (name は _u3)</p>
  </div>
</div>
<p>「<strong>nw4f_fixN</strong>（N は 0 以上 254 以下の整数）」で始まる名前の UV セットを使用すると、&lt;vtx_attrib&gt; の hint の割り当てを直接指定できます。<br /> たとえば UV セット名が「nw4f_fix3」なら hint は uv3 で出力されます。</p>
<p>「nw4f_fixN」で始まる名前の UV セットを使用する場合、テクスチャーが使用する UV セット名はすべてのオブジェクトで共通にしてください。<br /> 「nw4f_fixN」で始まらない名前の UV セットは、空いている hint に前から順番に割り当てられます。</p>
<p>UV セット名が「<strong>nw4f_fixN_</strong>」で始まる場合、nw4f_fixN_ の後の文字列が &lt;vtx_attrib&gt; の name に反映されます。</p>
<p>たとえば、カラーで使用されている UV セット「uvSet1」、使用されていない UV セット「nw4f_fix_decal」、「nw4f_fix0」、「nw4f_fix7_bake」が存在する場合、次のように割り当てられます。</p>
<div class="info_new">
  <div class="info_new_left">参考：</div>
  <div class="info_new_right">
    <p>uv0 : nw4f_fix0 (name は _u0)<br />uv1 : uvSet1 (name は _u1)<br />uv2 : nw4f_fix_decal (name は decal)<br />uv7 : nw4f_fix7_bake (name は bake)</p>
  </div>
</div>
<h2 id="Anchor_83955838_h2_1">まとめ</h2>
<p>以上の情報をまとめると &lt;vtx_attrib&gt; の hint は以下のような順番で設定されます。</p>
<ol>
  <li>「nw4f_fixN」で始まる名前の UV セット（hint は N 固定で設定）</li>
  <li>テクスチャーが使用している UV セット（ここまでで使用されていない最小の hint から設定）</li>
  <li>「nw4f_fix_」で始まる名前の UV セット（ここまでで使用されていない最小の hint から設定）</li>
  <li>「nw4f_uv」で始まる名前の UV セット（ここまでで使用されていない最小の hint から設定）</li>
</ol>
<p>
  <a name="Anchor_83955838_normal_mapping"></a>
</p>
<h1 id="Anchor_83955838_h1_6">法線マッピング</h1>
<p>法線マッピングを設定するには、マテリアルの「<strong>バンプマッピング（Bump Mapping）</strong>」（<strong>法線カメラ（normalCamera）</strong>アトリビュート）に <strong>bump2d ノード</strong>経由で <strong>file ノード</strong>または <strong>layeredTexture ノード</strong>を接続し、file ノードの「イメージの名前（Image Name）」で法線マップ用テクスチャーを指定します。<br /> 法線マップ用テクスチャーは接線空間用のものを使用します。</p>
<div class="info_new">
  <div class="info_new_left">参考：</div>
  <div class="info_new_right">
    <p>bump2d ノードの<strong>使用対象（Use As）</strong>アトリビュートは「<strong>接線空間法線（Tangent Space Normals）</strong>」にしてください。接線空間法線でない場合、Maya 上で正常に表示されません。</p>
  </div>
</div>
<p>法線マップ用テクスチャーは「ライティング/シェーディング &gt; マップの転写（Lighting/Shading &gt; Transfer Maps）」で作成できます。<br /> マップの転写の<strong>マップ空間（Map space）</strong>オプションは「<strong>接線空間（Tangent space）</strong>」にしてください。</p>
<p>
  <strong>マップをシェーダにコネクト（Connect maps to shader）</strong>オプションを ON にして、<strong>マップのコネクト（Connect maps to）</strong>オプションを「<strong>割り当てシェーダ（Assigned shader）</strong>」にすると、作成したテクスチャーがターゲットのマテリアルのバンプマッピングに自動的に接続されます。</p>
<p>法線マッピングを設定すると、法線マップ用テクスチャーの UV セットに対応した接線と従法線を出力します。<br /> 接線と従法線の W 成分には、UV のワインド順序が時計回り（前向き）なら 1、反時計回り（後ろ向き）なら -1 を出力します。</p>
<p>layeredTexture ノードを使用すると、複数の法線マップ用テクスチャーを出力できます。<br />layeredTexture ノードに接続された各 file ノードが異なる UV セットを使用している場合、接線と従法線は UV セットの数だけ出力されます（最大 4 セットまで）。<br />その際、上位（左側）のテクスチャーから順に接線と従法線が中間ファイルの &lt;vtx_attrib&gt; に割り当てられます。</p>
</div>
<div class="breadcrumb_bottom"></div>
<div class="page_navigation">
<table class="page_navi_root">
<tr>
<td class="page_navi_left"></td>
<td class="page_navi_right"></td>
</tr>
<tr><td colspan="2" class="page_navi_bottom"></td></tr>
</table>
</div>
</div>
</div>
</body>
</html>
