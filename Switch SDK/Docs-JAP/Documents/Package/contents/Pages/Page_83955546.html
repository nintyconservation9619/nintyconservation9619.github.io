<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<script type="text/javascript" src="../template/js/jquery/jquery.js"></script>
<script type="text/javascript" src="../template/js/common/manualLib.js"></script>
<script type="text/javascript" src="../tocData.js"></script>
<link rel="stylesheet" type="text/css" href="../template/css/template.css" />
<title>エクスポートプラグイン使用方法</title>
</head>
<body data-reassemble="autoindex=no,forceNoLabel=yes">
<div id="autoindex_content">
<div class="body_content">
<noscript>
<div style="border: 4px double black; margin: 4px; padding: 2px; font-weight: bold; background-color: #FFFFCC;">
<p>お使いのブラウザは JavaScript が使用できないため、本ドキュメントの一部機能が無効になっています。</p><p>JavaScript が無効の環境では目次を使用することができません。<br />JavaScriptの実行が許可された状態で閲覧してください。<br /><br /></p>
</div>
</noscript>
<div class="page_navigation_top">
<table class="page_navi_root">
<tr>
<td class="page_navi_left"></td>
<td class="page_navi_right"></td>
</tr>
</table>
</div>
<div class="breadcrumb"></div>

<!-- エクスポートプラグイン使用方法 -->
<div class="pagetitle" id="PageId_83955546">エクスポートプラグイン使用方法</div>
<div class="text_separate">
<h1 id="Anchor_83955546_h1_1">エクスポートプラグイン使用方法</h1>
<p>ここでは、エクスポートプラグインの使用方法について下記項目で説明します。</p>
<p>
  <ul class="macro_toc">
    <li>
      <a href="#Anchor_83955546_h2_1">エクスポートプラグインの基本機能</a>
    </li>
    <li>
      <a href="#Anchor_83955546_h2_2">オプション設定</a>
    </li>
    <ul>
      <li>
        <a href="#Anchor_83955546_h3_1">Preset Options</a>
      </li>
      <li>
        <a href="#Anchor_83955546_h3_2">Output Options</a>
      </li>
      <li>
        <a href="#Anchor_83955546_h3_3">General Options</a>
      </li>
      <li>
        <a href="#Anchor_83955546_h3_4">Animation Options</a>
      </li>
      <li>
        <a href="#Anchor_83955546_h3_5">Output File Selection</a>
      </li>
      <li>
        <a href="#Anchor_83955546_h3_6">Optimization Options</a>
      </li>
      <li>
        <a href="#Anchor_83955546_h3_7">Animation Bake Tolerance Options</a>
      </li>
      <li>
        <a href="#Anchor_83955546_h3_8">Animation Quantization Tolerance Options</a>
      </li>
      <li>
        <a href="#Anchor_83955546_h3_9">Script Options</a>
      </li>
    </ul>
    <li>
      <a href="#Anchor_83955546_h2_3">オプション設定の管理</a>
    </li>
    <ul>
      <li>
        <a href="#Anchor_83955546_h3_10">オプションの設定をシーンに保存する方法</a>
      </li>
      <li>
        <a href="#Anchor_83955546_h3_11">オプションの設定を fdes ファイルとして入出力する方法</a>
      </li>
    </ul>
    <li>
      <a href="#Anchor_83955546_h2_4">コンフィグファイル</a>
    </li>
    <li>
      <a href="#Anchor_83955546_h2_5">関連リンク</a>
    </li>
  </ul>
</p>
<h2 id="Anchor_83955546_h2_1">エクスポートプラグインの基本機能</h2>
<p>特定のノードだけ出力する場合は、出力したいノードを 3ds Max 上で選択します。<br />選択したノードの下の階層のノードも出力されます。</p>
<p>シーン全体を出力する場合は、ノードを選択する必要はありません。</p>
<p>「Nintendo &gt; Export with Setting...」を実行して、 Nintendo&nbsp;Export&nbsp;のオプションウィンドウを表示します。<br /> 適切なオプションを設定して <strong>Export</strong> ボタンまたは<strong>Apply</strong>ボタンをクリックすると中間ファイルが出力されます。</p>
<p>適用ボタンは Export ボタンと違って出力後にオプションウィンドウを閉じません。</p>
<p>出力したときのオプションの設定が現在のオプションとして 3ds Max 内部に記録されます。<br />また、オプションの設定をシーンに保存したり、<a href="../Pages/Page_83955854.html">3D DCC プラグイン出力設定ファイル</a>として入出力したりすることも可能です （詳細は「<a href="#Anchor_83955546_manage_options">オプションの設定の管理</a>」で説明します）。</p>
<p>オプションウィンドウを表示しないで、現在のオプションで出力する場合は、「Nintendo &gt; Export」を実行します。</p>
<p>オプションウィンドウの「Settings &gt; Save Settings」を選択すると、中間ファイルを出力せずにオプション設定を 3ds Max 内部に保存できます（Save / Load Scene Settings が ON ならシーンにも保存されます）。<br /> オプションウィンドウの「Settings &gt; Reset Settings」を実行すると、オプション設定をデフォルト状態に戻せます。</p>
<p>オプションウィンドウの Settings メニュー内にある Lock All Settings または Unlock All Settings を選択すると、すべてのオプションの編集ロック状態を一度に変更できます。</p>
<h2 id="Anchor_83955546_h2_2">オプション設定</h2>
<p>エクスポートプラグインで設定するオプションは以下になります。</p>
<table style="margin-left: 1.5em;" class="table">
  <tbody>
    <tr>
      <th>
        <a href="#Anchor_83955546_preset_options">Preset Options</a>
      </th>
      <td>プリセットに関するオプションです。</td>
    </tr>
    <tr>
      <th>
        <a href="#Anchor_83955546_output_options">Output Options</a>
      </th>
      <td>中間ファイルの出力方法に関するオプションです。</td>
    </tr>
    <tr>
      <th>
        <a href="#Anchor_83955546_general_options">General Options</a>
      </th>
      <td>中間ファイル全般に関するオプションです。</td>
    </tr>
    <tr>
      <th>
        <a href="#Anchor_83955546_animation_options">Animation Options</a>
      </th>
      <td>アニメーションに関するオプションです。</td>
    </tr>
    <tr>
      <th>
        <a href="#Anchor_83955546_output_file_selection">Output File Selection</a>
      </th>
      <td>出力する中間ファイルの種類を指定するオプションです。</td>
    </tr>
    <tr>
      <th>
        <a href="#Anchor_83955546_optimization_options">Optimization Options</a>
      </th>
      <td>Maya から中間ファイルを出力する際、中間ファイルオプティマイザを使ってデータの最適化を行うことができます。最適化に関するオプションをここで指定します。</td>
    </tr>
    <tr>
      <th>
        <a href="#Anchor_83955546_animation_bake_tolerance_options">Animation Bake Tolerance Options</a>
      </th>
      <td>アニメーションをベイクして最適化する際の誤差の許容範囲を指定するオプションです。</td>
    </tr>
    <tr>
      <th>
        <a href="#Anchor_83955546_animation_quantization_tolerance_options">Animation Quantization Tolerance Options</a>
      </th>
      <td>アニメーションを量子化する際の誤差の許容範囲を指定するオプションです。</td>
    </tr>
    <tr>
      <th>
        <a href="#Anchor_83955546_script_options">Script Options</a>
      </th>
      <td>出力前後に実行するスクリプト（Max Script）を指定するオプションです。 </td>
    </tr>
  </tbody>
</table>
<p>
  <a name="Anchor_83955546_preset_options"></a>
</p>
<h3 id="Anchor_83955546_h3_1">Preset Options</h3>
<p>プリセットに関するオプションです。<br />プリセットとは、プリセットファイル（オプションを<a href="#Anchor_83955546_lock_unlock">編集ロック状態</a>にした fdes ファイル）を使用して、オプション設定の一部または全部を特定の値に固定する機能です。</p>
<p>次のような用途に利用できます。</p>
<ul>
  <li>デザイナーのリーダーが決定したオプション設定を他のデザイナーが不用意に変更してしまわないようにする。</li>
  <li>キャラクタ用のプリセットと地形用のプリセットを用意しておいて、それぞれのオプション設定を容易に切り替えられるようにする。</li>
</ul>
<div class="info_new">
  <div class="info_new_left">参考：</div>
  <div class="info_new_right">
    <p>プリセットファイルは通常 Tool\DccPlugin\3dsMaxPlugins\Config\Presets フォルダに配置します。<br />他のフォルダに配置したい場合は、環境変数 NINTENDO_3DSMAX_PRESETS にフォルダのパスを設定した状態でエクスポートプラグインを使用してください。</p>
  </div>
</div>
<p>オプションウィンドウの Settings メニュー内にある Open Presets Folder... を選択すると、Presets フォルダをエクスプローラで開きます（同時にオプションウィンドウを閉じます）。</p>
<p>プリセットはエクスポート実行時に評価されます。</p>
<div class="info_new">
  <div class="info_new_left">参考：</div>
  <div class="info_new_right">
    <p>複数のシーンで同じプリセットを使用している場合、プリセットファイルの内容を変更することによって、すべてのシーンのエクスポートオプションを変更できます。</p>
  </div>
</div>
<p>Preset Options 内のオプションは編集ロック状態にできません。</p>
<p>
  <a name="Anchor_83955546_lock_unlock"></a>
</p>
<div class="info_new">
  <div class="info_new_left">参考：</div>
  <div class="info_new_right">
    <strong>Edit Preset</strong>を ON にすると各オプションの横に錠前アイコンが表示され、編集ロック状態を変更できるようになります。<br /> 錠前アイコンをクリックして鍵のかかった状態にすると、オプションが編集できない状態 （ <strong>編集ロック状態 </strong>） になります。もう一度クリックして鍵のはずれた状態にすると、編集ロックが解除されます。<br /> 編集ロック状態はシーンや fdes ファイルに保存されます。<br /> オプションウィンドウの Settings メニュー内にある Lock All Settings または Unlock All Settings を選択すると、すべてのオプションの編集ロック状態を一度に変更できます。</div>
</div>
<ul>
  <li>
    <strong>Preset<br /> </strong> 使用するプリセットの名前を指定します。<br />  Presets フォルダに存在する fdes ファイルの名前がプリセット名としてメニューに列挙されます。<br />  プリセットを使用しない場合は  <strong>None</strong> 、プリセットを使用する場合はプリセット名を選択します。<br />  プリセットを切り替えると、 <strong>プリセットファイルで編集ロック状態になっているオプションについてはプリセットの値で上書きされます</strong> 。プリセットファイルで編集ロック状態になっていないオプションについては値は変更されません。<br />  プリセットを使用した場合、プリセットファイルで編集ロック状態になっているオプションの編集ロックを解除することはできません。また、編集ロックされていないオプションを編集ロック状態にすることもできません。<br />  プリセットを使用していない状態で  <strong>Save Preset...</strong>  ボタンをクリックすると、現在のオプション設定をプリセットとして Presets フォルダに出力できます。<br />新しいプリセットを作成する場合は  <strong>New</strong>  を選択してプリセット名を入力します。既存のプリセットに上書きする場合は  <strong>Overwrite</strong>  を選択してプリセット名を選択します。  <strong>Save</strong>  ボタンをクリックするとプリセットファイルが出力され、出力したプリセットを使用した状態になります。<br />  プリセットを使用している状態で  <strong>Delete Preset...</strong>  ボタンをクリックすると、使用中のプリセットのプリセットファイルが削除され、プリセットを使用していない状態になります。<br />  既存のプリセットの値を編集するには次の手順で操作します。<p>&nbsp;1. Preset オプションで編集したいプリセットを選択<br />&nbsp;2. Preset オプションを None に変更<br />&nbsp;3. 各オプションの値や編集ロック状態を変更<br />&nbsp;4. Save Preset... ボタンで上書き出力</p></li>
  <li>
    <strong>Show Preset UI<br /> </strong> プリセット使用時に、プリセットファイルで編集ロック状態になっているオプションの UI を表示するなら ON にします。<br />  OFF にすると編集可能なオプションの UI のみ表示できます。</li>
</ul>
<p>
  <a name="Anchor_83955546_output_options"></a>
</p>
<h3 id="Anchor_83955546_h3_2">Output Options</h3>
<p>中間ファイルの出力方法に関するオプションです。</p>
<ul>
  <li>
    <strong>Export Target<br /> </strong> 出力対象を指定します。<br />  <strong>All</strong>  を選択すると、シーン中の有効なノードがすべて出力されます。<br />  <strong>Selection</strong>  を選択すると、選択したノードとその下の階層のノードだけが出力されます。</li>
  <li>
    <strong>Output File Name<br /> </strong> 中間ファイルの名前（拡張子を除く）を指定します。<br />  空欄の場合は現在のシーン名が中間ファイル名となります。<br />  右にある  <strong>Scene</strong>  ボタンをクリックすると現在のシーン名がセットされます。 <strong>Node</strong>  ボタンをクリックすると選択されたノード（複数選択されている場合は一番最初に選択されたもの）の名前がセットされます。</li>
  <li>
    <strong>Output Folder<br /> </strong> 中間ファイルを出力するフォルダを指定します。<br />  テクスチャファイルは Output Folder で指定したフォルダの下の textures フォルダに出力されます。<br />  Output Folder に指定したフォルダが存在していない場合、そのフォルダを作成して出力します。</li>
  <li>
    <strong>Merge fmd File<br /> </strong> ON にして fmd ファイルのパスを指定すると、指定した fmd ファイルをマージします。<br />  fmd ファイルのパスが空欄の場合、上書きする出力先ファイルをマージします。<br />  fmd ファイルのパスがフルパスでない場合、現在のプロジェクトフォルダからの相対パスとみなします。<br />  fmd ファイルのマージ処理は中間ファイルオプティマイザが実行します。マージ処理の詳細については  <a href="../Pages/Page_83955705.html#Anchor_83955705_merge">中間ファイルオプティマイザのヘルプ</a>  を参照してください。</li>
  <li>
    <strong>Merge ftx File<br /> </strong> ON にすると ftx ファイルをマージします。<br />  fmd ファイルもマージする場合、Merge fmd File で指定したファイルのフォルダの下の textures フォルダにある同名ファイルとマージします。<br />  fmd ファイルをマージしない場合、Output Folder で指定したフォルダの下の textures フォルダにある同名ファイルとマージします。<br />  fmd ファイルを出力しない場合も、Output Folder で指定したフォルダの下の textures フォルダにある同名ファイルとマージします。<br />  fmd ファイルと ftx ファイルを同時にマージしない場合、fmd ファイルのミップマップフィルタと ftx ファイルのミップマップの有無が対応しなくなる可能性があるので注意してください。<br />  fmd ファイルをマージしない場合、マージ対象の ftx ファイルのミップマップ設定が fmd ファイルのミップマップフィルタに影響します。<br />  ftx ファイルのマージ処理は 3D テクスチャーコンバーターが実行します。マージ処理の詳細については  <a href="../Pages/Page_239574379.html#Anchor_239574379_tex_merge">3D テクスチャーコンバーターのヘルプ</a>  を参照してください。</li>
  <li>
    <strong>Merge Animation Folder<br /> </strong> ON にしてアニメーション中間ファイルのあるフォルダを指定すると、指定したアニメーション中間ファイルをマージします。<br />  フォルダが空欄の場合、Output Folder で指定したフォルダにあるアニメーション中間ファイルをマージします。<br />  Merge Animation Name にはマージするアニメーション中間ファイルの名前（拡張子を除く）を指定します<br />  Merge Animation Name が空欄の場合、Output File Name で指定した名前のファイルをマージします。<br />  アニメーション中間ファイルのマージ処理は中間ファイルオプティマイザが実行します。 マージ処理の詳細については  <a href="../Pages/Page_83955705.html#Anchor_83955705_merge">中間ファイルオプティマイザのヘルプ</a>  を参照してください。</li>
</ul>
<p> <a name="Anchor_83955546_general_options"></a> <br /> </p>
<h3 id="Anchor_83955546_h3_3">General Options</h3>
<p>中間ファイル全般に関するオプションです。</p>
<ul>
  <li>
    <strong>Magnify<br /> </strong> モデルの頂点座標や移動値に掛ける倍率です。</li>
  <li>
    <strong>Use FigureMode and SkinPose<br /> </strong> Physique やスキンの初期ポーズを Biped のフィギュアモードやボーンのスキンポーズを元に決定します。 スキニングが正しく出力されないデータは、このオプションをオンにすると正しく出力される場合があります。<br />  このオプションを使用する場合は、 Physique やスキンで使用するボーンとその親階層全てにスキンポーズを設定する必要が有ります。 Biped とボーンを組み合わせた場合も、ボーンには必ずスキンポーズを設定してください。</li>
  <li>
    <strong>Comment<br /> </strong> 中間ファイルに対する編集用コメント文を指定します。</li>
</ul>
<p> <a name="Anchor_83955546_animation_options"></a> <br /> </p>
<h3 id="Anchor_83955546_h3_4">Animation Options</h3>
<p>アニメーションに関するオプションです。</p>
<ul>
  <li>
    <strong>Start / End Frame<br /> </strong> アニメーションを出力する範囲（開始フレームと終了フレーム）を指定します。<br />  <strong>All</strong>  を選択すると、3ds Max 上のアニメーションの全範囲（アニメーション開始 / 終了（Animation Start / End））が出力されます。<br />  <strong>Range</strong>  を選択すると、開始フレームと終了フレームを数値入力で指定できます。<br />  アトリビュートがアニメーションしている場合、fmd ファイルにはここで指定した開始フレームにおける値が出力されます。<br />  ループアニメーションの終了フレームは、開始フレームと同じ状態になるフレームを指定してください。</li>
  <li>
    <strong>Loop<br /> </strong> ON にすると、ループ再生するデータとして出力します。<br />  OFF にすると、一度だけ再生するデータとして出力します。</li>
  <li>
    <strong>Frame Precision<br /> </strong> ベイクしたデータからアニメーションカーブデータを自動作成する際の、フレームの精度を指定します。<br /> <ul><li><strong>1.0</strong>  にすると、整数フレーム単位でベイクを実行します。<br /> </li><li><strong>0.5</strong>  にすると、0.5 フレーム単位でベイクを実行します。<br /> </li><li><strong>0.2</strong>  にすると、0.2 フレーム単位でベイクを実行します。<br /> </li><li><strong>0.1</strong>  にすると、0.1 フレーム単位でベイクを実行します。<br /> </li></ul>精度を高くすると、小数フレームのタイミングで不連続に変化するアニメーションなどを正確に再現できますが、出力に掛かる時間は長くなります。</li>
</ul>
<p> <a name="Anchor_83955546_output_file_selection"></a> <br /> </p>
<h3 id="Anchor_83955546_h3_5">Output File Selection</h3>
<p>出力する中間ファイルの種類を指定するオプションです。</p>
<p>
  <strong>Search Model Animation</strong> ボタンをクリックすると、出力対象のモデルに設定されているアニメーションに対応する中間ファイルのみ ON になります。</p>
<p>その際にキーがひとつでも設定されていたり、コンストレイントやスクリプトコントローラなどが使用されていれば、値が変化しなくてもアニメーションが設定されているとみなします。<br />Export Target が Selection の場合は、ノードを選択してから Search Model Animation ボタンをクリックしてください。</p>
<div class="info_new">
  <div class="info_new_left">参考：</div>
  <div class="info_new_right">
    <p>シーンアニメーションは検索されないので、手動で ON / OFF を切り替えてください。</p>
  </div>
</div>
<p>
  <a name="Anchor_83955546_optimization_options"></a>
</p>
<h3 id="Anchor_83955546_h3_6">Optimization Options</h3>
<p>3ds Max から中間ファイルを出力する際、中間ファイルオプティマイザを使ってデータの最適化を行うことができます。最適化に関するオプションをここで指定します。</p>
<ul>
  <li>
    <p>
      <strong>Compress Bone<br /> </strong> モデル全体に対するボーン圧縮のモードを指定します。ボーン数を減らすことによって行列演算の負荷が軽減され、メモリ使用量も小さくなります。<br />  圧縮されるのは中間ファイルに出力されるボーンであり、DCC ツール上のデータが変更されるわけではありません。</p>
    <table class="table">
      <thead>
        <tr>
          <th>モード</th>
          <th>説明</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td class="nowrap">
            <strong>None</strong>
          </td>
          <td>ボーンを圧縮しません。DCC ツール上の階層構造のまま出力します。</td>
        </tr>
        <tr>
          <td class="nowrap">
            <strong>Cull</strong>
          </td>
          <td>階層構造の末端に位置するモデルの表示に必要でないボーンを削除して出力します。<br />スキニングを使用しているモデルに効果があります。<br />圧縮不可フラグを設定したボーンは削除されません。</td>
        </tr>
        <tr>
          <td class="nowrap">
            <strong>Merge</strong>
          </td>
          <td>Cull の処理に加えて、行列を合成できるボーンを合成して出力します。<br />一般に Cull よりもボーン数が減りますが、<strong>「子供を持つボーンに不均等な（X、Y、Z の値が同じでない） スケールが設定されてはいけない」</strong>という制限があります。<br />制限が守られていないボーンおよびそのボーンの子供が圧縮されると、モデルが正しく表示されないことがあります。<br />スケールがアニメーションしている場合は、すべてのフレームで上記の制限が守られている必要があります。<br />圧縮不可フラグを設定したボーンは削除されません。</td>
        </tr>
        <tr>
          <td class="nowrap">
            <strong>Unite</strong>
          </td>
          <td>圧縮不可フラグを設定していないボーンを 1 つにまとめます。</td>
        </tr>
        <tr>
          <td class="nowrap">
            <strong>Unite All</strong>
          </td>
          <td>圧縮不可フラグに関係なく、すべてのボーンを 1 つにまとめます。<br />ルートボーンの行列は単位行列となり、すべてのシェイプの頂点座標・法線・接線・従法線はモデル座標系の値になります。<br />階層構造を必要としない地形データや単体オブジェクトなどに利用します。</td>
        </tr>
      </tbody>
    </table>
    <p>圧縮対応ファイルは fmd ファイル、fsk ファイル、fvb ファイルです。</p>
  </li>
  <li>
    <strong>Unite Child<br /> </strong> ON にすると、階層構造の末端に位置するシェイプを持ったノードを 1 つにまとめて出力します。Compress Bone が Unite 以外の場合に有効です。<br />  圧縮不可フラグを設定したボーンの子ボーンがすべて圧縮可能で、スキニングに影響していない場合に圧縮されます。<br />圧縮不可フラグを設定したボーンが 1 つもない場合、このオプションは機能しません。</li>
  <li>
    <strong>Compress Material<br /> </strong> ON にすると同じアトリビュートを持つマテリアルを圧縮して 1 つにまとめて出力します。<br />   <a href="../Pages/Page_83955882.html">マテリアルアトリビュート設定プラグイン</a>  で Compress が  <strong>Don&rsquo;t compress</strong>  に設定されているマテリアルは圧縮されません。</li>
  <li>
    <strong>Compress Shape<br /> </strong> ON にすると、属するボーンとマテリアルが同じシェイプ（fmd ファイルの &lt;shape&gt;）が複数存在すれば 1 つにまとめて出力します。<br />  OFF にすると、属するボーンとマテリアルが同じでもシェイプを個別に出力します。<br />  Compress Bone が None 以外または Unite Child が ON で、ボーンがまとめられた結果、1 つのボーンにマテリアルが同じシェイプが複数存在する状態になる場合に効果があります。<br />  Compress Material が ON で、マテリアルがまとめられた結果、1 つのボーンにマテリアルが同じシェイプが複数存在する状態になる場合にも効果があります。</li>
</ul>
<p> <a name="Anchor_83955546_animation_bake_tolerance_options"></a> <br /> </p>
<h3 id="Anchor_83955546_h3_7">Animation Bake Tolerance Options</h3>
<p>アニメーションをベイクして最適化する際の誤差の許容範囲を指定するオプションです。<br />開始フレームにおける値と各フレームにおける値の差の最大値が、ここで指定した許容値未満の場合は、アニメーションを一定とみなし、開始フレームにおける値だけ出力します。</p>
<p>ベイクしたデータからアニメーションカーブデータを自動作成する際に、Frame Precision で指定した単位で各フレームに対するキーを作成し、<strong>エルミート補間したときの誤差の最大値</strong>がここで指定した<strong>許容値未満</strong>になるキーを削除します。<br />誤差の許容値が小さいほどアニメーションの精度は高くなりますが、キー数が多くなってアニメーションカーブデータ量が増えます。</p>
<ul>
  <li>
    <strong>Node Translate</strong>、<strong>Node Rotate</strong>、<strong>Node Scale<br /> </strong> スケルタルアニメーションの移動、回転、スケールおよびシーンアニメーションの移動、回転（方向）に対する許容誤差を絶対値で指定します。<br />  Node Rotate の単位は度数です。<br />  Node Translate は  <strong>Magnify を掛ける前の値</strong> に対する許容誤差です。</li>
  <li>
    <strong>Texture Translate</strong>、<strong>Texture Rotate</strong>、<strong>Texture Scale<br /> </strong> テクスチャ SRT アニメーションの移動、回転、スケールに対する許容誤差を絶対値で指定します。<br />  Texture Rotate の単位は度数です。</li>
  <li>
    <strong>Color<br /> </strong> カラーアニメーションとシーンアニメーションの各カラー値に対する許容誤差を絶対値で指定します。</li>
</ul>
<p> <a name="Anchor_83955546_animation_quantization_tolerance_options"></a> <br /> </p>
<h3 id="Anchor_83955546_h3_8">Animation Quantization Tolerance Options</h3>
<p>アニメーションを量子化する際の誤差の許容範囲を指定するオプションです。</p>
<ul>
  <li>
    <strong>Node Translate</strong>、<strong>Node Rotate</strong>、<strong>Node Scale<br /> </strong> スケルタルアニメーションの移動、回転、スケールに対する許容誤差です。<br />  Node Translate と Node Scale はアニメーション結果の値の範囲に対する割合をパーセントで指定します。<br />  Node Rotate は絶対値（単位は度数）で指定します。</li>
  <li>
    <strong>Texture Translate</strong>、<strong>Texture Rotate</strong>、<strong>Texture Scale<br /> </strong> テクスチャ SRT アニメーションの移動、回転、スケールに対する許容誤差です。<br />  Texture Translate と Texture Scale はアニメーション結果の値の範囲に対する割合をパーセントで指定します。<br />  Texture Rotate は絶対値（単位は度数）で指定します。</li>
  <li>
    <strong>Frame<br /> </strong> 各アニメーションのフレームに対する許容誤差を絶対値で指定します。</li>
</ul>
<p>&nbsp;</p>
<div class="info_new">
  <div class="info_new_left">参考：</div>
  <div class="info_new_right">
    <p>アニメーション中間ファイルをマージする場合、このオプションは反映されません。マージする中間ファイルの値が使用されます。</p>
  </div>
</div>
<p>
  <a name="Anchor_83955546_script_options"></a>
</p>
<h3 id="Anchor_83955546_h3_9">Script Options</h3>
<p>出力前後に実行するスクリプト（MAX Script）を指定するオプションです。</p>
<ul>
  <li>
    <strong>Pre-Export Script<br /> </strong> 出力前に実行する MAX Script を指定します（MAX Script コマンドを直接記述できます）。<br />  空欄の場合は何も実行しません。</li>
  <li>
    <strong>Post-Export Script<br /> </strong> 出力後に実行する MAX Script を指定します（MAX Script コマンドを直接記述できます）。<br />  空欄の場合は何も実行しません。<br />  出力でエラーが発生した場合も、ここで指定した MAX Script は実行されます。後述する環境変数で出力が成功かどうか取得できます。<br />  中間ファイルのマージが ON の場合、マージ後のタイミングで、指定した MAX Script が実行されます。</li>
</ul>
<p>Pre-Export Script、Post-Export Script で指定した MAX Script 内では、次の環境変数から systemTools.getEnvVariable コマンドで情報を取得できます。</p>
<table class="table">
  <thead>
    <tr>
      <th>環境変数名</th>
      <th>内容</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td class="nowrap">NINTENDO_EXPORT_OUTPUT_FILE_NAME</td>
      <td>中間ファイル名（拡張子を除く）です。</td>
    </tr>
    <tr>
      <td class="nowrap">NINTENDO_EXPORT_OUTPUT_FOLDER</td>
      <td>出力フォルダのパスです。最後に「/（スラッシュ）」が付きます。</td>
    </tr>
    <tr>
      <td class="nowrap">NINTENDO_EXPORT_FTX_FOLDER</td>
      <td>テクスチャ出力フォルダのパスです。最後に「/（スラッシュ）」が付きます。</td>
    </tr>
    <tr>
      <td class="nowrap">NINTENDO_EXPORT_FMD_FILE_PATH</td>
      <td>fmd ファイルのフルパスです。出力しない場合は定義されません。</td>
    </tr>
    <tr>
      <td class="nowrap">NINTENDO_EXPORT_FSK_FILE_PATH</td>
      <td>fsk ファイルのフルパスです。出力しない場合は定義されません。</td>
    </tr>
    <tr>
      <td class="nowrap">NINTENDO_EXPORT_FVB_FILE_PATH</td>
      <td>fvb ファイルのフルパスです。出力しない場合は定義されません。</td>
    </tr>
    <tr>
      <td class="nowrap">NINTENDO_EXPORT_FCL_FILE_PATH</td>
      <td>fcl ファイルのフルパスです。出力しない場合は定義されません。</td>
    </tr>
    <tr>
      <td class="nowrap">NINTENDO_EXPORT_FTS_FILE_PATH</td>
      <td>fts ファイルのフルパスです。出力しない場合は定義されません。</td>
    </tr>
    <tr>
      <td class="nowrap">NINTENDO_EXPORT_FTP_FILE_PATH</td>
      <td>ftp ファイルのフルパスです。出力しない場合は定義されません。</td>
    </tr>
    <tr>
      <td class="nowrap">NINTENDO_EXPORT_FSH_FILE_PATH</td>
      <td>fsh ファイルのフルパスです。出力しない場合は定義されません。</td>
    </tr>
    <tr>
      <td class="nowrap">NINTENDO_EXPORT_FSN_FILE_PATH</td>
      <td>fsn ファイルのフルパスです。出力しない場合は定義されません。</td>
    </tr>
    <tr>
      <td class="nowrap">NINTENDO_EXPORT_FTX_ENABLED</td>
      <td>ftx ファイルの出力指定が ON なら 1、OFF なら 0 が格納されます。</td>
    </tr>
    <tr>
      <td class="nowrap">NINTENDO_EXPORT_G3D_TOOL_FOLDER</td>
      <td>G3D の 3dTools&nbsp;フォルダのパスです。<br /> 最後に「/（スラッシュ）」が付きます。</td>
    </tr>
    <tr>
      <td class="nowrap">NINTENDO_EXPORT_SUCCEEDED</td>
      <td>出力に成功なら 1、失敗なら 0 が格納されます。<br /> Post-Export Script でのみ使用可能です。</td>
    </tr>
    <tr>
      <td class="nowrap">NINTENDO_EXPORT_FTX_FILE_NAMES</td>
      <td>出力した ftx ファイル名（拡張子を含む）を半角スペースで区切って<br /> 並べた文字列です。出力しない場合は定義されません。<br /> Post-Export Script でのみ使用可能です。</td>
    </tr>
    <tr>
      <td class="nowrap">NINTENDO_EXPORT_USED_FTX_FILE_NAMES</td>
      <td>モデルが使用する ftx ファイル名（拡張子を含む）を半角スペースで区切って<br /> 並べた文字列です。<br /> fmd ファイルまたは ftx ファイルを出力する場合に定義されます。<br /> （値は NINTENDO_EXPORT_FTX_FILE_NAMES と同じですが、ftx ファイルを出力しない場合でも取得可能です。）<br /> Post-Export Script でのみ使用可能です。</td>
    </tr>
    <tr>
      <td class="nowrap">NINTENDO_EXPORT_OPTION_<em>keyword</em></td>
      <td>各エクスポートオプションの値が格納されます。<br /> <em>keyword</em> には <a href="../Pages/Page_83955854.html">fdes ファイル</a>の各キーワードが入ります。<br /> 値も fdes ファイルと同じです。<br /> たとえば、NINTENDO_EXPORT_OPTION_export_target には<br /> all または selection が格納されます。<br /> 以下のキーワードには対応していません。<br /> settings_version、date_time、show_preset_ui<br /> output_file_name、output_folder<br /> output_fmd/ftx/fsk/fvb/fcl/fts/ftp/fsh/fsn<br /> pre_export_script、post_export_script、lock_*</td>
    </tr>
  </tbody>
</table>
<p>一時的にスクリプトを無効にしたい場合は行頭に「&ndash;」を記述します。</p>
<table class="codeblock">
  <tbody>
    <tr>
      <td class="code">
        <div class="codeblock"><pre>--select $Box001</pre></div>
      </td>
    </tr>
  </tbody>
</table>
<p>MAX Script ファイルを実行するには fileIn コマンドを使用します。</p>
<table class="codeblock">
  <tbody>
    <tr>
      <td class="code">
        <div class="codeblock"><pre>fileIn &quot;D:/data/post_export1.ms&quot;</pre></div>
      </td>
    </tr>
  </tbody>
</table>
<p>DOSCommand, hiddenDOSCommand コマンド経由で Windows のバッチファイルを実行することもできます。</p>
<table class="codeblock">
  <tbody>
    <tr>
      <td class="code">
        <div class="codeblock"><pre>// コマンドプロンプトを表示しない場合
hiddenDOSCommand &quot;D:/data/post_export1.bat&quot; 

// コマンドプロンプトを表示する場合
DOSCommand &quot;D:/data/post_export1.bat&quot;

// バッチファイルバッチファイルの終了を待たない場合
DOSCommand &quot;start D:/data/post_export1.bat&quot;
hiddenDOSCommand &quot;start D:/data/post_export1.bat&quot; 
または
hiddenDOSCommand &quot;D:/data/post_export1.bat&quot; donotwait:true</pre></div>
      </td>
    </tr>
  </tbody>
</table>
<p>Windows のバッチファイル内でも上記の環境変数を使用できます。</p>
<table class="codeblock">
  <tbody>
    <tr>
      <td class="code">
        <div class="codeblock"><pre>rem バッチファイルで各 ftx ファイルのフルパスを使用する例です。

for %%I in (%NINTENDO_EXPORT_FTX_FILE_NAMES%) do (
&nbsp;&nbsp;&nbsp;&nbsp;echo %NINTENDO_EXPORT_FTX_FOLDER%%%I
)</pre></div>
      </td>
    </tr>
  </tbody>
</table>
<p>
  <a name="Anchor_83955546_manage_options"></a>
</p>
<h2 id="Anchor_83955546_h2_3">オプション設定の管理</h2>
<p>オプションの設定をシーンに保存したり、<a href="../Pages/Page_83955854.html">3D DCC プラグイン出力設定ファイル</a>として入出力したりするには、オプションウィンドウの <strong>Settings</strong> メニューの項目を使用します。</p>
<p>
  <span class="embedded-file-wrapper ">
    <img src="../Attachments/Attach_83955546/94714594.png" class="embedded-image" />
  </span>
</p>
<h3 id="Anchor_83955546_h3_10">オプションの設定をシーンに保存する方法</h3>
<ul>
  <li>
    <strong>Save / Load Scene Settings</strong> が ON の場合（デフォルトは ON になっています）<br />シーンをセーブするときに、 最後に中間ファイルを出力したときのオプションの設定がシーンデータに保存されます。<br />そして、シーンをオープンしたときにシーンデータに保存されていたオプションの設定が現在の設定として読み込まれます。 <br />オプションの設定がシーンデータに保存されていない場合は、現在のオプションの設定が残ります。 また、オプションの設定を保存したシーンをインポートした際も、オプションの設定が読み込まれます。</li>
  <li>
    <strong>Save / Load Scene Settings</strong> が OFF の場合<br />最後に中間ファイルを出力したときのオプションの設定はシーンデータに保存されません。 また、シーンデータをオープンしたときも、オプションの設定は読み込まれません。<br /> <strong>Save / Load Scene Settings</strong> の ON,OFF に関わらず、最後に中間ファイルを出力したときのオプションの設定は、デフォルトの設定ファイルとして保存されます。<br />また、次の起動時もデフォルトの設定ファイルが読み込まれます。<br />デフォルトの設定ファイルはプラグイン設定フォルダ「 C:\Users\[ユーザー名]\AppData\Local\Autodesk\3dsMax\[maxのバージョン]\[国コード]\[言語コード]\plugcfg 」に「NintendoExport.fdes 」というファイル名で保存されます。</li>
  <li>
    <strong>Delete Scene Settings</strong> をクリック<br />シーンデータに保存されたオプションの設定を消去します。 <br />ただし、クリック後に、<strong>Save / Load Scene Settings</strong>をオフにしてシーンデータを保存した場合に限ります。<br />シーンデータを保存しなければ、クリックしても消去されません。</li>
  <li>
    <strong>Reset Settings</strong> をクリック<br />オプションの設定を初期値に戻します。</li>
  <li>
    <strong>Save Settings</strong> をクリック<br />オプションの設定をデフォルトの設定ファイルに保存します。また、<strong>Save / Load Scene Settings</strong> が ON の場合はシーンにも保存します。<br />（Export や Apply を行わないでオプションの設定を保存したい時に使います。）</li>
</ul>
<h3 id="Anchor_83955546_h3_11">オプションの設定を fdes ファイルとして入出力する方法</h3>
<p>オプションの設定を fdes ファイルに出力するには、<strong>Save Settings to fdes File</strong> をクリックします。<br />ファイル選択ウィンドウで出力ファイル名を指定すると出力されます。このとき、出力ファイルの拡張子が .fdes でなければ、自動的に .fdes が追加されます。</p>
<p>オプションの設定を fdes ファイルから入力するには、<strong>Load Settings from fdes File</strong> をクリックします。<br />ファイル選択ウィンドウで入力ファイル名を指定すると入力されます。このとき、Settings メニューの Save / Load Scene Settings が ON なら、オプションの設定をシーン中に保存した script ノードも更新されます。</p>
<h2 id="Anchor_83955546_h2_4">コンフィグファイル</h2>
<p>Tool\DccPlugin\3dsMaxPlugins\Config にある Export.ini&nbsp;を編集すると、エクスポートプラグインの動作をカスタマイズできます。</p>
<p>エクスポートプラグイン実行時に Export.ini が存在しなければ、同じフォルダの Export_Sample.ini が Export.ini にコピーされて読み込まれます。</p>
<p>コンフィグファイルの各行には、カスタマイズ項目に対応するキーワードと設定内容を表す値を次のように記述します。</p>
<table class="codeblock">
  <tbody>
    <tr>
      <td class="code">
        <div class="codeblock"><pre>キーワード=&quot;値&quot;</pre></div>
      </td>
    </tr>
  </tbody>
</table>
<p># から始まる行はコメント行で無視されます。</p>
<p>各キーワードについて説明します。</p>
<p>キーワードが存在しない場合はデフォルト値が使用されます。</p>
<ul>
  <li>
    <strong>display_profile<br /> </strong>出力時に各処理の処理時間をリスナーウィンドウに表示するなら true、表示しないなら false を指定します。デフォルトは false です。<br /></li>
  <li>
    <strong>project_root<br /></strong>アプリケーションのプロジェクトのルートフォルダを指定します（3ds Max のプロジェクトフォルダではありません）。&nbsp;<br />指定した場合、中間ファイルの &lt;create&gt; の src_path にルートフォルダからの相対パスを出力します。空文字なら絶対パスを出力します。% で囲われた環境変数を含めることもできます。&nbsp;&nbsp;</li>
  <li>
    <strong>max_vertex_skinning_count<br /> </strong>スキニングのウェイト値を分配可能な最大ノード数を 1 以上 8 以下の整数値で指定します。<br />  指定した値を超える数のノードにウェイト値が分配されていればエラーになります。<br />  ただし、8 を指定した場合は、9 ノード以上に分配されていてもエラーにはならず、ウェイト値の大きい順に 8 ノードまでが反映されます。<br />  デフォルトは 8 です。</li>
  <li>
    <strong>adjust_smooth_skinning<br /> </strong>3ds Max 上のノード単位で中間ファイルのシェイプがスムーススキニングか判定するなら true、シェイプ（マテリアルが同じポリゴン群）単位で判定するなら false を指定します。デフォルトは false です。<br />  スムーススキニングとリジッドスキニングの計算の誤差によるドット欠けが目立つ場合は true を指定します。</li>
  <li>
    <p>
      <strong>optimize_primitive<br /> </strong>プリミティブ最適化のモードを指定します。</p>
    <table class="table">
      <thead>
        <tr>
          <th>モード</th>
          <th>説明</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td class="nowrap">
            <strong>none</strong>
          </td>
          <td>プリミティブ最適化をしません。</td>
        </tr>
        <tr>
          <td class="nowrap">
            <strong>default</strong>
          </td>
          <td>通常のプリミティブ最適化をします。</td>
        </tr>
        <tr>
          <td class="nowrap">
            <strong>force</strong>
          </td>
          <td>時間を掛けてプリミティブ最適化をします。</td>
        </tr>
        <tr>
          <td class="nowrap">
            <strong>brute_force</strong>
          </td>
          <td>より長い時間を掛けてプリミティブ最適化をします。</td>
        </tr>
        <tr>
          <td class="nowrap">
            <strong>forsyth</strong>
          </td>
          <td>Forsyth アルゴリズムでプリミティブ最適化をします。</td>
        </tr>
      </tbody>
    </table>
    <p>デフォルトは default です。</p>
  </li>
  <li>
    <strong>quantization_analysis<br /> </strong>量子化分析を有効にするなら true、無効にするなら false を指定します。デフォルトは true です。</li>
  <li>
    <strong>texture_ヒント情報<br /> </strong>テクスチャのヒント情報ごとにガンマのリニア変換を指定します。<br />  ガンマを sRGB からリニアに変換するなら 1、変換しないなら 0 を RGBA の順に 4 文字で指定します。<br />  たとえば 1110 とすると、RGB 成分は変換しますが A 成分は変換しません。<br />  デフォルトはヒント情報が albedo、emission、specular、reflection なら 1110、その他なら 0000（どの成分も変換しない）です。</li>
  <li>
    <strong>use_srgb_fetch<br /> </strong>テクスチャのガンマのリニア変換指定が 1110 で、グレースケール画像でない場合に srgb_* フォーマットを使用するなら true、 unorm_* フォーマットを使用するなら false を指定します。デフォルトは true です。</li>
  <li>
    <strong>enable_weighted_compress<br /></strong>bc1、bc2、bc3 フォーマットのテクスチャを圧縮する際に、RGB の誤差に対して人間の目に合わせた重み付けをするなら true、重み付けをしないなら false を指定します。デフォルトは false です。<br /></li>
  <li>
    <strong>filter_mip<br /> </strong>テクスチャのミップマップが有効な場合のミップマップフィルタを point または linear で指定します。デフォルトは linear です。<br /></li>
  <li>
    <strong>use_fcl_fts_ftp<br /></strong>マテリアルアニメーションの種類ごとに異なる拡張子の中間ファイルに出力するなら true、すべて fma ファイルに出力するなら false を指定します。デフォルトは true です。<br />true の場合、カラーアニメーションを fcl ファイル、テクスチャ SRT アニメーションを fts ファイル、テクスチャパターンアニメーションを ftp ファイルに出力します。</li>
  <li>
    <strong>separate_material_anim<br /></strong>マテリアルアニメーションの種類ごとに個別の fma ファイルに出力するなら true、1 つの fma ファイルに全マテリアルアニメーションを出力するなら false&nbsp;を指定します。デフォルトは false です。<br />true の場合、出力ファイル名に既定のサフィックスが追加されます（カラーアニメーションは _fcl、テクスチャ SRT アニメーションは _fts、テクスチャパターンアニメーションは _ftp）。<br />use_fcl_fts_ftp が true の場合、このキーワードは無視されます。&nbsp;</li>
  <li>
    <strong>export_bone_visibility_all<br /></strong>すべてのノードのボーンビジビリティアニメーションをバイナリファイルに出力するなら true、可視性にアニメーションが設定されているノードのみ出力するなら false を指定します。デフォルトは true です。</li>
  <li>
    <strong>warning_node_name_changed<br /> </strong>ノード名を変更して出力した場合に警告を表示するなら true、警告を表示しないなら false を指定します。デフォルトは true です。</li>
</ul>
<h2 id="Anchor_83955546_h2_5">関連リンク</h2>
<p> <a href="../Pages/Page_83955545.html">エクスポートプラグイン</a> </p>
</div>
<div class="breadcrumb_bottom"></div>
<div class="page_navigation">
<table class="page_navi_root">
<tr>
<td class="page_navi_left"></td>
<td class="page_navi_right"></td>
</tr>
<tr><td colspan="2" class="page_navi_bottom"></td></tr>
</table>
</div>
</div>
</div>
</body>
</html>
