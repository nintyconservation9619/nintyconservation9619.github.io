<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<script type="text/javascript" src="../template/js/jquery/jquery.js"></script>
<script type="text/javascript" src="../template/js/common/manualLib.js"></script>
<script type="text/javascript" src="../tocData.js"></script>
<link rel="stylesheet" type="text/css" href="../template/css/template.css" />
<title>RunOnTarget</title>
</head>
<body data-reassemble="autoindex=no,forceNoLabel=yes">
<div id="autoindex_content">
<div class="body_content">
<noscript>
<div style="border: 4px double black; margin: 4px; padding: 2px; font-weight: bold; background-color: #FFFFCC;">
<p>お使いのブラウザは JavaScript が使用できないため、本ドキュメントの一部機能が無効になっています。</p><p>JavaScript が無効の環境では目次を使用することができません。<br />JavaScriptの実行が許可された状態で閲覧してください。<br /><br /></p>
</div>
</noscript>
<div class="page_navigation_top">
<table class="page_navi_root">
<tr>
<td class="page_navi_left"></td>
<td class="page_navi_right"></td>
</tr>
</table>
</div>
<div class="breadcrumb"></div>

<!-- RunOnTarget -->
<div class="pagetitle" id="PageId_107320466">RunOnTarget</div>
<div class="text_separate">
<p>
  <ul class="macro_toc">
    <li>
      <a href="#Anchor_107320466_h1_1">概要</a>
    </li>
    <ul>
      <li>
        <a href="#Anchor_107320466_h2_1">パッケージ</a>
      </li>
      <li>
        <a href="#Anchor_107320466_h2_2">配置</a>
      </li>
      <li>
        <a href="#Anchor_107320466_h2_3">対応プラットフォーム</a>
      </li>
    </ul>
    <li>
      <a href="#Anchor_107320466_h1_2">使い方</a>
    </li>
    <li>
      <a href="#Anchor_107320466_h1_3">終了ステータス</a>
    </li>
    <li>
      <a href="#Anchor_107320466_h1_4">使用例</a>
    </li>
    <ul>
      <li>
        <a href="#Anchor_107320466_h2_4">基本的な実行</a>
      </li>
      <li>
        <a href="#Anchor_107320466_h2_5">Raw形式の実行</a>
      </li>
      <li>
        <a href="#Anchor_107320466_h2_6">ゲームカードアプリケーションの実行</a>
      </li>
      <li>
        <a href="#Anchor_107320466_h2_7">インストールされたアプリケーションの実行</a>
      </li>
      <li>
        <a href="#Anchor_107320466_h2_8">プログラム引数を渡す実行</a>
      </li>
      <li>
        <a href="#Anchor_107320466_h2_9">終了を待たない実行</a>
      </li>
      <li>
        <a href="#Anchor_107320466_h2_10">特定の開発機上での実行</a>
      </li>
      <li>
        <a href="#Anchor_107320466_h2_11">リセット後の実行</a>
      </li>
      <li>
        <a href="#Anchor_107320466_h2_12">タイムアウトを指定した実行</a>
      </li>
      <li>
        <a href="#Anchor_107320466_h2_13">特定のログ出力を終了条件とした実行</a>
      </li>
      <li>
        <a href="#Anchor_107320466_h2_14">特定のログ出力がなかった場合に失敗させる</a>
      </li>
    </ul>
    <li>
      <a href="#Anchor_107320466_h1_5">第1プログラム引数について</a>
    </li>
    <li>
      <a href="#Anchor_107320466_h1_6">オプション</a>
    </li>
  </ul>
</p>
<h1 id="Anchor_107320466_h1_1">概要</h1>
<p>RunOnTarget は、開発機上でプログラムを実行するためのコマンドラインツールです。</p>
<p>自動テストの用途で使うことを目的に複数の終了条件を設定することが可能です。</p>
<h2 id="Anchor_107320466_h2_1">パッケージ</h2>
<p>RunOnTarget は、NintendoSDK NX Addon で提供されます。</p>
<h2 id="Anchor_107320466_h2_2">配置</h2>
<table class="codeblock">
  <tbody>
    <tr>
      <td class="code">
        <div class="codeblock"><pre>$NINTENDO_SDK_ROOT/Tools/CommandLineTools/RunOnTarget.exe</pre></div>
      </td>
    </tr>
  </tbody>
</table>
<h2 id="Anchor_107320466_h2_3">対応プラットフォーム</h2>
<p>NX プラットフォームに対応しています。</p>
<h1 id="Anchor_107320466_h1_2">使い方</h1>
<div style="border-width: 1px;" class="preformatted panel">
  <div class="preformattedContent panelContent">
    <pre>Usage: RunOnTarget.exe [-t&lt;arg&gt;] [--suppress-auto-kill]
          [--env=&lt;arg&gt;] [--no-wait] [--success-timeout=&lt;arg&gt;]
          [--failure-timeout=&lt;arg&gt;]
          [--pattern-success-exit=&lt;arg&gt;]...
          [--pattern-failure-exit=&lt;arg&gt;]...
          [--pattern-reset-success-timeout=&lt;arg&gt;]...
          [--pattern-reset-failure-timeout=&lt;arg&gt;]...
          [--pattern-not-found-failure=&lt;arg&gt;]... [--filter=&lt;arg&gt;]
          [--reset] [--connect-timeout=&lt;arg&gt;] [-v] [--enable-aslr]
          [--disable-aslr] &lt;Program&gt; [--] [&lt;Arguments&gt;...]</pre>
  </div>
</div>
<h1 id="Anchor_107320466_h1_3">終了ステータス</h1>
<p>自動テストに組み込むことを目的として RunOnTarget は以下の終了ステータスになります。</p>
<table class="wrapped">
  <colgroup>
    <col />
    <col />
  </colgroup>
  <tbody>
    <tr>
      <th>条件</th>
      <th>値</th>
    </tr>
    <tr>
      <td>アプリケーションが正常終了した場合</td>
      <td>0</td>
    </tr>
    <tr>
      <td>それ以外</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
<h1 id="Anchor_107320466_h1_4">使用例</h1>
<h2 id="Anchor_107320466_h2_4">基本的な実行</h2>
<p>ビルドしたアプリケーションの &quot;.nsp&quot; ファイルを引数に渡すことでそのアプリケーションを実行できます。</p>
<div style="border-width: 1px;" class="preformatted panel">
  <div class="preformattedContent panelContent">
    <pre>$ RunOnTarget.exe HelloWorld.nsp
Hello World.
$</pre>
  </div>
</div>
<p>アプリケーションからのログを標準出力に出力し、アプリケーションが終了すると RunOnTarget も終了します。</p>
<div class="note_new">
  <div class="note_new_left">注意：</div>
  <div class="note_new_right">
    <p>NX Addon 1.0.0 から .nca でのアプリケーションの実行をサポートしていません。アプリケーションの実行には .nsp を使用してください。</p>
  </div>
</div>
<h2 id="Anchor_107320466_h2_5">Raw形式の実行</h2>
<p>
  <a href="../Pages/Page_107320222.html">&quot;.nspd&quot; ディレクトリ</a>を指定することで、&quot;.nsp&quot; ファイルにアーカイブされる前のディレクトリ形式のアプリケーションを実行できます。</p>
<p>個別のファイルのみ更新して実行することができるため、短いサイクルでビルドと実行を繰り返すことが出来ます。</p>
<div style="border-width: 1px;" class="preformatted panel">
  <div class="preformattedContent panelContent">
    <pre>$ RunOnTarget.exe HelloWorld.nspd
Hello World.
$</pre>
  </div>
</div>
<h2 id="Anchor_107320466_h2_6">ゲームカードアプリケーションの実行</h2>
<p>引数に &quot;gamecard&quot; と指定することで、ゲームカードに書き込まれているアプリケーションを実行できます。</p>
<div style="border-width: 1px;" class="preformatted panel">
  <div class="preformattedContent panelContent">
    <pre>$ RunOnTarget.exe gamecard</pre>
  </div>
</div>
<h2 id="Anchor_107320466_h2_7">インストールされたアプリケーションの実行</h2>
<p>引数にアプリケーションIDを指定することで、内蔵ストレージ等にインストールされたアプリケーションを実行できます。</p>
<div style="border-width: 1px;" class="preformatted panel">
  <div class="preformattedContent panelContent">
    <pre>$ RunOnTarget.exe 0x0100000000002802
 </pre>
  </div>
</div>
<h2 id="Anchor_107320466_h2_8">プログラム引数を渡す実行</h2>
<p>&nbsp;作成したアプリケーションにプログラム引数を渡すことが出来ます。</p>
<p>プログラム引数を渡すことで、起動時にアプリケーションの動作を変更することが出来ます。</p>
<p>アプリケーション内のコード上でプログラム引数を取得するには <span class="ApiLink_nn__os__GetHostArgc">nn::os::GetHostArgc</span>() と <span class="ApiLink_nn__os__GetHostArgv">nn::os::GetHostArgv</span>() を使用します。</p>
<div style="border-width: 1px;" class="preformatted panel">
  <div class="preformattedContent panelContent">
    <pre>$ RunOnTarget.exe app.nsp -- --input TestData.bin</pre>
  </div>
</div>
<p>&quot;--input&quot; のようなオプション表記のプログラム引数を渡す場合には、 &quot;--&quot; 以降にプログラム引数を記述してください。 &quot;--&quot; 以降のプログラム引数は全てアプリケーションに渡されます。 &quot;--&quot; 以前に置かれたオプション表記のプログラム引数は RunOnTarget の引数として扱われます。</p>
<h2 id="Anchor_107320466_h2_9">終了を待たない実行</h2>
<p>--no-wait オプションを使うとアプリケーションの終了を待たずに RunOnTarget は終了します。開発したアプリケーションを起動することが目的で、ログ出力を見る必要が無い場合に使用します。</p>
<div style="border-width: 1px;" class="preformatted panel">
  <div class="preformattedContent panelContent">
    <pre>$ RunOnTarget.exe app.nsp --no-wait
$</pre>
  </div>
</div>
<h2 id="Anchor_107320466_h2_10">特定の開発機上での実行</h2>
<p>--target を使用することで、特定の開発機上で実行します。 使用可能な開発機 は<a href="../Pages/Page_107334824.html">ControlTarget</a> を使用して探します。</p>
<p>開発機の名前、または、開発機のIPアドレスを使用して、実行する開発機を指定できます。</p>
<div style="border-width: 1px;" class="preformatted panel">
  <div class="preformattedContent panelContent">
    <pre>$ ControlTarget.exe list-target
XAWF0111100014       192.168.10.11
40-D2-8A-B4-60-3E    192.168.10.12

$ ControlTarget.exe detect-target
XAWF0111100014       192.168.10.11
40-D2-8A-B4-60-3E    192.168.10.12

$ RunOnTarget.exe app.nsp --target XAWF0111100014
$ RunOnTarget.exe app.nsp --target 192.168.10.12</pre>
  </div>
</div>
<h2 id="Anchor_107320466_h2_11">リセット後の実行</h2>
<p>--reset を使用することで、開発機を再起動した後にアプリケーションを実行します。</p>
<p>開発機の状態を起動直後の状態に戻したい場合や、開発機の状態に異常が発生している場合に使用します。</p>
<div style="border-width: 1px;" class="preformatted panel">
  <div class="preformattedContent panelContent">
    <pre>$ RunOnTarget.exe app.nsp --reset</pre>
  </div>
</div>
<h2 id="Anchor_107320466_h2_12">タイムアウトを指定した実行</h2>
<p>--failure-timeout または、 --success-timeout を使用することで、アプリケーションの実行時間に制限を設けることができます。</p>
<p>自動テストで実行時間に制限を設けたい場合に使用します。</p>
<p>以下の例では、３０秒間 アプリケーションが終了しなかった場合に、RunOnTarget の実行は失敗したものとして終了します。</p>
<div style="border-width: 1px;" class="preformatted panel">
  <div class="preformattedContent panelContent">
    <pre>$ RunOnTarget.exe app.nsp --failure-timeout 30</pre>
  </div>
</div>
<h2 id="Anchor_107320466_h2_13">特定のログ出力を終了条件とした実行</h2>
<p>--pattern-failure-exit または、 --pattern-success-exit を使用することで、正規表現にマッチする特定のログが出力された時に RunOnTarget を終了することができます。</p>
<p>以下の例は、 &quot;Assert&quot; や &quot;Break&quot; 等の文字列がログとして出力されたときに RunOnTarget は失敗したものとして終了し、 &quot;Success&quot; がログとして出力されたときに成功したものとして終了します。</p>
<div style="border-width: 1px;" class="preformatted panel">
  <div class="preformattedContent panelContent">
    <pre>$ RunOnTarget.exe app.nsp
    --pattern-failure-exit &quot;Assert|Break|Panic|Halt|Fatal&quot;
    --pattern-success-exit &quot;Success&quot;</pre>
  </div>
</div>
<p>自動テストでアプリケーションが停止した場合はその場でテスト実行を終了したい場合に使用できます。</p>
<p>これらの引数は複数回指定することができ、また組み合わせることができます。 以下の例は、ストレステストを１時間走らせる例です。</p>
<div style="border-width: 1px;" class="preformatted panel">
  <div class="preformattedContent panelContent">
    <pre>$ RunOnTarget.exe StressTest.nsp
    --success-timeout 3600
    --pattern-failure-exit &quot;Assert|Break|Panic|Halt|Fatal&quot;
    --pattern-failure-exit &quot;FAIL|Fail&quot;
    --pattern-failure-exit &quot;Exception|Error&quot;</pre>
  </div>
</div>
<p>１時間の間にアプリケーションが失敗と思われるログ出力を行った場合に、 RunOnTarget はその場で失敗扱いで終了します。</p>
<p>１時間の間、失敗を表すログ出力がない場合に、 RunOnTarget は成功扱いで終了します。</p>
<h2 id="Anchor_107320466_h2_14">特定のログ出力がなかった場合に失敗させる</h2>
<p>--pattern-not-found-failure を使用することで、指定したパターンが出現しなかった場合に RunOnTarget を失敗扱いで終了させることができます。</p>
<p>アプリケーションをテストを目的として、期待した処理が行われないままアプリケーションが終了してしまうことを検出できます。</p>
<p>以下は、サーバーへの接続のログが出ないままアプリケーションが終了した場合に失敗となります。</p>
<div style="border-width: 1px;" class="preformatted panel">
  <div class="preformattedContent panelContent">
    <pre>$ RunOnTarget.exe app.nsp
    --pattern-not-found-failure &quot;Connected to SOME service.&quot;
</pre>
  </div>
</div>
<h1 id="Anchor_107320466_h1_5">第1プログラム引数について</h1>
<p>アプリケーションに渡した1つ目のプログラム引数は、多くの場合実行しているアプリケーション自身の名前が渡されますが、具体的な値は実行方法によって以下のように変化します。</p>
<ul>
  <li>nsp を渡した場合は、nsp のパスが入ります。</li>
  <li>nspd を渡した場合は、 nspd のパスが入ります。</li>
  <li>インストールされたアプリケーションを ApplicationId を指定して実行した場合は ApplicationId が入ります。</li>
  <li>製品機相当の環境では空文字列が入ります。</li>
</ul>
<h1 id="Anchor_107320466_h1_6">オプション</h1>
<table class="wrapped">
  <colgroup>
    <col />
    <col />
  </colgroup>
  <tbody>
    <tr>
      <th>名前</th>
      <th>説明</th>
    </tr>
    <tr>
      <td>
        <pre>-t, --target</pre>
      </td>
      <td>
        <p>開発機を指定します。</p>
        <p>使用可能な開発機は ControlTarget.exe list-target で確認できます。</p>
      </td>
    </tr>
    <tr>
      <td>
        <pre>--no-wait</pre>
      </td>
      <td>開発機の実行結果を待たずに対象のプログラムを実行します。<br />複数のプログラムを実行したい場合や、ログを別の経路で取得している場合に使用します。</td>
    </tr>
    <tr>
      <td>
        <pre>--success-timeout &lt;arg&gt;</pre>
      </td>
      <td>
        <p>指定した時間（秒）を経過したら成功扱いで RunOnTarget を終了します。</p>
        <p>エージングテスト等で指定時間異常が無かったら成功扱いとする場合に使用します。</p>
      </td>
    </tr>
    <tr>
      <td>
        <pre>--failure-timeout &lt;arg&gt;</pre>
      </td>
      <td>
        <p>指定した時間（秒）を経過したら失敗扱いで RunOnTarget を終了します。</p>
        <p>短時間で成功して終了するはずのテストが終了しない場合に備えて使用します。</p>
      </td>
    </tr>
    <tr>
      <td>
        <pre>--pattern-success-exit &lt;arg&gt;</pre>
      </td>
      <td>
        <p>指定した文字列（.NET の正規表現）を見つけたら成功扱いで終了します。</p>
        <p>プログラムの終了を適切に拾えない場合や<br />ログ出力を使って成功を検出しないといけない場合に使用します。</p>
      </td>
    </tr>
    <tr>
      <td>
        <pre>--pattern-failure-exit &lt;arg&gt;</pre>
      </td>
      <td>
        <p>指定した文字列（.NET の正規表現）を見つけたら失敗扱いで終了します。</p>
        <p>プログラムとして正常に終了している場合でもログに異常があったら失敗扱いとしたい場合に使用します。</p>
      </td>
    </tr>
    <tr>
      <td>
        <pre>--pattern-reset-success-timeout &lt;arg&gt;</pre>
      </td>
      <td>
        <p>ログ出力を元に成功タイムアウトの時間をリセットします。</p>
        <p>通信エラー等のリトライがある時にテストの実行時間を延長する場合などに使用します。</p>
      </td>
    </tr>
    <tr>
      <td>
        <pre>--pattern-reset-failure-timeout &lt;arg&gt;</pre>
      </td>
      <td>
        <p>ログ出力を元に失敗タイムアウトの時間をリセットします。</p>
        <p>通信エラー等のリトライがある時にテストの実行時間を延長する場合などに使用します。</p>
      </td>
    </tr>
    <tr>
      <td>
        <pre>--pattern-not-found-failure</pre>
      </td>
      <td>
        <p>指定したログが出力されないままプログラムが終了した場合に、RunOnTarget を失敗扱いで終了します。</p>
        <p>プログラムの終了以外の条件で終了した場合はこのオプションは機能しません。</p>
        <p>
          <br />
        </p>
        <p>複数回指定することができ、この場合は、すべてのパターンが見つかった場合のみ成功扱いで終了します。</p>
        <p>一つでも見つからなかったら失敗扱いで終了します。</p>
      </td>
    </tr>
    <tr>
      <td>--filter &lt;arg&gt;</td>
      <td>
        <p>フィルタ式に適合するログのみを、出力するようにします。</p>
        <p>フィルタ式の文法については、<a href="../Pages/Page_163415826.html">Log Viewer</a>のフィルタリングの項目を参照してください。</p>
      </td>
    </tr>
    <tr>
      <td>
        <pre>--reset</pre>
      </td>
      <td>開発機をリセットした後にプログラムを実行します。</td>
    </tr>
    <tr>
      <td>
        <pre>--connect-timeout &lt;arg&gt;</pre>
      </td>
      <td>
        <p>指定した回数開発機への接続を試行し、成功しなかった場合失敗扱いで RunOnTarget を終了します。</p>
        <p>指定しない場合は 15 回接続試行が行われます。</p>
      </td>
    </tr>
    <tr>
      <td>
        <pre>-v, --verbose </pre>
      </td>
      <td>
        <p>詳細なログを出力します。</p>
        <p>タイムアウトの残り時間等を表示するようになります。</p>
      </td>
    </tr>
    <tr>
      <td>
        <pre>--env</pre>
      </td>
      <td>ターゲット環境変数定義ファイルのパスを指定します。絶対パスでも相対パスでも指定できます。<br />ターゲット環境変数については<a href="../Pages/Page_124013919.html">ターゲット環境変数</a>および<a href="../Pages/Page_124021418.html">ターゲット環境変数（NX Addon）</a>を参照してください。</td>
    </tr>
    <tr>
      <td>--enable-aslr</td>
      <td>
        <p>ASLR(A<span style="color: rgb(34,34,34);">ddress Space Layout Randomization</span>) を有効化します。<br />オプションを指定しない場合のデフォルトの挙動でも ASLR は有効です。</p>
      </td>
    </tr>
    <tr>
      <td>--disable-aslr</td>
      <td>ASLR(A<span style="color: rgb(34,34,34);">ddress Space Layout Randomization</span>) を無効化します。<br />オプションを指定しない場合のデフォルトの挙動としては ASLR は有効です。<br />製品環境では常に ASLR は有効です。このオプションはデバッグ目的にのみ使用してください。<br />ASLR を含むプログラムの起動時の動作の詳細については、<a href="../Pages/Page_92310396.html">プログラムの起動と初期化</a> を参照してください。<br /></td>
    </tr>
    <tr>
      <td>--suppress-auto-kill</td>
      <td>事前に起動していたアプリケーションを終了させることなく、次のプログラムの起動を試みます。<br />一つの開発機に接続可能な RunOnTarget は一つのみであり、開発機場で同時に起動可能なアプリケーションは1つのみです。<br />このため、このオプションが使用可能な状況は限られています。<br /><a href="../Pages/Page_107328760.html">DevMenuCommand</a> の一部のコマンドで有効に使える場合がありますので、詳細はそちらを参照してください。</td>
    </tr>
    <tr>
      <td>--</td>
      <td>
        <p>このオプションが現れた位置より後ろにあるプログラム引数は、すべてアプリケーションのプログラム引数として扱います。</p>
        <p>&quot;--verbose&quot; や &quot;--reset&quot; など RunOnTarget のオプションとして扱われる引数をアプリケーションに渡したい場合に使用します。</p>
      </td>
    </tr>
  </tbody>
</table>
<p>
  <br />
</p>
<p>
  <br />
</p>
</div>
<div class="breadcrumb_bottom"></div>
<div class="page_navigation">
<table class="page_navi_root">
<tr>
<td class="page_navi_left"></td>
<td class="page_navi_right"></td>
</tr>
<tr><td colspan="2" class="page_navi_bottom"></td></tr>
</table>
</div>
</div>
</div>
<!--AddLink-->
<script>
var NintendoSdkApiRefernce = {
    idMap: {},
    linkRewrite: function ()
    {
        var idMap = NintendoSdkApiRefernce.idMap;
        function rewrite(el)
        {
            var e = idMap[el.className];
            if (e === undefined)
            {
                return;
            }
            var html = '';
            html += '<a href=';
            html += e.url;
            html += ' target="_blank">';
            html += el.innerHTML;
            html += '</a>';
            el.innerHTML = html;
        }
        var apiLinkElems = document.querySelectorAll('span[class*="ApiLink_"]');
        for (var i = 0, n = apiLinkElems.length; i< n; ++i) {
            rewrite(apiLinkElems[i]);
        }
    }
};
function SetUrl( id, url )
{
    NintendoSdkApiRefernce.idMap[id] = { url: url };
}
SetUrl( 'ApiLink_nn__os__GetHostArgc', '../../../Api/HtmlNX/namespacenn_1_1os.html#acf2fa6b7b7074a51d0b2de1664cc7bb5' )
SetUrl( 'ApiLink_nn__os__GetHostArgv', '../../../Api/HtmlNX/namespacenn_1_1os.html#abd77e6bf19be140867869cc759fa492c' )

NintendoSdkApiRefernce.linkRewrite();
</script>
<!--AddLink-->
</body>
</html>
