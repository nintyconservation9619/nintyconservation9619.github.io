<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<script type="text/javascript" src="../template/js/jquery/jquery.js"></script>
<script type="text/javascript" src="../template/js/common/manualLib.js"></script>
<script type="text/javascript" src="../tocData.js"></script>
<link rel="stylesheet" type="text/css" href="../template/css/template.css" />
<title>シーケンスコマンド</title>
</head>
<body data-reassemble="autoindex=no,forceNoLabel=yes">
<div id="autoindex_content">
<div class="body_content">
<noscript>
<div style="border: 4px double black; margin: 4px; padding: 2px; font-weight: bold; background-color: #FFFFCC;">
<p>お使いのブラウザは JavaScript が使用できないため、本ドキュメントの一部機能が無効になっています。</p><p>JavaScript が無効の環境では目次を使用することができません。<br />JavaScriptの実行が許可された状態で閲覧してください。<br /><br /></p>
</div>
</noscript>
<div class="page_navigation_top">
<table class="page_navi_root">
<tr>
<td class="page_navi_left"></td>
<td class="page_navi_right"></td>
</tr>
</table>
</div>
<div class="breadcrumb"></div>

<!-- シーケンスコマンド -->
<div class="pagetitle" id="PageId_83955769">シーケンスコマンド</div>
<div class="text_separate">
<h1 id="Anchor_83955769_h1_1">目次</h1>
<p>
  <ul class="macro_toc">
    <li>
      <a href="#Anchor_83955769_h2_1">ノートコマンド</a>
    </li>
    <li>
      <a href="#Anchor_83955769_h2_2">休符コマンド</a>
    </li>
    <li>
      <a href="#Anchor_83955769_h2_3">シーケンスの終了</a>
    </li>
    <li>
      <a href="#Anchor_83955769_h2_4">プログラムチェンジ</a>
    </li>
    <li>
      <a href="#Anchor_83955769_h2_5">テンポチェンジ</a>
    </li>
    <li>
      <a href="#Anchor_83955769_h2_6">タイムベース</a>
    </li>
    <li>
      <a href="#Anchor_83955769_h2_7">トラックボリューム</a>
    </li>
    <li>
      <a href="#Anchor_83955769_h2_8">メインボリューム</a>
    </li>
    <li>
      <a href="#Anchor_83955769_h2_9">ピッチベンド</a>
    </li>
    <li>
      <a href="#Anchor_83955769_h2_10">トランスポーズ</a>
    </li>
    <li>
      <a href="#Anchor_83955769_h2_11">ベロシティレンジ</a>
    </li>
    <li>
      <a href="#Anchor_83955769_h2_12">トラックパン</a>
    </li>
    <li>
      <a href="#Anchor_83955769_h2_13">トラックサラウンドパン</a>
    </li>
    <li>
      <a href="#Anchor_83955769_h2_14">トラックイニシャルパン</a>
    </li>
    <li>
      <a href="#Anchor_83955769_h2_15">発音プライオリティ</a>
    </li>
    <li>
      <a href="#Anchor_83955769_h2_16">タイモード</a>
    </li>
    <li>
      <a href="#Anchor_83955769_h2_17">モノフォニックモード</a>
    </li>
    <li>
      <a href="#Anchor_83955769_h2_18">ノートウェイトモード</a>
    </li>
    <li>
      <a href="#Anchor_83955769_h2_19">ダンパーペダル</a>
    </li>
    <li>
      <a href="#Anchor_83955769_h2_20">ポルタメント</a>
    </li>
    <li>
      <a href="#Anchor_83955769_h2_21">スイープ</a>
    </li>
    <li>
      <a href="#Anchor_83955769_h2_22">LPF カットオフ周波数</a>
    </li>
    <li>
      <a href="#Anchor_83955769_h2_23">biquad フィルタ</a>
    </li>
    <li>
      <a href="#Anchor_83955769_h2_24">エフェクトセンド A～C</a>
    </li>
    <li>
      <a href="#Anchor_83955769_h2_25">メインセンド</a>
    </li>
    <li>
      <a href="#Anchor_83955769_h2_26">トラック確保</a>
    </li>
    <li>
      <a href="#Anchor_83955769_h2_27">トラック起動</a>
    </li>
    <li>
      <a href="#Anchor_83955769_h2_28">シーケンスジャンプ</a>
    </li>
    <li>
      <a href="#Anchor_83955769_h2_29">シーケンス呼び出し</a>
    </li>
    <li>
      <a href="#Anchor_83955769_h2_30">ループ</a>
    </li>
    <li>
      <a href="#Anchor_83955769_h2_31">エンベロープ</a>
    </li>
    <li>
      <a href="#Anchor_83955769_h2_32">エンベロープ無効化</a>
    </li>
    <li>
      <a href="#Anchor_83955769_h2_33">モジュレーション</a>
    </li>
    <li>
      <a href="#Anchor_83955769_h2_34">トラックミュート</a>
    </li>
    <li>
      <a href="#Anchor_83955769_h2_35">ユーザープロセス呼び出し</a>
    </li>
    <li>
      <a href="#Anchor_83955769_h2_36">バンクセレクト</a>
    </li>
  </ul>
</p>
<h1 id="Anchor_83955769_h1_2">シーケンスコマンド</h1>
<p>シーケンスコマンドは、テキストシーケンスで使うコマンド群です。</p>
<p>表 2 シーケンスコマンド一覧表</p>
<table class="table">
  <thead>
    <tr>
      <th>
        <p>コマンド名</p>
      </th>
      <th>
        <p>説明</p>
      </th>
      <th>
        <p>既定値</p>
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        <p>cn4 <em>velocity</em>, <em>length</em></p>
      </td>
      <td>
        <p>ノートコマンド</p>
      </td>
      <td>
        <p>&nbsp;</p>
      </td>
    </tr>
    <tr>
      <td>
        <p>wait <em>length</em></p>
      </td>
      <td>
        <p>休符コマンド</p>
      </td>
      <td>
        <p>&nbsp;</p>
      </td>
    </tr>
    <tr>
      <td>
        <p>fin</p>
      </td>
      <td>
        <p>シーケンスの終了</p>
      </td>
      <td>
        <p>&nbsp;</p>
      </td>
    </tr>
    <tr>
      <td>
        <p>prg <em>x</em></p>
      </td>
      <td>
        <p>プログラムチェンジ</p>
      </td>
      <td>
        <p>0</p>
      </td>
    </tr>
    <tr>
      <td>
        <p>tempo <em>x</em></p>
      </td>
      <td>
        <p>テンポチェンジ</p>
      </td>
      <td>
        <p>120</p>
      </td>
    </tr>
    <tr>
      <td>
        <p>timebase <em>x</em></p>
      </td>
      <td>
        <p>タイムベースを変更</p>
      </td>
      <td>
        <p>48</p>
      </td>
    </tr>
    <tr>
      <td>
        <p>volume <em>x</em></p>
      </td>
      <td>
        <p>トラックボリュームを変更</p>
      </td>
      <td>
        <p>127</p>
      </td>
    </tr>
    <tr>
      <td>
        <p>volume2 <em>x</em></p>
      </td>
      <td>
        <p>トラックボリュームを変更</p>
      </td>
      <td>
        <p>127</p>
      </td>
    </tr>
    <tr>
      <td>
        <p>main_volume <em>x</em></p>
      </td>
      <td>
        <p>プレイヤーのボリュームを変更</p>
      </td>
      <td>
        <p>127</p>
      </td>
    </tr>
    <tr>
      <td>
        <p>pitchbend <em>x</em></p>
      </td>
      <td>
        <p>ピッチベンドを変更</p>
      </td>
      <td>
        <p>0</p>
      </td>
    </tr>
    <tr>
      <td>
        <p>bendrange <em>x</em></p>
      </td>
      <td>
        <p>ピッチベンドレンジを変更</p>
      </td>
      <td>
        <p>2</p>
      </td>
    </tr>
    <tr>
      <td>
        <p>transpose <em>x</em></p>
      </td>
      <td>
        <p>トランスポーズ</p>
      </td>
      <td>
        <p>0</p>
      </td>
    </tr>
    <tr>
      <td>
        <p>velocity_range <em>x</em></p>
      </td>
      <td>
        <p>ベロシティレンジを変更</p>
      </td>
      <td>
        <p>127</p>
      </td>
    </tr>
    <tr>
      <td>
        <p>pan <em>x</em></p>
      </td>
      <td>
        <p>トラックパンを変更</p>
      </td>
      <td>
        <p>64</p>
      </td>
    </tr>
    <tr>
      <td>
        <p>span <em>x</em></p>
      </td>
      <td>
        <p>トラックサラウンドパンを変更</p>
      </td>
      <td>
        <p>0</p>
      </td>
    </tr>
    <tr>
      <td>
        <p>init_pan <em>x</em></p>
      </td>
      <td>
        <p>トラックイニシャルパンを変更</p>
      </td>
      <td>
        <p>64</p>
      </td>
    </tr>
    <tr>
      <td>
        <p>prio <em>x</em></p>
      </td>
      <td>
        <p>トラックの発音プライオリティを変更</p>
      </td>
      <td>
        <p>64</p>
      </td>
    </tr>
    <tr>
      <td>
        <p>tieon / tieoff</p>
      </td>
      <td>
        <p>タイモード開始 / 終了</p>
      </td>
      <td>
        <p>off</p>
      </td>
    </tr>
    <tr>
      <td>
        <p>monophonic_on &nbsp; monophonic_off</p>
      </td>
      <td>
        <p>モノフォニックモード開始 / 終了</p>
      </td>
      <td>
        <p>off</p>
      </td>
    </tr>
    <tr>
      <td>
        <p>notewait_on &nbsp; notewait_off</p>
      </td>
      <td>
        <p>ノートウェイトオン / オフ</p>
      </td>
      <td>
        <p>on</p>
      </td>
    </tr>
    <tr>
      <td>
        <p>porta <em>x</em></p>
      </td>
      <td>
        <p>ポルタメントの開始キー設定及び開始</p>
      </td>
      <td>
        <p>cn4(60)</p>
      </td>
    </tr>
    <tr>
      <td>
        <p>porta_time <em>x</em></p>
      </td>
      <td>
        <p>ポルタメントタイムの設定</p>
      </td>
      <td>
        <p>0</p>
      </td>
    </tr>
    <tr>
      <td>
        <p>damper_on &nbsp; damper_off</p>
      </td>
      <td>
        <p>ダンパーペダルのオン / オフ</p>
      </td>
      <td>
        <p>off</p>
      </td>
    </tr>
    <tr>
      <td>
        <p>porta_on / porta_off</p>
      </td>
      <td>
        <p>ポルタメントの開始 / 終了</p>
      </td>
      <td>
        <p>off</p>
      </td>
    </tr>
    <tr>
      <td>
        <p>sweep_pitch <em>x</em></p>
      </td>
      <td>
        <p>スイープピッチ変化量の設定</p>
      </td>
      <td>
        <p>0</p>
      </td>
    </tr>
    <tr>
      <td>
        <p>lpf_cutoff x</p>
      </td>
      <td>
        <p>LPF カットオフ周波数</p>
      </td>
      <td>
        <p>0</p>
      </td>
    </tr>
    <tr>
      <td>
        <p>biquad_type</p>
      </td>
      <td>
        <p>biquad フィルタタイプ</p>
      </td>
      <td>
        <p>0</p>
      </td>
    </tr>
    <tr>
      <td>
        <p>biquad_value</p>
      </td>
      <td>
        <p>biquad フィルタ値</p>
      </td>
      <td>
        <p>0</p>
      </td>
    </tr>
    <tr>
      <td>
        <p>fxsend_a <em>x</em></p>
      </td>
      <td>
        <p>エフェクトセンドA</p>
      </td>
      <td>
        <p>0</p>
      </td>
    </tr>
    <tr>
      <td>
        <p>fxsend_b <em>x</em></p>
      </td>
      <td>
        <p>エフェクトセンドB</p>
      </td>
      <td>
        <p>0</p>
      </td>
    </tr>
    <tr>
      <td>
        <p>fxsend_c <em>x</em></p>
      </td>
      <td>
        <p>エフェクトセンドC</p>
      </td>
      <td>
        <p>0</p>
      </td>
    </tr>
    <tr>
      <td>
        <p>mainsend <em>x</em></p>
      </td>
      <td>
        <p>メインセンド</p>
      </td>
      <td>
        <p>127</p>
      </td>
    </tr>
    <tr>
      <td>
        <p>alloctrack <em>mask</em></p>
      </td>
      <td>
        <p>トラック確保</p>
      </td>
      <td>
        <p>&nbsp;</p>
      </td>
    </tr>
    <tr>
      <td>
        <p>opentrack <em>no</em>, <em>label</em></p>
      </td>
      <td>
        <p>トラック起動</p>
      </td>
      <td>
        <p>&nbsp;</p>
      </td>
    </tr>
    <tr>
      <td>
        <p>jump <em>label</em></p>
      </td>
      <td>
        <p>シーケンスジャンプ</p>
      </td>
      <td>
        <p>&nbsp;</p>
      </td>
    </tr>
    <tr>
      <td>
        <p>call <em>label</em></p>
      </td>
      <td>
        <p>シーケンス呼び出し</p>
      </td>
      <td>
        <p>&nbsp;</p>
      </td>
    </tr>
    <tr>
      <td>
        <p>ret</p>
      </td>
      <td>
        <p>シーケンス復帰</p>
      </td>
      <td>
        <p>&nbsp;</p>
      </td>
    </tr>
    <tr>
      <td>
        <p>loop_start <em>count</em></p>
      </td>
      <td>
        <p>ループ始点</p>
      </td>
      <td>
        <p>&nbsp;</p>
      </td>
    </tr>
    <tr>
      <td>
        <p>loop_end</p>
      </td>
      <td>
        <p>ループ終点</p>
      </td>
      <td>
        <p>&nbsp;</p>
      </td>
    </tr>
    <tr>
      <td>
        <p>attack <em>x</em></p>
      </td>
      <td>
        <p>アタック値の設定</p>
      </td>
      <td>
        <p>&nbsp;</p>
      </td>
    </tr>
    <tr>
      <td>
        <p>env_hold <em>x</em></p>
      </td>
      <td>
        <p>ホールド値の設定</p>
      </td>
      <td>
        <p>&nbsp;</p>
      </td>
    </tr>
    <tr>
      <td>
        <p>decay <em>x</em></p>
      </td>
      <td>
        <p>ディケイ値の設定</p>
      </td>
      <td>
        <p>&nbsp;</p>
      </td>
    </tr>
    <tr>
      <td>
        <p>sustain <em>x</em></p>
      </td>
      <td>
        <p>サスティン値の設定</p>
      </td>
      <td>
        <p>&nbsp;</p>
      </td>
    </tr>
    <tr>
      <td>
        <p>release <em>x</em></p>
      </td>
      <td>
        <p>リリース値の設定</p>
      </td>
      <td>
        <p>&nbsp;</p>
      </td>
    </tr>
    <tr>
      <td>
        <p>env_adsr <em>a</em>,<em>d</em>,<em>s</em>,<em>r</em></p>
      </td>
      <td>
        <p>エンベロープ値の設定</p>
      </td>
      <td>
        <p>&nbsp;</p>
      </td>
    </tr>
    <tr>
      <td>
        <p>env_ahdsr <em>a</em>,<em>h</em>,<em>d</em>,<em>s</em>,<em>r</em></p>
      </td>
      <td>
        <p>エンベロープ値の設定（ホールド付き）</p>
      </td>
      <td>
        <p>&nbsp;</p>
      </td>
    </tr>
    <tr>
      <td>
        <p>envelope <em>a</em>,<em>d</em>,<em>s</em>,<em>r</em></p>
      </td>
      <td>
        <p>エンベロープ値の設定（非推奨）</p>
      </td>
      <td>
        <p>&nbsp;</p>
      </td>
    </tr>
    <tr>
      <td>
        <p>env_reset</p>
      </td>
      <td>
        <p>エンベロープ値の無効化</p>
      </td>
      <td>
        <p>&nbsp;</p>
      </td>
    </tr>
    <tr>
      <td>
        <p>mod_depth <em>x</em></p>
      </td>
      <td>
        <p>モジュレーションデプスの設定</p>
      </td>
      <td>
        <p>0</p>
      </td>
    </tr>
    <tr>
      <td>
        <p>mod_range <em>x</em></p>
      </td>
      <td>
        <p>モジュレーションレンジの設定</p>
      </td>
      <td>
        <p>1</p>
      </td>
    </tr>
    <tr>
      <td>
        <p>mod_speed <em>x</em></p>
      </td>
      <td>
        <p>モジュレーションスピードの設定</p>
      </td>
      <td>
        <p>16</p>
      </td>
    </tr>
    <tr>
      <td>
        <p>mod_delay <em>x</em></p>
      </td>
      <td>
        <p>モジュレーションディレイの設定</p>
      </td>
      <td>
        <p>0</p>
      </td>
    </tr>
    <tr>
      <td>
        <p>mod_type <em>x</em></p>
      </td>
      <td>
        <p>モジュレーションタイプの設定</p>
      </td>
      <td>
        <p>0</p>
      </td>
    </tr>
    <tr>
      <td>
        <p>mod_period <em>x</em></p>
      </td>
      <td>
        <p>モジュレーション周期の設定</p>
      </td>
      <td>
        <p>16</p>
      </td>
    </tr>
    <tr>
      <td>
        <p>mod_phase <em>x</em></p>
      </td>
      <td>
        <p>モジュレーションの位相の設定</p>
      </td>
      <td>
        <p>0</p>
      </td>
    </tr>
    <tr>
      <td>
        <p>mod_curve <em>x</em></p>
      </td>
      <td>
        <p>モジュレーションカーブの設定</p>
      </td>
      <td>
        <p>0</p>
      </td>
    </tr>
    <tr>
      <td>
        <p>mute&nbsp; <em>mode</em></p>
      </td>
      <td>
        <p>トラックのミュート / ミュート解除</p>
      </td>
      <td>
        <p>0</p>
      </td>
    </tr>
    <tr>
      <td>
        <p>userproc <em>procId</em></p>
      </td>
      <td>
        <p>ユーザープロシージャの呼び出し</p>
      </td>
      <td>
        <p>&nbsp;</p>
      </td>
    </tr>
    <tr>
      <td>
        <p>bank_select <em>bankId</em></p>
      </td>
      <td>
        <p>バンクセレクト</p>
      </td>
      <td>
        <p>0</p>
      </td>
    </tr>
  </tbody>
</table>
<p>&nbsp;</p>
<h2 id="Anchor_83955769_h2_1">ノートコマンド</h2>
<p>現在のプログラムナンバーを使って、発音を行います。</p>
<p>&nbsp;</p>
<table class="codeblock">
  <tbody>
    <tr>
      <td class="code">
        <div class="codeblock"><pre>cn4 velocity, length</pre></div>
      </td>
    </tr>
  </tbody>
</table>
<p>&nbsp;</p>
<p>キーは、cn4, cs4, dn4, ds4, en4, fn4, fs4, gn4, gs4, as4, as4, bn4, cn5 のような書式で書きます。中央のドは cn4 になります。範囲は、cnm1 から gn9 まで指定できます。(m1 はマイナス 1 を表します)</p>
<p>velocity はベロシティです。0 ～ 127 の範囲で、2 乗スケール値として解釈されます。すなわち、127 を 100% とすると、</p>
<p>
  <span class="embedded-file-wrapper ">
    <img src="../Attachments/Attach_83956113/83080132.gif" width="200" class="embedded-image" />
  </span>
</p>
<p>になります。</p>
<p>length は音の長さで、48 が 4 分音符の長さに相当します (ただし、4 分音符の長さは、タイムベースコマンド (timebase) で変更することが可能です)。値の範囲は 0 ～ 268435455 で、テンポに応じて発音する長さが決定されますが、このうち 0 のみは特別な意味を持ちます。</p>
<p>length の値に 0 が設定された場合には、そのノートの長さは「発音する波形データの終わりまで」と解釈されます。この指定は主にループする波形データに利用します。length の値に 0 を設定し、波形データがループしている場合、音はプログラムによる停止か、優先順位によって停止されるまで永遠に鳴り続けます。</p>
<p>ノートウェイトオンの状態 (デフォルト) では、音の長さ (lengthの値) と同じ時間シーケンスの処理がその場所で止まり、その長さ分を待ってから次のシーケンス処理に移ります。</p>
<p>この動作は length が 0 の場合も同様で、発音する波形データの終わりまでシーケンスが停止します。前記したループする波形を使った永久に鳴り続けるノートも、発音プライオリティが低くて、ノートの再生中に発音が強制的に停止させられた場合には次のシーケンス処理に移行しますので注意してください。</p>
<p>同じ動作を利用して、ループしない波形データに対して length に 0 を指定することで、波形データが終わり次第、次のシーケンス処理に移るような再生の指定も可能となります。</p>
<p>length の値によるシーケンス処理の停止は、プログラムで停止状態を解除、すなわちノートの処理を終わりにしてシーケンスを再開することができます。</p>
<p>&nbsp;</p>
<table class="codeblock">
  <tbody>
    <tr>
      <td class="code">
        <div class="codeblock"><pre>cn4 110, 48
dn4 110, 48
en4 127, 96</pre></div>
      </td>
    </tr>
  </tbody>
</table>
<p class="Code">&nbsp;</p>
<h2 id="Anchor_83955769_h2_2">休符コマンド</h2>
<p>指定時間シーケンスを停止します。</p>
<p>&nbsp;</p>
<table class="codeblock">
  <tbody>
    <tr>
      <td class="code">
        <div class="codeblock"><pre>wait length</pre></div>
      </td>
    </tr>
  </tbody>
</table>
<p>&nbsp;</p>
<p>length は音の長さで、48 が 4 分音符の長さに相当します (ただし、4 分音符の長さは、タイムベースコマンド (timebase) で変更することが可能です)。実際の長さはテンポに依存します。値の範囲は 0 ～ 268435455 です。</p>
<h2 id="Anchor_83955769_h2_3">シーケンスの終了</h2>
<p>トラックのシーケンス処理を終了します。</p>
<p>&nbsp;</p>
<table class="codeblock">
  <tbody>
    <tr>
      <td class="code">
        <div class="codeblock"><pre>fin</pre></div>
      </td>
    </tr>
  </tbody>
</table>
<p>&nbsp;</p>
<p>全トラックのシーケンス処理が終了した時点で、プレイヤーの処理も停止します。</p>
<p>fin コマンドを書き忘れると、下方のシーケンスデータが続けて実行されてしまいます。予期せぬ音が鳴ったり、場合によっては暴走したりしますので、十分注意してください。</p>
<h2 id="Anchor_83955769_h2_4">プログラムチェンジ</h2>
<p>プログラムチェンジを実行します。</p>
<p>&nbsp;</p>
<table class="codeblock">
  <tbody>
    <tr>
      <td class="code">
        <div class="codeblock"><pre>prg x</pre></div>
      </td>
    </tr>
  </tbody>
</table>
<p>&nbsp;</p>
<p>プログラムナンバーは、0 ～ 32767 の範囲です。ただし、MIDI からは 127 までしか指定できません。デフォルト値は 0 です。</p>
<h2 id="Anchor_83955769_h2_5">テンポチェンジ</h2>
<p>テンポを変更します。</p>
<p>&nbsp;</p>
<table class="codeblock">
  <tbody>
    <tr>
      <td class="code">
        <div class="codeblock"><pre>tempo x</pre></div>
      </td>
    </tr>
  </tbody>
</table>
<p>&nbsp;</p>
<p>テンポは、1 ～ 1023 の範囲です。プログラムから設定できるテンポ倍率の値を加味して、最終的なテンポ値になります。デフォルト値は、120 です。</p>
<h2 id="Anchor_83955769_h2_6">タイムベース</h2>
<p>タイムベース (4 分音符分解能) を変更します。</p>
<p>&nbsp;</p>
<table class="codeblock">
  <tbody>
    <tr>
      <td class="code">
        <div class="codeblock"><pre>timebase x</pre></div>
      </td>
    </tr>
  </tbody>
</table>
<p>&nbsp;</p>
<p>タイムベースは 1 ～ 255 の範囲です。デフォルト値は 48 です。</p>
<h2 id="Anchor_83955769_h2_7">トラックボリューム</h2>
<p>トラックのボリュームを変更します。</p>
<p>&nbsp;</p>
<table class="codeblock">
  <tbody>
    <tr>
      <td class="code">
        <div class="codeblock"><pre>volume x
volume2 x</pre></div>
      </td>
    </tr>
  </tbody>
</table>
<p>&nbsp;</p>
<p>ボリューム値は、0 ～ 127 の範囲です。デフォルト値は 127 です。</p>
<p>ベロシティと同様に、2 乗スケール値として解釈されます。すなわち、127 を 100% とすると、</p>
<p>
  <span class="embedded-file-wrapper ">
    <img src="../Attachments/Attach_83956113/83080134.gif" width="200" class="embedded-image" />
  </span>
</p>
<p>になります。</p>
<p>volume コマンドと volume2 コマンドのどちから一方だけ使う場合に、機能的な違いはありません。両方同時に指定した場合は、両者の効果は同時に反映されます。この時例えば、volume に 80%、volume2 に 50% を設定していると、0.8 &times; 0.5 = 0.4 で、40% のボリュームとなります。</p>
<h2 id="Anchor_83955769_h2_8">メインボリューム</h2>
<p>シーケンス全体のボリュームを変更します。</p>
<p>&nbsp;</p>
<table class="codeblock">
  <tbody>
    <tr>
      <td class="code">
        <div class="codeblock"><pre>main_volume x</pre></div>
      </td>
    </tr>
  </tbody>
</table>
<p>&nbsp;</p>
<p>ボリューム値は、0 ～ 127の範囲です。デフォルト値は 127 です。</p>
<p>ベロシティと同様に、2 乗スケール値として解釈されます。すなわち、127 を 100% とすると、</p>
<p>
  <span class="embedded-file-wrapper ">
    <img src="../Attachments/Attach_83956113/83080134.gif" width="200" class="embedded-image" />
  </span>
</p>
<p>になります。</p>
<h2 id="Anchor_83955769_h2_9">ピッチベンド</h2>
<p>ピッチベンドまたは、ピッチベンドレンジを変更します。</p>
<p>&nbsp;</p>
<table class="codeblock">
  <tbody>
    <tr>
      <td class="code">
        <div class="codeblock"><pre>pitchbend x
bendrange x</pre></div>
      </td>
    </tr>
  </tbody>
</table>
<p>&nbsp;</p>
<p>ピッチベンドの値の範囲は、-128 ～ 127 です。デフォルト値は 0 です。</p>
<p>ベンドレンジの単位は半音で、デフォルト値は2、範囲は 0 ～ 127 です。</p>
<p>ピッチベンドの値が MAX の時、ちょうどベンドレンジで指定した高さ分変化します。例えば、ベンドレンジが 2 の場合、ピッチベンドの値が 127 の時 +2 半音、64 の時 +1 半音、-64 の時 -1 半音変化します。</p>
<h2 id="Anchor_83955769_h2_10">トランスポーズ</h2>
<p>トランスポーズを行います。</p>
<p>&nbsp;</p>
<table class="codeblock">
  <tbody>
    <tr>
      <td class="code">
        <div class="codeblock"><pre>transpose x</pre></div>
      </td>
    </tr>
  </tbody>
</table>
<p>&nbsp;</p>
<p>トランスポーズの値の単位は半音で、-64 ～ +63 の範囲です。デフォルト値は 0 です。</p>
<h2 id="Anchor_83955769_h2_11">ベロシティレンジ</h2>
<p>トラックのベロシティレンジを変更します。</p>
<p>&nbsp;</p>
<table class="codeblock">
  <tbody>
    <tr>
      <td class="code">
        <div class="codeblock"><pre>velocity_range x</pre></div>
      </td>
    </tr>
  </tbody>
</table>
<p>&nbsp;</p>
<p>ベロシティレンジの値の範囲は、0～127 です。デフォルト値は 127 です。</p>
<p>ベロシティレンジの値を変更すると、ノートコマンドのベロシティ値を動的に変化させることができます。ノートコマンドのベロシティ値に、ベロシティレンジの値 &divide;127 を掛け合わせた値が、最終的なベロシティ値になります。</p>
<p>volume コマンドも velocity_range コマンドも結果的に音量が変化しますが、velocity_raneg コマンドはベロシティリージョンが変わる可能性がある点が異なります。</p>
<h2 id="Anchor_83955769_h2_12">トラックパン</h2>
<p>トラックのパンを変更します。</p>
<p>&nbsp;</p>
<table class="codeblock">
  <tbody>
    <tr>
      <td class="code">
        <div class="codeblock"><pre>pan x</pre></div>
      </td>
    </tr>
  </tbody>
</table>
<p>&nbsp;</p>
<p>パン値は、0 ～ 127の範囲で、0 の時左、127 の時右、64 の時中央になります。デフォルト値は 64 です。</p>
<h2 id="Anchor_83955769_h2_13">トラックサラウンドパン</h2>
<p>トラックのサラウンドパンを変更します。</p>
<p>&nbsp;</p>
<table class="codeblock">
  <tbody>
    <tr>
      <td class="code">
        <div class="codeblock"><pre>span x</pre></div>
      </td>
    </tr>
  </tbody>
</table>
<p>&nbsp;</p>
<p>サラウンドパン値は、0 ～ 127 の範囲で、0 の時フロント出力のみ (前方)、127 の時リア出力のみ (後方) になります。デフォルト値は 0 です。</p>
<h2 id="Anchor_83955769_h2_14">トラックイニシャルパン</h2>
<p>トラックのイニシャルパンを変更します。</p>
<p>&nbsp;</p>
<table class="codeblock">
  <tbody>
    <tr>
      <td class="code">
        <div class="codeblock"><pre>init_pan x</pre></div>
      </td>
    </tr>
  </tbody>
</table>
<p>&nbsp;</p>
<p>イニシャルパンは、通常のパンとは違いノート単位でパンが設定されます。</p>
<p>例えば、ノートウェイトモード (後述) を notewait_off に設定し、以下のようなシーケンスを組んだ場合、最初の cn4 の音も pan 127 の影響を受け、途中で定位が変わってしまいます。</p>
<p>&nbsp;</p>
<table class="codeblock">
  <tbody>
    <tr>
      <td class="code">
        <div class="codeblock"><pre>notewait_off
pan 64
cn4 127, 96
wait 48
pan 127
en4 127, 96
wait 96
fin</pre></div>
      </td>
    </tr>
  </tbody>
</table>
<p>&nbsp;</p>
<p>この例のようなケースで、最初に発音した cn4 の定位を変えずに、後で鳴らす en4 の定位を変えたい場合に、イニシャルパンを次の例のように利用します。</p>
<p>&nbsp;</p>
<table class="codeblock">
  <tbody>
    <tr>
      <td class="code">
        <div class="codeblock"><pre>notewait_off
init_pan 64
cn4 127, 96
wait 48
init_pan 127
en4 127, 96
wait 96
fin</pre></div>
      </td>
    </tr>
  </tbody>
</table>
<p>&nbsp;</p>
<p>次に示す例では、ノート設定型パンを利用することによって、ひとつのトラックで、ノートごとに別のパンを設定した和音を作成しています。</p>
<p>&nbsp;</p>
<table class="codeblock">
  <tbody>
    <tr>
      <td class="code">
        <div class="codeblock"><pre>notewait_off
init_pan 0
cn4 127, 96
init_pan 64
en4 127, 96
init_pan 127
gn4 127, 96
wait 96
fin</pre></div>
      </td>
    </tr>
  </tbody>
</table>
<p class="Code">&nbsp;</p>
<h2 id="Anchor_83955769_h2_15">発音プライオリティ</h2>
<p>トラックの発音プライオリティを設定します。</p>
<p>&nbsp;</p>
<table class="codeblock">
  <tbody>
    <tr>
      <td class="code">
        <div class="codeblock"><pre>prio x</pre></div>
      </td>
    </tr>
  </tbody>
</table>
<p>&nbsp;</p>
<p>プライオリティ値の範囲は 0 ～ 127 で、デフォルト値は 64 です。値が大きいほど優先順位が高くなり、値が同じ場合は後から発音する方が優先されます。</p>
<p>実際に発音を判定する値は、トラック単位で指定するこのプライオリティ値と SoundMaker や NintendoWare サウンドライブラリの API で指定しているシーケンスサウンド単位のチャンネル優先度を足し合わせたものが使用されます。</p>
<h2 id="Anchor_83955769_h2_16">タイモード</h2>
<p>タイモードを変更します。</p>
<p>&nbsp;</p>
<table class="codeblock">
  <tbody>
    <tr>
      <td class="code">
        <div class="codeblock"><pre>tieon
tieoff</pre></div>
      </td>
    </tr>
  </tbody>
</table>
<p>&nbsp;</p>
<p>デフォルトはタイモードオフです。</p>
<p>タイモードオンの状態でノートオンを行うと、ノートコマンドの音長指定にかかわらず、音が鳴り続けます。続けてノートオンを行うと、発音を続けたまま音程とベロシティだけ変化します。タイモードをオフにするか、シーケンスを停止させると、発音は終了します。</p>
<p>タイモードオンにすると、発音中の音は強制リリースさせられます。また、ノートウェイトモードをオフにしていたとしても、単音でしか鳴らせませんので、注意してください。</p>
<h2 id="Anchor_83955769_h2_17">モノフォニックモード</h2>
<p>モノフォニックモードを変更します。</p>
<p>&nbsp;</p>
<table class="codeblock">
  <tbody>
    <tr>
      <td class="code">
        <div class="codeblock"><pre>monophonic_on
monophonic_off</pre></div>
      </td>
    </tr>
  </tbody>
</table>
<p>&nbsp;</p>
<p>デフォルトはモノフォニックモードオフです。</p>
<p>モノフォニックモードオンの状態では、トラックで1音のみの発音に制限されます。ノートオンする際に、そのトラックですでにノートが発音中である場合は、すでに鳴っている音の発音を続けたまま音程とベロシティだけ変化します。トラックで発音中のノートがない場合は、通常のノートオン動作を行います。</p>
<p>直前のノートのノートオフタイミングと、新たに鳴らすノートのノートオンタイミングが同じ場合は、ノートオフが先に処理されるため、新たに鳴らすノートは通常のノートオンで処理されます。したがって、音程とベロシティだけが変化する一続きの音として演奏させるためには 1tick 以上ノートを重ねる必要があります。</p>
<p>SMF からシーケンスデータをコンバートして使用する際には、4 分音符分解能を変換する際に端数の tick 値が丸め込まれる可能性がありますので注意が必要です。コンバート後の分解能を 48 にする場合、1tick が 3 連 64 分音符に相当しますので、3 連 64 分音符以上のノートの重なりを設けないと、ひと続きの音として処理されない可能性があります。</p>
<h2 id="Anchor_83955769_h2_18">ノートウェイトモード</h2>
<p>ノートウェイトモードを変更します。</p>
<p>&nbsp;</p>
<table class="codeblock">
  <tbody>
    <tr>
      <td class="code">
        <div class="codeblock"><pre>notewait_on
notewait_off</pre></div>
      </td>
    </tr>
  </tbody>
</table>
<p>&nbsp;</p>
<p>デフォルトはノートウェイトオンの状態です。</p>
<p>ノートウェイトオンの状態でノートオンを行うと、ノートコマンドの音長と同じ時間だけシーケンスが停止します。オフの状態では、停止せずにそのまま次のコマンドが処理されます。</p>
<p>オンの状態では、音が鳴っている間シーケンスが止まるので、順番に音を鳴らすような時、いちいち休符コマンドを挟む必要が無くて便利ですが、発音中は何も処理が行えません。</p>
<p>一方、オフの状態では、ノートコマンドの後に待ちが入りませんので、同時に 2 音以上の音を鳴らしたり、発音中にパンを移動させたりすることができます。</p>
<h2 id="Anchor_83955769_h2_19">ダンパーペダル</h2>
<p>ダンパーペダルの操作を行います。</p>
<p>&nbsp;</p>
<table class="codeblock">
  <tbody>
    <tr>
      <td class="code">
        <div class="codeblock"><pre>damper_on
damper_off</pre></div>
      </td>
    </tr>
  </tbody>
</table>
<p>&nbsp;</p>
<p>damper_on でダンパー (サスティン) ペダルを踏み込んだ状態になります。この時にノートオフが来ても、ノートはリリースされず保持されます。</p>
<p>保持されたノートは、damper_off のタイミングでリリースされます。</p>
<h2 id="Anchor_83955769_h2_20">ポルタメント</h2>
<p>ポルタメントの設定を行います。</p>
<p>&nbsp;</p>
<table class="codeblock">
  <tbody>
    <tr>
      <td class="code">
        <div class="codeblock"><pre>porta key
porta_time time
porta_on
porta_off</pre></div>
      </td>
    </tr>
  </tbody>
</table>
<p>&nbsp;</p>
<p>porta コマンドで、ポルタメントモードに入ります。ポルタメントモードでノートコマンドを実行すると、key で指定した音程から、ノートコマンドで指定した音程へと、変化しながら再生されます。さらに続けてノートコマンドを実行すると、前のノートコマンドの音程から、今回のノートコマンドの音程へと変化します。</p>
<p>porta_time コマンドで、音程変化の速さを指定します (MIDI の慣習にあわせて、porta_speed ではなく、porta_time になっています)。値の範囲は 0 ～ 255 で、デフォルトは 0 です。値が大きいほど変化が遅く、時間が長くなります。0 の時は、特別にノート長と同じ長さで変化することを意味します。すなわち、ノートコマンドによる発音の時間と同じ時間をかけて、音程が変化します。</p>
<p>porta_on コマンドも、porta コマンド同様、ポルタメントモードに入りますが、開始キーを指定しません。次のノートコマンドは、porta_on コマンドより前に実行されたノートコマンドの音程から変化します。さらに続けてノートコマンドを実行すると、前のノートコマンドの音程から、今回のノートコマンドの音程へと変化します。</p>
<p>porta_off コマンドで、ポルタメントモードが解除されます。</p>
<p>タイモードオンの状態でポルタメントを使うと、ピッチベンドで音程を連続変化させるような表現が可能です。</p>
<p>porta_time が 0 (デフォルト) の状態で MIDI からこのコマンドを使用した場合、リアルタイム MIDI 再生時には無視されることに注意してください。</p>
<h2 id="Anchor_83955769_h2_21">スイープ</h2>
<p>スイープの設定を行います。</p>
<p>&nbsp;</p>
<table class="codeblock">
  <tbody>
    <tr>
      <td class="code">
        <div class="codeblock"><pre>sweep_pitch pitch</pre></div>
      </td>
    </tr>
  </tbody>
</table>
<p>&nbsp;</p>
<p>sweep_pitch コマンドを使うと、各発音がスイープして鳴るようになります。スイープ設定をした状態で、ノートコマンドを実行すると、ノートコマンドで指定した音程から pitch の分ずれた音程で鳴り始め、徐々に正しい音程に変化します。pitch の値の範囲は、-32768 ～ 32767 で、デフォルトは 0 です。64 の時ちょうど 1 半音ずれます。</p>
<p>正しい音程に戻る速さは、porta_time コマンドで設定した速さと同じになります。</p>
<p>porta_time が 0 (デフォルト) の状態で MIDI からこのコマンドを使用した場合、リアルタイム MIDI 再生時には無視されることに注意してください。</p>
<h2 id="Anchor_83955769_h2_22">LPF カットオフ周波数</h2>
<p>ローパスフィルタのカットオフ周波数を変更します。</p>
<p>&nbsp;</p>
<table class="codeblock">
  <tbody>
    <tr>
      <td class="code">
        <div class="codeblock"><pre>lpf_cutoff x</pre></div>
      </td>
    </tr>
  </tbody>
</table>
<p>&nbsp;</p>
<p>LPF カットオフ周波数は、0 ～ 127 の範囲で、64 をセンターとして 0 に近づくほどフィルタがかかり、127 に近づくほどフィルタが開放されます。デフォルト値は 64 です。</p>
<p>また、LPF と biquad フィルタは併用することができ、併用した場合は 2 つのフィルタの効果が重ね掛けされます。</p>
<p>&nbsp;</p>
<div class="note_new">
  <div class="note_new_left">注意：</div>
  <div class="note_new_right">
    <p>現在シーケンスコマンドの LPF カットオフ周波数による音の操作は、数値の下方向 (64 ～ 0) に、フィルタのかかる操作のみ有効に機能します。LPF カットオフ周波数の設定は、将来 instrument からも設定を行う可能性を考慮し、64 をセンターとしています。</p>
  </div>
</div>
<h2 id="Anchor_83955769_h2_23">biquad フィルタ</h2>
<p>biquad フィルタを設定します。</p>
<p>&nbsp;</p>
<table class="codeblock">
  <tbody>
    <tr>
      <td class="code">
        <div class="codeblock"><pre>biquad_type type
biquad_value x</pre></div>
      </td>
    </tr>
  </tbody>
</table>
<p>&nbsp;</p>
<p>biquad フィルタを使うと、LPF (ローパスフィルタ) や HPF (ハイパスフィルタ)、BPF (バンドパスフィルタ) などのフィルタをかけることができます。フィルタの種類を変えるには、biquad_type コマンドで、次の値を設定します。</p>
<p>表 3 biquad フィルタタイプ</p>
<table class="table">
  <thead>
    <tr>
      <th>
        <p>type 値</p>
      </th>
      <th>
        <p>フィルタの種類</p>
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        <p>0</p>
      </td>
      <td>
        <p>フィルタを使用しません (デフォルト値)</p>
      </td>
    </tr>
    <tr>
      <td>
        <p>1</p>
      </td>
      <td>
        <p>LPF</p>
      </td>
    </tr>
    <tr>
      <td>
        <p>2</p>
      </td>
      <td>
        <p>HPF</p>
      </td>
    </tr>
    <tr>
      <td>
        <p>3</p>
      </td>
      <td>
        <p>BPF (中心周波数 512Hz)</p>
      </td>
    </tr>
    <tr>
      <td>
        <p>4</p>
      </td>
      <td>
        <p>BPF (中心周波数 1024Hz)</p>
      </td>
    </tr>
    <tr>
      <td>
        <p>5</p>
      </td>
      <td>
        <p>BPF (中心周波数 2048Hz)</p>
      </td>
    </tr>
    <tr>
      <td>
        <p>64</p>
      </td>
      <td>
        <p>ユーザー定義のフィルタ (最小値)</p>
      </td>
    </tr>
    <tr>
      <td>
        <p>127</p>
      </td>
      <td>
        <p>ユーザー定義のフィルタ (最大値)</p>
      </td>
    </tr>
  </tbody>
</table>
<p>&nbsp;</p>
<p>フィルタの効き具合は、biquad_value コマンドで設定します。0 ～ 127 の範囲で、0 の時は効果無し。127 の時に効果が最大になります。デフォルト値は 0 です。</p>
<p>フィルタタイプで設定できる値の範囲は、0 ～ 127 です。現在割り当てられていない数値の内、63 以下の数値に対しては、将来フィルタタイプが追加される可能性があることに注意してください。また、64 以上の数値については、ユーザー独自のフィルタタイプを追加することができます。フィルタタイプの追加は、プログラムで行う必要があります。詳しくは、関数リファレンスマニュアルの nw::snd::SoundSystem::SetBiquadFilterCallback 関数をご覧下さい。フィルタタイプ 64 は nw::snd::BiquadFilterType の BIQUAD_FILTER_TYPE_USER_MIN が該当し、フィルタタイプ 127 は BIQUAD_FILTER_TYPE_USER_MAX が該当します。</p>
<p>また、 biquad フィルタ と LPF は併用することができ、併用した場合は 2 つのフィルタの効果が重ね掛けされます。</p>
<h2 id="Anchor_83955769_h2_24">エフェクトセンド A～C</h2>
<p>各補助バスへのセンド量を変更します。この3種類のコマンドは、A ～ C の各補助バスに対応して同じ動作を行いますので、エフェクトセンド A を例に解説します。</p>
<p>&nbsp;</p>
<table class="codeblock">
  <tbody>
    <tr>
      <td class="code">
        <div class="codeblock"><pre>fxsend_a x</pre></div>
      </td>
    </tr>
  </tbody>
</table>
<p class="Code">&nbsp;</p>
<p>&nbsp;</p>
<p>エフェクトセンド量は、0 ～ 127 の範囲で、0 の時センド無し、127 の時センド最大になります。デフォルト値は 0 です。</p>
<h2 id="Anchor_83955769_h2_25">メインセンド</h2>
<p>メインバスの音量のみを変更します。メインセンドは各補助バスへのエフェクトセンドと組み合わせて、ドライ (原音) 成分の音量のみを変更するために使用します。</p>
<p>&nbsp;</p>
<table class="codeblock">
  <tbody>
    <tr>
      <td class="code">
        <div class="codeblock"><pre>mainsend x</pre></div>
      </td>
    </tr>
  </tbody>
</table>
<p class="Code">&nbsp;</p>
<p>&nbsp;</p>
<p>メインセンド量は、0 ～ 127 の範囲で、0 の時ドライ成分無し、127 の時ドライ成分最大なります。デフォルト値は 127 です。</p>
<p>以下にミキシングにおけるメインセンドとエフェクトセンドの役割を概念図に示します。</p>
<p>図 1 エフェクトのミキシング概念</p>
<p>&nbsp;<span class="embedded-file-wrapper "><img src="../Attachments/Attach_83956113/83080133.gif" width="300" class="embedded-image" /></span></p>
<p>メインセンドを 0 にすることで、ウェット (エフェクト) 成分のみのボイスを作成できます。</p>
<h2 id="Anchor_83955769_h2_26">トラック確保</h2>
<p>トラックを確保します。</p>
<p>&nbsp;</p>
<table class="codeblock">
  <tbody>
    <tr>
      <td class="code">
        <div class="codeblock"><pre>alloctrack mask </pre></div>
      </td>
    </tr>
  </tbody>
</table>
<p>&nbsp;</p>
<p>このコマンドは、必ずシーケンスの一番はじめで使う必要があります。</p>
<p>mask は、確保するトラックのビットマスクで、下位ビットから順にトラック 0、トラック 1、トラック 2 &hellip;を表し、ビットが立っているトラックを確保します (トラック 0 はすでに確保されているので、再下位ビットは無視されます)。また、マクロを使って、次のように記述することもできます。</p>
<p>&nbsp;</p>
<table class="codeblock">
  <tbody>
    <tr>
      <td class="code">
        <div class="codeblock"><pre>alloctrack TRACK_1 | TRACK_2 | TRACK_3 </pre></div>
      </td>
    </tr>
  </tbody>
</table>
<p>&nbsp;</p>
<p>上記の記述により、トラック 1、トラック 2、トラック 3 が確保されます。</p>
<h2 id="Anchor_83955769_h2_27">トラック起動</h2>
<p>別のトラックを起動します。</p>
<p>&nbsp;</p>
<table class="codeblock">
  <tbody>
    <tr>
      <td class="code">
        <div class="codeblock"><pre>opentrack no, label </pre></div>
      </td>
    </tr>
  </tbody>
</table>
<p>&nbsp;</p>
<p>このコマンドは、前もって alloctrack で確保したトラックに対してのみ実行できます。</p>
<p>no はトラック番号で、0 ～ 15 を指定できますが、現在のトラックを指定することはできません。また、すでに実行中のトラックは一度全ての音をリリースした後、実行されます。</p>
<p>label は、シーケンスの先頭を表すラベルです。</p>
<p>fin コマンドで終了したトラックは解放されますので、opentrack コマンドで再起動することはできません。再起動する必要がある場合は、fin コマンドの代わりに、wait コマンドを挟んだループで待ち続けるようにしてください。</p>
<p>なお、現在のトラックより大きい番号のトラックを開いた場合、同じフレームではじめの処理が実行されますが、小さい番号のトラックを開いた場合は、1 フレーム遅れて実行されることに注意してください。</p>
<h2 id="Anchor_83955769_h2_28">シーケンスジャンプ</h2>
<p>シーケンス位置を別の場所に飛ばします。</p>
<p>&nbsp;</p>
<table class="codeblock">
  <tbody>
    <tr>
      <td class="code">
        <div class="codeblock"><pre>jump label </pre></div>
      </td>
    </tr>
  </tbody>
</table>
<p>&nbsp;</p>
<p>label は飛び先を表すラベルです。</p>
<p>ジャンプを使うことで、ループするシーケンスを作成することができます。ただし、ループ内に wait コマンドや、ノートウェイトオンでのノートコマンドなどの、シーケンスを停止させるコマンドが含まれていないと、永遠にループし続けてしまいますので、注意してください。</p>
<h2 id="Anchor_83955769_h2_29">シーケンス呼び出し</h2>
<p>シーケンス位置を別の場所に飛ばしますが、後で元の位置に戻ってくるようにします。</p>
<p>&nbsp;</p>
<table class="codeblock">
  <tbody>
    <tr>
      <td class="code">
        <div class="codeblock"><pre>call label
ret </pre></div>
      </td>
    </tr>
  </tbody>
</table>
<p>&nbsp;</p>
<p>label は飛び先を表すラベルです。</p>
<p>飛んだ先で ret コマンドを使うと、元の呼び出し位置に戻ります。飛び先で再び call コマンドを実行することもできますが、ループコマンドと合計して 3 階層までしか呼び出せません。</p>
<h2 id="Anchor_83955769_h2_30">ループ</h2>
<p>回数を指定して、ある区間の処理を繰り返し実行します。</p>
<p>&nbsp;</p>
<table class="codeblock">
  <tbody>
    <tr>
      <td class="code">
        <div class="codeblock"><pre>loop_start count
loop_end </pre></div>
      </td>
    </tr>
  </tbody>
</table>
<p>&nbsp;</p>
<p>loop_start でループ開始点を設定します。count はループ回数で、0 ～ 255 の範囲で指定できます。0 の時は無限ループになります。</p>
<p>loop_end でループ終点を設定します。ループ回数が指定した回数に満たない場合は、loop_start で設定したループ開始点へ戻ります。</p>
<p>ループ区間の中で、さらにループさせることもできますが、call コマンドと合計して 3 階層までしかできません。</p>
<p>MIDI からこのコマンドを使用した場合、リアルタイム MIDI 再生時には無視されることに注意してください。</p>
<h2 id="Anchor_83955769_h2_31">エンベロープ</h2>
<p>エンベロープの設定を行います。</p>
<p>&nbsp;</p>
<table class="codeblock">
  <tbody>
    <tr>
      <td class="code">
        <div class="codeblock"><pre>attack x
env_hold x
decay x
sustain x
release x
env_adsr a, d, s, r
env_ahdsr a, h, d, s, r
envelope a, d, s, r (非推奨) </pre></div>
      </td>
    </tr>
  </tbody>
</table>
<p>&nbsp;</p>
<p>デフォルトでは、バンクのエンベロープ値が使われますが、これらのコマンドを使うことで、エンベロープの値を上書きすることができます。release コマンドなどを単独で用いた場合、他のアタックなどの値は、バンクで設定した値が使われます。env_adsr や env_ahdsr コマンドを使うことで、一度に複数の値を設定することがきます。envelope コマンドは、互換性のために残されていますので、代わりに env_adsr コマンドを使用してください。</p>
<p>ホールドタイムの値は、以下の計算式でミリ秒に換算して適用されます。最大 (127) で約 4 秒のホールドタイムを指定することができます。</p>
<p>&nbsp;<span class="embedded-file-wrapper "><img src="../Attachments/Attach_83956113/83080136.gif" width="200" class="embedded-image" /></span></p>
<p>エンベロープの各値には、-1 を指定することで、一度変更した各値を無効にすることができます。無効にされた各値には、再びデフォルトであるバンクのエンベロープ値が使われます。</p>
<p>SoundMaker マニュアルの &ldquo;付録&rdquo;-&ldquo;エンベロープテーブル&rdquo; ページに、attack, decay, release の各値と秒数、減衰速度の関係について説明した一覧表がありますので、そちらも参照してください。</p>
<h2 id="Anchor_83955769_h2_32">エンベロープ無効化</h2>
<p>設定したエンベロープの値を無効にします。</p>
<p>&nbsp;</p>
<table class="codeblock">
  <tbody>
    <tr>
      <td class="code">
        <div class="codeblock"><pre>env_reset </pre></div>
      </td>
    </tr>
  </tbody>
</table>
<p>&nbsp;</p>
<p>各種エンベロープコマンドで設定したエンベロープ値を無効化し、バンクで設定されているエンベロープ値に戻します。エンベロープコマンドで -1を設定するのと同じですが、このコマンドでは全てのエンベロープパラメータが無効になります。</p>
<h2 id="Anchor_83955769_h2_33">モジュレーション</h2>
<p>モジュレーションの設定を行います。</p>
<p>&nbsp;</p>
<table class="codeblock">
  <tbody>
    <tr>
      <td class="code">
        <div class="codeblock"><pre>mod_depth depth
mod_range range
mod_speed speed
mod_period period
mod_delay delay
mod_type type
mod_curve curve
mod_phase phase </pre></div>
      </td>
    </tr>
  </tbody>
</table>
<p>&nbsp;</p>
<p>mod_depth でモジュレーションの深さを設定します。値の範囲は 0 ～ 127 で、デフォルト値は 0 です。最大値での変化の度合いは、以下の表の通りです (ただし、後述の mod_range が 1 の場合)。</p>
<p>表 4 モジュレーション変化の度合い</p>
<table class="table">
  <thead>
    <tr>
      <th>
        <p>タイプ</p>
      </th>
      <th>
        <p>変化の度合い</p>
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        <p>音程変化</p>
      </td>
      <td>
        <p>&plusmn; 1 半音の間で変化します</p>
      </td>
    </tr>
    <tr>
      <td>
        <p>音量変化</p>
      </td>
      <td>
        <p>&plusmn; 6.0 dB の間で変化します</p>
      </td>
    </tr>
    <tr>
      <td>
        <p>定位変化</p>
      </td>
      <td>
        <p>左 MAX ～ 右 MAX の間で変化します</p>
      </td>
    </tr>
  </tbody>
</table>
<p>&nbsp;</p>
<p>mod_range でモジュレーションの最大変化幅を設定します。値の範囲は、0 ～ 127 で、デフォルト値は 1 です。例えば音程変化の場合、デフォルトでは mod_depth が最大の時、&plusmn; 1 半音の間で変化しますが、mod_range を 12 にすると、&plusmn; 12 半音すなわち 1 オクターブの幅で、モジュレーションがかかります。</p>
<p>&nbsp;</p>
<p>mod_speed でモジュレーションの速さを設定します。値の範囲は 0 ～ 127 で、デフォルト値は 16 です。1 の時約 0.4 Hz で線形的に変化しますので、0.0 Hz ～ 約 50 Hz の範囲で設定できます。</p>
<p>&nbsp;</p>
<p>また、mod_period でもモジュレーションの速さを設定することができます。値の範囲は 0 ～ 32767 で、デフォルト値は 16 です。mod_speed と mod_period とで、後に設定したものが有効になります。mod_speed は「周波数」に相当する値を設定するものでしたが、mod_period は「周期」に相当する値を設定することができます。mod_period 1 は周期 0.01 秒に相当、mod_period 2 は周期 0.02 秒に相当・・・のように、「設定した値 &times; 0.01 秒」が周期として扱われます。mod_speed では値を大きくすると周期が短くなるのに対し、mod_period では値を大きくすると周期が長くなることに注意してください。mod_period を利用すると、mod_speed では実現できなかった長い周期のモジュレーションを設定することができます (最大 327.67 秒 (約 5 分半) の周期を設定することが可能です)。また、mod_period 0 を設定すると、まったく変化しなくなります。</p>
<p>&nbsp;</p>
<table class="codeblock">
  <tbody>
    <tr>
      <td class="code">
        <div class="codeblock"><pre>; なにも設定しない場合は、
; モジュレーションの速さはデフォルト値 (mod_speed 16 相当) になる。
&nbsp;
mod_speed 127
; 約 50 Hz に相当。1 周期あたり約 0.02 秒に相当。
&nbsp;
mod_period 100
; 上の mod_speed 127 で設定した値が上書きされ、1 周期あたり 1 秒になる。 </pre></div>
      </td>
    </tr>
  </tbody>
</table>
<p>&nbsp;</p>
<p>表 5 mod_speed と mod_period の比較</p>
<table class="table">
  <thead>
    <tr>
      <th>
        <p>コマンド</p>
      </th>
      <th>
        <p>値 : 1</p>
      </th>
      <th>
        <p>2</p>
      </th>
      <th>
        <p>16</p>
      </th>
      <th>
        <p>127</p>
      </th>
      <th>
        <p>32767</p>
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        <p>mod_speed (Hz 換算)</p>
      </td>
      <td>
        <p align="center">約&nbsp;&nbsp; 0.4</p>
      </td>
      <td>
        <p align="center">約&nbsp;&nbsp; 0.8</p>
      </td>
      <td>
        <p align="center">6.25</p>
      </td>
      <td>
        <p align="center">約&nbsp;&nbsp; 50</p>
      </td>
      <td>
        <p align="center">-</p>
      </td>
    </tr>
    <tr>
      <td>
        <p>mod_speed (周期換算)</p>
      </td>
      <td>
        <p align="center">約&nbsp;&nbsp; 2.5</p>
      </td>
      <td>
        <p align="center">約&nbsp;&nbsp; 1.25</p>
      </td>
      <td>
        <p align="center">0.16</p>
      </td>
      <td>
        <p align="center">約&nbsp;&nbsp; 0.02</p>
      </td>
      <td>
        <p align="center">-</p>
      </td>
    </tr>
    <tr>
      <td>
        <p>mod_period (周期換算)</p>
      </td>
      <td>
        <p align="center">0.01</p>
      </td>
      <td>
        <p align="center">0.02</p>
      </td>
      <td>
        <p align="center">0.16</p>
      </td>
      <td>
        <p align="center">1.27</p>
      </td>
      <td>
        <p align="center">327.67</p>
      </td>
    </tr>
  </tbody>
</table>
<p>&nbsp;</p>
<p>mod_delay でモジュレーションの遅延時間を設定します。値の範囲は、0 ～ 32767 で、デフォルト値は、0 です。単位は 5 ms で、テンポには依存しません。MIDI からは、コントロールチェンジ 26 または、27 を使って設定します。コントロールチェンジ 26 の方は、値をそのまま出力しますが、27 の方は値を 10 倍して出力します。結果、0 ～ 1270 の範囲で設定できます。</p>
<p>&nbsp;</p>
<p>mod_type はモジュレーションのタイプを設定します。設定できる値は、このドキュメントの付録にある「<a href="../Pages/Page_83955585.html">全シーケンスコマンド一覧表</a>」をご覧ください。デフォルトは 0 = ビブラート (音程変化) です。</p>
<p>モジュレーションのタイプは数値の他に、一覧にあるマクロの文字列によっても指定できます。</p>
<p>表 6 モジュレーションタイプ一覧</p>
<table class="table">
  <thead>
    <tr>
      <th>
        <p>数値</p>
      </th>
      <th>
        <p>マクロ</p>
      </th>
      <th>
        <p>説明</p>
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        <p>0</p>
      </td>
      <td>
        <p>MOD_TYPE_PITCH</p>
      </td>
      <td>
        <p>ビブラート (音程変化)</p>
      </td>
    </tr>
    <tr>
      <td>
        <p>1</p>
      </td>
      <td>
        <p>MOD_TYPE_VOLUME</p>
      </td>
      <td>
        <p>トレモロ (音量変化)</p>
      </td>
    </tr>
    <tr>
      <td>
        <p>2</p>
      </td>
      <td>
        <p>MOD_TYPE_PAN</p>
      </td>
      <td>
        <p>パン (定位変化)</p>
      </td>
    </tr>
  </tbody>
</table>
<p>&nbsp;</p>
<p>限界以上の振幅は頭打ちになって変化しません。例えば、音量変化させようとしても、元の音量が最大だった場合、音が大きくなる方の変化はせず、小さくなる方だけ変化することに注意してください。</p>
<p>&nbsp;</p>
<p>mod_curve は、モジュレーションの波形の形を設定します。値の範囲は 0～127 ですが、5 以降を設定すると変化しなくなります。デフォルト値は 0 です。</p>
<p>表 7 モジュレーションカーブ一覧</p>
<table class="table">
  <thead>
    <tr>
      <th>
        <p>数値</p>
      </th>
      <th>
        <p>説明</p>
      </th>
      <th>
        <p>取りうる値の範囲</p>
      </th>
      <th>
        <p>【例】音程変化させた場合に取りうる値の範囲</p>
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        <p>0</p>
      </td>
      <td>
        <p>サイン波</p>
      </td>
      <td>
        <p>-1.0 ～ 1.0</p>
      </td>
      <td>
        <p>-1 半音 ～ +1 半音</p>
      </td>
    </tr>
    <tr>
      <td>
        <p>1</p>
      </td>
      <td>
        <p>三角波</p>
      </td>
      <td>
        <p>-1.0 ～ 1.0</p>
      </td>
      <td>
        <p>-1 半音 ～ +1 半音</p>
      </td>
    </tr>
    <tr>
      <td>
        <p>2</p>
      </td>
      <td>
        <p>ノコギリ波</p>
      </td>
      <td>
        <p>0.0 ～ 1.0</p>
      </td>
      <td>
        <p>元の音程 ～ +1 半音</p>
      </td>
    </tr>
    <tr>
      <td>
        <p>3</p>
      </td>
      <td>
        <p>矩形波</p>
      </td>
      <td>
        <p>0.0, 1.0</p>
      </td>
      <td>
        <p>元の音程、+1 半音</p>
      </td>
    </tr>
    <tr>
      <td>
        <p>4</p>
      </td>
      <td>
        <p>ランダム波</p>
      </td>
      <td>
        <p>0.0 ～ 1.0</p>
      </td>
      <td>
        <p>元の音程 ～ +1 半音</p>
      </td>
    </tr>
    <tr>
      <td>
        <p>5～</p>
      </td>
      <td>
        <p>変化しない</p>
      </td>
      <td>
        <p>ずっと 0.0</p>
      </td>
      <td>
        <p>元の音程</p>
      </td>
    </tr>
  </tbody>
</table>
<p>&nbsp;</p>
<p>以下、それぞれのカーブの形を図示します。ランダム波は 1 周期中ずっと同じ値を取り続け、次の周期に入ったときに別のランダム値を取ります。</p>
<p>図 2 モジュレーションカーブの形 (サイン波 / 2 周期分)</p>
<p>&nbsp;<span class="embedded-file-wrapper "><img src="../Attachments/Attach_83956113/83080135.jpg" width="300" class="embedded-image" /></span></p>
<p>&nbsp;</p>
<p>図 3 モジュレーションカーブの形 (三角波 / 2 周期分)</p>
<p>&nbsp;<span class="embedded-file-wrapper "><img src="../Attachments/Attach_83956113/83080138.jpg" width="300" class="embedded-image" /></span></p>
<p>&nbsp;</p>
<p>図 4 モジュレーションカーブの形 (ノコギリ波 / 2 周期分)</p>
<p>&nbsp;<span class="embedded-file-wrapper "><img src="../Attachments/Attach_83956113/83080137.jpg" width="300" class="embedded-image" /></span></p>
<p>&nbsp;</p>
<p>図 5 モジュレーションカーブの形 (矩形波 / 2 周期分)</p>
<p>&nbsp;<span class="embedded-file-wrapper "><img src="../Attachments/Attach_83956113/83080140.jpg" width="300" class="embedded-image" /></span></p>
<p>&nbsp;</p>
<p>図 6 モジュレーションカーブの形 (ランダム波 / 2 周期分)</p>
<p>&nbsp;<span class="embedded-file-wrapper "><img src="../Attachments/Attach_83956113/83080139.jpg" width="300" class="embedded-image" /></span></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>mod_phase はモジュレーションの位相を設定します。値の範囲は 0～127 で、初期値は 0 です。0 ～ 127 で一周期を表現しており、たとえば、mod_phase で 64 を指定すると、半周期進んだところからモジュレーションが開始されます。</p>
<p>また、モジュレーションの数は 4 個あります。具体的には、上記で挙げた各種 mod_ コマンドに対して、それぞれ mod2_～ mod4_ コマンドがそれぞれ対応します。<br />詳しくは、「<a href="../Pages/Page_83955585.html">全シーケンスコマンド一覧表</a>」 をご確認ください。</p>
<p>&nbsp;</p>
<h2 id="Anchor_83955769_h2_34">トラックミュート</h2>
<p>トラックのミュート (消音) を制御します。</p>
<p>&nbsp;</p>
<table class="codeblock">
  <tbody>
    <tr>
      <td class="code">
        <div class="codeblock"><pre>mute mode </pre></div>
      </td>
    </tr>
  </tbody>
</table>
<p>&nbsp;</p>
<p>mode の数値によって様々なミュートの動作をおこないます。</p>
<p>表 8 トラックミュートの動作一覧</p>
<table class="table">
  <thead>
    <tr>
      <th>
        <p>数値</p>
      </th>
      <th>
        <p>説明</p>
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        <p>0</p>
      </td>
      <td>
        <p>トラックのミュートを解除</p>
      </td>
    </tr>
    <tr>
      <td>
        <p>1</p>
      </td>
      <td>
        <p>トラックをミュートして、すでに発音中の音はそのままにする</p>
      </td>
    </tr>
    <tr>
      <td>
        <p>2</p>
      </td>
      <td>
        <p>トラックをミュートして、すでに発音中の音をリリースさせて停止</p>
      </td>
    </tr>
    <tr>
      <td>
        <p>3</p>
      </td>
      <td>
        <p>トラックをミュートして、すでに発音中の音を即座に停止</p>
      </td>
    </tr>
  </tbody>
</table>
<p>&nbsp;</p>
<h2 id="Anchor_83955769_h2_35">ユーザープロセス呼び出し</h2>
<p>プログラムで登録されているユーザープロセスを呼び出します。</p>
<p>&nbsp;</p>
<table class="codeblock">
  <tbody>
    <tr>
      <td class="code">
        <div class="codeblock"><pre>userproc procId </pre></div>
      </td>
    </tr>
  </tbody>
</table>
<p>&nbsp;</p>
<p>userproc コマンドを記述すると、そのタイミングでプログラム側であらかじめ登録された関数が呼び出されます。procId の数値は、関数にパラメータとして渡されます。</p>
<p>ユーザープロセスとして登録された関数内では以下のことが可能です。</p>
<p>l シーケンス変数の参照、及び変更</p>
<p>l 比較コマンド (後述の節を参照) の結果の参照、及び変更</p>
<p>&nbsp;</p>
<p>また、ユーザープロセス内では自由にプログラムコードを記述できますので、シーケンスコマンドだけでは不可能な複雑な演算やゲームのシーンやパラメータに依存した処理を行い、その結果をシーケンス変数や比較コマンドの結果に格納してシーケンスデータに反映させることができます。</p>
<h2 id="Anchor_83955769_h2_36">バンクセレクト</h2>
<p>トラックのバンク番号を設定します。</p>
<p>&nbsp;</p>
<table class="codeblock">
  <tbody>
    <tr>
      <td class="code">
        <div class="codeblock"><pre>bank_select bankIndex </pre></div>
      </td>
    </tr>
  </tbody>
</table>
<p>&nbsp;</p>
<p>SoundMaker で、1 つのシーケンスサウンドに対してバンクを 4 つまで登録できますが、その 4 つのうちどのバンクを使うかを設定することができます。</p>
<p>bankIndex は 0 ～ 3 までの数値で指定します。0 ～ 3 は SoundMaker の「マルチバンクの設定」で表示されるダイアログ内のリストの行番号に該当します。</p>
<p>&nbsp;</p>
</div>
<div class="breadcrumb_bottom"></div>
<div class="page_navigation">
<table class="page_navi_root">
<tr>
<td class="page_navi_left"></td>
<td class="page_navi_right"></td>
</tr>
<tr><td colspan="2" class="page_navi_bottom"></td></tr>
</table>
</div>
</div>
</div>
</body>
</html>
