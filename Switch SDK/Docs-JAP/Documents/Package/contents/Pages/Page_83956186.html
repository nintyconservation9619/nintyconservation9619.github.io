<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<script type="text/javascript" src="../template/js/jquery/jquery.js"></script>
<script type="text/javascript" src="../template/js/common/manualLib.js"></script>
<script type="text/javascript" src="../tocData.js"></script>
<link rel="stylesheet" type="text/css" href="../template/css/template.css" />
<title>エクスポートプラグイン使用方法</title>
</head>
<body data-reassemble="autoindex=no,forceNoLabel=yes">
<div id="autoindex_content">
<div class="body_content">
<noscript>
<div style="border: 4px double black; margin: 4px; padding: 2px; font-weight: bold; background-color: #FFFFCC;">
<p>お使いのブラウザは JavaScript が使用できないため、本ドキュメントの一部機能が無効になっています。</p><p>JavaScript が無効の環境では目次を使用することができません。<br />JavaScriptの実行が許可された状態で閲覧してください。<br /><br /></p>
</div>
</noscript>
<div class="page_navigation_top">
<table class="page_navi_root">
<tr>
<td class="page_navi_left"></td>
<td class="page_navi_right"></td>
</tr>
</table>
</div>
<div class="breadcrumb"></div>

<!-- エクスポートプラグイン使用方法 -->
<div class="pagetitle" id="PageId_83956186">エクスポートプラグイン使用方法</div>
<div class="text_separate">
<p>ここでは、エクスポートプラグインの使用方法について下記項目で説明します。</p>
<p>
  <ul class="macro_toc">
    <li>
      <a href="#Anchor_83956186_h1_1">エクスポートプラグインの基本機能</a>
    </li>
    <li>
      <a href="#Anchor_83956186_h1_2">オプション設定</a>
    </li>
    <ul>
      <li>
        <a href="#Anchor_83956186_h2_1">Preset Options</a>
      </li>
      <li>
        <a href="#Anchor_83956186_h2_2">Output Options</a>
      </li>
      <li>
        <a href="#Anchor_83956186_h2_3">General Options</a>
      </li>
      <li>
        <a href="#Anchor_83956186_h2_4">Animation Options</a>
      </li>
      <li>
        <a href="#Anchor_83956186_h2_5">Output File Selection</a>
      </li>
      <li>
        <a href="#Anchor_83956186_h2_6">Optimization Options</a>
      </li>
      <li>
        <a href="#Anchor_83956186_h2_7">Animation Bake Tolerance Options</a>
      </li>
      <li>
        <a href="#Anchor_83956186_h2_8">Animation Quantization Tolerance Options</a>
      </li>
      <li>
        <a href="#Anchor_83956186_h2_9">Script Options</a>
      </li>
    </ul>
    <li>
      <a href="#Anchor_83956186_h1_3">オプション設定の管理</a>
    </li>
    <ul>
      <li>
        <a href="#Anchor_83956186_h2_10">オプションの設定をシーンに保存する方法</a>
      </li>
      <li>
        <a href="#Anchor_83956186_h2_11">オプションの設定を fdes ファイルとして入出力する方法</a>
      </li>
    </ul>
    <li>
      <a href="#Anchor_83956186_h1_4">コンフィグファイル</a>
    </li>
  </ul>
</p>
<p>
  <a name="Anchor_83956186_basic_functions"></a>
</p>
<h1 id="Anchor_83956186_h1_1">エクスポートプラグインの基本機能</h1>
<p>エクスポートプラグインを使用して、特定のノードだけ出力する場合は、出力したいノードを Maya 上で選択します。<br />選択したノードの下の階層ノードも出力されます。</p>
<div class="info_new">
  <div class="info_new_left">参考：</div>
  <div class="info_new_right">
    <p>シーン全体を出力する場合は、ノードを選択する必要はありません。</p>
  </div>
</div>
<p>「Nintendo &gt; Export with Setting...」を選択して、 Nintendo&nbsp;Export のオプションウィンドウを表示します。<br />適切なオプションを設定して <strong>Export</strong> ボタンまたは<strong>適用（Apply）</strong>ボタンをクリックすると中間ファイルが出力されます。<br />適用ボタンは Export ボタンと違って出力後にオプションウィンドウを閉じません。</p>
<p>出力したときのオプションの設定が現在のオプションとして Maya 内部に記録されます。<br />また、オプションの設定をシーンに保存したり、<a href="../Pages/Page_83955854.html">3D DCC プラグイン出力設定ファイル（fdes ファイル）</a>として入出力したりすることも可能です（詳細は「<a href="#Anchor_83956186_management_option_settings">オプションの設定の管理</a>」で説明します）。</p>
<p>オプションウィンドウを表示しないで、現在のオプションで出力する場合は、「Nintendo&nbsp;&gt; Export」を選択します。</p>
<p>オプションウィンドウの<span style="color: rgb(51,51,51);">左上のメニュー</span>「編集 &gt; 設定の保存（Edit &gt; Save Settings）」を選択すると、中間ファイルを出力せずにオプション設定を Maya 内部に保存できます（<a href="#Anchor_83956186_management_option_settings">Save / Load Scene Settings</a> が ON ならシーンにも保存されます）。<br />「編集 &gt; 設定のリセット（Edit &gt; Reset Settings）」を選択すると、オプション設定をデフォルト状態に戻せます。</p>
<p>
  <a name="Anchor_83956186_edit_lock"></a>
</p>
<h3 id="Anchor_83956186_h3_1">編集ロック状態</h3>
<p>オプションウィンドウの各オプション名を右クリックして表示されるポップアップメニューから Lock を選択すると、オプションが編集できない状態（編集ロック状態）になり、錠前アイコンが表示されます。<br /> 錠前アイコンを右クリックして表示されるポップアップメニューから Unlock を選択すると、編集ロック状態が解除されます。</p>
<p>編集ロック状態はシーンや fdes ファイルに保存されます。<br /> オプションウィンドウの Nintendo&nbsp;Settings メニュー内にある Lock All Settings または Unlock All Settings を選択すると、すべてのオプションの編集ロック状態を一度に変更できます。</p>
<p>
  <a name="Anchor_83956186_option_settings"></a>
</p>
<h1 id="Anchor_83956186_h1_2">オプション設定</h1>
<p>エクスポートプラグインで設定するオプションは以下になります。</p>
<table class="wrapped">
  <tbody>
    <tr>
      <th>
        <a href="#Anchor_83956186_preset_options">Preset Options</a>
      </th>
      <td>プリセットに関するオプションです。</td>
    </tr>
    <tr>
      <th>
        <a href="#Anchor_83956186_output_options">Output Options</a>
      </th>
      <td>中間ファイルの出力方法に関するオプションです。</td>
    </tr>
    <tr>
      <th>
        <a href="#Anchor_83956186_general_options">General Options</a>
      </th>
      <td>中間ファイル全般に関するオプションです。</td>
    </tr>
    <tr>
      <th>
        <a href="#Anchor_83956186_animation_options">Animation Options</a>
      </th>
      <td>アニメーションに関するオプションです。</td>
    </tr>
    <tr>
      <th>
        <a href="#Anchor_83956186_output_file_selection">Output File Selection</a>
      </th>
      <td>出力する中間ファイルの種類を指定するオプションです。</td>
    </tr>
    <tr>
      <th>
        <a href="#Anchor_83956186_optimization_options">Optimization Options</a>
      </th>
      <td>Maya から中間ファイルを出力する際、中間ファイルオプティマイザーを使ってデータの最適化を行うことができます。最適化に関するオプションをここで指定します。</td>
    </tr>
    <tr>
      <th>
        <a href="#Anchor_83956186_animation_bake_tolerance_options">Animation Bake Tolerance Options</a>
      </th>
      <td>アニメーションをベイクして最適化する際の誤差の許容範囲を指定するオプションです。</td>
    </tr>
    <tr>
      <th>
        <a href="#Anchor_83956186_animation_quantization_tolerance_options">Animation Quantization Tolerance Options</a>
      </th>
      <td>アニメーションを量子化する際の誤差の許容範囲を指定するオプションです。</td>
    </tr>
    <tr>
      <th>
        <a href="#Anchor_83956186_script_options">Script Options</a>
      </th>
      <td>出力前後に実行するスクリプト（MEL）を指定するオプションです。</td>
    </tr>
  </tbody>
</table>
<p>
  <a name="Anchor_83956186_preset_options"></a>
</p>
<h2 id="Anchor_83956186_h2_1">Preset Options</h2>
<p>プリセットに関するオプションです。</p>
<p>プリセットとは、プリセットファイル（オプションを<a href="#Anchor_83956186_edit_lock">編集ロック状態</a>にした fdes ファイル）を使用して、オプション設定の一部または全部を特定の値に固定する機能です。</p>
<p>次のような用途に利用できます。</p>
<ul>
  <li>デザイナーのリーダーが決定したオプション設定を他のデザイナーが不用意に変更してしまわないようにする。</li>
  <li>キャラクタ用のプリセットと地形用のプリセットを用意しておいて、それぞれのオプション設定を容易に切り替えられるようにする。</li>
</ul>
<div class="info_new">
  <div class="info_new_left">参考：</div>
  <div class="info_new_right">
    <p>プリセットファイルは通常 Tools\Graphics\MayaPlugins\Config\Presets フォルダーに配置します。<br />環境変数 NINTENDO_MAYA_CONFIG で <a href="#Anchor_83956186_config_file">コンフィグファイル</a> のフォルダーを指定した場合、%NINTENDO_MAYA_CONFIG%\Presets フォルダーにプリセットファイルを配置します。</p>
  </div>
</div>
<p>また、環境変数 NINTENDO_MAYA_PRESETS でプリセットファイルのフォルダーを直接指定することも可能です（NINTENDO_MAYA_CONFIG より優先されます）。<br /> オプションウィンドウの Nintendo Settings メニュー内にある Open Presets Folder... を選択すると、Presets フォルダーをエクスプローラーで開きます（同時にオプションウィンドウを閉じます）。</p>
<p>プリセットはエクスポート実行時に評価されます。複数のシーンで同じプリセットを使用している場合、プリセットファイルの内容を変更することによって、すべてのシーンのエクスポートオプションを変更できます。</p>
<p>Preset Options 内のオプションは編集ロック状態にできません。</p>
<ul>
  <li>
    <strong>Preset</strong> <br /> 使用するプリセットの名前を指定します。<br />  Presets フォルダーに存在する fdes ファイルの名前がプリセット名としてメニューに列挙されます。<br />  プリセットを使用しない場合は  <strong>None</strong> 、プリセットを使用する場合はプリセット名を選択します。<br />  プリセットを切り替えると、 <strong>プリセットファイルで編集ロック状態になっているオプションについてはプリセットの値で上書きされます</strong> 。<br />  プリセットファイルで編集ロック状態になっていないオプションについては値は変更されません。&nbsp;<br />  プリセットを使用した場合、プリセットファイルで編集ロック状態になっているオプションの編集ロックを解除することはできません。また、編集ロックされていないオプションを編集ロック状態にすることもできません。<br />  プリセットを使用していない状態で  <strong>Save Preset...</strong>  ボタンをクリックすると、現在のオプション設定をプリセットとして Presets フォルダーに出力できます。新しいプリセットを作成する場合は  <strong>New</strong>  を選択してプリセット名を入力します。既存のプリセットに上書きする場合は  <strong>Overwrite</strong>  を選択してプリセット名を選択します。<br />  <strong>Save</strong>  ボタンをクリックするとプリセットファイルが出力され、出力したプリセットを使用した状態になります。<br />  プリセットを使用している状態で  <strong>Delete Preset...</strong>  ボタンをクリックすると、使用中のプリセットのプリセットファイルが削除され、プリセットを使用していない状態になります。<br /> 既存のプリセットの値を編集するには次の手順で操作します。<ol><li>Preset オプションで編集したいプリセットを選択</li><li>Preset オプションを None に変更</li><li>各オプションの値や編集ロック状態を変更</li><li>Save Preset... ボタンで上書き出力</li></ol></li>
</ul>
<ul>
  <li>
    <strong>Show Preset UI<br /> </strong>プリセット使用時に、プリセットファイルで編集ロック状態になっているオプションの UI を表示するなら ON にします。<br />OFF にすると編集可能なオプションの UI のみ表示できます。</li>
</ul>
<p>
  <a name="Anchor_83956186_output_options"></a>
</p>
<h2 id="Anchor_83956186_h2_2">Output Options</h2>
<p>中間ファイルの出力方法に関するオプションです。</p>
<ul>
  <li>
    <strong>Export Taget<br /> </strong>出力対象を指定します。<br /> <strong>All</strong>  を選択すると、シーン中の有効なノードがすべて出力されます。<br /> <strong>Selection</strong> を選択すると、選択したノードとその下の階層のノードだけが出力されます。</li>
  <li>
    <strong>LOD Export<br /> </strong> ON にすると LOD モデルを結合した中間ファイルを出力します。詳細については「  <a href="../Pages/Page_83956044.html">LOD エクスポート</a>  」を参照してください。</li>
  <li>
    <p>
      <strong> Output File Name<br />  </strong>中間ファイルの名前（拡張子を除く）を指定します。</p>
    <div class="info_new">
      <div class="info_new_left">参考：</div>
      <div class="info_new_right">
        <p>非 ASCII 文字や「-（ハイフン）」「.（ドット）」「_（アンダーバー）」以外の記号は使用できません。<br />空欄の場合は現在のシーン名が中間ファイル名となります。</p>
      </div>
    </div>
    <p>
      <strong>@node</strong>  と入力すると、選択されたノード（複数選択されている場合は階層が一番上のもの）の名前が中間ファイル名に反映されます。<br />  右にある  <strong>Scene</strong>  ボタンをクリックすると現在のシーン名がセットされます。<br />  <strong>Node</strong>  ボタンをクリックすると選択されたノード（複数選択されている場合は階層が一番上のもの）の名前がセットされます。<br /> ノードを選択しないで Node ボタンをクリックするとアルファベット順で先頭のノードの名前がセットされます。</p>
  </li>
  <li>
    <strong>Output Folder<br /> </strong>中間ファイルを出力するフォルダーを指定します。<br />テクスチャーファイルは Output Folder で指定したフォルダーの下の textures フォルダーに出力されます。<br />Output Folder に指定したフォルダーが存在していない場合、そのフォルダーを作成して出力します。<br />Output Folder がフルパスでない場合、現在のプロジェクトフォルダーからの相対パスとみなします。<br />Output Folder には環境変数が使用できます。環境変数は <strong>%NAME%</strong> または <strong>$NAME</strong> のように記述します。</li>
  <li>
    <strong>Merge fmd File<br /> </strong> ON にして fmd ファイルのパスを指定すると、指定した fmd ファイルをマージします。<br />  <span style="color: rgb(255,0,0);"> <strong>fmd ファイルのパスが空欄の場合、上書きする出力先ファイルをマージします。</strong> </span> <br />fmd ファイルのパスがフルパスでない場合、現在のプロジェクトフォルダーからの相対パスとみなします。<br />Merge fmd File のパスには環境変数が使用できます。<br /> fmd ファイルのマージ処理は中間ファイルオプティマイザーが実行します。マージ処理の詳細については  <a href="../Pages/Page_83955705.html#Anchor_83955705_merge">中間ファイルオプティマイザーのヘルプ</a>  を参照してください。</li>
  <li>
    <strong>Merge ftx File</strong> <br /> ON にすると ftx ファイルをマージします。 <br /> &nbsp;fmd ファイルもマージする場合、Merge fmd File で指定したファイルのフォルダーの下の textures フォルダーにある同名ファイルとマージします。<br />fmd ファイルをマージしない場合、Output Folder で指定したフォルダーの下の textures フォルダーにある同名ファイルとマージします。<br />fmd ファイルを出力しない場合も、Output Folder で指定したフォルダーの下の textures フォルダーにある同名ファイルとマージします。<br />fmd ファイルと ftx ファイルを同時にマージしない場合、fmd ファイルのミップマップフィルターと ftx ファイルのミップマップの有無が対応しなくなる可能性があるので注意してください。<br />fmd ファイルをマージしない場合、マージ対象の ftx ファイルのミップマップ設定が fmd ファイルのミップマップフィルターに影響します。<br /> ftx ファイルのマージ処理は 3D テクスチャーコンバーターが実行します。マージ処理の詳細については  <a href="../Pages/Page_239574379.html#Anchor_239574379_tex_merge">3D テクスチャーコンバーターのヘルプ</a>  を参照してください。</li>
  <li>
    <strong>Merge Animation Folder</strong> <br /> ON にしてアニメーション中間ファイルのあるフォルダーを指定すると、指定したアニメーション中間ファイルをマージします。 <br />フォルダーが空欄の場合、Output Folder で指定したフォルダーにあるアニメーション中間ファイルをマージします。<br />Merge Animation Folder には環境変数が使用できます。<br />Merge Animation Name にはマージするアニメーション中間ファイルの名前（拡張子を除く）を指定します。<br />Merge Animation Name が空欄の場合、Output File Name で指定した名前のファイルをマージします。<br />アニメーション中間ファイルのマージ処理は中間ファイルオプティマイザーが実行します。マージ処理の詳細については <a href="../Pages/Page_83955705.html#Anchor_83955705_merge">中間ファイルオプティマイザーのヘルプ</a> を参照してください。</li>
</ul>
<p>
  <a name="Anchor_83956186_general_options"></a>
</p>
<h2 id="Anchor_83956186_h2_3">General Options</h2>
<p>中間ファイル全般に関するオプションです。</p>
<ul>
  <li>
    <strong>Magnify</strong> <br /> モデルの頂点座標や移動値に掛ける倍率です。</li>
  <li>&nbsp; <strong>Texture SRT Mode</strong> <br /> テクスチャー SRT の計算方式を指定します。 <br />テクスチャー SRT の計算方式は fmd ファイルと fma ファイル（fts ファイル）に影響します。<br /> <strong>Maya</strong>  を選択すると、Maya 方式の計算方法となります。 Maya 方式では、スケールの中心は左下、回転の中心は中央、回転方向は時計回りが正です。<br />  <strong>3dsmax</strong>  を選択すると、3ds Max 方式の計算方法となります。 3dsmax 方式では、スケールと回転の中心は共に中央、回転方向は時計回りが正です。<br />  <strong>Softimage</strong>  を選択すると、Softimage 方式の計算方法となります。 Softimage 方式では、スケールと回転の中心は共に左下、回転方向は反時計回りが正です。<br /> 3dsmax 方式、Softimage 方式を指定しても、Maya の画面上には反映されません（Maya 上と、対象プラットフォーム上でテクスチャーの表示が異なる場合があります）。</li>
  <li>
    <p>
      <strong>Remove Namespace<br /> </strong>ON にすると、ノード名とマテリアル名のネームスペース部分を削除して出力します。&nbsp;<br />OFF にすると、ネームスペース部分を出力します。「:（コロン）」は「_（アンダーバー）」に変換されます。</p>
    <div class="info_new">
      <div class="info_new_left">参考：</div>
      <div class="info_new_right">
        <p>例<br />Maya 上のノード名が「model:final:head」の場合、このオプションが ON なら「head」、OFF なら「model_final_head」という名前で出力されます。</p>
      </div>
    </div>
    <p>ネームスペース部分を削除した結果、名前が重複した場合は、同名ノード（マテリアル）が複数存在する場合と同じ規則で名前が変更されます。</p>
  </li>
  <li>
    <strong>Comment<br /> </strong>中間ファイルに対する編集用コメント文を指定します。</li>
</ul>
<p>
  <a name="Anchor_83956186_animation_options"></a>
</p>
<h2 id="Anchor_83956186_h2_4">Animation Options</h2>
<p>アニメーションに関するオプションです。</p>
<ul>
  <li>
    <p>
      <strong>Start / End Frame<br /> </strong>アニメーションを出力する範囲（開始フレームと終了フレーム）を指定します。<br /> <strong>All</strong> を選択すると、Maya 上のアニメーションの全範囲（アニメーション開始 / 終了（Animation Start / End））が出力されます。<br /> <strong>Playback</strong> を選択すると Maya 上のアニメーションの再生範囲（再生開始 / 終了（Playback Start / End））が出力されます。<br /> <strong>Range</strong> を選択すると、開始フレームと終了フレームを数値入力で指定できます。<br />アトリビュートがアニメーションしている場合、fmd ファイルにはここで指定した開始フレームにおける値が出力されます。</p>
    <div class="info_new">
      <div class="info_new_left">参考：</div>
      <div class="info_new_right">
        <p>ループアニメーションの終了フレームは、開始フレームと同じ状態になるフレームを指定してください。</p>
      </div>
    </div>
    <div class="info_new">
      <div class="info_new_left">参考：</div>
      <div class="info_new_right">
        <p>Start Frame より前のフレームと、End Frame より後のフレームにおけるアニメーション再生は保証されません。</p>
      </div>
    </div>
  </li>
  <li>
    <strong>Loop<br /> </strong> ON にすると、ループ再生するデータとして出力します。<br /> OFF にすると、一度だけ再生するデータとして出力します。</li>
  <li>
    <strong>Bake All Animation<br /> </strong> ON にすると、すべてのアニメーションについて、ベイクしたデータからアニメーションカーブデータを自動作成して出力します。<br /> OFF にすると、可能な限り Maya 上のアニメーションカーブをそのまま出力します。そのまま出力できない部分はベイクしたデータからアニメーションカーブデータを自動作成して出力します。</li>
  <li>
    <p>
      <strong>Frame Precision<br /> </strong>ベイクしたデータからアニメーションカーブデータを自動作成する際の、フレームの精度を指定します。<br /> <strong>1.0</strong> にすると、整数フレーム単位でベイクを実行します。<br /> <strong>0.5</strong> にすると、0.5 フレーム単位でベイクを実行します。<br /> <strong>0.2</strong> にすると、0.2 フレーム単位でベイクを実行します。<br /> <strong>0.1</strong> にすると、0.1 フレーム単位でベイクを実行します。</p>
    <div class="info_new">
      <div class="info_new_left">参考：</div>
      <div class="info_new_right">
        <p>精度を高くすると、小数フレームのタイミングで不連続に変化するアニメーションなどを正確に再現できますが、出力に掛かる時間は長くなります。</p>
      </div>
    </div>
  </li>
</ul>
<p>
  <a name="Anchor_83956186_output_file_selection"></a>
</p>
<h2 id="Anchor_83956186_h2_5">Output File Selection</h2>
<p>出力する中間ファイルの種類を指定するオプションです。</p>
<p>
  <strong>Search Model Animation</strong> ボタンをクリックすると、出力対象のモデルに設定されているアニメーションに対応する中間ファイルのみ ON になります。<br />その際、アニメーションカーブが接続されていれば、値が変化しなくてもアニメーションが設定されているとみなします。</p>
<p>Export Target が Selection の場合は、ノードを選択してから Search Model Animation ボタンをクリックしてください。</p>
<div class="info_new">
  <div class="info_new_left">参考：</div>
  <div class="info_new_right">
    <p>1 つの fma ファイルに全マテリアルアニメーションを出力する場合、ON になっている種類のアニメーションのみ fma ファイルに含まれます。</p>
  </div>
</div>
<div class="info_new">
  <div class="info_new_left">参考：</div>
  <div class="info_new_right">
    <p>シーンアニメーションは検索されないので、手動で ON / OFF を切り替えてください。</p>
  </div>
</div>
<p>
  <a name="Anchor_83956186_optimization_options"></a>
</p>
<h2 id="Anchor_83956186_h2_6">Optimization Options</h2>
<p>Maya から中間ファイルを出力する際、<a href="../Pages/Page_83955705.html">中間ファイルオプティマイザー</a>を使ってデータの最適化を行うことができます。最適化に関するオプションをここで指定します。</p>
<p>
  <a name="Anchor_83956186_compress_bone"></a>
</p>
<ul>
  <li>
    <p>
      <strong>Compress Bone<br /> </strong>モデル全体に対する<a href="../Pages/Page_83955705.html#Anchor_83955705_compress_bone">ボーン圧縮</a>のモードを指定します。<br />ボーン数を減らすことによって行列演算の負荷が軽減され、メモリー使用量も小さくなります。</p>
    <div class="info_new">
      <div class="info_new_left">参考：</div>
      <div class="info_new_right">
        <p>圧縮されるのは中間ファイルに出力されるボーンであり、DCC ツール上のデータが変更されるわけではありません。</p>
        <p>圧縮対応ファイルは fmd ファイル、fsk ファイル、fvb ファイルです。&nbsp;</p>
      </div>
    </div>
    <table class="wrapped">
      <thead>
        <tr>
          <th>モード</th>
          <th>説明</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td class="nowrap">
            <strong>None</strong>
          </td>
          <td>ボーンを圧縮しません。DCC ツール上の階層構造のまま出力します。</td>
        </tr>
        <tr>
          <td class="nowrap">
            <strong>Cull</strong>
          </td>
          <td>
            <p>階層構造の末端に位置するモデルの表示に必要でないボーンを削除して出力します。</p>
            <p>スキニングを使用しているモデルに効果があります。</p>
            <p>圧縮不可フラグを設定したボーンは削除されません。</p>
          </td>
        </tr>
        <tr>
          <td class="nowrap">
            <strong>Merge</strong>
          </td>
          <td>
            <p>Cull の処理に加えて、行列を合成できるボーンを合成して出力します。</p>
            <p>一般に Cull よりもボーン数が減りますが、<strong>「子供を持つボーンに不均等な（X、Y、Z の値が同じでない） スケールが設定されてはいけない」</strong>という制限があります。</p>
            <p>制限が守られていないボーンおよびそのボーンの子供が圧縮されると、モデルが正しく表示されないことがあります。</p>
            <p>スケールがアニメーションしている場合は、すべてのフレームで上記の制限が守られている必要があります。</p>
            <p>圧縮不可フラグを設定したボーンは削除されません。</p>
          </td>
        </tr>
        <tr>
          <td class="nowrap">
            <strong>Unite</strong>
          </td>
          <td>圧縮不可フラグを設定していないボーンを 1 つにまとめます。スキニングモデルとの併用はできません。スキニングモデルはリジッドボディーに変換されます。</td>
        </tr>
        <tr>
          <td class="nowrap">
            <strong>Unite All</strong>
          </td>
          <td>
            <p>圧縮不可フラグに関係なく、すべてのボーンを 1 つにまとめます。</p>
            <p>ルートボーンの行列は単位行列となり、すべてのシェイプの頂点座標・法線・接線・従法線はモデル座標系の値になります。</p>
            <p>階層構造を必要としない地形データや単体オブジェクトなどに利用します。</p>
          </td>
        </tr>
      </tbody>
    </table>
    <p>圧縮対応ファイルは fmd ファイル、fsk ファイル、fvb ファイルです。</p>
    <p>
      <a name="Anchor_83956186_unite_child"></a>
    </p>
  </li>
  <li>
    <p>
      <strong> Unite Child <br /> </strong>ON にすると、階層構造の末端に位置するシェイプを持ったノードを 1 つにまとめて出力します。Compress Bone が Unite 以外の場合に有効です。<br />圧縮不可フラグを設定したボーンの子ボーンがすべて圧縮可能で、スキニングに影響していない場合に圧縮されます。圧縮不可フラグを設定したボーンが 1 つもない場合、このオプションは機能しません。</p>
  </li>
  <li>
    <p>
      <strong>Compress Material<br /> </strong>ON にすると同じアトリビュートを持つマテリアルを圧縮して 1 つにまとめて出力します。<br />  <a href="../Pages/Page_83956030.html">マテリアルアトリビュート設定プラグイン</a>  で Compress が  <strong>Don&rsquo;t compress</strong>  に設定されているマテリアルは圧縮されません。</p>
  </li>
  <li>
    <p>
      <strong>Compress Shape<br /> </strong>ON にすると、属するボーンとマテリアルが同じシェイプ（fmd ファイルの &lt;shape&gt;）が複数存在すれば 1 つにまとめて出力します。<br />OFF にすると、属するボーンとマテリアルが同じでもシェイプを個別に出力します。<br />Compress Bone が None 以外または Unite Child が ON で、ボーンがまとめられた結果 、1 つのボーンにマテリアルが同じシェイプが複数存在する状態になる場合に効果があります。<br />Compress Material が ON で、マテリアルがまとめられた結果、1 つのボーンにマテリアルが同じシェイプが複数存在する状態になる場合にも効果があります。</p>
  </li>
  <li>
    <p>
      <strong>Divide Submesh<br /> </strong>サブメッシュ分割を指定します。<br /> サブメッシュを分割する場合、ON にして右側に  <a href="../Pages/Page_83955705.html#Anchor_83955705_divide_submesh">中間ファイルオプティマイザーの --divide-submesh-options オプション</a>  の値を入力します。オプションが空欄ならサブメッシュを分割しません。</p>
    <div class="info_new">
      <div class="info_new_left">参考：</div>
      <div class="info_new_right">
        <p>例） --max-bounding-box-width=1.0</p>
      </div>
    </div>
  </li>
  <li>
    <p>
      <strong>Polygon Reduction<br /> </strong>ポリゴンリダクションを指定します。<br />ポリゴンリダクションを実行する場合、ON にして右側に <a href="../Pages/Page_83955705.html#Anchor_83955705_polygon_reduction">中間ファイルオプティマイザーの --polygon-reduction-options オプション</a>&nbsp;の値を入力します。<br />オプションが空欄ならポリゴンリダクションを実行しません。<br />LOD エクスポートモードでこのオプションを ON にすると、ポリゴンリダクションで作成した LOD モデルを Maya 上に存在する LOD モデルで置き換えたり、Maya 上に存在する LOD モデルを追加したりできます。<br />その際、--optimize-position-policy オプションは頂点共有しない値（1 以外）を指定してください。</p>
    <div class="info_new">
      <div class="info_new_left">参考：</div>
      <div class="info_new_right">
        <p>例） --target-rate-lod-level1=0.5 --target-rate-lod-level2=0.2</p>
      </div>
    </div>
  </li>
</ul>
<p>
  <a name="Anchor_83956186_animation_bake_tolerance_options"></a>
</p>
<h2 id="Anchor_83956186_h2_7">Animation Bake Tolerance Options</h2>
<p>アニメーションをベイクして最適化する際の誤差の許容範囲を指定するオプションです。</p>
<p>開始フレームにおける値と各フレームにおける値の差の最大値が、ここで指定した許容値未満の場合は、アニメーションを一定とみなし、開始フレームにおける値だけ出力します。</p>
<p>ベイクしたデータからアニメーションカーブデータを自動作成する際に、Frame Precision で指定した単位で各フレームに対するキーを作成し、<strong>エルミート補間したときの誤差の最大値</strong>がここで指定した<strong>許容値未満</strong>になるキーを削除します。</p>
<div class="info_new">
  <div class="info_new_left">参考：</div>
  <div class="info_new_right">
    <p>誤差の許容値が小さいほどアニメーションの精度は高くなりますが、キー数が多くなってアニメーションカーブデータ量が増えます。</p>
  </div>
</div>
<ul>
  <li>
    <strong>Node Translate</strong>、<strong>Node Rotate</strong>、<strong>Node Scale<br /> </strong> スケルタルアニメーションの移動、回転、スケールおよびシーンアニメーションの移動、回転（方向）に対する許容誤差を絶対値で指定します。<br /> Node Rotate の単位は度数です。<br /> Node Translate は  <strong>Magnify を掛ける前の値</strong> に対する許容誤差です。</li>
  <li>
    <strong>Texture Translate</strong>、<strong>Texture Rotate</strong>、<strong>Texture Scale<br /> </strong> テクスチャー SRT アニメーションの移動、回転、スケールに対する許容誤差を絶対値で指定します。<br /> Texture Rotate の単位は度数です。</li>
  <li>
    <strong>Color<br /> </strong>カラーアニメーションとシーンアニメーションの各カラー値に対する許容誤差を絶対値で指定します。</li>
</ul>
<p>
  <a name="Anchor_83956186_animation_quantization_tolerance_options"></a>
</p>
<h2 id="Anchor_83956186_h2_8">Animation Quantization Tolerance Options</h2>
<p>アニメーションを量子化する際の誤差の許容範囲を指定するオプションです。</p>
<ul>
  <li>
    <strong>Node Translate</strong>、<strong>Node Rotate</strong>、<strong>Node Scale<br /> </strong> スケルタルアニメーションの移動、回転、スケールおよびシーンアニメーションの移動、回転（方向）に対する許容誤差です。<br /> Node Translate と Node Scale はアニメーション結果の値の範囲に対する割合をパーセントで指定します。<br />Node Rotate は絶対値（単位は度数）で指定します。</li>
  <li>
    <strong>Texture Translate</strong>、<strong>Texture Rotate</strong>、<strong>Texture Scale<br /> </strong> テクスチャー SRT アニメーションの移動、回転、スケールに対する許容誤差です。<br /> Texture Translate と Texture Scale はアニメーション結果の値の範囲に対する割合をパーセントで指定します。<br />Texture Rotate は絶対値（単位は度数）で指定します。</li>
</ul>
<div class="info_new">
  <div class="info_new_left">参考：</div>
  <div class="info_new_right">
    <p>アニメーション中間ファイルをマージする場合、このオプションは反映されません。マージする中間ファイルの値が使用されます。</p>
  </div>
</div>
<p>
  <a name="Anchor_83956186_script_options"></a>
</p>
<h2 id="Anchor_83956186_h2_9">Script Options</h2>
<p>出力前後に実行するスクリプト（MEL）を指定するオプションです。</p>
<p>
  <a name="Anchor_83956186_pre_export_script"></a>
</p>
<ul>
  <li>
    <strong>Pre-Export Script<br /> </strong> 出力前に実行する MEL を指定します（MEL コマンドを直接記述できます）。<br /> 空欄の場合は何も実行しません。<br />Export Target オプションが Selection の場合、このオプションで「select root_node」のようにノードを選択して、出力するノードを指定できます。<br />環境変数&nbsp;NINTENDO_EXPORT_IS_MULTI_EXPORT の値を見て、マルチエクスポートプラグインで出力中でなければ選択するといった処理も可能です。  <br />Output File Name オプションが @node の場合、このオプションで選択したノードの名前が反映されます。<br />Output Folder、Merge fmd File、Merge Animation Folder オプションで環境変数を使用している場合、このオプションで環境変数に設定した値が反映されます。<br /> <a href="../Pages/Page_83955842.html#Anchor_83955842_SetOptimizerExtraOptionFmd">NintendoSetOptimizerExtraOptionFmd</a> プロシージャを呼ぶと、fmd ファイルに対する中間ファイルオプティマイザーの追加オプションを指定できます。<br /> <a href="../Pages/Page_83955842.html#Anchor_83955842_OverwriteExportOption">NintendoOverwriteExportOption</a> プロシージャを呼ぶと、出力中のエクスポートオプション設定を上書きできます。</li>
  <li>
    <strong> <a name="Anchor_83956186_post_export_script"></a>Post-Export Script<br /> </strong> 出力後に実行する MEL を指定します（MEL コマンドを直接記述できます）。<br /> 空欄の場合は何も実行しません。<br /> <strong>出力でエラーが発生した場合も、ここで指定した MEL は実行されます。</strong>後述する環境変数 <strong>NINTENDO_EXPORT_SUCCEEDED</strong> &nbsp;で出力が成功かどうか取得できます。<br />中間ファイルのマージが ON の場合、マージ後のタイミングで、指定した MEL が実行されます。<br />Pre-Export Script、Post-Export Script で指定した MEL 内では、次の環境変数から getenv コマンドで情報を取得できます。</li>
</ul>
<table class="wrapped">
  <colgroup> <col /> <col /> </colgroup>
  <thead>
    <tr>
      <th>環境変数名</th>
      <th>内容</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td class="nowrap">NINTENDO_EXPORT_SUCCEEDED</td>
      <td>出力に成功なら 1、失敗なら 0 が格納されます。<br />Post-Export Script でのみ使用可能です。</td>
    </tr>
    <tr>
      <td class="nowrap">NINTENDO_EXPORT_IS_MULTI_EXPORT</td>
      <td>マルチエクスポートプラグインで出力中なら 1、それ以外なら 0 が格納されます。</td>
    </tr>
    <tr>
      <td class="nowrap">NINTENDO_EXPORT_OUTPUT_FILE_NAME</td>
      <td>中間ファイル名（拡張子を除く）です。</td>
    </tr>
    <tr>
      <td class="nowrap">NINTENDO_EXPORT_OUTPUT_FOLDER</td>
      <td>出力フォルダーのパスです。最後に「/（スラッシュ）」が付きます。</td>
    </tr>
    <tr>
      <td class="nowrap">NINTENDO_EXPORT_FTX_FOLDER</td>
      <td>テクスチャー出力フォルダーのパスです。最後に「/（スラッシュ）」が付きます。</td>
    </tr>
    <tr>
      <td class="nowrap">NINTENDO_EXPORT_FMD_FILE_PATH</td>
      <td>fmd ファイルのフルパスです。出力しない場合は定義されません。</td>
    </tr>
    <tr>
      <td class="nowrap">NINTENDO_EXPORT_FSK_FILE_PATH</td>
      <td>fsk ファイルのフルパスです。出力しない場合は定義されません。</td>
    </tr>
    <tr>
      <td class="nowrap">NINTENDO_EXPORT_FVB_FILE_PATH</td>
      <td>fvb ファイルのフルパスです。出力しない場合は定義されません。</td>
    </tr>
    <tr>
      <td class="nowrap">NINTENDO_EXPORT_FMA_FILE_PATH</td>
      <td>fma ファイルのフルパスです。出力しない場合は定義されません。<br /> </td>
    </tr>
    <tr>
      <td class="nowrap">NINTENDO_EXPORT_FCL_FILE_PATH</td>
      <td>カラーアニメーション中間ファイル（fma または fcl）のフルパスです。出力しない場合は定義されません。&nbsp;</td>
    </tr>
    <tr>
      <td class="nowrap">NINTENDO_EXPORT_FTS_FILE_PATH</td>
      <td>テクスチャー SRT&nbsp;アニメーション中間ファイル（fma または  fts）のフルパスです。出力しない場合は定義されません。</td>
    </tr>
    <tr>
      <td class="nowrap">NINTENDO_EXPORT_FTP_FILE_PATH</td>
      <td>テクスチャーパターンアニメーション中間ファイル（fma または  ftp）のフルパスです。出力しない場合は定義されません。</td>
    </tr>
    <tr>
      <td class="nowrap">NINTENDO_EXPORT_FSH_FILE_PATH</td>
      <td>fsh ファイルのフルパスです。出力しない場合は定義されません。</td>
    </tr>
    <tr>
      <td class="nowrap">NINTENDO_EXPORT_FSN_FILE_PATH</td>
      <td>fsn ファイルのフルパスです。出力しない場合は定義されません。</td>
    </tr>
    <tr>
      <td class="nowrap">NINTENDO_EXPORT_FTX_ENABLED</td>
      <td>ftx ファイルの出力指定が ON なら 1、OFF なら 0 が格納されます。</td>
    </tr>
    <tr>
      <td class="nowrap">NINTENDO_EXPORT_G3D_TOOL_FOLDER</td>
      <td>g3d の 3dTools フォルダーのパスです。<br />最後に「/（スラッシュ）」が付きます。</td>
    </tr>
    <tr>
      <td class="nowrap">NINTENDO_EXPORT_FTX_FILE_NAMES</td>
      <td>出力した ftx ファイル名（拡張子を含む）を半角スペースで区切って並べた文字列です。出力しない場合は定義されません。<br />Post-Export Script でのみ使用可能です。</td>
    </tr>
    <tr>
      <td class="nowrap">NINTENDO_EXPORT_USED_FTX_FILE_NAMES</td>
      <td>モデルが使用する ftx ファイル名（拡張子を含む）を半角スペースで区切って並べた文字列です。<br />fmd ファイルまたは ftx ファイルを出力する場合に定義されます。<br />（値は NINTENDO_EXPORT_FTX_FILE_NAMES と同じですが、ftx ファイルを出力しない場合でも取得可能です。）<br />Post-Export Script でのみ使用可能です。</td>
    </tr>
    <tr>
      <td class="nowrap">NINTENDO_EXPORT_TEMP_OUTPUT_FOLDER</td>
      <td>テンポラリー出力フォルダーのパスです。最後に「/（スラッシュ）」が付きます。</td>
    </tr>
    <tr>
      <td class="nowrap">NINTENDO_EXPORT_TEMP_FTX_FOLDER</td>
      <td>テンポラリーテクスチャー出力フォルダーのパスです。最後に「/（スラッシュ）」が付きます。</td>
    </tr>
    <tr>
      <td class="nowrap">NINTENDO_EXPORT_TEMP_FMD_FILE_PATH</td>
      <td>テンポラリー出力フォルダーの fmd ファイルのフルパスです。出力しない場合は定義されません。</td>
    </tr>
    <tr>
      <td class="nowrap">NINTENDO_EXPORT_TEMP_FSK_FILE_PATH</td>
      <td>テンポラリー出力フォルダーの fsk ファイルのフルパスです。出力しない場合は定義されません。</td>
    </tr>
    <tr>
      <td class="nowrap">NINTENDO_EXPORT_TEMP_FVB_FILE_PATH</td>
      <td>テンポラリー出力フォルダーの fvb ファイルのフルパスです。出力しない場合は定義されません。</td>
    </tr>
    <tr>
      <td class="nowrap">NINTENDO_EXPORT_TEMP_FMA_FILE_PATH</td>
      <td>テンポラリー出力フォルダーの fma ファイルのフルパスです。出力しない場合は定義されません。<br /> </td>
    </tr>
    <tr>
      <td class="nowrap">NINTENDO_EXPORT_TEMP_FCL_FILE_PATH</td>
      <td>テンポラリー出力フォルダーのカラーアニメーション中間ファイル（fma または  fcl）のフルパスです。出力しない場合は定義されません。</td>
    </tr>
    <tr>
      <td class="nowrap">NINTENDO_EXPORT_TEMP_FTS_FILE_PATH</td>
      <td>テンポラリー出力フォルダーのテクスチャー SRT&nbsp;アニメーション中間ファイル（fma または  fts）のフルパスです。出力しない場合は定義されません。</td>
    </tr>
    <tr>
      <td class="nowrap">NINTENDO_EXPORT_TEMP_FTP_FILE_PATH</td>
      <td>テンポラリー出力フォルダーのテクスチャーパターンアニメーション中間ファイル（fma または  ftp）のフルパスです。出力しない場合は定義されません。</td>
    </tr>
    <tr>
      <td class="nowrap">NINTENDO_EXPORT_TEMP_FSH_FILE_PATH</td>
      <td>テンポラリー出力フォルダーの fsh ファイルのフルパスです。出力しない場合は定義されません。</td>
    </tr>
    <tr>
      <td class="nowrap">NINTENDO_EXPORT_TEMP_FSN_FILE_PATH</td>
      <td>テンポラリー出力フォルダーの fsn ファイルのフルパスです。出力しない場合は定義されません。</td>
    </tr>
    <tr>
      <td class="nowrap">NINTENDO_EXPORT_FRAME_COUNT</td>
      <td>アニメーションのフレーム数（終了フレーム - 開始フレーム）です。</td>
    </tr>
    <tr>
      <td class="nowrap">NINTENDO_EXPORT_SUB_FRAME_COUNT</td>
      <td>
        <p>ベイクするフレーム（サブフレーム）の総数です。</p>
        <p>frame_resolution = 1.0 / (Frame Precision) として、次の式で計算した値です。</p>
        <p>(終了フレーム数 - 開始フレーム) * frame_resolution + 1</p>
      </td>
    </tr>
    <tr>
      <td class="nowrap">NINTENDO_EXPORT_OPTION_<em>keyword</em></td>
      <td>各エクスポートオプションの値が格納されます。<br /> <em>keyword</em> には <a href="../Pages/Page_83955854.html">fdes ファイル</a>の各キーワードが入ります。<br /> 値も fdes ファイルと同じです。<br /> たとえば、NINTENDO_EXPORT_OPTION_export_target には<br /> all または selection が格納されます。<br /> 以下のキーワードには対応していません。<br /> settings_version、date_time、show_preset_ui<br /> output_file_name、output_folder<br /> output_fmd/ftx/fsk/fvb/fcl/fts/ftp/fsh/fsn<br /> pre_export_script、post_export_script、lock_*</td>
    </tr>
  </tbody>
</table>
<div class="info_new">
  <div class="info_new_left">参考：</div>
  <div class="info_new_right">
    <p>Pre-Export Script では、環境変数 NINTENDO_EXPORT_FTX_FILE_NAMES と NINTENDO_EXPORT_USED_FTX_FILE_NAMES を使用できませんが、<a href="../Pages/Page_83955842.html#Anchor_83955842_GetUsedFtxFileNames">NintendoGetUsedFtxFileNames</a> プロシージャを呼ぶことでモデルを出力した場合の ftx ファイル名一覧を取得できます。 <br />Pre-Export Script 内で出力対象を選択する場合、選択後に NintendoGetUsedFtxFileNames() を呼ぶと、出力対象が使用する ftx ファイル名一覧を取得できます。</p>
    <p>
      <br />
    </p>
  </div>
</div>
<div class="info_new">
  <div class="info_new_left">参考：</div>
  <div class="info_new_right">
    <p>Output Folder オプションでユーザー定義の環境変数を使用している場合、Pre-Export Script でユーザー定義の環境変数を設定しても環境変数 NINTENDO_EXPORT_OUTPUT_FOLDER には反映されませんが、<a href="../Pages/Page_83955842.html#Anchor_83955842_UpdateEnvVarForScript">NintendoUpdateEnvVarForScript</a> プロシージャを呼ぶことで反映されます。</p>
  </div>
</div>
<div class="info_new">
  <div class="info_new_left">参考：</div>
  <div class="info_new_right">
    <p>環境変数 NINTENDO_EXPORT_TEMP_* は、<a href="#Anchor_83956186_config_file">コンフィグファイルの設定</a>によって、テンポラリーフォルダーに出力した状態で Post-Export Script を実行する場合のみ定義されます。</p>
  </div>
</div>
<div class="info_new">
  <div class="info_new_left">参考：</div>
  <div class="info_new_right">
    <p>マテリアルアニメーションの種類ごとに個別の fma ファイルに出力する場合、環境変数 NINTENDO_EXPORT_FMA_FILE_PATH、NINTENDO_EXPORT_TEMP_FMA_FILE_PATH は定義されません。<br /> </p>
  </div>
</div>
<p>一時的にスクリプトを無効にしたい場合は行頭に「//」を記述します。</p>
<table class="codeblock">
  <tbody>
    <tr>
      <td class="code">
        <div class="codeblock"><pre>//parent -w pCube1</pre></div>
      </td>
    </tr>
  </tbody>
</table>
<p>MEL ファイルを実行するには source コマンドを使用します。</p>
<table class="codeblock">
  <tbody>
    <tr>
      <td class="code">
        <div class="codeblock"><pre>source &quot;D:/data/post_export1.mel&quot;</pre></div>
      </td>
    </tr>
  </tbody>
</table>
<p>Python スクリプトは、次のように MEL の python コマンド経由で実行できます。</p>
<table class="codeblock">
  <tbody>
    <tr>
      <td class="code">
        <div class="codeblock"><pre>python &quot;import maya.cmds; maya.cmds.move(1, 0, 0, r=1)&quot;</pre></div>
      </td>
    </tr>
  </tbody>
</table>
<p>Python ファイルを実行するには execfile 関数を使用します。</p>
<table class="codeblock">
  <tbody>
    <tr>
      <td class="code">
        <div class="codeblock"><pre>python &quot;execfile(\&quot;D:/data/post_export1.py\&quot;)&quot;</pre></div>
      </td>
    </tr>
  </tbody>
</table>
<p>system コマンド経由で Windows のバッチファイルを実行することもできます。</p>
<table class="codeblock">
  <tbody>
    <tr>
      <td class="code">
        <div class="codeblock"><pre>// コマンドプロンプトを表示しない場合
system &quot;D:/data/post_export1.bat&quot;

// コマンドプロンプトを表示する場合
system &quot;start D:/data/post_export1.bat&quot;

// バッチファイルで echo した文字列をスクリプトエディタに表示する場合
print `system &quot;D:/data/post_export1.bat&quot;`</pre></div>
      </td>
    </tr>
  </tbody>
</table>
<p>Windows のバッチファイル内でも上記の環境変数を使用できます。</p>
<table class="codeblock">
  <tbody>
    <tr>
      <td class="code">
        <div class="codeblock"><pre>rem バッチファイルで各 ftx ファイルのフルパスを使用する例です。

for %%I in (%NINTENDO_EXPORT_FTX_FILE_NAMES%) do (
&nbsp;&nbsp;&nbsp;&nbsp;echo %NINTENDO_EXPORT_FTX_FOLDER%%%I
)</pre></div>
      </td>
    </tr>
  </tbody>
</table>
<p>
  <a name="Anchor_83956186_management_option_settings"></a>
</p>
<h1 id="Anchor_83956186_h1_3">オプション設定の管理</h1>
<p>オプションの設定をシーンに保存したり、<a href="../Pages/Page_83955854.html">fdes ファイル</a>として入出力したりするには、オプションウィンドウの <strong>Nintendo Settings</strong> メニューの項目を使用します。</p>
<p>
  <span class="embedded-file-wrapper ">
    <img src="../Attachments/Attach_83956186/83081430.png" class="embedded-image" />
  </span>
</p>
<p>
  <a name="Anchor_83956186_option_save"></a>
</p>
<h2 id="Anchor_83956186_h2_10">オプションの設定をシーンに保存する方法</h2>
<p>
  <strong>Save / Load Scene Settings</strong> が ON の場合（デフォルトは ON になっています）、シーンを保存するときに、最後に中間ファイルを出力したときのオプションの設定がシーンデータに保存されます（内部的には &quot;nw4fExpDialog_Setting1&quot; という名前の script ノードに保存しています）。<br />そして、シーンを開いたときにシーンデータに保存されていたオプションの設定が現在の設定として読み込まれます。</p>
<p>オプションの設定がシーンデータに保存されていない場合は、現在のオプションの設定が残ります。</p>
<p>オプションウィンドウの<span style="color: rgb(51,51,51);">左上のメニュー</span>「編集 &gt; 設定の保存（Edit &gt; Save Settings）」を選択した場合も、中間ファイルを出力したときと同様にオプションの設定が更新されます。</p>
<p>
  <strong>Save / Load Scene Settings</strong> が OFF の場合、最後に中間ファイルを出力したときのオプションの設定はシーンデータに保存されません。<br />また、シーンデータを開いたときも、オプションの設定は読み込まれません。</p>
<p>
  <strong>Delete Scene Settings</strong> を選択すると、オプションの設定を保存した script ノードが消去されます。</p>
<p>
  <strong>Revert to Original Scene Settings</strong> を選択すると、現在のシーンを開いたときにシーンに保存されていたオプション設定に戻します。</p>
<p>
  <a name="Anchor_83956186_option_fdes_inout"></a>
</p>
<h2 id="Anchor_83956186_h2_11">オプションの設定を fdes ファイルとして入出力する方法</h2>
<p>オプションの設定を fdes ファイルに出力するには、<strong>Save Settings to fdes File...</strong> を選択します。ファイル選択ウィンドウで出力ファイル名を指定すると出力されます。<br />このとき、出力ファイルの拡張子が .fdes でなければ、自動的に .fdes が追加されます。</p>
<p>オプションの設定を fdes ファイルから入力するには、<strong>Load Settings from fdes File...</strong> を選択します。<br />ファイル選択ウィンドウで入力ファイル名を指定すると入力されます。このとき、Nintendo Settings メニューの Save / Load Scene Settings が ON なら、オプションの設定をシーン中に保存した script ノードも更新されます。</p>
<p>
  <a name="Anchor_83956186_config_file"></a>
</p>
<h1 id="Anchor_83956186_h1_4">コンフィグファイル</h1>
<p>Tools\Graphics\MayaPlugins\Config フォルダーにあるコンフィグファイル Export.ini を編集すると、エクスポートプラグインの動作をカスタマイズできます。</p>
<p>エクスポートを実行したときに&nbsp;Export.ini が存在しなければ、上記フォルダーにある Export_Sample.ini が Export.ini にコピーされて読み込まれます。</p>
<p>他のフォルダーにあるコンフィグファイルを使用したい場合は、環境変数 <strong>NINTENDO_MAYA_CONFIG</strong> にフォルダーのパスを設定した状態でエクスポートプラグインを使用してください。</p>
<p>コンフィグファイルの各行には、カスタマイズ項目に対応するキーワードと設定内容を表す値を次のように記述します。</p>
<table class="codeblock">
  <tbody>
    <tr>
      <td class="code">
        <div class="codeblock"><pre>キーワード=&quot;値&quot;</pre></div>
      </td>
    </tr>
  </tbody>
</table>
<p># から始まる行はコメント行で無視されます。</p>
<p>各キーワードについて説明します。<br /> キーワードが存在しない場合はデフォルト値が使用されます。</p>
<ul>
  <li>
    <strong>display_profile<br /> </strong>出力時に各処理の処理時間や中間ファイルオプティマイザーのコマンドとメッセージなどをスクリプトエディタに表示するなら true、表示しないなら false を指定します。デフォルトは false です。</li>
  <li>
    <strong>project_root<br /> </strong>アプリケーションのプロジェクトのルートフォルダーを指定します（Maya のプロジェクトではありません）。&nbsp;<br />指定した場合、中間ファイルの &lt;create&gt; の src_path にルートフォルダーからの相対パスを出力します。空文字なら絶対パスを出力します。% で囲われた環境変数を含めることもできます。&nbsp;</li>
  <li>
    <strong>max_vertex_skinning_count<br /> </strong>スキニングのウェイト値を分配可能な最大ノード数を 1 以上 8 以下の整数値で指定します。<br />指定した値を超える数のノードにウェイト値が分配されていればエラーになります。<br />ただし、8 を指定した場合は、9 ノード以上に分配されていてもエラーにはならず、ウェイト値の大きい順に 8 ノードまでが反映されます。<br />デフォルトは 8 です。</li>
  <li>
    <strong>adjust_smooth_skinning<br /> </strong>Maya 上のノード単位で中間ファイルのシェイプがスムーススキニングか判定するなら true、シェイプ（マテリアルが同じポリゴン群）単位で判定するなら false を指定します。デフォルトは true&nbsp;です。<br />スムーススキニングとリジッドスキニングの計算の誤差によるドット欠けが目立つ場合は true を指定します。</li>
  <li>
    <strong>  <a name="Anchor_83956186_compress_ignoring_vertex_skinning_count"></a> compress_ignoring_vertex_skinning_count</strong> <br />Compress Shape オプションを ON にした際に、1 頂点に影響するスキニングのノード数が異なるシェイプを圧縮するなら true、圧縮しないなら false を指定します。デフォルトは false です。<br />詳細は<a href="../Pages/Page_83955705.html#Anchor_83955705_compress_shape">中間ファイルオプティマイザーのヘルプ</a>を参照してください。</li>
  <li>
    <p>
      <strong>optimize_primitive<br /> </strong>プリミティブ最適化のモードを指定します。</p>
    <table class="wrapped">
      <colgroup>
        <col />
        <col />
      </colgroup>
      <thead>
        <tr>
          <th>モード</th>
          <th>説明</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td class="nowrap">
            <strong>none</strong>
          </td>
          <td>プリミティブ最適化をしません。</td>
        </tr>
        <tr>
          <td class="nowrap">
            <strong>default</strong>
          </td>
          <td>通常のプリミティブ最適化をします。</td>
        </tr>
        <tr>
          <td class="nowrap">
            <strong>force</strong>
          </td>
          <td>時間を掛けてプリミティブ最適化をします。</td>
        </tr>
        <tr>
          <td class="nowrap">
            <strong>brute_force</strong>
          </td>
          <td>より長い時間を掛けてプリミティブ最適化をします。</td>
        </tr>
        <tr>
          <td class="nowrap">
            <strong>forsyth</strong>
          </td>
          <td>Forsyth アルゴリズムでプリミティブ最適化をします。</td>
        </tr>
      </tbody>
    </table>
    <p>デフォルトは forsyth&nbsp;です。</p>
  </li>
  <li>
    <strong>quantization_analysis<br /> </strong>量子化分析を有効にするなら true、無効にするなら false を指定します。デフォルトは true です。</li>
  <li>
    <strong>delete_near_vertex<br /> </strong>近似頂点削除を指定します。 &nbsp;<a href="../Pages/Page_83955705.html#Anchor_83955705_delete_near_vertex">中間ファイルオプティマイザー の --delete-near-vertex-options オプション</a>&nbsp;の値を指定します。空欄なら近似頂点を削除しません。デフォルトは空欄です。</li>
  <li>
    <strong>disable_original_image<br /></strong>ftx ファイルにエンコード前の元画像データを含めないなら true、含めるなら false を指定します。デフォルトは false です。</li>
  <li>
    <strong>texture_ヒント情報<br /> </strong>テクスチャーのヒント情報ごとにガンマのリニアー変換を指定します。<br />ガンマを sRGB からリニアーに変換するなら 1、変換しないなら 0 を RGBA の順に 4 文字で指定します。<br />たとえば 1110 とすると、RGB 成分は変換しますが A 成分は変換しません。<br />デフォルトはヒント情報が albedo、emission、specular、reflection なら 1110、その他なら 0000（どの成分も変換しない）です。</li>
  <li>
    <strong>use_srgb_fetch<br /> </strong>テクスチャーのガンマのリニアー変換指定が 1110 または 1111 で、グレースケール画像でない場合に srgb_* フォーマットを使用するなら true、 unorm_* フォーマットを使用するなら false を指定します。デフォルトは true です。</li>
  <li>
    <strong>normal_texture_format<br /> </strong>法線マップ用テクスチャーのフォーマットを指定します。3D テクスチャーコンバーターが対応しているフォーマット（bc6、float_* 以外）を指定できます。デフォルトは snorm_bc5 です。<br />&quot;フォーマット,成分選択&quot; の形式で成分選択を指定することもできます。成分選択を指定しなければ <a href="../Pages/Page_239574379.html#Anchor_239574379_comp_sel">フォーマットに応じた成分選択</a> を適用します。</li>
  <li>
    <strong>enable_weighted_compress<br /> </strong>bc1、bc2、bc3、etc1、etc2&nbsp;フォーマットのテクスチャーを圧縮する際に、RGB の誤差に対して人間の目に合わせた重み付けをするなら true、重み付けをしないなら false を指定します。デフォルトは false です。</li>
  <li>
    <strong>gpu_encoding<br /> </strong>テクスチャーが GPU エンコーディングの対象フォーマットの場合に、GPU でエンコードするなら true、CPU でエンコードするなら false、可能なら GPU でエンコードして不可能なら CPU でエンコードするなら auto&nbsp;を指定します。デフォルトは true です。<strong> <br /> </strong></li>
  <li>
    <strong>filter_mip<br /> </strong>テクスチャーのミップマップが有効な場合のミップマップフィルターを point または linear で指定します。デフォルトは linear です。</li>
  <li>
    <strong> <a name="Anchor_83956186_sampler_merge_priority"></a>sampler_merge_priority<br /> </strong>fmd ファイルをマージする際に、Maya 側のサンプラー情報を優先してマージするなら true、マージファイルのサンプラー情報を優先してマージするなら false を指定します。デフォルトは false です。<br />詳細は <a href="../Pages/Page_83955705.html#Anchor_83955705_sampler_merge">中間ファイルオプティマイザーのヘルプ</a> を参照してください。</li>
  <li>
    <strong>use_fcl_fts_ftp<br /> </strong>マテリアルアニメーションの種類ごとに異なる拡張子の中間ファイルに出力するなら true、すべて fma ファイルに出力するなら false を指定します。デフォルトは true です。<br />true の場合、カラーアニメーションを fcl ファイル、テクスチャー SRT アニメーションを fts ファイル、テクスチャーパターンアニメーションを ftp ファイルに出力します。</li>
  <li>
    <strong>separate_material_anim<br /> </strong>マテリアルアニメーションの種類ごとに個別の fma ファイルに出力するなら true、1 つの fma ファイルに全マテリアルアニメーションを出力するなら false&nbsp;を指定します。デフォルトは false です。<br />true の場合、出力ファイル名に既定のサフィックスが追加されます（カラーアニメーションは _fcl、テクスチャー SRT アニメーションは _fts、テクスチャーパターンアニメーションは _ftp）。<br />use_fcl_fts_ftp が true の場合、このキーワードは無視されます。<strong> <br /> </strong></li>
  <li>
    <strong>  <a name="Anchor_83956186_bone_visibility_merge_priority"></a> bone_visibility_merge_priority<br class="_mce_tagged_br" /> </strong>fmd ファイルをマージする際に、Maya 側のノードの可視性（ボーンビジビリティー）を優先してマージするなら true、マージファイルのボーンビジビリティーを優先してマージするなら false&nbsp;を指定します。デフォルトは false です。</li>
</ul>
<ul>
  <li>
    <strong>export_bone_visibility_all<br /> </strong>すべてのノードのボーンビジビリティーアニメーションをバイナリーファイル（.bfres）に出力するなら true、可視性にアニメーションが設定されているノードのみ出力するなら false を指定します。デフォルトは true です。</li>
  <li>
    <strong>error_preset_none<br /> </strong>プリセットが None の状態で出力した場合にエラーを発生するなら true、エラーを発生しないなら false を指定します。デフォルトは false です。<strong> <br /> </strong></li>
  <li>
    <strong>error_wrong_file_name<br /> </strong>出力する中間ファイル名に非 ASCII 文字やサポート外の記号が含まれる場合に エラーを発生するなら true、エラーを発生しないなら false を指定します。「-（ハイフン）」「.（ドット）」「_（アンダーバー）」以外の記号はサポート外です。デフォルトは true です。<br />false を指定した場合でも、ファイル名に使用できない文字や「;（セミコロン）」が含まれるとエラーを発生します。</li>
  <li>
    <strong>error_no_texture_file_always</strong> <br />ftx ファイルを出力しない場合でも、file ノードで指定したテクスチャーファイルがなければエラーを発生するなら true、エラーを発生しないなら false を指定します。デフォルトは false です。<br />fmd ファイルを出力しない場合は、true が指定されていてもエラーを発生しません。<strong> <br /> </strong></li>
  <li>
    <strong>warning_node_name_changed<br /> </strong>ノード名を変更して出力した場合に警告を表示するなら true、警告を表示しないなら false を指定します。デフォルトは true です。</li>
  <li>
    <strong>use_temp_folder_for_script<br class="_mce_tagged_br" /> </strong>中間ファイルをテンポラリーフォルダーに出力した状態で Post-Export Script を実行するなら true、本来の出力フォルダーに出力してから Post-Export Script を実行するなら false を指定します。デフォルトは false です。<br />true を指定した場合、Post-Export Script 実行後にテンポラリーフォルダーの中間ファイルを本来の出力フォルダーに移動します。ただし、Post-Export Script で MEL のエラーが発生した場合は移動しません。<br />次のようなケースでは true を指定してください。<br /><ul><li>Post-Export Script で中間ファイルを加工していて、加工に失敗したら本来の出力フォルダーに出力したくない場合</li><li>Post-Export Script で中間ファイルを加工していて、加工後に 3DEditor に自動再読み込みさせたい場合</li></ul>Post-Export Script では、環境変数 <a href="#Anchor_83956186_post_export_script">NINTENDO_EXPORT_TEMP_OUTPUT_FOLDER</a> などからテンポラリーフォルダーやテンポラリー中間ファイルのパスを取得できます。</li>
  <li>
    <strong>delete_temp_file_on_error</strong> <br />Post-Export Script や中間ファイルオプティマイザーでエラーが発生した場合に、テンポラリーフォルダーに出力した中間ファイルを削除するなら true、削除しないなら false を指定します。デフォルトは true です。<br />中間ファイルオプティマイザーが扱う中間ファイルのパスは、display_profile で true を指定しているとスクリプトエディタに表示されます。</li>
  <li>
    <p>
      <a name="Anchor_83956186_user_custom_ui"></a> <strong>user_custom_ui</strong> <br />エクスポートプラグインのオプションウィンドウにユーザーカスタム UI を追加するスクリプト（MEL）を指定します。右辺の文字列内ではダブルクォートの代わりにシングルクォートを使用します。空文字ならユーザーカスタム UI を追加しません。<br />たとえば、次の MEL をパスの通ったフォルダーに&nbsp;MyNwCreateUi.mel という名前で保存し、コンフィグファイルで user_custom_ui=&quot;MyNwCreateUi&quot; を指定すると、オプションウィンドウの最上部に 3DEditor を起動するボタンが追加されます。</p>
    <table class="codeblock">
      <tbody>
        <tr>
          <td class="code">
            <div class="codeblock"><pre>global proc MyNwStart3dEditor()
{
&nbsp;&nbsp;&nbsp;&nbsp;string $bridge = getenv(&quot;NINTENDO_MAYA_ROOT&quot;) + &quot;/../3dEditor/3dEditorBridge.exe&quot;;
&nbsp;&nbsp;&nbsp;&nbsp;string $cmd = &quot;\&quot;&quot; + $bridge + &quot;\&quot; start-3deditor&quot;;
&nbsp;&nbsp;&nbsp;&nbsp;// プロジェクト特有の起動オプションがあれば、ここで $cmd に追加します。
&nbsp;&nbsp;&nbsp;&nbsp;print(`system(&quot;\&quot;&quot; + $cmd + &quot;\&quot;&quot;)`);
}
 
global proc MyNwCreateUi()
{
&nbsp;&nbsp;&nbsp;&nbsp;columnLayout -cat &quot;both&quot; 8 -rs 4;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;button -w 160 -l &quot;Start 3DEditor&quot; -c &quot;MyNwStart3dEditor&quot;;
&nbsp;&nbsp;&nbsp;&nbsp;setParent ..; // columnLayout
}</pre></div>
          </td>
        </tr>
      </tbody>
    </table>
  </li>
  <li>
    <strong>multi_export_user_custom_ui</strong> <br />マルチエクスポートプラグインのウィンドウにユーザーカスタム UI を追加するスクリプト（MEL）を指定します。右辺の文字列内ではダブルクォートの代わりにシングルクォートを使用します。空文字ならユーザーカスタム UI を追加しません。<br />使用方法はキーワード&nbsp;user_custom_ui と同様です。</li>
  <li>
    <p>
      <strong>
        <a name="Anchor_83956186_multi_export_user_custom_list_menu"></a>multi_export_user_custom_list_menu0</strong>
      <br /> マルチエクスポートプラグインで、出力アイテムのリストを右クリックした際に表示するユーザーカスタムメニューを &quot;<strong>メニュー名,実行するプロシージャ名,タイプ,注釈</strong>&quot; の形式で指定します（タイプと注釈は省略可能）。空文字ならユーザーカスタムメニューを表示しません。<br />タイプは <strong>single</strong>（リストの項目を 1 つだけ選択した場合に表示）または <strong>multi</strong>（1 つまたは複数選択した場合に表示）を指定します（省略時は multi）。<br />プロシージャの引数は選択された出力アイテムのインデックス配列です。</p>
    <table class="codeblock">
      <tbody>
        <tr>
          <td class="code">
            <div class="codeblock"><pre>global proc MyNwMultiExportCustomData(int $itemIdxs[])
{
&nbsp;&nbsp;&nbsp;&nbsp;...
}</pre></div>
          </td>
        </tr>
      </tbody>
    </table>
    <table class="codeblock">
      <tbody>
        <tr>
          <td class="code">
            <div class="codeblock"><pre>multi_export_user_custom_list_menu0=&quot;My Export,MyNwMultiExportCustomData,multi,Export custom data&quot;</pre></div>
          </td>
        </tr>
      </tbody>
    </table>
    <p>menu0 から menu3 まで最大 4 つ指定できます。<br />multi_export_user_custom_list_menu1<br />multi_export_user_custom_list_menu2<br />multi_export_user_custom_list_menu3</p>
  </li>
</ul>
<p>
  <br />
</p>
</div>
<div class="breadcrumb_bottom"></div>
<div class="page_navigation">
<table class="page_navi_root">
<tr>
<td class="page_navi_left"></td>
<td class="page_navi_right"></td>
</tr>
<tr><td colspan="2" class="page_navi_bottom"></td></tr>
</table>
</div>
</div>
</div>
</body>
</html>
