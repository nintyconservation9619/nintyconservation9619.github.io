<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<script type="text/javascript" src="../template/js/jquery/jquery.js"></script>
<script type="text/javascript" src="../template/js/common/manualLib.js"></script>
<script type="text/javascript" src="../tocData.js"></script>
<link rel="stylesheet" type="text/css" href="../template/css/template.css" />
<title>テクスチャーエクスポートプラグイン</title>
</head>
<body data-reassemble="autoindex=no,forceNoLabel=yes">
<div id="autoindex_content">
<div class="body_content">
<noscript>
<div style="border: 4px double black; margin: 4px; padding: 2px; font-weight: bold; background-color: #FFFFCC;">
<p>お使いのブラウザは JavaScript が使用できないため、本ドキュメントの一部機能が無効になっています。</p><p>JavaScript が無効の環境では目次を使用することができません。<br />JavaScriptの実行が許可された状態で閲覧してください。<br /><br /></p>
</div>
</noscript>
<div class="page_navigation_top">
<table class="page_navi_root">
<tr>
<td class="page_navi_left"></td>
<td class="page_navi_right"></td>
</tr>
</table>
</div>
<div class="breadcrumb"></div>

<!-- テクスチャーエクスポートプラグイン -->
<div class="pagetitle" id="PageId_83956098">テクスチャーエクスポートプラグイン</div>
<div class="text_separate">
<h1 id="Anchor_83956098_h1_1">テクスチャーエクスポートプラグイン</h1>
<p>ここでは、テクスチャーエクスポートプラグインの機能と使用方法を説明します。</p>
<p>
  <ul class="macro_toc">
    <li>
      <a href="#Anchor_83956098_h2_1">使用方法</a>
    </li>
    <li>
      <a href="#Anchor_83956098_h2_2">オプション設定</a>
    </li>
    <li>
      <a href="#Anchor_83956098_h2_3">コンフィグファイル</a>
    </li>
    <li>
      <a href="#Anchor_83956098_h2_4">注意事項</a>
    </li>
    <ul>
      <li>
        <a href="#Anchor_83956098_h3_1">イメージモード</a>
      </li>
      <li>
        <a href="#Anchor_83956098_h3_2">アルファチャンネル</a>
      </li>
      <li>
        <a href="#Anchor_83956098_h3_3">レイヤー</a>
      </li>
    </ul>
    <li>
      <a href="#Anchor_83956098_h2_5">バッチファイルによる出力</a>
    </li>
    <li>
      <a href="#Anchor_83956098_h2_6">スクリプトからの利用</a>
    </li>
    <li>
      <a href="#Anchor_83956098_h2_7">関連リンク</a>
    </li>
  </ul>
</p>
<h2 id="Anchor_83956098_h2_1">使用方法</h2>
<ul>
  <li>最初にテクスチャー中間ファイル（.ftxb ファイル）および TGA ファイルを出力する PSD ファイルを開きます。<br /> 中間ファイルおよび TGA ファイルは PSD ファイルからの相対パスで出力するため、PSD ファイルが保存済みである必要があります。<br /> 以下の説明では、中間ファイルおよび TGA ファイルを「テクスチャーファイル」と記述します。</li>
  <li>PSD ファイルに出力オプション設定を保存する場合は、[ファイル] &rarr; [自動処理] &rarr; [Nintendo Export Texture Settings...] を実行します。<br /> オプションダイアログで各オプションを設定して <strong>OK</strong> ボタンをクリックすると出力オプション設定が保存されます。<br /> <strong>Cancel</strong> ボタンをクリックすると出力オプション設定を保存せずにオプションダイアログを閉じます。<br /> 出力オプション設定はデフォルトではファイル情報の「キーワード」に保存されますが、 <a href="#Anchor_83956098_tex_config">コンフィグファイル</a> で保存先を変更することも可能です。<br /> <strong>Export</strong> ボタンをクリックすると、現在の設定でテクスチャーファイルを出力します。その際、出力オプション設定は保存されません。<br /> <strong>Export Selected Layer Comp</strong> ボタンをクリックすると、現在の設定で、選択されているレイヤーカンプのテクスチャーファイルのみ出力します。その際、出力オプション設定は保存されません。<br /> <strong>Data Size</strong> には現在の出力オプション設定におけるテクスチャーの実データサイズ、幅、高さ、ミップマップのレベル数などが表示されます。対象プラットフォームによってはバイナリ変換時にデータがタイリングされるので、テクスチャーバイナリファイルにおけるデータサイズはこの値より大きくなる場合があります。<br /> <strong>Linear</strong> には、ガンマを sRGB からリニアーに変換する RGBA 成分があれば表示されます（変更はできません）。<br /> リニアー変換は <a href="#Anchor_83956098_tex_config">コンフィグファイル</a> で、フォーマット選択のプリセットに対して設定します。</li>
  <li>PSD ファイルに保存された出力オプション設定に従ってテクスチャーファイルを出力する場合は、[ファイル] &rarr; [自動処理] &rarr; [Nintendo Export Texture] を実行します。<br /> Nintendo Export Texture を実行した場合でも、出力オプション設定が保存されていない場合や、保存された出力オプション設定で出力できない場合はオプションダイアログが表示されます。<strong>OK</strong> ボタンをクリックすると出力オプション設定が保存され、テクスチャーファイルが出力されます。</li>
  <li>PSD ファイルに保存された出力オプション設定に従って、Photoshop 上で選択しているレイヤーカンプのテクスチャーファイルのみ出力する場合は、[ファイル] &rarr; [自動処理] &rarr; [Nintendo Export Selected Texture] を実行します。レイヤーカンプを複数選択している場合は、レイヤーカンプパネルで一番上にあるレイヤーカンプが出力されます。<br /> 出力オプション設定が保存されていない場合や、保存された出力オプション設定で出力できない場合の動作は Nintendo Export Texture と同様です。<br /> 選択しているレイヤーカンプと適用しているレイヤーカンプが異なる場合は、選択しているレイヤーカンプを出力します。</li>
  <li>PSD ファイルに保存された出力オプション設定を削除してデフォルト状態に戻したい場合は、[ファイル] &rarr; [ファイル情報...] で、「キーワード」または「追加のカテゴリー」の内容を削除します（<a href="#Anchor_83956098_tex_config">コンフィグファイル</a>で保存先に選択したほうを削除します）。</li>
</ul>
<h2 id="Anchor_83956098_h2_2">オプション設定</h2>
<p>
  <a name="Anchor_83956098_config"></a>
</p>
<ul>
  <li>
    <strong>Config<br /> </strong> <a href="#Anchor_83956098_tex_config">コンフィグファイル</a> が複数存在する場合に、使用するコンフィグ名を選択します。<br /> このオプションを変更すると、以下の設定がコンフィグファイルの設定で上書きされます。<ul><li><strong>Output ftx</strong> オプション</li><li><strong>Output TGA</strong> オプション</li><li><strong>Output Folder</strong> オプション</li><li><strong>Merge</strong> オプション</li><li><strong>Format</strong> オプション</li><li><strong>Component Selection</strong> オプション</li><li><strong>Hint</strong> オプション</li><li><strong>Swizzle</strong> オプション（乱数指定も）</li><li><strong>TGA Folder</strong> オプション</li><li>出力時に PSD ファイルを上書き保存するかどうか</li><li>オプション設定の保存先</li></ul><p>ダイアログの <strong>OK</strong> ボタンをクリックした際に、選択されていたコンフィグ名が Photoshop 本体に記録されます。出力オプション設定が保存されていない PSD ファイルに対してテクスチャーエクスポートプラグインを実行した場合、Photoshop 本体に記録されていたコンフィグ名がデフォルトで選択されます。</p></li>
  <li>
    <strong>Layer Comp Export<br /> </strong> レイヤーカンプごとにテクスチャーファイルを出力するなら ON にします。<br /> OFF にすると、現在のレイヤーの状態でテクスチャーファイルを 1 つ出力します。<br /> レイヤーカンプが存在しない場合は ON にできません。<br /> 以下のオプションは <strong>レイヤーカンプごとに設定可能</strong> です。<br /> 設定したいレイヤーカンプをドロップダウンリストで選択してから、各オプションを設定してください。<ul><li><strong>Enable</strong></li><li><strong>Target Slice</strong></li><li><strong>Resize</strong></li><li><strong>Use Layer Mask for Alpha</strong></li><li><strong>Output File Name</strong> が <strong>&lt;Input&gt;</strong> の場合のファイル名</li><li><strong>Merge</strong></li><li><strong>Format</strong> (All Format)</li><li><strong>Weighted Compress</strong></li><li><strong>Dimension</strong></li><li><strong>Mipmap</strong></li><li><strong>Mip Gen Filter</strong></li><li><strong>Component Selection</strong></li><li><strong>Hint</strong></li><li><strong>Swizzle</strong></li><li><strong>Comment</strong></li></ul></li>
  <li>
    <strong>Enable<br /> </strong> Layer Comp Export で選択されているレイヤーカンプを出力するなら ON にします。</li>
  <li>
    <p>
      <strong>Slice Export<br /> </strong> スライスごとにテクスチャーファイルを出力するなら ON にします。<br /> テクスチャーファイルの名前には「スライス名」が追加されます。<br /> スライスオプションで名前が設定されていなければ、スライス名は「01」「02」といった番号になります。<br /> スライスオプションでスライスの種類が「画像なし」に設定されているスライスは出力しません。<br /> <strong>Target Slice...</strong> ボタンをクリックすると、出力するスライスを指定するダイアログが表示されます。<br /> すべてのスライスを出力するなら <strong>All</strong> 、すべてのユーザ定義スライスを出力するなら <strong>User</strong> 、指定したスライスのみ出力するなら <strong>Selection</strong> を選択します。Selection の場合、チェックボックスで出力するスライスを指定します。<br /> <strong>OK</strong> ボタンをクリックすると出力するスライスが決定されます。</p>
    <div class="note_new">
      <div class="note_new_left">注意：</div>
      <div class="note_new_right">
        <p>Photoshop CC 2014 以前では、Selection を選択して OK ボタンをクリックした後、再び Target Slice... ボタンをクリックするとダイアログが正しく表示されない不具合があります。<br />その場合は、オプションダイアログを一度閉じて開きなおしてください。<br />Selection 選択後、Unify Image Options、Unify Converter Options を ON にした場合も同様の不具合が起こります。</p>
      </div>
    </div>
  </li>
  <li>
    <strong>Zero-Based Index<br /> </strong> テクスチャーファイルの名前に使用する「スライス名」の番号を 1 減らして 0 起算にするなら ON にします。<br /> このオプションが ON の場合、スライスオプションで名前が設定されていても、スライス名は「00」「01」といった番号になります。</li>
  <li>
    <strong>Resize<br /> </strong> テクスチャーの幅と高さのサイズ変更を指定します。<br /> PSD ファイルと同じサイズで出力するなら <strong>1/1</strong> 、<br /> 幅と高さを半分にして出力するなら <strong>1/2</strong> 、<br /> 幅と高さを 1/4 にして出力するなら <strong>1/4</strong> を選択します。<br /> パーセントで指定するなら <strong>percent</strong> を選択し、幅と高さに対するパーセントを入力します。<br /> ピクセル数を直接指定するなら <strong>pixel</strong> を選択し、幅と高さのピクセル数を入力します。Slice Export が ON の場合、スライスごとのピクセル数ではなく、分割前の画像全体のピクセル数となります。<br /> 選択可能な項目（分数または実数）を <a href="#Anchor_83956098_tex_config">コンフィグファイル</a> で追加できます。</li>
  <li>
    <strong>Resize Filter</strong> <br /> サイズ変更する際のフィルターを指定します。<br /> ポイントサンプリングなら&nbsp;<strong>point</strong>、線形補間なら <strong>linear</strong>、標準的なキュービック補間なら <strong>cubic</strong>、滑らかなキュービック補間なら&nbsp;<strong>cubic_smooth</strong>、シャープなキュービック補間なら <strong>cubic_sharp </strong> を選択します。</li>
  <li>
    <strong> <a name="Anchor_83956098_Use_Layer_Mask_for_Alpha"></a>Use Layer Mask for Alpha<br /> </strong> 可視の最下位レイヤー（グループ）にレイヤーマスクが存在する場合に、レイヤーマスクをアルファとして出力するなら ON にします。<br /> ON にすると、レイヤーマスクで透明になっているピクセルの RGB 成分がそのまま出力されますが、次の制限があります。<ul><li>最下位レイヤーの消しゴムツールなどによるピクセルの透明化が反映されません。</li><li>最下位レイヤーの他にレイヤーが存在していて、他のレイヤーのピクセルが最下位レイヤーのレイヤーマスクの範囲外にあると、そのピクセルの透明度が反映されません。</li></ul><p>OFF にすると、アルファチャンネルが存在しない場合、表示レイヤーを結合した状態のピクセルの透明度をアルファとして出力します。ただし、レイヤーマスクで透明になっているピクセルの RGB 成分が白色になることがあります。<br /> ON にしていても、すでにアルファチャンネルが存在する場合は、レイヤーマスクを無効にし、既存のアルファチャンネルを出力します。<br /> ON にしていても、最下位レイヤー（グループ）にレイヤーマスクが存在しなければ、OFF の場合と同じ動作になります。<br />アルファとして出力されるレイヤーマスクの例です。</p><table class="codeblock"><tbody><tr><td class="code"><div class="codeblock"><pre>【最下位レイヤーにレイヤーマスクが存在する場合】
グループ1（レイヤーマスク）
&nbsp;&nbsp;+ レイヤー0（レイヤーマスク）← アルファとして出力
 
【最下位レイヤーにレイヤーマスクが存在せず、最下位グループにレイヤーマスクが存在する場合】
グループ1（レイヤーマスク）← アルファとして出力
&nbsp;&nbsp;+ レイヤー0（レイヤーマスク）
&nbsp;&nbsp;+ レイヤー1
 
【最下位レイヤーにも最下位グループにもレイヤーマスクが存在しない場合】
グループ1
&nbsp;&nbsp;+ レイヤー0（レイヤーマスク）
&nbsp;&nbsp;+ レイヤー1
（レイヤー0 のレイヤーマスクはアルファとして出力されません）</pre></div></td></tr></tbody></table></li>
  <li>
    <strong>Unify Image Options<br /> </strong> ON にしていると、画像処理オプション（サイズ変更とレイヤーマスクの設定）を変更した際に、 <strong>Layer Comp Export</strong> で選択中のレイヤーカンプの画像処理オプション設定が他のすべてのレイヤーカンプに自動的にコピーされます。<br /> OFF から ON に変更した際は確認ダイアログが表示されます。確認ダイアログで <strong>Yes</strong> ボタンをクリックした際にも画像処理オプション設定がコピーされます。</li>
  <li>
    <p>
      <strong>Output File Name<br /> </strong> テクスチャーファイルの名前（拡張子を除く）を指定します。<br />非 ASCII 文字（全角文字や半角カナ文字）は使用できません。<br /> リストで <strong>&lt;Input&gt;</strong> を選択した場合、右側に名前を直接入力します。空欄なら PSD ファイルまたはレイヤーカンプ（Layer Comp Export が ON のとき）の名前で出力します。Slice Export が ON なら、指定した名前の後に「_スライス名」が追加されます。<br /> リストで <strong>&lt;Input&gt;</strong> 以外を選択した場合、 <strong>&lt;PSD&gt;</strong> には PSD ファイル名、 <strong>&lt;LayerComp&gt;</strong> にはレイヤーカンプ名、 <strong>&lt;Slice&gt;</strong> にはスライス名が入ります。</p>
    <div class="info_new">
      <div class="info_new_left">参考：</div>
      <div class="info_new_right">
        <p>リストで&nbsp;&lt;Input&gt;&nbsp;を選択した場合に、右側に &lt;PSD&gt;、&lt;LayerComp&gt;、&lt;Slice&gt; を含む文字列を入力することもできます。それぞれ PSD ファイル名、レイヤーカンプ名、スライス名に置換されます。<br />その場合、Slice Export が ON でもファイル名に「_スライス名」は自動的に追加されません。<br />出力対象のスライスが複数存在する場合に&nbsp;&lt;Slice&gt; を含む文字列を指定しないと、最後に出力したファイルで上書きされるので注意してください。</p>
      </div>
    </div>
  </li>
  <li>
    <strong>Output ftx<br /> </strong> 中間ファイルを出力するなら ON にします。</li>
  <li>
    <strong>Output TGA<br /> </strong> TGA ファイルを出力するなら ON にします。<br /> TGA ファイルの名前は中間ファイルの名前と同じになります。<br /> 画像が 32 bit/チャンネルの場合は TGA ファイルを出力できません。<br /> TGA ファイルはデフォルトでは RLE 圧縮で出力されますが、 <a href="#Anchor_83956098_tex_config">コンフィグファイル</a> で非圧縮にすることもできます。<br />中間ファイルを出力しないで&nbsp;TGA ファイルのみ出力する場合、画像の幅と高さに制限はありません。</li>
  <li>
    <strong>Output Folder<br /> </strong> 中間ファイルを出力するフォルダーを指定します。<br /> 絶対パスでない場合は PSD ファイルのあるフォルダーからの相対パスとみなします。<br /> （空欄の場合は PSD ファイルのあるフォルダーに出力します。)。<br /> パスには環境変数が使用できます。環境変数は <strong>%NAME%</strong> のように記述します。</li>
  <li>
    <strong>Merge<br /> </strong> Output Folder で指定したフォルダーに同名で既存の中間ファイルがある場合にマージするなら ON にします。<br /> マージした場合、既存の中間ファイルの設定（フォーマット、次元、ミップマップの有無、ミップマップ生成フィルター、成分選択、ヒント情報、リニアー変換、初期スウィズル値、編集用コメント文）で出力します。<br /> 既存の中間ファイルの設定はこのオプションの右側に表示されます。<br /> 3DEditor などでフォーマットなどを変更する場合は ON にします。<br /> このオプションが ON であっても、既存の中間ファイルがなければ、オプションダイアログで指定した設定で出力します。<br /> 編集用コメント文は Comment オプションが空の場合のみマージされます。</li>
  <li>
    <strong>Format<br /> </strong> フォーマットを指定します。<br /> 選択可能な項目は <a href="#Anchor_83956098_tex_config">コンフィグファイル</a> で設定できます。<br /> <strong>All Format</strong> を ON にすると、現在のイメージモードに対応しているすべてのフォーマットから選択できます。<br />unorm_4_4、unorm_8_8、unorm_bc5、unorm_eac_11_11 フォーマットでヒント情報が normal 以外の場合、アルファチャンネルがあればアルファチャンネルをテクスチャーの G 成分に反映します。</li>
</ul>
<ul>
  <li>
    <a name="Anchor_83956098_weighted_compress"></a> <strong>Weighted Compress<br /> </strong> bc1、bc2、bc3、etc1、etc2 の圧縮をする際に、RGB の誤差に対して人間の目に合わせた重み付けをするなら ON にします。</li>
  <li>
    <strong>Dimension<br /> </strong> 次元を指定します。<br /> 一次元テクスチャーなら <strong>1d</strong> 、二次元テクスチャーなら <strong>2d</strong> 、キューブマップなら <strong>cube</strong> を選択します。<br /> cube は画像が <a href="../Pages/Page_239574379.html#Anchor_239574379_horizontal_cross">水平十字または垂直十字キューブマップ</a> の状態になっている場合のみ選択可能です。</li>
  <li>
    <strong>Mipmap<br /> </strong> ミップマップを作成するなら ON にします。<br /> ミップマップは幅と高さが 1 になるレベルまで作成されます。</li>
  <li>
    <strong>Mip Gen Filter<br /> </strong> ミップマップを生成する際のフィルターを指定します。<br /> ポイントサンプルなら <strong>point</strong> 、線形補間なら <strong>linear</strong> 、キュービック補間なら <strong>cubic</strong> を選択します。</li>
  <li>
    <strong>Component Selection<br /> </strong> RGBA の各チャンネルに対するカラー成分をリストから選択します（左から RGBA の順に指定します）。<br /> All Format が OFF の場合、このオプションは無効となり、 <a href="#Anchor_83956098_tex_config">コンフィグファイル</a> で指定したプリセットの成分選択が適用されます。<br /> All Format が ON の場合、フォーマットを変更した際に <a href="../Pages/Page_239574379.html#Anchor_239574379_comp_sel">フォーマットに対するデフォルトの成分選択</a> が自動的に適用されます。独自の成分選択を指定する場合は、フォーマットを決定してからこのオプションを変更してください。</li>
  <li>
    <strong>Hint<br /> </strong> ヒント情報を指定します。<br /> 選択可能な項目は <a href="#Anchor_83956098_tex_config">コンフィグファイル</a> で設定できます。<br /> コンフィグファイルで、フォーマット選択のプリセットに対してヒント情報を指定している場合は変更できません。<br /> プリセットのフォーマットを選択した際は、コンフィグファイルで指定したヒント情報が適用されます。<br /> ヒント情報が normal で画像が 8 bit/チャンネルの場合、法線の Z 成分が 0 以上かつ長さが 1.0 になるように調整したテクスチャーデータを出力します（中間ファイルの元画像データは調整しません）。<br />All Format が ON かつ ASTC フォーマットを指定している場合、ヒント情報を変更した際に<a href="../Pages/Page_239574379.html#Anchor_239574379_comp_sel">フォーマットに対するデフォルトの成分選択</a> が自動的に適用されます。</li>
  <li>
    <strong>Swizzle<br /> </strong> 初期スウィズル値を指定します。初期スウィズル値は特定プラットフォームでのみ、パフォーマンスに影響します。<br /> <a href="#Anchor_83956098_tex_config">コンフィグファイル</a> で、フォーマット選択のプリセットに対して初期スウィズル値を指定している場合は変更できません。<br /> プリセットのフォーマットを選択した際は、コンフィグファイルで指定した初期スウィズル値が適用されます。<br /> コンフィグファイルで、random_initial_swizzle に 0 以上 7 以下の整数値を設定することによって、初期スウィズル値にテクスチャー名から求めた乱数を使用することも可能です。詳細は ExportTexture_Sample.jsxinc のコメントを参照してください。</li>
  <li>
    <strong>Comment<br /> </strong> 中間ファイルに対する編集用コメント文を指定します。<br /> ダブルクォートは使用できません。</li>
  <li>
    <strong>Unify Converter Options<br /> </strong> ON にしていると、3D テクスチャーコンバーター関連オプションを変更した際に、 <strong>Layer Comp Export</strong> で選択中のレイヤーカンプの 3D テクスチャーコンバーター関連オプション設定が他のすべてのレイヤーカンプに自動的にコピーされます。<br /> OFF から ON に変更した際は確認ダイアログが表示されます。確認ダイアログで <strong>Yes</strong> ボタンをクリックした際にも 3D テクスチャーコンバーター関連オプション設定がコピーされます。</li>
  <li>
    <strong>TGA Folder<br /> </strong> TGA ファイルを出力するフォルダーを指定します。<br /> フォルダーが絶対パスでない場合は PSD ファイルのあるフォルダーからの相対パスとみなします。<br /> （空欄の場合は PSD ファイルのあるフォルダーに出力します。)<br /> パスには環境変数が使用できます。環境変数は <strong>%NAME%</strong> のように記述します。</li>
  <li>
    <strong>Pre-Export Script<br /> </strong> 出力前に実行するスクリプトを指定します（JavaScript を直接記述できます）。<br /> 空欄の場合は何も実行しません。<br /> Output Folder、TGA Folder オプションで環境変数を使用している場合、このオプションで環境変数に設定した値が反映されます。環境変数の設定には $.setenv(name, value) ではなく <strong>SetEnv(name, value)</strong> を使用してください。<br /> スクリプトの例については Post-Export Script の説明を参照してください。</li>
  <li>
    <p>
      <strong> <a name="Anchor_83956098_Post-Export_Script"></a>Post-Export Script<br /> </strong> 出力後に実行するスクリプトを指定します（JavaScript を直接記述できます）。<br /> 空欄の場合は何も実行しません。<br /> 出力でエラーが発生した場合は実行しません。<br /> Windows のバッチファイルを呼び出す場合は次のように記述します。</p>
    <table class="codeblock">
      <tbody>
        <tr>
          <td class="code">
            <div class="codeblock"><pre>CallBatFile(&quot;バッチファイルのパス&quot;)</pre></div>
          </td>
        </tr>
      </tbody>
    </table>
    <p>フォルダーの区切り文字は / または \\ です。フルパスでなければ PSD ファイルのあるフォルダーからの相対パスとみなします。<br /> 次のようにバッチファイルの引数を指定することも可能です。</p>
    <table class="codeblock">
      <tbody>
        <tr>
          <td class="code">
            <div class="codeblock"><pre>CallBatFile(&quot;convert_to_array.bat&quot;, &quot;arg1 arg2&quot;)</pre></div>
          </td>
        </tr>
      </tbody>
    </table>
    <p>CallBatFile の代わりに <strong>CallBatFileMin</strong> を使用すると、コマンドウインドウを最小化した状態でバッチファイルを実行します。 <strong>CallBatFileHide</strong> を使用すると、コマンドウインドウを表示しないでバッチファイルを実行します。<br /> Pre-Export Script、Post-Export Script で指定した JavaScript および呼び出したバッチファイル内では、次の環境変数から情報を取得できます。</p>
    <table class="wrapped">
      <thead>
        <tr>
          <th>環境変数名</th>
          <th>内容</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td class="nowrap">NINTENDO_EXPORT_CONFIG</td>
          <td>使用するコンフィグ名です。<br /> &lt;Standard&gt; の場合は定義されません。</td>
        </tr>
        <tr>
          <td class="nowrap">NINTENDO_EXPORT_PSD_FILE_PATH</td>
          <td>PSD ファイルのパスです。</td>
        </tr>
        <tr>
          <td class="nowrap">NINTENDO_EXPORT_LAYER_COMP_NAMES</td>
          <td>出力対象のレイヤーカンプ名を半角スペースで区切って並べた文字列です。<br /> レイヤーカンプごとにテクスチャーファイルを出力しない場合は定義されません。</td>
        </tr>
        <tr>
          <td class="nowrap">NINTENDO_EXPORT_FTX_FOLDER</td>
          <td>ftx ファイル出力フォルダーのパスです。最後に「/（スラッシュ）」が付きます。<br /> 出力しない場合は定義されません。</td>
        </tr>
        <tr>
          <td class="nowrap">NINTENDO_EXPORT_TGA_FOLDER</td>
          <td>TGA ファイル出力フォルダーのパスです。最後に「/（スラッシュ）」が付きます。<br /> 出力しない場合は定義されません。</td>
        </tr>
        <tr>
          <td class="nowrap">NINTENDO_EXPORT_FTX_FILE_NAMES</td>
          <td>出力する ftx ファイル名（拡張子を含む）を半角スペースで区切って並べた文字列です。</td>
        </tr>
        <tr>
          <td class="nowrap">NINTENDO_EXPORT_FTX_FILE_COUNT</td>
          <td>出力する ftx ファイル数です。</td>
        </tr>
        <tr>
          <td class="nowrap">NINTENDO_EXPORT_TGA_FILE_NAMES</td>
          <td>出力する TGA ファイル名（拡張子を含む）を半角スペースで区切って並べた文字列です。</td>
        </tr>
        <tr>
          <td class="nowrap">NINTENDO_EXPORT_TGA_FILE_COUNT</td>
          <td>出力する TGA ファイル数です。</td>
        </tr>
      </tbody>
    </table>
    <p>
      <a name="Anchor_83956098_tex_config"></a>
    </p>
  </li>
</ul>
<h2 id="Anchor_83956098_h2_3">コンフィグファイル</h2>
<p>%NINTENDO_SDK_ROOT%\Tools\Graphics\PhotoshopPlugins\Config フォルダーにあるコンフィグファイル ExportTexture.jsxinc を編集すると、次の各種設定を変更できます。</p>
<ul>
  <li>アプリケーションのプロジェクトのルートフォルダー</li>
  <li>テクスチャー中間ファイルにエンコード前の元画像データを含めるかどうか</li>
  <li>出力時に PSD ファイルを上書き保存するかどうか</li>
  <li>出力オプション設定がない場合のデフォルトのオプション統一設定</li>
  <li>デフォルトの出力オプション設定</li>
  <li>サイズ変更選択のプリセット</li>
  <li>出力オプション設定がない場合のデフォルトのサイズ変更</li>
  <li>リニアー空間でのサイズ変更計算フラグ</li>
  <li>フォーマット選択のプリセット</li>
  <li>出力オプション設定がない場合（不正な場合）のデフォルトのフォーマット（およびレイヤーカンプ出力フラグ）</li>
  <li>ヒント情報選択のプリセット</li>
  <li>
    <a href="#Anchor_83956098_weighted_compress">Weighted Compress</a> オプションの有効／無効</li>
  <li>GPU によるエンコードの有効／無効</li>
  <li>初期スウィズル値の乱数指定</li>
  <li>TGA ファイルの圧縮／非圧縮</li>
  <li>出力前後に実行するスクリプト指定</li>
  <li>エラーの抑制</li>
  <li>オプション設定の保存先</li>
</ul>
<p>テクスチャーエクスポートプラグイン実行時または ftx ファイル形式プラグインでセーブ時に ExportTexture.jsxinc が存在しなければ %NINTENDO_SDK_ROOT%\Tools\Graphics\PhotoshopPlugins\Config\ExportTexture_Sample.jsxinc が ExportTexture.jsxinc にコピーされて読み込まれます。</p>
<p>設定例については ExportTexture_Sample.jsxinc のコメントを参照してください。</p>
<p>他のフォルダーにあるコンフィグファイルを使用したい場合は、環境変数 <strong>NINTENDO_PHOTOSHOP_CONFIG</strong> にフォルダーのパスを設定した状態でプラグインを使用してください。</p>
<p>コンフィグファイルを複数用意して <a href="#Anchor_83956098_config">Config</a> オプションで選択することも可能です。<br /> 標準の ExportTexture.jsxinc 以外のコンフィグファイルは「<strong>ExportTexture_コンフィグ名.jsxinc</strong>」という名前で ExportTexture.jsxinc と同じフォルダーに置きます。<br /> たとえば、ExportTexture.jsxinc と ExportTexture_Effect.jsxinc が存在する場合、Config オプションで「&lt;Standard&gt;」を選択すれば ExportTexture.jsxinc、「Effect」を選択すれば ExportTexture_Effect.jsxinc の設定が適用されます。<br /> コンフィグ名には非 ASCII 文字（全角文字や半角カナ文字）を使用できません。ファイル名に非 ASCII 文字を含むコンフィグファイルは無視されます。</p>
<h2 id="Anchor_83956098_h2_4">注意事項</h2>
<p>テクスチャーエクスポートプラグインを使用する際の注意事項です。</p>
<h3 id="Anchor_83956098_h3_1">イメージモード</h3>
<p>イメージモードがグレースケール、インデックスカラー、RGB カラー以外のファイルや、16 bit/チャンネルのファイルは出力できません。<br />32 bit/チャンネルのファイルを astc フォーマットで出力する場合、実数型に換算したピクセル値が [0,1] の範囲外の場合はクランプします。&nbsp;</p>
<h3 id="Anchor_83956098_h3_2">アルファチャンネル</h3>
<p>アルファチャンネルが 2 つ以上存在する場合、チャンネルウィンドウで一番上にあるアルファチャンネルだけが出力されます。</p>
<h3 id="Anchor_83956098_h3_3">レイヤー</h3>
<p>表示された背景がなくレイヤーのみが存在する画像（またはレイヤーカンプ）で、アルファチャンネルがなければ、表示レイヤーを結合した場合のピクセルの透明度をアルファとしてセーブします。</p>
<p>レイヤーマスクを使用している場合、<a href="#Anchor_83956098_Use_Layer_Mask_for_Alpha">Use Layer Mask for Alpha</a> オプションの説明を参照してください。</p>
<h2 id="Anchor_83956098_h2_5">バッチファイルによる出力</h2>
<p>Windows のバッチファイルを使用して、指定した PSD ファイルからテクスチャー中間ファイルおよび TGA ファイルを出力することができます。</p>
<p>バッチファイルによる出力では、%NINTENDO_SDK_ROOT%\Tools\Graphics\PhotoshopPlugins\Batch にある NintendoBatchExportTexture.bat を使用します。</p>
<p>NintendoBatchExportTexture.bat またはそのショートカットに PSD ファイルや PSD ファイルを含むフォルダーをドラッグ＆ドロップすると、その PSD ファイルからテクスチャー中間ファイル（TGA ファイル）を出力します。<br />PSD ファイルに出力オプション設定が保存されていない場合は出力されません（警告が表示されます）。 <br />フォルダーをドラッグ＆ドロップすると、そのフォルダーおよびサブフォルダー以下のすべての PSD ファイルから出力します。<br />NintendoBatchExportTexture.bat へのショートカットを Windows の「送る」メニューに登録して使用することもできます。</p>
<p>次に、ユーザーが作成したバッチファイルから NintendoBatchExportTexture.bat を利用する方法を説明します。</p>
<p>指定した PSD ファイルから出力する場合、次の書式でバッチファイルを記述します。</p>
<table class="codeblock">
  <tbody>
    <tr>
      <td class="code">
        <div class="codeblock"><pre>call NintendoBatchExportTexture.bat &quot;PSDファイルのパス&quot;</pre></div>
      </td>
    </tr>
  </tbody>
</table>
<p>複数の PSD ファイルのパスをスペースで区切って指定できます。</p>
<p>指定フォルダーおよびサブフォルダー以下のすべての PSD ファイルから出力する場合、次の書式でバッチファイルを記述します。</p>
<table class="codeblock">
  <tbody>
    <tr>
      <td class="code">
        <div class="codeblock"><pre>call NintendoBatchExportTexture.bat &quot;フォルダーのパス&quot;</pre></div>
      </td>
    </tr>
  </tbody>
</table>
<p>複数のフォルダーのパスをスペースで区切って指定できます。</p>
<p>次のように PSD ファイルのパスを列挙したテキストファイルを作成して、出力することもできます。</p>
<table class="codeblock">
  <tbody>
    <tr>
      <td class="code">
        <div class="codeblock"><pre># テキストファイルのフォルダーにあるファイル
image1.psd
image2.psd
# テキストファイルのフォルダーの下の sub フォルダーにあるファイル
sub\image3.psd
# 絶対パス指定
C:\data\image4.psd</pre></div>
      </td>
    </tr>
  </tbody>
</table>
<p>パスは 1 行に 1 つ記述します。<br /> パスが絶対パスでない場合はテキストファイルのフォルダーからの相対パスとみなします。<br /> # で始まる行はコメントです。</p>
<p>テキストファイルで列挙した PSD ファイルから出力する場合、次の書式でバッチファイルを記述します。</p>
<table class="codeblock">
  <tbody>
    <tr>
      <td class="code">
        <div class="codeblock"><pre>call NintendoBatchExportTexture.bat &quot;@テキストファイルのパス&quot;</pre></div>
      </td>
    </tr>
  </tbody>
</table>
<p>PC に複数バージョンの Photoshop がインストールされている場合、デフォルトでは最新バージョンの Photoshop で出力します。<br /> 使用する Photoshop を指定したい場合は環境変数 <strong>NINTENDO_PHOTOSHOP_APP_VER</strong> にバージョン名（CC2014、CC2015、CC2015_5、CC2017、CC2018）を設定してから、NintendoBatchExportTexture.bat を呼び出します。<br />ただし、NintendoBatchExportTexture.bat を呼び出す前に Photoshop が起動していた場合は、起動中の&nbsp;Photoshop で出力します。</p>
<table class="codeblock">
  <tbody>
    <tr>
      <td class="code">
        <div class="codeblock"><pre>set NINTENDO_PHOTOSHOP_APP_VER=CC2017
call NintendoBatchExportTexture.bat &quot;PSDファイルのパス&quot;</pre></div>
      </td>
    </tr>
  </tbody>
</table>
<h2 id="Anchor_83956098_h2_6">スクリプトからの利用</h2>
<p>スクリプトからテクスチャーエクスポートプラグインを利用するには、次のような jsx ファイルを作成します。</p>
<table class="codeblock">
  <tbody>
    <tr>
      <td class="code">
        <div class="codeblock"><pre>$.evalFile(File($.getenv(&quot;NINTENDO_SDK_ROOT&quot;) + &quot;/Tools/Graphics/PhotoshopPlugins/NintendoPhotoshopScripts/NintendoExportTextureFunc.jsxinc&quot;));
var opts = GetExportOptions(); // 出力オプション設定を取得します。
if (opts)
{
&nbsp;&nbsp;&nbsp;&nbsp;//
&nbsp;&nbsp;&nbsp;&nbsp;// 出力前に実行したい処理があればここに記述します。
&nbsp;&nbsp;&nbsp;&nbsp;//
&nbsp;&nbsp;&nbsp;&nbsp;if (ExportTextureDirect(opts)) // 出力します。
&nbsp;&nbsp;&nbsp;&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;//
&nbsp;&nbsp;&nbsp;&nbsp;// 出力後に実行したい処理があればここに記述します
&nbsp;&nbsp;&nbsp;&nbsp;//
&nbsp;&nbsp;&nbsp;&nbsp;}
}</pre></div>
      </td>
    </tr>
  </tbody>
</table>
<p>関数 <strong>GetExportOptions()</strong> は、アクティブな PSD ファイルから、出力オプション設定を取得します。出力オプション設定がなければ null を返します。</p>
<p>関数 <strong>ExportTextureDirect()</strong> は、アクティブな PSD ファイルから、テクスチャー中間ファイルおよび TGA ファイルを出力します。出力に成功すれば true を返します。</p>
<p>GetExportOptions()、ExportTextureDirect() を呼んだ後は、<a href="#Anchor_83956098_Post-Export_Script">Post-Export Script </a>で説明した環境変数から情報を取得できます。また、ExportTextureDirect() を呼んだ後は、環境変数 NINTENDO_EXPORT_SUCCEEDED に出力成功なら 1、失敗なら 0 が格納されます。</p>
<p>Pre/Post-Export Script で指定したスクリプト内では GetExportOptions()、ExportTextureDirect() を呼び出さないでください。</p>
<h2 id="Anchor_83956098_h2_7">関連リンク</h2>
<p>
  <a href="../Pages/Page_83956012.html">Photoshop プラグイン</a>
</p>
</div>
<div class="breadcrumb_bottom"></div>
<div class="page_navigation">
<table class="page_navi_root">
<tr>
<td class="page_navi_left"></td>
<td class="page_navi_right"></td>
</tr>
<tr><td colspan="2" class="page_navi_bottom"></td></tr>
</table>
</div>
</div>
</div>
</body>
</html>
