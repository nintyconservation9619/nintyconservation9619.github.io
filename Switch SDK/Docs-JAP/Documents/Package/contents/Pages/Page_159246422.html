<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<script type="text/javascript" src="../template/js/jquery/jquery.js"></script>
<script type="text/javascript" src="../template/js/common/manualLib.js"></script>
<script type="text/javascript" src="../tocData.js"></script>
<link rel="stylesheet" type="text/css" href="../template/css/template.css" />
<title>ネットワークサービスアカウントの利用</title>
</head>
<body data-reassemble="autoindex=no,forceNoLabel=yes">
<div id="autoindex_content">
<div class="body_content">
<noscript>
<div style="border: 4px double black; margin: 4px; padding: 2px; font-weight: bold; background-color: #FFFFCC;">
<p>お使いのブラウザは JavaScript が使用できないため、本ドキュメントの一部機能が無効になっています。</p><p>JavaScript が無効の環境では目次を使用することができません。<br />JavaScriptの実行が許可された状態で閲覧してください。<br /><br /></p>
</div>
</noscript>
<div class="page_navigation_top">
<table class="page_navi_root">
<tr>
<td class="page_navi_left"></td>
<td class="page_navi_right"></td>
</tr>
</table>
</div>
<div class="breadcrumb"></div>

<!-- ネットワークサービスアカウントの利用 -->
<div class="pagetitle" id="PageId_159246422">ネットワークサービスアカウントの利用</div>
<div class="text_separate">
<h1 id="Anchor_159246422_h1_1">事前準備</h1>
<p>ネットワークサービスアカウントを利用するには、事前に次の準備が行われている必要があります。</p>
<ul style="list-style-type: square;">
  <li>インターネットへの接続設定<ul style="list-style-type: square;"><li>具体的な方法は&nbsp;<a href="../Pages/Page_104465190.html">NIFM ライブラリ</a>&nbsp;のページを参照してください。</li></ul></li>
  <li>ユーザーアカウントの作成<ul><li><a href="../Pages/Page_310877311.html">DevMenu の 「Accounts」メニュー</a> よりユーザーアカウントを作成することができます。</li><li>「Accounts」メニューの「Add a user account」ボタンを押すごとにひとつのユーザーアカウントが作成されます。</li></ul></li>
</ul>
<h1 id="Anchor_159246422_h1_2">ネットワークサービスアカウントの可用性</h1>
<p>現在のバージョンの SDK では、次の条件を満たすネットワークサービスアカウントを「可用性がある」と扱います。</p>
<ul style="list-style-type: square;">
  <li>ネットワークサービスアカウントが登録されている</li>
  <li>登録されているネットワークサービスアカウントが、プログラムの要求する資格を有している</li>
  <li>ユーザーアカウントが次のいずれかの状態である:<ul style="list-style-type: square;"><li>ニンテンドーアカウントとの連携が完了しており、連携状態が健全である。</li><li>下記「ニンテンドーアカウントと連携せずネットワークサービスアカウントを利用する」に記載の手順を完了している。</li></ul></li>
</ul>
<p>可用性のあるネットワークサービスアカウントに対して、プログラムはネットワークサービスを提供できます。&nbsp;</p>
<h2 id="Anchor_159246422_h2_1">ネットワークサービスアカウントの可用性の確認</h2>
<p>ネットワークサービスアカウントの可用性は次のように確認することができます。<br />(ただし、この手順ではプログラムの要求する資格を有しているかを確認しません。)</p>
<ul>
  <li>
    <a href="../Pages/Page_310877311.html">DevMenu の 「Accounts」メニュー</a>
    <a href="../Pages/Page_107328771.html">DevMenu</a>からユーザーアカウントの詳細画面を開く</li>
  <li>NSA Status を確認する<ul><li>Available ... ネットワークサービスアカウントを利用可能です。</li><li>それ以外 ...&nbsp;ネットワークサービスアカウントを利用可能ではありません。</li></ul></li>
</ul>
<h2 id="Anchor_159246422_h2_2">ネットワークサービスアカウントの可用性の回復</h2>
<p>ネットワークサービスアカウントの可用性が失われた際には、次の手順で回復することができます。<br />(ただし、この手順ではプログラムの要求する資格の取得を行いません。)</p>
<ul>
  <li>
    <a href="../Pages/Page_310877311.html">DevMenu の 「Accounts」メニュー</a>
    <a href="../Pages/Page_107328771.html">DevMenu</a>からユーザーアカウントの詳細画面を開く</li>
  <li>「Unregister NSA」ボタンを押して、ネットワークサービスアカウントの登録を解除する</li>
  <li>前述の可用性のための条件を満たす</li>
</ul>
<div class="info_new">
  <div class="info_new_left">参考：</div>
  <div class="info_new_right">
    <p>このとき「Unregister NSA」後に連携解除前と同じニンテンドーアカウントを使用すると、元のネットワークサービスアカウントが登録されます。</p>
  </div>
</div>
<h2 id="Anchor_159246422_h2_3">プログラムが要求できるネットワークサービスアカウントの資格</h2>
<p>プログラムはそれぞれのプラットフォームで、ネットワークサービスアカウントに対してネットワークサービスの利用に関する資格を要求することができます。</p>
<!--Remove-->
<div class="platform_nx">
  <p>Nintendo Switchでは、プログラムは次のポリシーの範囲で、ネットワークサービスアカウントに資格を要求できます。</p>
  <ul style="list-style-type: square;">
    <li>追加の要求なし</li>
    <li>プログラムでのネットワークサービスアカウントの利用全般について、一律して Nintendo Switch Online への加入を要求</li>
    <li>プログラムの独自の機能区分で、 Nintendo Switch Online への加入を要求 (※)</li>
  </ul>
</div>
<h3 id="Anchor_159246422_h3_1">プログラムが独自に資格を要求しない場合のアプリケーションの対応</h3>
<p>プログラムが上記の「※」<strong>以外の</strong>ポリシーを採用する場合、アプリケーションはアプリケーション内でネットワークサービスの可用性の検証を行ってください。<br />資格が必要な場合は他のネットワークサービスアカウントに関するエラーの場合と同じくネットワークサービスアカウントへのログインに失敗します。<br />このエラーの解消には同様に <a href="../../../Api/HtmlNX/namespacenn_1_1account.html">nn::account::EnsureNetworkServiceAccountAvailable()</a> を使用します。</p>
<h3 id="Anchor_159246422_h3_2">プログラムの独自の機能区分で資格を要求する場合の留意点 (SDK 4.4.0 以降)<br /></h3>
<p>プログラムが上記の「※」で示したポリシーを採用する場合、ユーザーへの資格の取得の要求は、プログラムが独自に行う必要があります。<br />またプログラムの独自の判断でユーザーのネットワークサービスアカウントの利用に資格を要求する場合、Nintendo SDKの&nbsp;<a href="../../../Api/HtmlNX/namespacenn_1_1account.html">nn::account::ShowLicenseRequirementsForNetworkService()</a> を使用して本体システムの UI を表示しなければいけません。</p>
<p>プログラムの提供するサービスをユーザーが過不足ない資格で利用できることについて、プログラムはガイドラインに沿って適切に対応してください。</p>
<h2 id="Anchor_159246422_h2_4">Tips</h2>
<h3 id="Anchor_159246422_h3_3">ニンテンドーアカウントと連携せずネットワークサービスアカウントを利用する</h3>
<p>開発の便利のために、ネットワークサービスアカウントの可用性に必要な次のポリシーを無効とすることができます。<br />これにより、ニンテンドーアカウントに関する手続きを省略してネットワークサービスアカウントを利用することが可能です&nbsp;</p>
<ul>
  <li>ニンテンドーアカウントとの連携が完了しており、連携状態が健全である。</li>
</ul>
<p>具体的な手順は次の通りです。</p>
<ol>
  <li>次のいずれかの方法で、ネットワークサービスアカウントの利用ポリシーを無効化<ul><li><a href="../Pages/Page_107328771.html">DevMenu</a>&nbsp;の 「アカウント管理 / Firmware settings」の「Requires Nintendo Account for use of network service」を disable に変更し、開発機をリセットする</li><li><a href="../Pages/Page_107328760.html">DevMenuCommand</a>&nbsp;の「アカウントシステムの設定」記載の「fwdbg:require_na_for_nwservice」を disable に変更し、開発機をリセットする</li></ul></li>
  <li>ネットワークサービスアカウントの作成<br /><ul><li><a href="../Pages/Page_310877311.html">DevMenu の 「Accounts」メニュー</a><a href="../Pages/Page_107328771.html">DevMenu</a>からユーザーアカウントの詳細を表示する</li><li>「Accounts」メニューで対象のユーザーアカウントを選択し、「Register NSA」ボタンを押して登録処理を行う<ul><li>登録に際して情報の入力等は必要ありません。</li><li>成功すると「Success」と画面に表示されます。</li></ul></li></ul></li>
</ol>
<div class="note_new">
  <div class="note_new_left">注意：</div>
  <div class="note_new_right">
    <p>この機能は、アプリケーション開発の便利のために限り使用することができます。<br />アプリケーションは最終的に、ニンテンドーアカウントに関するポリシーを有効にした状態で動作が保証されなくてはいけません。</p>
  </div>
</div>
<h3 id="Anchor_159246422_h3_4">ネットワークサービスアカウントの資格の検証を省略する (SDK 5.0.0 以降)</h3>
<p>開発の便利のために、ネットワークサービスアカウントへのログイン時に行われる資格の検証を省略することができます。<br />これにより、ネットワークサービスアカウントに必要な資格を与えることなくネットワークサービスアカウントの ID トークンを取得することが可能です。<br />ただし資格の検証を省略した場合、資格に関する情報は ID トークンに記録されませんので、プログラムが独自に資格を検証する場合には注意してください。</p>
<p>資格の検証を省略する方法は次のいずれかです。</p>
<ul style="list-style-type: square;">
  <li>上記「ニンテンドーアカウントと連携せずネットワークサービスアカウントを利用する」を実施する</li>
  <li>
    <a href="../Pages/Page_107328771.html">DevMenu</a>&nbsp;の 「アカウント管理 / Firmware settings」の「Enable Nintendo Account license verification」を disable に変更し、開発機をリセットする</li>
  <li>
    <a href="../Pages/Page_107328760.html">DevMenuCommand</a>&nbsp;の「アカウントシステムの設定」記載の「fwdbg:na_license_verification_enabled」を disable に変更し、開発機をリセットする</li>
</ul>
<div class="note_new">
  <div class="note_new_left">注意：</div>
  <div class="note_new_right">
    <p>この機能は、アプリケーション開発の便利のために限り使用することができます。<br />アプリケーションは最終的に、ネットワークサービスアカウントの資格の検証を有効にした状態で動作が保証されなくてはいけません。</p>
  </div>
</div>
<div class="note_new">
  <div class="note_new_left">注意：</div>
  <div class="note_new_right">
    <p>
      <span style="color: rgb(51,51,51);">SDK 5.0.0 より過去のバージョンでは「ニンテンドーアカウントと連携せずネットワークサービスアカウントを利用する」を実施した場合でも資格の検証は省略されず、 ID トークンの取得に失敗します。 (エラーコード：2124-5006)</span>
    </p>
  </div>
</div>
<h1 id="Anchor_159246422_h1_3">プログラムからネットワークサービスアカウントを利用可能な条件</h1>
<p>現在のバージョンの SDK では、次の条件を満たすプログラムからネットワークサービスアカウントを利用可能です。&nbsp;</p>
<ul>
  <li>「ネットワークサービスアカウントの可用性」にある条件を満たしている。</li>
  <li>OMAS (Online title MAnagemet System)&nbsp;でネットワークサービスの利用を承認されたアプリケーション ID をもつ。</li>
</ul>
<div class="info_new">
  <div class="info_new_left">参考：</div>
  <div class="info_new_right">
    <div>
      <p>プログラムからネットワークサービスアカウントを利用する際には、サンプル「Samples/Sources/Applications/AccountApplication」を参照し実装例を確認してください。 <br />このサンプルプログラムでは <a href="../Pages/Page_172900706.html">エラーハンドリング</a> のページに記載の、Nintendo SDK の推奨とするエラーハンドリングを実装しています。</p>
    </div>
    <div class="platform_nx">
      <p>NX 開発における ACCOUNT ライブラリの各エラーコードや Result 値の説明は、 <a href="../Pages/Page_187703099.html">エラーコード</a> のページを参照してください。</p>
    </div>
  </div>
</div>
<div class="note_new">
  <div class="note_new_left">注意：</div>
  <div class="note_new_right">
    <p>ニンテンドーアカウントに関するポリシーを無効にした状態では、連携の有無に関わらず、ニンテンドーアカウントに関する API 呼び出しが失敗する場合があります。<br />これにはリファレンスに記載されていないエラーの発生も含みます。</p>
  </div>
</div>
<h2 id="Anchor_159246422_h2_5">ネットワークサービスアカウントの利用</h2>
<p>プログラムがネットワークサービスアカウントが利用可能な状態では、 ACCOUNT ライブラリの次の SDK 機能を使用することができます。</p>
<ul style="list-style-type: square;">
  <li>
    <a href="../../../Api/HtmlNX/namespacenn_1_1account.html#a8a800930ca2f1f5b402bf4cc25db7f1d">nn::account::GetNetworkServiceAccountId()</a>
  </li>
  <li>
    <a href="../../../Api/HtmlNX/namespacenn_1_1account.html#ade43b0fd5b5f5e1ec1752efe37d1ed97">nn::account::EnsureNetworkServiceAccountIdTokenCacheAsync()</a>
  </li>
  <li>
    <a href="../../../Api/HtmlNX/namespacenn_1_1account.html#afae1661923ba118f18a5b4af7ff1011a">nn::account::LoadNetworkServiceAccountIdTokenCache()</a>
  </li>
</ul>
<p>
  <br />
</p>
</div>
<div class="breadcrumb_bottom"></div>
<div class="page_navigation">
<table class="page_navi_root">
<tr>
<td class="page_navi_left"></td>
<td class="page_navi_right"></td>
</tr>
<tr><td colspan="2" class="page_navi_bottom"></td></tr>
</table>
</div>
</div>
</div>
</body>
</html>
