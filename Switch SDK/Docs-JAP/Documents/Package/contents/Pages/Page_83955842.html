<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<script type="text/javascript" src="../template/js/jquery/jquery.js"></script>
<script type="text/javascript" src="../template/js/common/manualLib.js"></script>
<script type="text/javascript" src="../tocData.js"></script>
<link rel="stylesheet" type="text/css" href="../template/css/template.css" />
<title>スクリプトからの利用</title>
</head>
<body data-reassemble="autoindex=no,forceNoLabel=yes">
<div id="autoindex_content">
<div class="body_content">
<noscript>
<div style="border: 4px double black; margin: 4px; padding: 2px; font-weight: bold; background-color: #FFFFCC;">
<p>お使いのブラウザは JavaScript が使用できないため、本ドキュメントの一部機能が無効になっています。</p><p>JavaScript が無効の環境では目次を使用することができません。<br />JavaScriptの実行が許可された状態で閲覧してください。<br /><br /></p>
</div>
</noscript>
<div class="page_navigation_top">
<table class="page_navi_root">
<tr>
<td class="page_navi_left"></td>
<td class="page_navi_right"></td>
</tr>
</table>
</div>
<div class="breadcrumb"></div>

<!-- スクリプトからの利用 -->
<div class="pagetitle" id="PageId_83955842">スクリプトからの利用</div>
<div class="text_separate">
<p>この章ではプラグインの機能をスクリプトから利用する方法を説明します。</p>
<p>以下のグローバルプロシージャがスクリプト（MEL）から利用可能です。<br /> 以下に記述していないプロシージャはプライベートなプロシージャであり、廃止・変更する可能性があるので、使用を推奨しません。</p>
<h1 id="Anchor_83955842_h1_1">エクスポート関連</h1>
<p>スクリプトから利用できるエクスポート関連の機能です。</p>
<table class="wrapped">
  <colgroup>
    <col />
    <col />
  </colgroup>
  <tbody>
    <tr>
      <th>NintendoExportDialog()</th>
      <td>エクスポートオプションウィンドウを表示します。</td>
    </tr>
    <tr>
      <th>NintendoExportDirect()</th>
      <td>
        <p>現在のオプション設定で出力します。<br />出力先に同名の中間ファイルが存在する場合は上書き確認します。</p>
      </td>
    </tr>
    <tr>
      <th>NintendoExportDirectForce()</th>
      <td>
        <p>現在のオプション設定で出力します。<br />出力先に同名の中間ファイルが存在しても上書き確認しません。</p>
      </td>
    </tr>
    <tr>
      <th>NintendoMultiExportDialog()</th>
      <td>マルチエクスポートプラグインのウィンドウを表示します。</td>
    </tr>
    <tr>
      <th>NintendoMultiExportDirect()</th>
      <td>
        <p>シーンに保存されたマルチエクスポート設定で、すべての出力アイテムを出力します。<br />出力先に同名の中間ファイルが存在しても上書き確認しません。</p>
      </td>
    </tr>
    <tr>
      <th>NintendoMultiExportDirect2(string $namesStr)</th>
      <td>
        <p>シーンに保存されたマルチエクスポート設定で、引数で指定した出力アイテムを出力します。</p>
        <p>namesStr には中間ファイル名を「,（カンマ）」で区切って指定します。<br />出力先に同名の中間ファイルが存在しても上書き確認しません。</p>
      </td>
    </tr>
    <tr>
      <th>
        <p>NintendoExportByFdes(string $fdesPath)<br />NintendoExportByFdes2(string $fdesPath, string $outPath)<br />NintendoExportByFdes3(string $fdesPath, string $outPath, string $option)<br />NintendoExportByScene()</p>
      </th>
      <td>
        <a href="../Pages/Page_83956120.html">バッチファイルによるエクスポート</a>を参照してください。</td>
    </tr>
  </tbody>
</table>
<h1 id="Anchor_83955842_h1_2">fdes ファイル関連</h1>
<p>スクリプトから利用できる fdes ファイル関連の機能です。</p>
<table class="wrapped">
  <colgroup>
    <col />
    <col />
  </colgroup>
  <tbody>
    <tr>
      <th>NintendoSaveFdes(string $fdesPath)</th>
      <td>現在のオプション設定を fdes ファイルにセーブします。<br />fdesPath がフルパスでなければ現在のプロジェクトフォルダーからの相対パスとします。</td>
    </tr>
    <tr>
      <th>NintendoLoadFdes(string $fdesPath)</th>
      <td>fdes ファイルの設定をロードして現在のオプション設定にします。<br /><a href="../Pages/Page_83956186.html#Anchor_83956186_management_option_settings">Save / Load Scene Settings</a>&nbsp;が ON ならシーンのオプション設定に反映され、シーンを保存した際にオプション設定も保存されます。<br />fdesPath がフルパスでなければ現在のプロジェクトフォルダーからの相対パスとします。</td>
    </tr>
  </tbody>
</table>
<p>
  <a name="Anchor_83955842_execution_script"></a>
</p>
<h1 id="Anchor_83955842_h1_3">出力前後に実行するスクリプト関連</h1>
<p>出力前後に実行するスクリプト関連の機能です。</p>
<table class="wrapped">
  <colgroup>
    <col />
    <col />
  </colgroup>
  <tbody>
    <tr>
      <th>
        <div class="content-wrapper">
          <p>
            <a name="Anchor_83955842_GetUsedFtxFileNames"></a>string[] NintendoGetUsedFtxFileNames()</p>
        </div>
      </th>
      <td>
        <p>現在のシーンからモデルを出力した場合の ftx ファイル名一覧を取得します。<br />通常、<a href="../Pages/Page_83956186.html#Anchor_83956186_pre_export_script">Pre-Export Script</a>&nbsp;オプションで指定したスクリプトから呼びます。<br />返り値は、モデルが使用する ftx ファイル名（拡張子を含む）の配列です。</p>
        <p>このプロシージャ内でシーンを解析するため、シーンが複雑だと処理に時間が掛かる場合があります。Post-Export Script では環境変数 NINTENDO_EXPORT_USED_FTX_FILE_NAMES を使用してください。<br />環境変数&nbsp;<strong>NINTENDO_EXPORT_OPTION_export_target</strong>&nbsp;で出力対象を判断するので、Pre-Export Script 以外から呼ぶ場合は事前に環境変数 NINTENDO_EXPORT_OPTION_export_target に all または selection を設定してください。</p>
      </td>
    </tr>
    <tr>
      <th>
        <div class="content-wrapper">
          <p>
            <a name="Anchor_83955842_UpdateEnvVarForScript"></a>NintendoUpdateEnvVarForScript()</p>
        </div>
      </th>
      <td>
        <p>Pre-Export Script オプションで指定したスクリプトから呼ぶと、環境変数に格納されている出力情報が更新されます。<br />たとえば、Output Folder オプションで環境変数 MY_FOLDER を使用している場合、Pre-Export Script で MY_FOLDER を設定しても Pre-Export Script 内では環境変数 NINTENDO_EXPORT_OUTPUT_FOLDER に反映されませんが、MY_FOLDER 設定後にこのプロシージャを呼ぶと反映されます。</p>
        <p>&nbsp;（Post-Export Script 内では自動的に反映されます。）<br />また、Output File Name オプションが @node の場合、ノード選択後にこのプロシージャを呼ぶと、環境変数 NINTENDO_EXPORT_OUTPUT_FILE_NAME に反映されます。</p>
        <p>&nbsp;</p>
      </td>
    </tr>
    <tr>
      <th>
        <div class="content-wrapper">
          <p>
            <a name="Anchor_83955842_CancelExport"></a>NintendoCancelExport()</p>
        </div>
      </th>
      <td>Pre-Export Script オプションで指定したスクリプトから呼ぶと、出力をキャンセルします。</td>
    </tr>
    <tr>
      <th>
        <div class="content-wrapper">
          <p>
            <a name="Anchor_83955842_SetOptimizerExtraOptionFmd"></a>NintendoSetOptimizerExtraOptionFmd(string $opts)</p>
        </div>
      </th>
      <td>
        <p>Pre-Export Script オプションで指定したスクリプトから呼ぶと、fmd ファイルに対する中間ファイルオプティマイザの追加オプションを指定できます。<br />引数は中間ファイルオプティマイザのオプション文字列です。複数のオプションを半角スペースで区切って指定できます。</p>
      </td>
    </tr>
    <tr>
      <th>
        <div class="content-wrapper">
          <p>
            <a name="Anchor_83955842_OverwriteExportOption"></a>NintendoOverwriteExportOption(string $keyword, string $value)</p>
        </div>
      </th>
      <td>
        <p>Pre-Export Script オプションで指定したスクリプトから呼ぶと、出力中のエクスポートオプション設定を上書きします。</p>
        <p>keyword と value は <a href="../Pages/Page_83955854.html">fdes ファイル</a>と同じ仕様です。</p>
        <p>たとえば次のように使用します。</p>
        <p>NintendoOverwriteExportOption(&quot;output_file_name&quot;, &quot;test1&quot;);<br />NintendoOverwriteExportOption(&quot;output_fvb&quot;, &quot;true&quot;);</p>
        <p>
          <br />
        </p>
        <p>プリセットでロックしたオプションも上書きできます。</p>
        <p>Pre-Export Script 以外でこのプロシージャを呼んでも効果はありません（シーンに保存されたエクスポートオプション設定を変更する機能ではありません）。<br />このプロシージャを呼んだ後で、環境変数 NINTENDO_EXPORT_FMD_FILE_PATH などの値を取得する場合、NintendoUpdateEnvVarForScript で更新してから取得してください。</p>
        <p>keyword が poly_reduction_mode の場合、値では「&quot;（ダブルクォート）」の代わりに「'（シングルクォート）」を使用してください。</p>
        <p>
          <br />
        </p>
        <p>以下のオプションは上書きできません</p>
        <ul>
          <li>preset</li>
          <li>lod_export</li>
          <li>pre_export_script</li>
          <li>post_export_script</li>
        </ul>
        <p>
          <br />
        </p>
        <p>以下のコンフィグ設定を上書きすることもできます。</p>
        <p>
          <span style="color: rgb(51,51,51);">一時的に最適化を無効にすることによって出力時間を短縮したい場合などに利用します</span>。</p>
        <ul>
          <li>optimize_primitive (none / default / force / brute_force / forsyth)</li>
          <li>quantization_analysis (true / false)</li>
          <li>delete_near_vertex (文字列)</li>
        </ul>
      </td>
    </tr>
    <tr>
      <th>
        <div class="content-wrapper">
          <p>
            <a name="Anchor_83955842_ClearExportOptionOverwriting"></a>NintendoClearExportOptionOverwriting()</p>
        </div>
      </th>
      <td>
        <p>NintendoOverwriteExportOption で指定したエクスポートオプションの上書き指定をすべて解除します。</p>
        <p>Pre-Export Script オプションで指定したスクリプトから呼びます。</p>
        <p>
          <span style="color: rgb(51,51,51);">Pre-Export Script で NintendoOverwriteExportOption を呼ばなければ何も上書きされませんが、一度呼んだ後に条件によっては解除したい場合などに使用します。</span>
          <br />
        </p>
      </td>
    </tr>
  </tbody>
</table>
</div>
<div class="breadcrumb_bottom"></div>
<div class="page_navigation">
<table class="page_navi_root">
<tr>
<td class="page_navi_left"></td>
<td class="page_navi_right"></td>
</tr>
<tr><td colspan="2" class="page_navi_bottom"></td></tr>
</table>
</div>
</div>
</div>
</body>
</html>
