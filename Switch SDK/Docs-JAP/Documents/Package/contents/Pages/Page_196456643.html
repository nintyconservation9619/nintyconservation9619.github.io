<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<script type="text/javascript" src="../template/js/jquery/jquery.js"></script>
<script type="text/javascript" src="../template/js/common/manualLib.js"></script>
<script type="text/javascript" src="../tocData.js"></script>
<link rel="stylesheet" type="text/css" href="../template/css/template.css" />
<title>GPU クラッシュダンプ機能</title>
</head>
<body data-reassemble="autoindex=no,forceNoLabel=yes">
<div id="autoindex_content">
<div class="body_content">
<noscript>
<div style="border: 4px double black; margin: 4px; padding: 2px; font-weight: bold; background-color: #FFFFCC;">
<p>お使いのブラウザは JavaScript が使用できないため、本ドキュメントの一部機能が無効になっています。</p><p>JavaScript が無効の環境では目次を使用することができません。<br />JavaScriptの実行が許可された状態で閲覧してください。<br /><br /></p>
</div>
</noscript>
<div class="page_navigation_top">
<table class="page_navi_root">
<tr>
<td class="page_navi_left"></td>
<td class="page_navi_right"></td>
</tr>
</table>
</div>
<div class="breadcrumb"></div>

<!-- GPU クラッシュダンプ機能 -->
<div class="pagetitle" id="PageId_196456643">GPU クラッシュダンプ機能</div>
<div class="text_separate">
<h1 id="Anchor_196456643_h1_1">はじめに</h1>
<p>このページでは、NX 開発機の GPU クラッシュダンプ機能について説明します。</p>
<h1 id="Anchor_196456643_h1_2">ダンプファイルの生成</h1>
<p>DevMenu の「Debug &gt; CrashDump &gt; GPU Crash Automatic Dump」にチェックを入れた場合、アプリケーションが GPU エラーを発生させた場合に GPU クラッシュダンプファイルが生成されます。</p>
<p>GPU クラッシュダンプ機能の有効・無効のデフォルトは以下の通りです。各 NX Addon に対応するファームウェアバージョンについては、<a href="../Pages/Page_97640247.html">動作環境</a>&nbsp;を参照してください。</p>
<table class="wrapped" style="margin-left: 1.5em;">
  <colgroup>
    <col />
    <col />
  </colgroup>
  <tbody>
    <tr>
      <th>ファームウェアバージョン</th>
      <th>デフォルト設定値</th>
    </tr>
    <tr>
      <td>NX Addon 3.0.x 以前のファームウェア</td>
      <td>無効</td>
    </tr>
    <tr>
      <td>NX Addon 3.1.0 以降のファームウェア</td>
      <td>有効</td>
    </tr>
  </tbody>
</table>
<p>GPU クラッシュダンプ機能は開発用の機能であるため、PROD MODE においては GPU クラッシュダンプ機能は無効化されます。</p>
<p>TargetManager 経由で PC と接続している場合は PC 上に、未接続の場合は microSD 上に出力されます。出力先となるディレクトリは CPU クラッシュダンプと同じです。詳細は、<a href="../Pages/Page_172911316.html">ダンプ機能の使用方法</a>&nbsp;を参照してください。PC と未接続でかつ microSD が挿入されていない場合、ダンプファイルは生成されません。</p>
<p>ファイル名は &quot;$(実行されたターゲットのシリアルナンバー)_$(ターゲットに設定されている日時).nxgcd&quot; となります。</p>
<p>また、ダンプファイルは、GPU エラーの発生の仕方によって同時に複数個が生成される場合があります。</p>
<h1 id="Anchor_196456643_h1_3">ダンプファイルの使用方法</h1>
<p>ダンプファイルの内容は以下のようになっています。各 NX Addon に対応するファームウェアバージョンについては、<a href="../Pages/Page_97640247.html">動作環境</a>&nbsp;を参照してください。</p>
<table class="wrapped" style="margin-left: 1.5em;">
  <colgroup>
    <col />
    <col />
  </colgroup>
  <tbody>
    <tr>
      <th>ファームウェアバージョン</th>
      <th>内容</th>
    </tr>
    <tr>
      <td>NX Addon 3.x.x 以前のファームウェア</td>
      <td>テキスト</td>
    </tr>
    <tr>
      <td>NX Addon 4.0.0 以降のファームウェア</td>
      <td>バイナリ</td>
    </tr>
  </tbody>
</table>
<p>NX Addon 3.x.x 以前のファームウェアではテキストとなっています。そのまま中身を確認できます。</p>
<p>NX Addon 4.0.0 以降のファームウェアではバイナリとなっています。中身を確認するには、NX Addon 4.0.0 以降に含まれる&nbsp;NxgcdFormatter&nbsp;を利用してテキスト形式に変換する必要があります。<br />テキスト形式に変換するには、以下のように NxgcdFormatter&nbsp;の引数としてダンプファイルのパスを渡すか、NxgcdFormatter&nbsp;にドラッグ&amp;ドロップしてください。</p>
<table class="codeblock">
  <tbody>
    <tr>
      <td class="code">
        <div class="codeblock"><pre>$NINTEND_SDK_ROOT/Tools/Graphics/NxgcdFormatter/NxgcdFormatter.exe &lt;nxgcd file path&gt;</pre></div>
      </td>
    </tr>
  </tbody>
</table>
<p>内容については、<a href="../Pages/Page_87937850.html">マニュアル</a>の「GPU エラーガイド」&nbsp;を参照してください。</p>
<p>以下にダンプファイルの一例を示します。</p>
<h2 id="Anchor_196456643_h2_1">ダンプファイルの例</h2>
<p>出力されるダンプファイルの例を以下に示します。</p>
<h3 id="Anchor_196456643_h3_1">NXAddon 3.x.x 以前</h3>
<div style="border-width: 1px;" class="preformatted panel">
  <div class="preformattedContent panelContent">
    <pre>[gpu]: GPU exception on queue 2 (aruid 0x7e)
 [gpu]:  Exception type: gr ds error
 [gpu]:  Error Status: 0xa2040800
 [gpu]: Graphics context info:
 [gpu]:  new_ctx: queue 2 (aruid 0x7e)
 [gpu]:  curr_ctx: queue 2 (aruid 0x7e)
 [gpu]: Graphics register dump:
 [gpu]:  gr_intr_r (0x400100): 0x200000
 [gpu]:  gr_status_r (0x400700): 0x200901
 [gpu]:  gr_status_1_r (0x400604): 0x0
 [gpu]:  gr_status_2_r (0x400608): 0x0
 [gpu]:  gr_engine_status_r (0x40060c): 0x1
 [gpu]:  gr_gpfifo_status_r (0x400504): 0x1
 [gpu]:  gr_gpfifo_ctl_r (0x400500): 0x0
 [gpu]:  gr_fecs_host_int_status_r (0x409c18): 0x0
 [gpu]:  gr_exception_r (0x400108): 0x0
 [gpu]:  gr_fecs_intr_r (0x400144): 0x0
 [gpu]:  gr_activity_0_r (0x400380): 0xc6
 [gpu]:  gr_activity_1_r (0x400384): 0x0
 [gpu]:  gr_activity_2_r (0x400388): 0x0
 [gpu]:  gr_activity_4_r (0x400390): 0x0
 [gpu]:  gr_pri_sked_activity_r (0x407054): 0x0
 [gpu]:  gr_pri_gpc0_gpccs_gpc_activity0_r (0x502c80): 0x0
 [gpu]:  gr_pri_gpc0_gpccs_gpc_activity1_r (0x502c84): 0x0
 [gpu]:  gr_pri_gpc0_gpccs_gpc_activity2_r (0x502c88): 0x0
 [gpu]:  gr_pri_gpc0_gpccs_gpc_activity3_r (0x502c8c): 0x0
 [gpu]:  gr_pri_gpc0_tpc0_tpccs_tpc_activity_0_r (0x504500): 0x0
 [gpu]:  gr_pri_gpc0_tpc1_tpccs_tpc_activity_0_r (0x504d00): 0x0
 [gpu]:  gr_pri_gpc0_tpcs_tpccs_tpc_activity_0_r (0x501d00): 0x0
 [gpu]:  gr_pri_gpcs_gpccs_gpc_activity_0_r (0x41ac80): 0x0
 [gpu]:  gr_pri_gpcs_gpccs_gpc_activity_1_r (0x41ac84): 0x0
 [gpu]:  gr_pri_gpcs_gpccs_gpc_activity_2_r (0x41ac88): 0x0
 [gpu]:  gr_pri_gpcs_gpccs_gpc_activity_3_r (0x41ac8c): 0x0
 [gpu]:  gr_pri_gpcs_tpc0_tpccs_tpc_activity_0_r (0x41c500): 0x0
 [gpu]:  gr_pri_gpcs_tpc1_tpccs_tpc_activity_0_r (0x41cd00): 0x0
 [gpu]:  gr_pri_gpcs_tpcs_tpccs_tpc_activity_0_r (0x419d00): 0x0
 [gpu]:  gr_pri_be0_becs_be_activity0_r (0x410200): 0x0
 [gpu]:  gr_pri_be1_becs_be_activity0_r (0x410600): 0x0
 [gpu]:  gr_pri_bes_becs_be_activity0_r (0x408a00): 0x0
 [gpu]:  gr_pri_ds_mpipe_status_r (0x405858): 0x0
 [gpu]:  gr_pri_fe_go_idle_on_status_r (0x404150): 0x2e
 [gpu]:  gr_fe_go_idle_timeout_r (0x404154): 0x800
 [gpu]:  gr_pri_fe_go_idle_check_r (0x404158): 0x800
 [gpu]:  gr_pri_fe_go_idle_info_r (0x404194): 0x23000711
 [gpu]:  gr_pri_gpc0_tpc0_tex_m_tex_subunits_status_r (0x504238): 0x0
 [gpu]:  gr_cwd_fs_r (0x405b00): 0x201
 [gpu]:  gr_fe_tpc_fs_r (0x4041c4): 0x3
 [gpu]:  gr_cwd_gpc_tpc_id_r(0) (0x405b60): 0x100
 [gpu]:  gr_cwd_sm_id_r(0) (0x405ba0): 0x100
 [gpu]:  gr_fecs_ctxsw_status_fe_0_r (0x409c00): 0x20002
 [gpu]:  gr_fecs_ctxsw_status_1_r (0x409400): 0x380
 [gpu]:  gr_gpc0_gpccs_ctxsw_status_gpc_0_r (0x502c04): 0x0
 [gpu]:  gr_gpc0_gpccs_ctxsw_status_1_r (0x502400): 0x300
 [gpu]:  gr_fecs_ctxsw_idlestate_r (0x409420): 0xf
 [gpu]:  gr_gpc0_gpccs_ctxsw_idlestate_r (0x502420): 0xf
 [gpu]:  gr_fecs_current_ctx_r (0x409b00): 0x80402600
 [gpu]:  gr_fecs_new_ctx_r (0x409b04): 0x80402600
 [gpu]:  gr_pri_be0_crop_status1_r (0x410134): 0x6000000
 [gpu]:  gr_pri_bes_crop_status1_r (0x408934): 0x6000000
 [gpu]:  gr_pri_be0_zrop_status_r (0x410048): 0x0
 [gpu]:  gr_pri_be0_zrop_status2_r (0x41004c): 0x0
 [gpu]:  gr_pri_bes_zrop_status_r (0x408848): 0x0
 [gpu]:  gr_pri_bes_zrop_status2_r (0x40884c): 0x0
 [gpu]:  gr_pri_be0_becs_be_exception_r (0x410204): 0x0
 [gpu]:  gr_pri_be0_becs_be_exception_en_r (0x410208): 0x0
 [gpu]:  gr_pri_gpc0_gpccs_gpc_exception_r (0x502c90): 0x0
 [gpu]:  gr_pri_gpc0_gpccs_gpc_exception_en_r (0x502c94): 0x30000
 [gpu]:  gr_pri_gpc0_tpc0_tpccs_tpc_exception_r (0x504508): 0x0
 [gpu]:  gr_pri_gpc0_tpc0_tpccs_tpc_exception_en_r (0x50450c): 0x2
 [gpu]: GPU exception on queue 2 (aruid 0x7e)
 [gpu]:  Exception type: MMU fault
 [gpu]:  Fault info: 0x00001040
 [gpu]:  Access type: read
 [gpu]:  Faulting address: 0x0000000000000000
 [gpu]:  Faulting unit: Primitive Distributor (pd)
 [gpu]:  Fault type: 0 (pde), Page Descriptor Entry has no valid page tables
 [gpu]:  Queue hw ctx ptr: 0x402600000
 [gpu]: Dump VM:
 [gpu]:  VA start: 0x0004000000 VA limit 0x2000000000
 [gpu]:  [0x0000400000-0x00004f7fff]: pgsize 0x01000 kind 0x00
 [gpu]:  [0x0040000000-0x004000ffff]: pgsize 0x10000 kind 0x00
 [gpu]:  [0x0050000000-0x005000ffff]: pgsize 0x10000 kind 0x00
 [gpu]:  [0x0050010000-0x005002ffff]: pgsize 0x10000 kind 0xfe
 [gpu]:  [0x0050030000-0x005003ffff]: pgsize 0x10000 kind 0x00
 [gpu]:  [0x0050040000-0x005004ffff]: pgsize 0x10000 kind 0xfe
 [gpu]:  [0x0050050000-0x00500affff]: pgsize 0x10000 kind 0x00
 [gpu]:  [0x00500b0000-0x005010ffff]: pgsize 0x10000 kind 0xfe
 [gpu]:  [0x0050110000-0x005210ffff]: pgsize 0x10000 kind 0x00
 [gpu]:  [0x0052110000-0x0053ffffff]: pgsize 0x10000 kind 0xfe
 [gpu]:  [0x0050400000-0x005050ffff]: pgsize 0x10000 kind 0xfe
 [gpu]:  [0x0050510000-0x005250ffff]: pgsize 0x10000 kind 0xdb
 [gpu]:  [0x0052510000-0x005251ffff]: pgsize 0x10000 kind 0x00
 [gpu]:  [0x0052520000-0x005252ffff]: pgsize 0x10000 kind 0xfe</pre>
  </div>
</div>
<h3 id="Anchor_196456643_h3_2">NXAddon 4.0.0 以降（テキスト形式への変換後のデータ）</h3>
<div style="border-width: 1px;" class="preformatted panel">
  <div class="preformattedContent panelContent">
    <pre>=============================================
Graphics Exception Summary
=============================================
GPU exception on queue 2 (aruid 0x83)
 Exception type: graphics engine error (class error)
 Class Error Code: 0x0000000c
 Method: 0xb197,0x000017c8
 Data: 0x00000000:0xffffffff
---------------------------------------------
Graphics Exception ISR Data
---------------------------------------------
  intr = 0x00100000
  exception = 0x00000000
  addr = 0x001017c8
  data_lo = 0xffffffff
  data_hi = 0x00000000
  curr_ctx = 0x804024b0
  chid = 0x00000002
  offset = 0x000005f2
  sub_chan = 0x00000000
  class_num = 0x0000b197</pre>
  </div>
</div>
</div>
<div class="breadcrumb_bottom"></div>
<div class="page_navigation">
<table class="page_navi_root">
<tr>
<td class="page_navi_left"></td>
<td class="page_navi_right"></td>
</tr>
<tr><td colspan="2" class="page_navi_bottom"></td></tr>
</table>
</div>
</div>
</div>
</body>
</html>
