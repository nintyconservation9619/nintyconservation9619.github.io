<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<script type="text/javascript" src="../template/js/jquery/jquery.js"></script>
<script type="text/javascript" src="../template/js/common/manualLib.js"></script>
<script type="text/javascript" src="../tocData.js"></script>
<link rel="stylesheet" type="text/css" href="../template/css/template.css" />
<title>クラッシュレポート</title>
</head>
<body data-reassemble="autoindex=no,forceNoLabel=yes">
<div id="autoindex_content">
<div class="body_content">
<noscript>
<div style="border: 4px double black; margin: 4px; padding: 2px; font-weight: bold; background-color: #FFFFCC;">
<p>お使いのブラウザは JavaScript が使用できないため、本ドキュメントの一部機能が無効になっています。</p><p>JavaScript が無効の環境では目次を使用することができません。<br />JavaScriptの実行が許可された状態で閲覧してください。<br /><br /></p>
</div>
</noscript>
<div class="page_navigation_top">
<table class="page_navi_root">
<tr>
<td class="page_navi_left"></td>
<td class="page_navi_right"></td>
</tr>
</table>
</div>
<div class="breadcrumb"></div>

<!-- クラッシュレポート -->
<div class="pagetitle" id="PageId_267167329">クラッシュレポート</div>
<div class="text_separate">
<p>
  <ul class="macro_toc">
    <li>
      <a href="#Anchor_267167329_h1_1">概要</a>
    </li>
    <ul>
      <li>
        <a href="#Anchor_267167329_h2_1">クラッシュレポートとは</a>
      </li>
      <li>
        <a href="#Anchor_267167329_h2_2">クラッシュレポートに含まれる情報</a>
      </li>
      <li>
        <a href="#Anchor_267167329_h2_3">クラッシュレポートのハッシュ値</a>
      </li>
      <li>
        <a href="#Anchor_267167329_h2_4">ダイイング・メッセージ</a>
      </li>
    </ul>
    <li>
      <a href="#Anchor_267167329_h1_2">クラッシュレポートを有効にするには</a>
    </li>
    <li>
      <a href="#Anchor_267167329_h1_3">クラッシュレポートに関する注意事項</a>
    </li>
    <li>
      <a href="#Anchor_267167329_h1_4">クラッシュレポート取得ツール</a>
    </li>
    <ul>
      <li>
        <a href="#Anchor_267167329_h2_5">パッケージ</a>
      </li>
      <li>
        <a href="#Anchor_267167329_h2_6">配置</a>
      </li>
      <li>
        <a href="#Anchor_267167329_h2_7">アクセストークンの取得</a>
      </li>
      <li>
        <a href="#Anchor_267167329_h2_8">利用方法</a>
      </li>
      <li>
        <a href="#Anchor_267167329_h2_9">利用例</a>
      </li>
      <ul>
        <li>
          <a href="#Anchor_267167329_h3_1">標準モード</a>
        </li>
        <li>
          <a href="#Anchor_267167329_h3_2">詳細モード</a>
        </li>
      </ul>
      <li>
        <a href="#Anchor_267167329_h2_10">オプション</a>
      </li>
      <li>
        <a href="#Anchor_267167329_h2_11">例外によって発生するエラーコード</a>
      </li>
    </ul>
  </ul>
</p>
<h1 id="Anchor_267167329_h1_1">概要</h1>
<h2 id="Anchor_267167329_h2_1">クラッシュレポートとは</h2>
<p>クラッシュレポートとは、アプリケーションが予期せぬエラーでクラッシュしたときのスタックトレースやレジスタの情報をまとめたものです。クラッシュレポートが有効化されたアプリケーションがクラッシュすると、システムがクラッシュレポートを作成し、任天堂のクラッシュレポートサーバーに送信します。アプリケーション開発者は、NintendoSDK に同梱されているクラッシュレポート取得ツールを利用することで、ユーザーがクラッシュレポートの共有に同意したクラッシュレポートを取得することができます。</p>
<p>システムがクラッシュレポートを収集するのは、クラッシュレポートが有効化されたアプリケーションのみです。クラッシュレポートを有効にする方法は「クラッシュレポートを有効にするには」節を参照してください。</p>
<p>ユーザーは、クラッシュレポートをアプリケーション開発者と共有することに対して、システム側で同意したり（オプトイン）、停止したり（オプトアウト）できます。アプリケーション開発者は、ユーザーが同意した（オプトイン）クラッシュレポートのみ取得することができます。</p>
<div class="info_new">
  <div class="info_new_left">参考：</div>
  <div class="info_new_right">
    <p>市場で発生したクラッシュレポートの収集にのみ対応しています。<br />開発機で発生したクラッシュレポートの収集には対応していません。</p>
  </div>
</div>
<h2 id="Anchor_267167329_h2_2">クラッシュレポートに含まれる情報</h2>
<p>アプリケーションのクラッシュ時に、以下の情報を収集します。</p>
<ul>
  <li>エラーコード</li>
  <li>例外種別</li>
  <li>例外アドレス</li>
  <li>汎用レジスタ一覧</li>
  <li>モジュール情報（コード領域・モジュール名）</li>
  <li>スタックトレース</li>
  <li>ハッシュ値（次節参照）</li>
  <li>ダイイング・メッセージ（アプリケーション定義のデータ：次節参照）</li>
</ul>
<p>また、クラッシュレポートを取得する際、ハッシュ値ごとに「発生台数」「発生件数」を集計します。それぞれの意味は以下の通りです。</p>
<ul>
  <li>発生台数：クラッシュが発生した本体の台数。同じ本体で何度置きても１回だけカウント</li>
  <li>発生件数：クラッシュが発生した回数。同じ本体で N 回起きたら N 回カウント</li>
</ul>
<p>これらの情報から、市場で広く発生しているクラッシュなのか、本体依存性のあるクラッシュなのかなどを推測することができます。</p>
<h2 id="Anchor_267167329_h2_3">クラッシュレポートのハッシュ値</h2>
<p>各クラッシュレポートには、スタックトレース、PC レジスタ, LR レジスタから算出される「ハッシュ値」が付与されます。「ハッシュ値」が同じであれば、スタックトレースが同じであると見なすことができます。この「ハッシュ値」を集計することによって、市場でどのクラッシュがどの程度起きているかを知ることができます。</p>
<p>ハッシュ値は、クラッシュの原因となったスレッドの情報のみから計算されます。ハッシュ値が同じでも、全スレッドの状態はそれぞれ異なる可能性があります。</p>
<h2 id="Anchor_267167329_h2_4">ダイイング・メッセージ</h2>
<p>ダイイング・メッセージは、クラッシュレポートに残すことのできるアプリケーション定義のデータです。<span class="ApiLink_nn__os__SetDyingMessageRegion">nn::os::SetDyingMessageRegion</span>() でメモリ領域を設定しておくと、アプリケーションがクラッシュ際、システムが指定したメモリ領域の内容を読み取りクラッシュレポートに残します。このメモリ領域には任意のバイナリデータを残すことができます。ただし、個人情報は含まないでください。指定できるメモリ領域のサイズは最大 4KB です。</p>
<div class="info_new">
  <div class="info_new_left">参考：</div>
  <div class="info_new_right">
    <p>開発機で発生したクラッシュレポートの収集には対応していないため、クラッシュレポート取得ツールを用いて開発中のダイイング・メッセージをご確認いただくことはできません。デバッガで停止してメモリを見る、プログラムでダンプする等の方法でのご確認をお願いいたします。</p>
  </div>
</div>
<h1 id="Anchor_267167329_h1_2">クラッシュレポートを有効にするには</h1>
<p>クラッシュレポート収集を有効にするためには、nmeta ファイルの「CrashReport」を「Allow」に設定する必要があります。デフォルトでは「Deny」に設定されています。<a href="../Pages/Page_166503043.html">nmeta ファイルの書き方</a>の「クラッシュレポート」の項目を参考に nmeta ファイルを修正してください。<a href="../Pages/Page_187698789.html">AuthoringEditor</a> も利用できます。</p>
<p>クラッシュレポートを有効にできるのは 64 ビットアプリケーションのみです。32 ビットアプリケーションには対応していません。</p>
<p>クラッシュレポートに含まれるスタックトレースのシンボルを表示するには、マスターROM の nsp に対応した nss が必要です。クラッシュレポート活用のため、マスターROM の nsp に対応した nss を保管してください。</p>
<p>パッチを出す場合、アプリケーションのバージョン（nmeta ファイルの DisplayVersion）は以前とは異なる値を指定してください。バイナリが異なるにも関わらず同じ DisplayVersion を指定すると、nss を指定してシンボルを表示する際、誤ったシンボルが表示される恐れがあります。</p>
<h1 id="Anchor_267167329_h1_3">クラッシュレポートに関する注意事項</h1>
<p class="inline-comment-marker">クラッシュレポートにクレジットカード情報を含めることは許されません。クラッシュレポートにクレジットカード情報が含まれる可能性があるシーンでは、nn::oe::DisableCrashReport() を利用してクラッシュレポートの作成機能を無効にしてください。その後、クレジットカード情報が含まれる可能性がなくなった場合には、nn::oe::EnableCrashReport() を利用してクラッシュレポートの作成機能を再び有効にすることができます。API の詳細は <a href="../../../Api/HtmlNX/namespacenn_1_1oe.html">nn::oe ライブラリの関数リファレンス</a>を参照してください。詳細はガイドラインを参照してください。</p>
<p>クラッシュレポートの作成機能が無効になっているかどうかは、DevMenu の Error タブから確認してください。画面下部に「Application Crash Report」という項目に「(Temporarily Disabled)」との表示があれば無効化されています。</p>
<p>
  <span class="embedded-file-wrapper ">
    <img src="../Attachments/Attach_267167329/267179789.png" height="250" class="embedded-image" />
  </span>
</p>
<div class="info_new">
  <div class="info_new_left">参考：</div>
  <div class="info_new_right">
    <p>クラッシュレポート作成機能を一時的に無効にする機能は NX Addon 4 系から提供されます。<br />NX Addon 3 系では、クラッシュレポート作成機能を一時的に無効にできないため、クレジットカード情報を扱うアプリケーションがクラッシュレポート作成機能を有効にすることは許されません。</p>
  </div>
</div>
<h1 id="Anchor_267167329_h1_4">クラッシュレポート取得ツール</h1>
<p>クラッシュレポート取得ツールは、市場で発生したクラッシュレポートの情報を取得するための CUI ツールです。</p>
<p>以下の２つのモードがあります。</p>
<ul>
  <li>標準モード：クラッシュレポートをスタックトレースのハッシュ値ごとに集計し、発生した本体の台数の多いものから順に表示</li>
  <li>詳細モード：--detail オプションを指定することで、集計された結果ではなく、クラッシュ１件１件の詳細な情報（全スレッドのダンプやダイイング・メッセージなど）を表示</li>
</ul>
<p>それぞれのモードの利用例は後述します。</p>
<p>結果はテキスト形式で表示されます。--json オプションを指定することで JSON フォーマットで出力することも可能です。</p>
<h2 id="Anchor_267167329_h2_5">パッケージ</h2>
<p>クラッシュレポート取得ツールは、NintendoSDK NX Addon で提供されます。</p>
<h2 id="Anchor_267167329_h2_6">配置</h2>
<table class="codeblock">
  <tbody>
    <tr>
      <td class="code">
        <div class="codeblock"><pre>$NINTENDO_SDK_ROOT/Tools/CommandLineTools/CrashReport.exe</pre></div>
      </td>
    </tr>
  </tbody>
</table>
<h2 id="Anchor_267167329_h2_7">アクセストークンの取得</h2>
<p>クラッシュレポート取得ツールを利用するためには、クラッシュレポートサーバーのアクセストークンを取得する必要があります。</p>
<p>アクセストークンの取得手順は、以下の通りです。</p>
<ol>
  <li>ブラウザでクラッシュレポートサーバー（<a href="https://crash-report.mng.nintendo.net">https://crash-report.mng.nintendo.net</a>）へ接続する</li>
  <li>NDID でログインする</li>
  <li>ログイン後、アクセストークン（文字列）を取得する</li>
</ol>
<h2 id="Anchor_267167329_h2_8">利用方法</h2>
<div style="border-width: 1px;" class="preformatted panel">
  <div class="preformattedContent panelContent">
    <pre>CrashReport.exe
  --application_id       &lt;id&gt;       [必須] アプリケーションID を指定
  --application_version  &lt;version&gt;  [必須] アプリケーションバージョン (DisplayVersion) を指定
  --access_token         &lt;token&gt;    [必須] アクセストークンを指定

Mode options:
  --default                         [デフォルト] 標準モードでまとめと例外スレッドのダンプを表示
  --detail                          各クラッシュの詳細（全スレッドダンプ・ダイイング・メッセージ）を表示

Output format options:
  --text                            [デフォルト] 結果をテキストで表示
  --json                            結果を JSON フォーマットで表示

Other options:
  --nss                  &lt;path&gt;     アプリケーションの .nss ファイルのパスを指定
  --date_begin           &lt;date&gt;     取得するクラッシュレポートの開始日を ISO8601 で指定
  --date_end             &lt;date&gt;     取得するクラッシュレポートの終了日を ISO8601 で指定
  --top                  &lt;N&gt;        上位 N 件のレポートのみを表示
  --hash                 &lt;hash&gt;     指定したハッシュ値を持つレポートのみを表示
  --addr2line            &lt;path&gt;     addr2line.exe のパスを指定
  --summary_only                    まとめのみを表示 (*1)
  --count_only                      発生台数の合計のみを表示 (*1)
  --min_count            &lt;N&gt;        &lt;N&gt; 台以上で発生したクラッシュのみを表示 (*1)
  --offset               &lt;N&gt;        &lt;N&gt; 番目のオフセットから結果を取得 (*2)
  --version                         バージョン情報を表示
  --help                            使い方を表示
                                    *1: 標準モードのみ, *2: 詳細モードのみ</pre>
  </div>
</div>
<h2 id="Anchor_267167329_h2_9">利用例</h2>
<p>クラッシュレポート取得ツールの各モード（標準モード・詳細モード）での利用例を以下に示します。</p>
<h3 id="Anchor_267167329_h3_1">標準モード</h3>
<p>以下に、標準モードでのコマンドの例を示します。ここでは必須項目のみを指定しています。</p>
<table class="codeblock">
  <tbody>
    <tr>
      <td class="code">
        <div class="codeblock"><pre>$ CrashReport.exe --application_id 0x01009b500007c000 --application_version 1.0.0 --access_token &lt;ACCESS TOKEN&gt;</pre></div>
      </td>
    </tr>
  </tbody>
</table>
<p>クラッシュレポート取得ツールを実行すると、まず「まとめ」が表示されます。まとめには、各クラッシュのハッシュ値、エラーコード、発生台数、発生件数が表示されます。「発生台数」はクラッシュが起きた台数を示します。同じ本体で何度置きても１回だけカウントされる値です。「発生件数」は単純にクラッシュが起きた回数を示します。同じ本体で N 回起きた場合には N 回カウントされます。</p>
<table class="codeblock">
  <tbody>
    <tr>
      <td class="code">
        <div class="codeblock"><pre>Hash                                                             ErrorCode Serial/Total
915EBD6D0AFD94F0581D55A65A6C89BA9F195BBF01C7D9C6E1D2A3ABA09B1A7A 2168-0002 1918/2280
D6AB70C16F35EEE274F83AC991A6777D602B494C3C25421CAFE99106241E2307 2168-0006 1255/1315
5228D66FCAA16C74E34D7037426CA604DADB11ECC4CAC92BEE85392687CD6B5B 2168-0002 367/367
9CF77D3C8B00CD5E16C87D96BD63A38A6806A3C783F01E2A160143DF82F1BB4C 2168-0002 298/318
5F3DB0828EA0F71CF153000C07434C9B80F6AC78974598D3833FF11C7B61755F 2168-0006 263/263
CD4F4DC81A60EDECFACA24618E09C8DF106498571061C9F6801477C8045B306E 2168-0002 231/259</pre></div>
      </td>
    </tr>
  </tbody>
</table>
<p>その後、各クラッシュの詳細が表示されます。詳細には、レジスタ情報、モジュール情報、スタックトレースが含まれます。</p>
<table class="codeblock">
  <tbody>
    <tr>
      <td class="code">
        <div class="codeblock"><pre>---------------------------------------------------------------------------------------
915EBD6D0AFD94F0581D55A65A6C89BA9F195BBF01C7D9C6E1D2A3ABA09B1A7A 1918/2280

Error code:        2168-0002
Exception code:    Access Violation Data
Exception address: 0x0000000000000004

Module Information:
&nbsp;&nbsp;0x0000000008000000 - 0x0000000008002000 nnrtld
&nbsp;&nbsp;0x000000000800D000 - 0x0000000008030000 Application.nss
&nbsp;&nbsp;0x0000000008200000 - 0x0000000008731000 nnSdkJp

----
X00:  0x000000000000015C
X01:  0x00000037A849727C
X02:  0x0000000000000000
X03:  0x00000037A912A5F4
X04:  0x0000000000000000
X05:  0x0000000000000000
X06:  0x0000000000000000
X07:  0x0000000000000000
X08:  0x000000000000015C
X09:  0x000000000000015C
X10:  0x0000000000000000
X11:  0x00000037A8B91718
X12:  0x00000037A90F2000
X13:  0x0000000000000054
X14:  0x0000000000000069
X15:  0x0000000000000000
X16:  0x00000037A94ADB38
X17:  0x00000037AA2025A4
X18:  0x0000000000000000
X19:  0x00000051456BE040
X20:  0x000000000000015C
X21:  0x00000051426DA4E8
X22:  0x0000000000000001
X23:  0x000000000000002C
X24:  0x0000000000000000
X25:  0x00000037A963E5E0
X26:  0x000000000000002D
X27:  0x0000000000000001
X28:  0x0000000000000008
FP :  0x00000056587AD730
LR :  0x00000037A822aacc: 0x37a8206000 + 0x22aacc <span class="o">(</span>Application.nss<span class="o">)</span>
SP :  0x00000056587AD710 
PC :  0x00000037A822ff00: 0x37a8206000 + 0x22ff00 <span class="o">(</span>Application.nss<span class="o">)</span>
PSTATE: 0x80000000

Stack: 0x0100000000000000 - 0x0100000000000000

Stack trace:
&nbsp;&nbsp;0x00000037A822aa44: 0x37a8206000 + 0x22aa44 <span class="o">(</span>Application.nss<span class="o">)</span>
&nbsp;&nbsp;0x00000037A822aa88: 0x37a8206000 + 0x22aa88 <span class="o">(</span>Application.nss<span class="o">)</span>
&nbsp;&nbsp;0x00000037A899aa00: 0x37a8206000 + 0x99aa00 <span class="o">(</span>Application.nss<span class="o">)</span>
&nbsp;&nbsp;0x00000037A899aacc: 0x37a8206000 + 0x99aacc <span class="o">(</span>Application.nss<span class="o">)</span>
&nbsp;&nbsp;0x00000037A899aa88: 0x37a8206000 + 0x99aa88 <span class="o">(</span>Application.nss<span class="o">)</span>
&nbsp;&nbsp;0x00000037A877aacc: 0x37a8206000 + 0x77aacc <span class="o">(</span>Application.nss<span class="o">)</span>
&nbsp;&nbsp;0x00000037A8aaaa88: 0x37a8206000 + 0xaaaa88 <span class="o">(</span>Application.nss<span class="o">)</span>
&nbsp;&nbsp;0x00000037A8aaaacc: 0x37a8206000 + 0xaaaacc <span class="o">(</span>Application.nss<span class="o">)</span>
&nbsp;&nbsp;0x00000037A899aa88: 0x37a8206000 + 0x99aa88 <span class="o">(</span>Application.nss<span class="o">)</span>
&nbsp;&nbsp;0x00000037A82000DC: 0x37a8200000 + 0xdc <span class="o">(</span>nnrtld<span class="o">)</span>

---------------------------------------------------------------------------------------
D6AB70C16F35EEE274F83AC991A6777D602B494C3C25421CAFE99106241E2307 1918/2280

（略）</pre></div>
      </td>
    </tr>
  </tbody>
</table>
<p>コマンドラインで --nss オプションを指定した場合には、スタックトレースやレジスタ情報の一部にシンボル情報が表示されます。</p>
<table class="codeblock">
  <tbody>
    <tr>
      <td class="code">
        <div class="codeblock"><pre>$ CrashReport.exe --application_id 0x01009b500007c000 --application_version 1.0.0 --access_token &lt;ACCESS TOKEN&gt; --nss application.nss

（中略）

LR :  0x00000037A822aacc: CrashFunction1<span class="o">()</span> at D:<span class="se">\S</span>amples<span class="se">\S</span>ources<span class="se">\A</span>pplications<span class="se">\C</span>rashApplication/Function.cpp:71 <span class="o">(</span>Application.nss<span class="o">)</span>
SP :  0x00000056587AD710 
PC :  0x00000037A822ff00: CrashFunction2<span class="o">()</span> at D:<span class="se">\S</span>amples<span class="se">\S</span>ources<span class="se">\A</span>pplications<span class="se">\C</span>rashApplication/Function.cpp:97 <span class="o">(</span>Application.nss<span class="o">)</span>
PSTATE: 0x80000000

Stack: 0x0100000000000000 - 0x0100000000000000

Stack trace:
&nbsp;&nbsp;0x00000037A899aa88: nnMain at D:<span class="se">\S</span>amples<span class="se">\S</span>ources<span class="se">\A</span>pplications<span class="se">\C</span>rashApplication/Main.cpp:121 <span class="o">(</span>Application.nss<span class="o">)</span>
&nbsp;&nbsp;0x00000037A82000DC: 0x37a8200000 + 0xdc <span class="o">(</span>nnrtld<span class="o">)</span></pre></div>
      </td>
    </tr>
  </tbody>
</table>
<p>--json オプションを指定することで JSON フォーマットで結果を出力することもできます。</p>
<table class="codeblock">
  <tbody>
    <tr>
      <td class="code">
        <div class="codeblock"><pre>$ CrashReport.exe --application_id 0x01009b500007c000 --application_version 1.0.0 --access_token &lt;ACCESS TOKEN&gt; --nss application.nss --json

[{&quot;application_version&quot;:&quot;1.0.0&quot;,
&nbsp;&nbsp;&nbsp;&nbsp;&quot;crash_report_hash&quot;:&quot;915EBD6D0AFD94F0581D55A65A6C89BA9F195BBF01C7D9C6E1D2A3ABA09B1A7A&quot;,
&nbsp;&nbsp;&nbsp;&nbsp;&quot;dying_message_base64&quot;:null,
&nbsp;&nbsp;&nbsp;&nbsp;&quot;error_code&quot;:&quot;2003-0008&quot;,
&nbsp;&nbsp;&nbsp;&nbsp;&quot;exception_address&quot;:280724143384,
&nbsp;&nbsp;&nbsp;&nbsp;&quot;exception_code&quot;:&quot;User Break&quot;,
&nbsp;&nbsp;&nbsp;&nbsp;&quot;exception_thread_id&quot;:628,
&nbsp;&nbsp;&nbsp;&nbsp;&quot;is_64bit&quot;:true,
&nbsp;&nbsp;&nbsp;&nbsp;&quot;modules&quot;:[
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&quot;module_name&quot;:&quot;nnrtld&quot;, &quot;module_begin_address&quot;:280718475264, &quot;module_end_address&quot;:280718483456},
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&quot;module_name&quot;:&quot;Application.nss&quot;, &quot;module_begin_address&quot;:280718528512, &quot;module_end_address&quot;:280718684160},
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&quot;module_name&quot;:&quot;nnSdk&quot;, &quot;module_begin_address&quot;:280723038208, &quot;module_end_address&quot;:280729530368}],
&nbsp;&nbsp;&nbsp;&nbsp;&quot;occurrence_time&quot;:&quot;2018-03-03T03:03:03.000Z&quot;,
&nbsp;&nbsp;&nbsp;&nbsp;&quot;os_version&quot;:&quot;5.0.0&quot;,
&nbsp;&nbsp;&nbsp;&nbsp;&quot;serial_number_count&quot;:1918,
&nbsp;&nbsp;&nbsp;&nbsp;&quot;threads&quot;:[{&quot;thread_id&quot;:628,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;registers&quot;:[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;fp&quot;:9846213504,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;lr&quot;:280723397228,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;sp&quot;:9846213504,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;pc&quot;:280724143380,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;pstate&quot;:536870912,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;stack_top&quot;:9845166080,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;stack_bottom&quot;:9846214656,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;stack_trace&quot;:[280723389600, 280723389796, 280718529296, 280718530064, 280723689020, 280718475436],
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;lr_symbol&quot;:&quot;0x415C65A000 + 0x57A6C (nnSdk)&quot;,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;pc_symbol&quot;:&quot;0x415C65A000 + 0x10DD14 (nnSdk)&quot;,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;stack_trace_symbol&quot;:[&quot;0x415C65A000 + 0x55CA0 (nnSdk)&quot;,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;0x415C65A000 + 0x55D64 (nnSdk)&quot;,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;CrashFunction1() at D:\Samples\Sources\Applications\CrashApplication/Function.cpp:71 (Application.nss)&quot;,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;nnMain at D:\Samples\Sources\Applications\CrashApplication/Main.cpp:121 (Application.nss)&quot;,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;0x415C65A000 + 0x9EE3C (nnSdk)&quot;,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;0x415C200000 + 0xAC (nnrtld)&quot;]}],
&nbsp;&nbsp;&nbsp;&nbsp;&quot;total_count&quot;:2280},
(後略）</pre></div>
      </td>
    </tr>
  </tbody>
</table>
<h3 id="Anchor_267167329_h3_2">詳細モード</h3>
<p>以下に、詳細モードでのコマンドの例を示します。詳細モードでクラッシュレポート取得するには --detail オプションを指定する必要があります。</p>
<table class="codeblock">
  <tbody>
    <tr>
      <td class="code">
        <div class="codeblock"><pre>$ CrashReport.exe --detail --application_id 0x01009b500007c000 --application_version 1.0.0 --access_token &lt;ACCESS TOKEN&gt;</pre></div>
      </td>
    </tr>
  </tbody>
</table>
<p>詳細モードでは、発生したクラッシュレポート１件１件を取得して結果を出力します。詳細モードでは、標準モードの情報に加えて</p>
<ul>
  <li>全スレッドのダンプ</li>
  <li>ダイイング・メッセージ</li>
  <li>クラッシュ発生日時</li>
  <li>OS バージョン</li>
</ul>
<p>が出力されます。</p>
<table class="codeblock">
  <tbody>
    <tr>
      <td class="code">
        <div class="codeblock"><pre>---------------------------------------------------------------------------------------
Error code:          2168-0002
Exception code:      Access Violation Data
Exception address:   0x0000000000000004
Exception Thread ID: 0x0000000000000256
Occurrence Time:     2018-02-16T04:41:21.000Z
Os version:          5.0.0
Crash Hash:          9E2FBC3CFD2427C01BA703006A7A4AF6C40ABB35EC5BC8265FA81B0007B61773

Module Information:
&nbsp;&nbsp;0x000000341DE00000 - 0x000000341DE02000 nnrtld
&nbsp;&nbsp;0x000000341DE0D000 - 0x000000341DE33000 Application.nss
&nbsp;&nbsp;0x000000341E25A000 - 0x000000341E88B000 nnSdkJp</pre></div>
      </td>
    </tr>
  </tbody>
</table>
<p>これに続いて、全スレッドのダンプが表示されます。</p>
<p>各スレッドのダンプには、ThreadId が表示されます。ThreadId が Exception Thread ID（例外を起こしたスレッドID）と同じ場合には「&lt;Exception Thread&gt;」が表示されます。</p>
<table class="codeblock">
  <tbody>
    <tr>
      <td class="code">
        <div class="codeblock"><pre>----
ThreadId :  0x0000000000000256 &lt;Exception Thread&gt; &lt;<span class="o">==</span> 例外を起こしたスレッド

X00:  0x0000000000000000
X01:  0x000000789BC72000
X02:  0x0000004C425B6D18
X03:  0x0000000000000000
X04:  0x0000000000000000
X05:  0x0000000000000000
X06:  0x0000000000000000
X07:  0x0000000000000000
X08:  0x0000000000000004
X09:  0x000000000000DEAD
X10:  0x0000000000000000
X11:  0x0000000000000000
X12:  0x0000000000000000
X13:  0x0000000000000000
X14:  0x0000000000000000
X15:  0x0000000000000000
X16:  0x0000000000000000
X17:  0x0000000000000000
X18:  0x0000000000000000
X19:  0x000000341DED9174
X20:  0x000000341DED9774
X21:  0x00000022A2638D22
X22:  0x000000341DE590D0
X23:  0x000000341DED9774
X24:  0x00000000431BDE82
X25:  0x00000000D7B634DB
X26:  0x00000008E9B38D61
X27:  0x2A91BB94C28F5C2F
X28:  0x000000341DE4B11C
FP :  0x0000004C425B6D40
LR :  0x000000341DE0D2C0: CrashFunction1<span class="o">()</span> at D:<span class="se">\S</span>amples<span class="se">\S</span>ources<span class="se">\A</span>pplications<span class="se">\C</span>rashApplication/Function.cpp:71 <span class="o">(</span>Application.nss<span class="o">)</span>
SP :  0x0000004C425B6D40
PC :  0x000000341DE0D2C8: CrashFunction2<span class="o">()</span> at D:<span class="se">\S</span>amples<span class="se">\S</span>ources<span class="se">\A</span>pplications<span class="se">\C</span>rashApplication/Function.cpp:97 <span class="o">(</span>Application.nss<span class="o">)</span>
PSTATE:  0x80000000

Stack: 0x0000004C424B7000 - 0x0000004C425B7000

Stack trace:
&nbsp;&nbsp;0x000000341DE17FBC: nnMain at D:<span class="se">\S</span>amples<span class="se">\S</span>ources<span class="se">\A</span>pplications<span class="se">\C</span>rashApplication/Main.cpp:121 <span class="o">(</span>Application.nss<span class="o">)</span>
&nbsp;&nbsp;0x000000341E2F8E3C: 0x341E25A000 + 0x9EE3C <span class="o">(</span>nnSdkJp<span class="o">)</span>
&nbsp;&nbsp;0x000000341DE000AC: 0x341DE00000 + 0xAC <span class="o">(</span>nnrtld<span class="o">)</span>

----
ThreadId :  0x0000000000000267                    &lt;<span class="o">==</span> 例外を起こしていないスレッド（&lt;Exception Thread&gt; が表示されない）

（後略）</pre></div>
      </td>
    </tr>
  </tbody>
</table>
<p>最後にダイイング・メッセージの内容が表示されます。</p>
<table class="codeblock">
  <tbody>
    <tr>
      <td class="code">
        <div class="codeblock"><pre>Dying Message <span class="o">(</span>BASE64<span class="o">)</span>: <span class="s2">&quot;&quot;&quot;
AAECAwQFBgcICQoLDA0ODxAREhMUFRYXGBkaGxwdHh8gISIjJCUmJygpKiss
LS4vMDEyMzQ1Njc4OTo7PD0+P0BBQkNERUZHSElKS0xNTk9QUVJTVFVWV1hZ
WltcXV5fYGFiY2RlZmdoaWprbG1ub3BxcnN0dXZ3eHl6e3x9fn+AgYKDhIWG
h4iJiouMjY6PkJGSk5SVlpeYmZqbnJ2en6ChoqOkpaanqKmqq6ytrq+wsbKz
tLW2t7i5uru8vb6/wMHCw8TFxsfIycrLzM3Oz9DR0tPU1dbX2Nna29zd3t/g
4eLj5OXm5+jp6uvs7e7v8PHy8/T19vf4+fr7/P3+/w==
&quot;&quot;&quot;</span></pre></div>
      </td>
    </tr>
  </tbody>
</table>
<p>「&quot;&quot;&quot;」で囲まれる部分が BASE64 エンコードされたダイイング・メッセージです。</p>
<p>詳細モードで一度に取得できるクラッシュレポートは 500 件までです。これ以降のクラッシュレポートを取得したい場合は、--offset オプションにて取得したレポートのオフセットを指定してください。--hash オプションによってハッシュを限定した場合には、同一のハッシュのクラッシュレポートを 500 件まで取得できます。</p>
<p>詳細モードでも、標準モードと同様に --json オプションを指定することで JSON フォーマットで結果を出力することもできます。</p>
<h2 id="Anchor_267167329_h2_10">オプション</h2>
<table class="wrapped">
  <colgroup>
    <col />
    <col />
  </colgroup>
  <tbody>
    <tr>
      <th>名前</th>
      <th>
        <div class="content-wrapper">
          <p>説明</p>
        </div>
      </th>
    </tr>
    <tr>
      <td>
        <pre>--application_id &lt;arg&gt;</pre>
      </td>
      <td>【必須】<br />クラッシュレポートを取得するアプリケーションのアプリケーション ID を指定します。</td>
    </tr>
    <tr>
      <td>
        <pre>--application_version &lt;arg&gt;</pre>
      </td>
      <td>
        <p>【必須】</p>
        <p>クラッシュレポートを取得するアプリケーションのバージョン（nmeta ファイルの DisplayVersion）を指定します。</p>
      </td>
    </tr>
    <tr>
      <td>
        <pre>--access_token &lt;arg&gt;</pre>
      </td>
      <td>
        <p>【必須】</p>
        <p>取得したアクセストークンを指定します。</p>
      </td>
    </tr>
    <tr>
      <td>
        <pre>--default</pre>
      </td>
      <td>標準モードでクラッシュレポートを取得します。クラッシュレポートとまとめと、例外を起こしたスレッドのダンプが表示されます。</td>
    </tr>
    <tr>
      <td>
        <pre>--detail</pre>
      </td>
      <td>詳細モードでクラッシュレポートを取得します。各クラッシュの詳細（全スレッドのダンプ・ダイイング・メッセージなど）が表示されます。</td>
    </tr>
    <tr>
      <td>
        <pre>--text</pre>
      </td>
      <td>テキストで結果を出力します。</td>
    </tr>
    <tr>
      <td>
        <pre>--json</pre>
      </td>
      <td>JSON 形式で結果を出力します。</td>
    </tr>
    <tr>
      <td>
        <pre>--nss &lt;arg&gt;</pre>
      </td>
      <td>
        <p>アプリケーションの .nss ファイルのパスを指定します。</p>
        <p>スタックトレースのシンボルを表示するためには nss を指定する必要があります。マスターROM の nsp に対応する nss を保管してください。誤った nss を指定した場合、誤ったシンボルが表示される場合があります。ご注意ください。</p>
      </td>
    </tr>
    <tr>
      <td>
        <pre>--date_begin &lt;arg&gt;</pre>
      </td>
      <td>
        <p>クラッシュレポートを取得する期間の開始日時を ISO8601 で指定します（例えば、20170303 や 20170303T000000+900)。</p>
        <p>省略した場合は現在日時 - 1ヶ月になります。<br />期間が6ヶ月を超える場合、終了日時は開始日時＋6ヶ月になります。</p>
      </td>
    </tr>
    <tr>
      <td>
        <pre>--date_end &lt;arg&gt;</pre>
      </td>
      <td>
        <p>クラッシュレポートを取得する期間の終了日時を ISO8601 で指定します（例えば、20170303 や 20170303T000000+900)。</p>
        <p>省略した場合は現在日時になります。<br />期間が6ヶ月を超える場合、終了日時は開始日時＋6ヶ月になります。</p>
      </td>
    </tr>
    <tr>
      <td>
        <pre>--top &lt;arg&gt;</pre>
      </td>
      <td>発生台数の上位 &lt;arg&gt; 件のみを表示します。</td>
    </tr>
    <tr>
      <td>
        <pre>--hash &lt;arg&gt;</pre>
      </td>
      <td>クラッシュレポートのハッシュ値が &lt;arg&gt; に一致するもののみを表示します。</td>
    </tr>
    <tr>
      <td>
        <pre>--addr2line &lt;arg&gt;</pre>
      </td>
      <td>
        <p>シンボル解析のための addr2line のパスを指定します。</p>
        <p>指定しなかった場合、$NINTENDO_SDK_ROOT/Compilers/NX/nx/aarch64/bin/aarch64-nintendo-nx-elf-addr2line.exe を利用します。</p>
      </td>
    </tr>
    <tr>
      <td>
        <pre>--summary_only</pre>
      </td>
      <td>まとめのみを表示します（標準モードのみ）。</td>
    </tr>
    <tr>
      <td>
        <pre>--count_only</pre>
      </td>
      <td>発生台数の合計のみを表示します（標準モードのみ）。</td>
    </tr>
    <tr>
      <td>
        <pre>--min_count &lt;N&gt;</pre>
      </td>
      <td>&lt;N&gt; 台以上の本体で発生したクラッシュレポートのみを表示します（標準モードのみ）。</td>
    </tr>
    <tr>
      <td>
        <pre>--offset &lt;N&gt;</pre>
      </td>
      <td>&lt;N&gt; 番目のオフセットからクラッシュレポートを取得します（詳細モードのみ）。</td>
    </tr>
    <tr>
      <td>
        <pre>--version</pre>
      </td>
      <td>バージョン情報を表示します。</td>
    </tr>
    <tr>
      <td>
        <pre>--help</pre>
      </td>
      <td>使い方を表示します。</td>
    </tr>
  </tbody>
</table>
<h2 id="Anchor_267167329_h2_11">例外によって発生するエラーコード</h2>
<p>不正なメモリ領域へのデータアクセスなどの例外によって発生するエラーコードは以下の通りです。<br />これ以外のエラーコードの意味はエラーコードデータベースを参照してください。</p>
<table class="wrapped">
  <colgroup>
    <col />
    <col />
    <col />
  </colgroup>
  <tbody>
    <tr>
      <th>エラーコード</th>
      <th>対応する例外</th>
      <th>主な原因</th>
    </tr>
    <tr>
      <td>
        <pre>2168-0000</pre>
      </td>
      <td>
        <pre>Undefined Instruction</pre>
      </td>
      <td>未定義の命令を実行した</td>
    </tr>
    <tr>
      <td>
        <pre>2168-0001</pre>
      </td>
      <td>
        <pre>Access Violation Instruction</pre>
      </td>
      <td>不正なメモリ領域への命令アクセス</td>
    </tr>
    <tr>
      <td>
        <pre>2168-0002</pre>
      </td>
      <td>
        <pre>Access Violation Data</pre>
      </td>
      <td>不正なメモリ領域へのデータアクセス</td>
    </tr>
    <tr>
      <td>
        <pre>2168-0003</pre>
      </td>
      <td>
        <pre>Data Type Misaligned</pre>
      </td>
      <td>不正なアライメントでのデータアクセス</td>
    </tr>
    <tr>
      <td>
        <pre>2168-0006</pre>
      </td>
      <td>
        <pre>User Break</pre>
      </td>
      <td>Break の呼び出し（NN_ABORT の呼び出し）</td>
    </tr>
    <tr>
      <td>
        <pre>2168-0008</pre>
      </td>
      <td>
        <pre>Undefined System Call</pre>
      </td>
      <td>無効なシステムコールの呼び出し</td>
    </tr>
    <tr>
      <td>
        <pre>2168-0009</pre>
      </td>
      <td>
        <pre>Memory System Error</pre>
      </td>
      <td>メモリシステムでのエラー</td>
    </tr>
  </tbody>
</table>
</div>
<div class="breadcrumb_bottom"></div>
<div class="page_navigation">
<table class="page_navi_root">
<tr>
<td class="page_navi_left"></td>
<td class="page_navi_right"></td>
</tr>
<tr><td colspan="2" class="page_navi_bottom"></td></tr>
</table>
</div>
</div>
</div>
<!--AddLink-->
<script>
var NintendoSdkApiRefernce = {
    idMap: {},
    linkRewrite: function ()
    {
        var idMap = NintendoSdkApiRefernce.idMap;
        function rewrite(el)
        {
            var e = idMap[el.className];
            if (e === undefined)
            {
                return;
            }
            var html = '';
            html += '<a href=';
            html += e.url;
            html += ' target="_blank">';
            html += el.innerHTML;
            html += '</a>';
            el.innerHTML = html;
        }
        var apiLinkElems = document.querySelectorAll('span[class*="ApiLink_"]');
        for (var i = 0, n = apiLinkElems.length; i< n; ++i) {
            rewrite(apiLinkElems[i]);
        }
    }
};
function SetUrl( id, url )
{
    NintendoSdkApiRefernce.idMap[id] = { url: url };
}
SetUrl( 'ApiLink_nn__os__SetDyingMessageRegion', '../../../Api/HtmlNX/namespacenn_1_1os.html#a25125eea675c69bc6912e1140d4df148' )

NintendoSdkApiRefernce.linkRewrite();
</script>
<!--AddLink-->
</body>
</html>
