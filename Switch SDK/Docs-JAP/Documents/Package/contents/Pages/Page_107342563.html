<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<script type="text/javascript" src="../template/js/jquery/jquery.js"></script>
<script type="text/javascript" src="../template/js/common/manualLib.js"></script>
<script type="text/javascript" src="../tocData.js"></script>
<link rel="stylesheet" type="text/css" href="../template/css/template.css" />
<title>マニュアル</title>
</head>
<body data-reassemble="autoindex=no,forceNoLabel=yes">
<div id="autoindex_content">
<div class="body_content">
<noscript>
<div style="border: 4px double black; margin: 4px; padding: 2px; font-weight: bold; background-color: #FFFFCC;">
<p>お使いのブラウザは JavaScript が使用できないため、本ドキュメントの一部機能が無効になっています。</p><p>JavaScript が無効の環境では目次を使用することができません。<br />JavaScriptの実行が許可された状態で閲覧してください。<br /><br /></p>
</div>
</noscript>
<div class="page_navigation_top">
<table class="page_navi_root">
<tr>
<td class="page_navi_left"></td>
<td class="page_navi_right"></td>
</tr>
</table>
</div>
<div class="breadcrumb"></div>

<!-- マニュアル -->
<div class="pagetitle" id="PageId_107342563">マニュアル</div>
<div class="text_separate">
<p>
  <ul class="macro_toc">
    <li>
      <a href="#Anchor_107342563_h1_1">概要</a>
    </li>
    <ul>
      <li>
        <a href="#Anchor_107342563_h2_1">パッケージ</a>
      </li>
      <li>
        <a href="#Anchor_107342563_h2_2">対応プラットフォーム</a>
      </li>
      <li>
        <a href="#Anchor_107342563_h2_3">関連項目</a>
      </li>
    </ul>
    <li>
      <a href="#Anchor_107342563_h1_2">デバッガの機能</a>
    </li>
    <ul>
      <ul>
        <li>
          <a href="#Anchor_107342563_h3_1">NX 固有の挙動を伴う機能</a>
        </li>
        <ul>
          <li>
            <a href="#Anchor_107342563_h4_1">アセンブリファイルのビルド</a>
          </li>
          <li>
            <a href="#Anchor_107342563_h4_2">コンパイル済みヘッダ</a>
          </li>
        </ul>
        <li>
          <a href="#Anchor_107342563_h3_2">NX 固有の機能</a>
        </li>
        <ul>
          <li>
            <a href="#Anchor_107342563_h4_3">ソースファイルの単体処理</a>
          </li>
        </ul>
        <li>
          <a href="#Anchor_107342563_h3_3">非サポートの機能</a>
        </li>
      </ul>
    </ul>
    <li>
      <a href="#Anchor_107342563_h1_3">デバッグ情報</a>
    </li>
    <li>
      <a href="#Anchor_107342563_h1_4">互換性</a>
    </li>
    <li>
      <a href="#Anchor_107342563_h1_5">インストール・アンインストール・再インストール</a>
    </li>
    <ul>
      <ul>
        <ul>
          <ul>
            <li>
              <a href="#Anchor_107342563_h5_1">事前準備</a>
            </li>
            <li>
              <a href="#Anchor_107342563_h5_2">アンインストール</a>
            </li>
            <li>
              <a href="#Anchor_107342563_h5_3">インストール</a>
            </li>
            <li>
              <a href="#Anchor_107342563_h5_4">再インストール</a>
            </li>
          </ul>
        </ul>
      </ul>
    </ul>
    <li>
      <a href="#Anchor_107342563_h1_6">複数台のデバッグ</a>
    </li>
    <li>
      <a href="#Anchor_107342563_h1_7">制限事項</a>
    </li>
    <ul>
      <li>
        <a href="#Anchor_107342563_h2_4">デバッグ中に「すべて中断 (Ctrl+Alt+Break) 」を使用して停止した場合、変数の値が正しくないことがある</a>
      </li>
      <li>
        <a href="#Anchor_107342563_h2_5">アタッチ直後に nn::diag::IsDebuggerAttached() を呼び出した場合、アタッチしていないという結果が返ることがある</a>
      </li>
    </ul>
  </ul>
</p>
<h1 id="Anchor_107342563_h1_1">概要</h1>
<p>NX VSI は、NX アプリケーション開発用の VSI (Visual Studio Integration) です。</p>
<p>NX VSI をインストールすると、Visual Studio を使用して NX アプリケーションをビルド・デバッグできるようになります。</p>
<p>ブレークポイント・ステップ実行・変数のウォッチなど、多くの一般的なデバッグ機能がサポートされています。</p>
<p>
  <br />
</p>
<p>また、NX プラットフォーム向けのプログラムを Windows 向けにビルドし、Windows 上で実行・デバッグを行うことができます。</p>
<p>NX プラットフォーム向けビルドと Windows 向けビルドは、Visual Studio 上のリストボックスから簡単に切り替えることができます。基本的に、アプリケーションプログラムを書き換える必要はありません。</p>
<h2 id="Anchor_107342563_h2_1">パッケージ</h2>
<p>NX VSI は、NintendoSDK NX Addon で提供されます。</p>
<h2 id="Anchor_107342563_h2_2">対応プラットフォーム</h2>
<p>Windows および NX プラットフォームに対応しています。</p>
<h2 id="Anchor_107342563_h2_3">関連項目</h2>
<p>VSI を使って、NX プラットフォーム上でアプリケーションを実行・デバッグするには、Target Manager を起動しておく必要があります。</p>
<p>詳しくは、<a href="../Pages/Page_93359711.html">開発機の制御／Target Manager</a> をご覧ください。</p>
<h1 id="Anchor_107342563_h1_2">デバッガの機能</h1>
<p>Windows アプリケーションのデバッグの際に Visual Studio で使用できる機能は、基本的には NX プラットフォームでもサポートします。</p>
<h3 id="Anchor_107342563_h3_1">NX 固有の挙動を伴う機能</h3>
<h4 id="Anchor_107342563_h4_1">アセンブリファイルのビルド</h4>
<ul>
  <li>VSI for NX では、アセンブリファイルをプロジェクトに追加するだけで、コンパイル・リンクが行われます。</li>
</ul>
<h4 id="Anchor_107342563_h4_2">コンパイル済みヘッダ</h4>
<ul>
  <li>VSI for NX では、コンパイル済みヘッダは自動的にインクルードされます</li>
</ul>
<h3 id="Anchor_107342563_h3_2">NX 固有の機能</h3>
<h4 id="Anchor_107342563_h4_3">ソースファイルの単体処理</h4>
<p>ソリューションエクスプローラ上でソースコードを右クリックし、「Preprocess ～」や「Disassemble ～」を選択すると、そのファイルのプリプロセスや逆アセンブルを一時的に生成、確認することが可能です。</p>
<h3 id="Anchor_107342563_h3_3">非サポートの機能</h3>
<p>今後対応予定のものも含みます。</p>
<ul>
  <li>ウォッチウインドウでのフォーマット指定子</li>
  <li>ウォッチウインドウでの式評価</li>
  <li>ウォッチウインドウでの式の再設定</li>
  <li>いくつかのレジスタの値の編集</li>
  <li>エディットコンティニュー</li>
  <li>呼び出し履歴ウインドウ &gt; コンテキストメニュー &gt; このフレームへのアンワインド</li>
  <li>並列スタックウインドウ &gt;&nbsp;スタックの表示プルダウンリスト &gt; タスク</li>
  <li>並列スタックウインドウ &gt; コンテキストメニュー &gt;&nbsp;タスクに移動</li>
</ul>
<h1 id="Anchor_107342563_h1_3">デバッグ情報</h1>
<p>NX アプリケーションのデバッグ情報は拡張子が nss のファイルに格納されています。</p>
<p>VSI を使って NX アプリケーションをデバッグする際は、以下のディレクトリから nss ファイルを検索します。</p>
<ul>
  <li>プログラムの出力ディレクトリ (拡張子が nspd ディレクトリや nca のファイルが出力されるディレクトリ)</li>
  <li>ライブラリディレクトリ</li>
</ul>
<p>これらのディレクトリ内に必要な nss ファイルが見つからなかった場合、&quot;Unable to find debug data for （モジュール名）.&quot; というログが Target Manager　に出力されます。</p>
<h1 id="Anchor_107342563_h1_4">互換性</h1>
<p>VSI のバージョンは、Target Manager のバージョンと必ず一致している必要があります。<br />Target Manager と、FW や他のツールとの互換性については <a href="../Pages/Page_93359711.html#Anchor_93359711_h1_6">Target Manager の互換性</a>&nbsp;を参照してください。</p>
<h1 id="Anchor_107342563_h1_5">インストール・アンインストール・再インストール</h1>
<p>VSI は Target Manager と紐づいているため、VSI の(再)インストールの際には、Target Manager の(再)インストールも行っていただく必要があります。</p>
<p>手順は以下となります。</p>
<h5 id="Anchor_107342563_h5_1">事前準備</h5>
<p>あらかじめ Target Manager, Visual Studio をすべて終了させておきます。</p>
<h5 id="Anchor_107342563_h5_2">アンインストール</h5>
<ol>
  <li>現在インストールされている Target Manager に対応した Nintendo SDK の、NintendoSDK\Installers\TargetManager\Uninstall.bat を実行する</li>
  <li>現在インストールされている VSI に対応した Nintendo SDK の、NintendoSDK\Installers\Vsi\Uninstall.bat を実行する</li>
</ol>
<p>
  <br />
</p>
<div class="warn_new">
  <div class="warn_new_left">警告：</div>
  <div class="warn_new_right">
    <p>これからインストールする Nintendo SDK に含まれる Uninstall.bat を実行するわけではないことに注意してください。</p>
  </div>
</div>
<p>Target Manager と NX Addon のバージョン対応は&nbsp;<a href="../Pages/Page_93359711.html#Anchor_93359711_h2_22">開発機の制御／Target Manager - 各 NX Addon に含まれる Target Manager のバージョン</a>&nbsp;を参照してください。</p>
<h5 id="Anchor_107342563_h5_3">インストール</h5>
<ol>
  <li>インストールしたい Target Manager が含まれる Nintendo SDK の、NintendoSDK\Installers\TargetManager\Install.bat を実行する</li>
  <li>インストールしたい VSI が含まれる Nintendo SDK の、NintendoSDK\Installers\Vsi\Install.bat を実行する</li>
</ol>
<h5 id="Anchor_107342563_h5_4">再インストール</h5>
<p>上述の手順に従って、アンインストールを行った後、インストールを行ってください。</p>
<div class="info_new">
  <div class="info_new_left">参考：</div>
  <div class="info_new_right">
    <p>特定のバージョン(4.3.4～<span style="color: rgb(51,51,51);">5.2.2.22477_Hotfix1</span>)の VSI 2015 がインストールされている場合、そのアンインストール時に、ドライブ直下のファイルが削除される問題がありました。</p>
    <p>この問題に遭遇する条件を満たしている場合は、上記バッチファイル実行時に、ダイアログが出て処理が中断されます。</p>
    <p>適切に対処したうえで再試行してください。</p>
  </div>
</div>
<p>
  <br />
</p>
<h1 id="Anchor_107342563_h1_6">複数台のデバッグ</h1>
<p>一つの VSI のインスタンスは、複数台の同時デバッグをサポートしていません。<br />複数のプログラムを同時にデバッグする場合は、それぞれに対して VS を立ち上げてデバッグしてください。<br />なお、同時デバッグできるインスタンスの数に上限はありませんが、PC のリソースという観点で実質的上限が存在します。<br />また、動作検証が行われている台数は2台までとなるため、それを超えた台数を同時にデバッグする場合などに、不具合がある可能性があります。</p>
<h1 id="Anchor_107342563_h1_7">制限事項</h1>
<p>制限事項について説明します。これらは非サポートの機能や既知の不具合とは異なり、修正予定はありません。</p>
<h2 id="Anchor_107342563_h2_4">デバッグ中に「すべて中断 (Ctrl+Alt+Break) 」を使用して停止した場合、変数の値が正しくないことがある</h2>
<p>すべて中断した場合、PC, SP 以外のレジスタの値は保証されません。その結果、レジスタ上でのみ更新されるよう最適化された変数の値も正しくない場合があります。<br />確実な状態で停止させるためには、ブレークポイントやアサートなどで停止してください。<br />ステップ実行などでコードを進めることで、正しい状態に戻る場合もあります。</p>
<h2 id="Anchor_107342563_h2_5">アタッチ直後に nn::diag::IsDebuggerAttached() を呼び出した場合、アタッチしていないという結果が返ることがある</h2>
<p>
  <span class="ApiLink_nn__diag__IsDebuggerAttached">nn::diag::IsDebuggerAttached</span>()&nbsp;&nbsp;は呼び出した時点での状態を返す API です。アタッチした直後にこの関数を呼び出した場合、アタッチされていない状態として結果を返すタイミングが、短いながらも存在する可能性があります。</p>
</div>
<div class="breadcrumb_bottom"></div>
<div class="page_navigation">
<table class="page_navi_root">
<tr>
<td class="page_navi_left"></td>
<td class="page_navi_right"></td>
</tr>
<tr><td colspan="2" class="page_navi_bottom"></td></tr>
</table>
</div>
</div>
</div>
<!--AddLink-->
<script>
var NintendoSdkApiRefernce = {
    idMap: {},
    linkRewrite: function ()
    {
        var idMap = NintendoSdkApiRefernce.idMap;
        function rewrite(el)
        {
            var e = idMap[el.className];
            if (e === undefined)
            {
                return;
            }
            var html = '';
            html += '<a href=';
            html += e.url;
            html += ' target="_blank">';
            html += el.innerHTML;
            html += '</a>';
            el.innerHTML = html;
        }
        var apiLinkElems = document.querySelectorAll('span[class*="ApiLink_"]');
        for (var i = 0, n = apiLinkElems.length; i< n; ++i) {
            rewrite(apiLinkElems[i]);
        }
    }
};
function SetUrl( id, url )
{
    NintendoSdkApiRefernce.idMap[id] = { url: url };
}
SetUrl( 'ApiLink_nn__diag__IsDebuggerAttached', '../../../Api/HtmlNX/namespacenn_1_1diag.html#a11289e5a5c20b19933ea319a220988b3' )

NintendoSdkApiRefernce.linkRewrite();
</script>
<!--AddLink-->
</body>
</html>
